(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9338],{68652:(e,s,a)=>{Promise.resolve().then(a.bind(a,69575))},69575:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>A});var l=a(95155),t=a(12115),n=a(20063),i=a(34818),r=a(3998),c=a(86948),d=a(65142),o=a(76444),m=a(31120),u=a(19708),x=a(15894),h=a(92033),p=a(83883),j=a(15567),g=a(26615),v=a(5225),f=a(1554),N=a(99470),w=a(50916);function A(){let e=(0,n.useRouter)(),s=(0,n.useParams)().id,{toast:a}=(0,x.dj)(),{user:A}=(0,f.Jd)(),C=(0,f.jt)(),[k,b]=(0,t.useState)(""),[y,T]=(0,t.useState)(""),[E,S]=(0,t.useState)(null),[O,_]=(0,t.useState)(null),z=(0,t.useRef)(null),$=(0,t.useRef)(null),R=(0,t.useRef)(null),L=(0,f.$e)(()=>A&&s?(0,u.H9)(C,"users/".concat(A.uid,"/messageTemplates/").concat(s)):null,[C,A,s]),{data:Z,isLoading:B}=(0,N.u)(L);return((0,t.useEffect)(()=>{Z&&(b(Z.title),T(Z.content))},[Z]),B)?(0,l.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,l.jsx)(h.A,{className:"h-8 w-8 animate-spin text-primary"})}):Z?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.z,{title:"Editar Template: ".concat(Z.title)}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-8 items-start",children:[(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)(c.Zp,{children:[(0,l.jsxs)(c.aR,{children:[(0,l.jsx)(c.ZB,{children:"Conte\xfado do Template"}),(0,l.jsx)(c.BT,{children:"Ajuste o conte\xfado da sua mensagem. Use as vari\xe1veis dispon\xedveis para personaliza\xe7\xe3o."})]}),(0,l.jsxs)(c.Wu,{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{htmlFor:"title",children:"T\xedtulo do Template"}),(0,l.jsx)(d.p,{id:"title",placeholder:"Ex: Lembrete de Consulta",value:k,onChange:e=>b(e.target.value)})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{htmlFor:"content",children:"Conte\xfado da Mensagem"}),(0,l.jsx)(m.T,{id:"content",ref:R,placeholder:"Ol\xe1 {{NOME_CLIENTE}}, sua consulta est\xe1 marcada para...",className:"min-h-[200px]",value:y,onChange:e=>T(e.target.value)})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{children:"Vari\xe1veis Clic\xe1veis"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:[{name:"{{NOME_CLIENTE}}",description:"O nome completo do paciente."},{name:"{{DATA_CONSULTA}}",description:"A data da consulta agendada."},{name:"{{HORA_CONSULTA}}",description:"A hora da consulta agendada."}].map(e=>(0,l.jsx)(r.$,{variant:"outline",size:"sm",className:"font-mono text-xs",onClick:()=>(e=>{let s=R.current;if(s){let a=s.selectionStart,l=s.selectionEnd;T(y.substring(0,a)+e+y.substring(l)),setTimeout(()=>{s.focus(),s.selectionStart=s.selectionEnd=a+e.length},0)}})(e.name),children:e.name},e.name))})]})]})]}),(0,l.jsxs)(c.Zp,{children:[(0,l.jsxs)(c.aR,{children:[(0,l.jsx)(c.ZB,{children:"Anexos"}),(0,l.jsx)(c.BT,{children:"Adicione imagens ou documentos \xe0 sua mensagem (opcional)."})]}),(0,l.jsxs)(c.Wu,{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)(r.$,{variant:"outline",onClick:()=>{var e;return null==(e=z.current)?void 0:e.click()},children:[(0,l.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Anexar Imagem"]}),(0,l.jsx)("input",{type:"file",ref:z,className:"hidden",accept:"image/*",onChange:e=>{var s;return S((null==(s=e.target.files)?void 0:s[0])||null)}}),E&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,l.jsx)(j.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:E.name}),(0,l.jsx)(r.$,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>S(null),children:(0,l.jsx)(g.A,{className:"h-4 w-4"})})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)(r.$,{variant:"outline",onClick:()=>{var e;return null==(e=$.current)?void 0:e.click()},children:[(0,l.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Anexar Documento"]}),(0,l.jsx)("input",{type:"file",ref:$,className:"hidden",accept:".pdf,.doc,.docx",onChange:e=>{var s;return _((null==(s=e.target.files)?void 0:s[0])||null)}}),O&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,l.jsx)(j.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:O.name}),(0,l.jsx)(r.$,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>_(null),children:(0,l.jsx)(g.A,{className:"h-4 w-4"})})]})]})]})]})]}),(0,l.jsxs)("div",{className:"space-y-6 sticky top-8",children:[(0,l.jsxs)(c.Zp,{children:[(0,l.jsx)(c.aR,{children:(0,l.jsx)(c.ZB,{children:"Pr\xe9-visualiza\xe7\xe3o"})}),(0,l.jsx)(c.Wu,{children:(0,l.jsx)("div",{className:"bg-black border-black border-4 rounded-2xl w-full max-w-sm mx-auto shadow-xl",children:(0,l.jsx)("div",{className:"bg-white p-4 rounded-lg min-h-[400px] flex flex-col",children:(0,l.jsx)("div",{className:"flex-grow flex flex-col justify-end",children:(0,l.jsxs)("div",{className:"bg-green-200 p-2.5 rounded-lg max-w-[85%] self-end",children:[(E||O)&&(0,l.jsxs)("div",{className:"p-2 rounded-md bg-green-300/50 mb-2 flex items-center gap-2",children:[E&&(0,l.jsx)(p.A,{className:"h-5 w-5 text-green-900"}),O&&(0,l.jsx)(v.A,{className:"h-5 w-5 text-green-900"}),(0,l.jsx)("span",{className:"text-xs text-green-900 font-medium truncate",children:(null==E?void 0:E.name)||(null==O?void 0:O.name)})]}),(0,l.jsx)("p",{className:"text-sm text-gray-800 whitespace-pre-wrap break-words",children:y||"Sua mensagem aparecer\xe1 aqui..."}),(0,l.jsx)("p",{className:"text-xs text-right text-gray-500 mt-1",children:"10:30"})]})})})})})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)(r.$,{variant:"outline",onClick:()=>{e.push("/templates")},children:"Cancelar"}),(0,l.jsx)(r.$,{onClick:()=>{if(L){if(!k||!y)return void a({variant:"destructive",title:"Campos obrigat\xf3rios",description:"O t\xedtulo e o conte\xfado do template n\xe3o podem estar vazios."});(0,w.wu)(L,{title:k,content:y,hasImage:!!E,hasDocument:!!O},{merge:!0}),a({title:"Template atualizado!",description:"Suas altera\xe7\xf5es foram salvas com sucesso."}),e.push("/templates")}},children:"Salvar Altera\xe7\xf5es"})]})]})]})]}):(0,l.jsx)("div",{className:"text-center",children:(0,l.jsx)("p",{children:"Template n\xe3o encontrado."})})}},92033:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(14294).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},99470:(e,s,a)=>{"use strict";a.d(s,{u:()=>r});var l=a(12115),t=a(19708),n=a(9891),i=a(86501);function r(e){let[s,a]=(0,l.useState)(null),[r,c]=(0,l.useState)(!1),[d,o]=(0,l.useState)(null);return(0,l.useEffect)(()=>{if(!e){a(null),c(!1),o(null);return}c(!0),o(null);let s=(0,t.aQ)(e,e=>{e.exists()?a({...e.data(),id:e.id}):a(null),o(null),c(!1)},s=>{let l=new i.$({operation:"get",path:e.path});o(l),a(null),c(!1),n.d.emit("permission-error",l)});return()=>s()},[e]),{data:s,isLoading:r,error:d}}}},e=>{e.O(0,[2992,7138,7112,9251,1659,8863,8441,1255,7358],()=>e(e.s=68652)),_N_E=e.O()}]);