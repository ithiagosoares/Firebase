(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5830],{5807:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>f});var l=a(95155),n=a(12115),t=a(20063),i=a(34818),r=a(3998),c=a(86948),d=a(65142),o=a(76444),m=a(31120),x=a(19708),u=a(15894),h=a(83883),p=a(15567),j=a(26615),v=a(5225),g=a(1554),N=a(50916);function f(){let e=(0,t.useRouter)(),{toast:s}=(0,u.dj)(),{user:a}=(0,g.Jd)(),f=(0,g.jt)(),[C,w]=(0,n.useState)(""),[A,b]=(0,n.useState)(""),[k,T]=(0,n.useState)(null),[y,E]=(0,n.useState)(null),S=(0,n.useRef)(null),O=(0,n.useRef)(null),_=(0,n.useRef)(null);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.z,{title:"Criar Novo Template"}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-8 items-start",children:[(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)(c.Zp,{children:[(0,l.jsxs)(c.aR,{children:[(0,l.jsx)(c.ZB,{children:"Conte\xfado do Template"}),(0,l.jsx)(c.BT,{children:"Defina o t\xedtulo e o conte\xfado da sua mensagem. Use as vari\xe1veis dispon\xedveis para personaliza\xe7\xe3o."})]}),(0,l.jsxs)(c.Wu,{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{htmlFor:"title",children:"T\xedtulo do Template"}),(0,l.jsx)(d.p,{id:"title",placeholder:"Ex: Lembrete de Consulta",value:C,onChange:e=>w(e.target.value)})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{htmlFor:"content",children:"Conte\xfado da Mensagem"}),(0,l.jsx)(m.T,{id:"content",ref:_,placeholder:"Ol\xe1 {{NOME_CLIENTE}}, sua consulta est\xe1 marcada para...",className:"min-h-[200px]",value:A,onChange:e=>b(e.target.value)})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(o.J,{children:"Vari\xe1veis Clic\xe1veis"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:[{name:"{{NOME_CLIENTE}}",description:"O nome completo do paciente."},{name:"{{DATA_CONSULTA}}",description:"A data da consulta agendada."},{name:"{{HORA_CONSULTA}}",description:"A hora da consulta agendada."}].map(e=>(0,l.jsx)(r.$,{variant:"outline",size:"sm",className:"font-mono text-xs",onClick:()=>(e=>{let s=_.current;if(s){let a=s.selectionStart,l=s.selectionEnd;b(A.substring(0,a)+e+A.substring(l)),setTimeout(()=>{s.focus(),s.selectionStart=s.selectionEnd=a+e.length},0)}})(e.name),children:e.name},e.name))})]})]})]}),(0,l.jsxs)(c.Zp,{children:[(0,l.jsxs)(c.aR,{children:[(0,l.jsx)(c.ZB,{children:"Anexos"}),(0,l.jsx)(c.BT,{children:"Adicione imagens ou documentos \xe0 sua mensagem (opcional)."})]}),(0,l.jsxs)(c.Wu,{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)(r.$,{variant:"outline",onClick:()=>{var e;return null==(e=S.current)?void 0:e.click()},children:[(0,l.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Anexar Imagem"]}),(0,l.jsx)("input",{type:"file",ref:S,className:"hidden",accept:"image/*",onChange:e=>{var s;return T((null==(s=e.target.files)?void 0:s[0])||null)}}),k&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,l.jsx)(p.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:k.name}),(0,l.jsx)(r.$,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>T(null),children:(0,l.jsx)(j.A,{className:"h-4 w-4"})})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)(r.$,{variant:"outline",onClick:()=>{var e;return null==(e=O.current)?void 0:e.click()},children:[(0,l.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Anexar Documento"]}),(0,l.jsx)("input",{type:"file",ref:O,className:"hidden",accept:".pdf,.doc,.docx",onChange:e=>{var s;return E((null==(s=e.target.files)?void 0:s[0])||null)}}),y&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,l.jsx)(p.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:y.name}),(0,l.jsx)(r.$,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>E(null),children:(0,l.jsx)(j.A,{className:"h-4 w-4"})})]})]})]})]})]}),(0,l.jsxs)("div",{className:"space-y-6 sticky top-8",children:[(0,l.jsxs)(c.Zp,{children:[(0,l.jsx)(c.aR,{children:(0,l.jsx)(c.ZB,{children:"Pr\xe9-visualiza\xe7\xe3o"})}),(0,l.jsx)(c.Wu,{children:(0,l.jsx)("div",{className:"bg-black border-black border-4 rounded-2xl w-full max-w-sm mx-auto shadow-xl",children:(0,l.jsx)("div",{className:"bg-white p-4 rounded-lg min-h-[400px] flex flex-col",children:(0,l.jsx)("div",{className:"flex-grow flex flex-col justify-end",children:(0,l.jsxs)("div",{className:"bg-green-200 p-2.5 rounded-lg max-w-[85%] self-end",children:[(k||y)&&(0,l.jsxs)("div",{className:"p-2 rounded-md bg-green-300/50 mb-2 flex items-center gap-2",children:[k&&(0,l.jsx)(h.A,{className:"h-5 w-5 text-green-900"}),y&&(0,l.jsx)(v.A,{className:"h-5 w-5 text-green-900"}),(0,l.jsx)("span",{className:"text-xs text-green-900 font-medium truncate",children:(null==k?void 0:k.name)||(null==y?void 0:y.name)})]}),(0,l.jsx)("p",{className:"text-sm text-gray-800 whitespace-pre-wrap break-words",children:A||"Sua mensagem aparecer\xe1 aqui..."}),(0,l.jsx)("p",{className:"text-xs text-right text-gray-500 mt-1",children:"10:30"})]})})})})})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)(r.$,{variant:"outline",onClick:()=>{e.push("/templates")},children:"Cancelar"}),(0,l.jsx)(r.$,{onClick:()=>{if(!a||!f)return void s({variant:"destructive",title:"Erro de autentica\xe7\xe3o",description:"Voc\xea precisa estar logado para salvar um template."});if(!C||!A)return void s({variant:"destructive",title:"Campos obrigat\xf3rios",description:"O t\xedtulo e o conte\xfado do template n\xe3o podem estar vazios."});let l=(0,x.rJ)(f,"users/".concat(a.uid,"/messageTemplates")),n={title:C,content:A,userId:a.uid,hasImage:!!k,hasDocument:!!y};(0,N.BH)(l,n),s({title:"Template salvo!",description:"Seu novo modelo de mensagem foi criado com sucesso."}),e.push("/templates")},children:"Salvar Template"})]})]})]})]})}},16492:(e,s,a)=>{Promise.resolve().then(a.bind(a,5807))}},e=>{e.O(0,[2992,7138,7112,9251,1659,8863,8441,1255,7358],()=>e(e.s=16492)),_N_E=e.O()}]);