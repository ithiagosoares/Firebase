(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1346],{1001:(e,t,r)=>{"use strict";r.d(t,{k:()=>d});var a=r(95155),s=r(12115),n=r(42687),o=r(70682),i=r(19708);function d(e){let{date:t,showTime:r=!1,timeOnly:d=!1}=e,[l,u]=(0,s.useState)("");return((0,s.useEffect)(()=>{try{let e=t instanceof i.Dc?t.toDate():t,a=Intl.DateTimeFormat().resolvedOptions().timeZone,s=(0,o.L_)(e,a),l="dd/MM/yyyy";d?l="HH:mm":r&&(l="dd/MM/yyyy HH:mm"),u((0,n.GP)(s,l))}catch(e){console.error("Invalid date for formatting:",t),u("Data inv\xe1lida")}},[t,r,d]),l)?(0,a.jsx)(a.Fragment,{children:l}):null}},1554:(e,t,r)=>{"use strict";r.d(t,{ZJ:()=>d,R8:()=>l,As:()=>c,D3:()=>u,sh:()=>f,jt:()=>m,$e:()=>p,Jd:()=>h});var a=r(95155),s=r(12115),n=r(59253),o=r(9891);function i(){let[e,t]=(0,s.useState)(null);if((0,s.useEffect)(()=>{let e=e=>{t(e)};return o.d.on("permission-error",e),()=>{o.d.off("permission-error",e)}},[]),e)throw e;return null}let d=(0,s.createContext)(void 0),l=e=>{let{children:t,firebaseApp:r,firestore:o,auth:l}=e,[u,c]=(0,s.useState)({user:null,isUserLoading:!0,userError:null});(0,s.useEffect)(()=>{if(!l)return void c({user:null,isUserLoading:!1,userError:Error("Auth service not provided.")});c({user:null,isUserLoading:!0,userError:null});let e=(0,n.hg)(l,e=>{c({user:e,isUserLoading:!1,userError:null})},e=>{console.error("FirebaseProvider: onAuthStateChanged error:",e),c({user:null,isUserLoading:!1,userError:e})});return()=>e()},[l]);let m=(0,s.useMemo)(()=>{let e=!!(r&&o&&l);return{areServicesAvailable:e,firebaseApp:e?r:null,firestore:e?o:null,auth:e?l:null,user:u.user,isUserLoading:u.isUserLoading,userError:u.userError}},[r,o,l,u]);return(0,a.jsxs)(d.Provider,{value:m,children:[(0,a.jsx)(i,{}),t]})},u=()=>{let e=(0,s.useContext)(d);if(void 0===e)throw Error("useFirebase must be used within a FirebaseProvider.");if(!e.areServicesAvailable||!e.firebaseApp||!e.firestore||!e.auth)throw Error("Firebase core services not available. Check FirebaseProvider props.");return{firebaseApp:e.firebaseApp,firestore:e.firestore,auth:e.auth,user:e.user,isUserLoading:e.isUserLoading,userError:e.userError}},c=()=>{let{auth:e}=u();return e},m=()=>{let{firestore:e}=u();return e},f=()=>{let{firebaseApp:e}=u();return e};function p(e,t){let r=(0,s.useMemo)(e,t);return"object"!=typeof r||null===r||(r.__memo=!0),r}let h=()=>{let{user:e,isUserLoading:t,userError:r}=u();return{user:e,isUserLoading:t,userError:r}}},3998:(e,t,r)=>{"use strict";r.d(t,{$:()=>l,r:()=>d});var a=r(95155),s=r(12115),n=r(32467),o=r(83101),i=r(64269);let d=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,t)=>{let{className:r,variant:s,size:o,asChild:l=!1,...u}=e,c=l?n.DX:"button";return(0,a.jsx)(c,{className:(0,i.cn)(d({variant:s,size:o,className:r})),ref:t,...u})});l.displayName="Button"},9891:(e,t,r)=>{"use strict";r.d(t,{d:()=>a});let a=function(){let e={};return{on(t,r){var a;e[t]||(e[t]=[]),null==(a=e[t])||a.push(r)},off(t,r){var a;e[t]&&(e[t]=null==(a=e[t])?void 0:a.filter(e=>e!==r))},emit(t,r){var a;e[t]&&(null==(a=e[t])||a.forEach(e=>e(r)))}}}()},11647:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var a=r(95155);r(12115);var s=r(83101),n=r(64269);let o=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(o({variant:r}),t),...s})}},15894:(e,t,r)=>{"use strict";r.d(t,{dj:()=>c});var a=r(12115);let s=0,n=new Map,o=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),l({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},i=[],d={toasts:[]};function l(e){d=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?o(r):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(d,e),i.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>l({type:"DISMISS_TOAST",toastId:r});return l({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>l({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function c(){let[e,t]=a.useState(d);return a.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>l({type:"DISMISS_TOAST",toastId:e})}}},34818:(e,t,r)=>{"use strict";r.d(t,{z:()=>n});var a=r(95155),s=r(64269);function n(e){let{title:t,children:r,className:n,...o}=e;return(0,a.jsxs)("div",{className:(0,s.cn)("flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-6",n),...o,children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:t}),r&&(0,a.jsx)("div",{className:"flex shrink-0 items-center gap-2",children:r})]})}},41048:(e,t,r)=>{"use strict";r.d(t,{G:()=>i});var a=r(12115),s=r(19708),n=r(9891),o=r(86501);function i(e){let[t,r]=(0,a.useState)(null),[i,d]=(0,a.useState)(!1),[l,u]=(0,a.useState)(null);if((0,a.useEffect)(()=>{if(!e){r(null),d(!1),u(null);return}d(!0),u(null);let t=(0,s.aQ)(e,e=>{let t=[];for(let r of e.docs)t.push({...r.data(),id:r.id});r(t),u(null),d(!1)},t=>{let a="collection"===e.type?e.path:e._query.path.canonicalString(),s=new o.$({operation:"list",path:a});u(s),r(null),d(!1),n.d.emit("permission-error",s)});return()=>t()},[e]),e&&!e.__memo)throw Error(e+" was not properly memoized using useMemoFirebase");return{data:t,isLoading:i,error:l}}},50276:(e,t,r)=>{"use strict";r.d(t,{V:()=>l});var a=r(95155);r(12115);var s=r(51190),n=r(63263),o=r(58954),i=r(64269),d=r(3998);function l(e){let{className:t,classNames:r,showOutsideDays:l=!0,...u}=e;return(0,a.jsx)(o.hv,{showOutsideDays:l,className:(0,i.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,i.cn)((0,d.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,i.cn)((0,d.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:e=>{let{className:t,...r}=e;return(0,a.jsx)(s.A,{className:(0,i.cn)("h-4 w-4",t),...r})},IconRight:e=>{let{className:t,...r}=e;return(0,a.jsx)(n.A,{className:(0,i.cn)("h-4 w-4",t),...r})}},...u})}l.displayName="Calendar"},50916:(e,t,r)=>{"use strict";r.d(t,{BH:()=>i,pt:()=>d,wu:()=>o,zb:()=>l});var a=r(19708),s=r(9891),n=r(86501);function o(e,t,r){(0,a.BN)(e,t,r).catch(r=>{console.error("setDocumentNonBlocking failed:",r),s.d.emit("permission-error",new n.$({path:e.path,operation:"write",requestResourceData:t}))})}function i(e,t){return(0,a.gS)(e,t).catch(r=>{console.error("addDocumentNonBlocking failed:",r),s.d.emit("permission-error",new n.$({path:e.path,operation:"create",requestResourceData:t}))})}function d(e,t){(0,a.mZ)(e,t).catch(r=>{console.error("updateDocumentNonBlocking failed:",r),s.d.emit("permission-error",new n.$({path:e.path,operation:"update",requestResourceData:t}))})}function l(e,t){let r;r=void 0!==t&&"firestore"in e?(0,a.H9)(e,t):e,(0,a.kd)(r).catch(e=>{console.error("deleteDocumentNonBlocking failed:",e),s.d.emit("permission-error",new n.$({path:r.path,operation:"delete"}))})}},56221:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>_});var a=r(95155),s=r(12115),n=r(34818),o=r(11647),i=r(50276),d=r(86948),l=r(19708),u=r(92033),c=r(28638),m=r(42687),f=r(95136),p=r(70682),h=r(3998),g=r(15894),v=r(1001),x=r(1554),y=r(41048),b=r(50916),w=r(86501),N=r(9891);function _(){let[e,t]=(0,s.useState)([]),[r,_]=(0,s.useState)(!0),[j,S]=(0,s.useState)(new Date),{user:E}=(0,x.Jd)(),D=(0,x.jt)(),{toast:T}=(0,g.dj)(),A=(0,x.$e)(()=>E?(0,l.rJ)(D,"users/".concat(E.uid,"/patients")):null,[D,E]),{data:C,isLoading:I}=(0,y.G)(A),R=async()=>{if(E&&D&&C)try{let e=C.map(e=>{let t=(0,l.rJ)(D,"users/".concat(E.uid,"/patients/").concat(e.id,"/appointments"));return(0,l.GG)(t)}),r=(await Promise.all(e)).flatMap((e,t)=>{let r=C[t].name;return e.docs.map(e=>{let t=e.data();return{id:e.id,...t,patientName:r||"Paciente",type:t.notes||"Consulta"}})});t(r)}catch(t){let e=new w.$({operation:"list",path:"appointments for user ".concat(E.uid)});N.d.emit("permission-error",e)}finally{_(!1)}};(0,s.useEffect)(()=>{E&&D&&!I&&R()},[E,D,C,I]);let M=(0,s.useMemo)(()=>e.map(e=>e.dateTime.toDate()),[e]),k=(0,s.useMemo)(()=>{if(!j)return[];let t=Intl.DateTimeFormat().resolvedOptions().timeZone,r=(0,p.L_)(j,t);return e.filter(e=>{let a=(0,p.L_)(e.dateTime.toDate(),t);return(0,c.r)(a,r)})},[e,j]),O=async()=>{if(!E||!j||!C||0===C.length)return void T({variant:"destructive",title:"N\xe3o \xe9 poss\xedvel salvar",description:"Selecione uma data e tenha certeza de que h\xe1 pacientes cadastrados."});let e=C[0],t=Intl.DateTimeFormat().resolvedOptions().timeZone,r=(0,m.GP)(j,"yyyy-MM-dd"),a="".concat(r," ").concat("11:00"),s=(0,f.qg)(a,"yyyy-MM-dd HH:mm",new Date),n=(0,p.L_)(s,t),o={patientId:e.id,userId:E.uid,dateTime:l.Dc.fromDate(n),notes:"Consulta agendada"},i=(0,l.rJ)(D,"users/".concat(E.uid,"/patients/").concat(e.id,"/appointments"));await (0,b.BH)(i,o),T({title:"Consulta Agendada!",description:"Consulta para ".concat(e.name," em ").concat(s.toLocaleString()," foi agendada.")}),R()};return r||I?(0,a.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,a.jsx)(u.A,{className:"h-8 w-8 animate-spin text-primary"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.z,{title:"Calend\xe1rio de Consultas",children:(0,a.jsx)(h.$,{onClick:O,children:"Agendar Consulta para 11:00"})}),(0,a.jsxs)("div",{className:"grid md:grid-cols-[1fr_350px] gap-8 items-start",children:[(0,a.jsx)(d.Zp,{children:(0,a.jsx)(d.Wu,{className:"p-0",children:(0,a.jsx)(i.V,{mode:"single",selected:j,onSelect:S,className:"p-3 w-full",classNames:{day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground"},modifiers:{withAppointment:M},modifiersClassNames:{withAppointment:"day-with-appointment"}})})}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"Consultas do Dia"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("div",{className:"space-y-4",children:k.length>0?k.map(e=>(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"font-semibold",children:(0,a.jsx)(v.k,{date:e.dateTime,showTime:!0,timeOnly:!0})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium",children:e.patientName}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.type})]}),(0,a.jsx)(o.E,{variant:"Retorno"===e.type?"secondary":"default",children:"Primeira Consulta"===e.type?"Novo":"Retorno"===e.type?"Retorno":"Rotina"})]},e.id)):(0,a.jsx)("p",{className:"text-muted-foreground text-center",children:"Nenhuma consulta para este dia."})})})]})]})]})}},61626:(e,t,r)=>{Promise.resolve().then(r.bind(r,56221))},64269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(2821),s=r(75889);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},86501:(e,t,r)=>{"use strict";r.d(t,{$:()=>s});var a=r(59253);class s extends Error{constructor(e){let t=function(e){let t=null;try{let e=(0,a.xI)().currentUser;e&&(t=function(e){var t;if(!e)return null;let r={name:e.displayName,email:e.email,email_verified:e.emailVerified,phone_number:e.phoneNumber,sub:e.uid,firebase:{identities:e.providerData.reduce((e,t)=>(t.providerId&&(e[t.providerId]=[t.uid]),e),{}),sign_in_provider:(null==(t=e.providerData[0])?void 0:t.providerId)||"custom",tenant:e.tenantId}};return{uid:e.uid,token:r}}(e))}catch(e){}return{auth:t,method:e.operation,path:"/databases/(default)/documents/".concat(e.path),resource:e.requestResourceData?{data:e.requestResourceData}:void 0}}(e);super("Missing or insufficient permissions: The following request was denied by Firestore Security Rules:\n".concat(JSON.stringify(t,null,2))),this.name="FirebaseError",this.request=t}}},86948:(e,t,r)=>{"use strict";r.d(t,{BT:()=>l,Wu:()=>u,ZB:()=>d,Zp:()=>o,aR:()=>i,wL:()=>c});var a=r(95155),s=r(12115),n=r(64269);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});o.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});d.displayName="CardTitle";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});l.displayName="CardDescription";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});u.displayName="CardContent";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})});c.displayName="CardFooter"}},e=>{e.O(0,[2992,7138,7112,9251,1659,2687,8820,663,6326,8441,1255,7358],()=>e(e.s=61626)),_N_E=e.O()}]);