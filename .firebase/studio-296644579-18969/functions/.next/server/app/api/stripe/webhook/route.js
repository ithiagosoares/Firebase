(()=>{var exports={};exports.id=287,exports.ids=[287],exports.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3421:(a,b,c)=>{"use strict";var d;d={value:!0},Object.defineProperty(b,"I",{enumerable:!0,get:function(){return h}});let e=c(71237),f=c(55088),g=c(17679);async function h(a,b,c,d){if((0,e.isNodeNextResponse)(b)){var h;b.statusCode=c.status,b.statusMessage=c.statusText;let e=["set-cookie","www-authenticate","proxy-authenticate","vary"];null==(h=c.headers)||h.forEach((a,c)=>{if("x-middleware-set-cookie"!==c.toLowerCase())if("set-cookie"===c.toLowerCase())for(let d of(0,g.splitCookiesString)(a))b.appendHeader(c,d);else{let d=void 0!==b.getHeader(c);(e.includes(c.toLowerCase())||!d)&&b.appendHeader(c,a)}});let{originalResponse:i}=b;c.body&&"HEAD"!==a.method?await (0,f.pipeToNodeResponse)(c.body,i,d):i.end()}}},4673:(a,b,c)=>{"use strict";a.exports=e;var d=c(13884);function e(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)this[b[c]]=a[b[c]]}e.create=function(a){return this.$type.create(a)},e.encode=function(a,b){return this.$type.encode(a,b)},e.encodeDelimited=function(a,b){return this.$type.encodeDelimited(a,b)},e.decode=function(a){return this.$type.decode(a)},e.decodeDelimited=function(a){return this.$type.decodeDelimited(a)},e.verify=function(a){return this.$type.verify(a)},e.fromObject=function(a){return this.$type.fromObject(a)},e.toObject=function(a,b){return this.$type.toObject(a,b)},e.prototype.toJSON=function(){return this.$type.toObject(this,d.toJSONOptions)}},4781:(a,b)=>{"use strict";var c=b,d=c.isAbsolute=function(a){return/^(?:\/|\w+:)/.test(a)},e=c.normalize=function(a){var b=(a=a.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),c=d(a),e="";c&&(e=b.shift()+"/");for(var f=0;f<b.length;)".."===b[f]?f>0&&".."!==b[f-1]?b.splice(--f,2):c?b.splice(f,1):++f:"."===b[f]?b.splice(f,1):++f;return e+b.join("/")};c.resolve=function(a,b,c){return(c||(b=e(b)),d(b))?b:(c||(a=e(a)),(a=a.replace(/(?:\/|^)[^/]+$/,"")).length?e(a+"/"+b):b)}},4825:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.validateLoadBalancingConfig=b.getFirstUsableConfig=b.isLoadBalancerNameRegistered=b.createLoadBalancer=b.registerDefaultLoadBalancerType=b.registerLoadBalancerType=b.createChildChannelControlHelper=void 0,b.createChildChannelControlHelper=function(a,b){var c,d,e,f,g,h,i,j,k,l;return{createSubchannel:null!=(d=null==(c=b.createSubchannel)?void 0:c.bind(b))?d:a.createSubchannel.bind(a),updateState:null!=(f=null==(e=b.updateState)?void 0:e.bind(b))?f:a.updateState.bind(a),requestReresolution:null!=(h=null==(g=b.requestReresolution)?void 0:g.bind(b))?h:a.requestReresolution.bind(a),addChannelzChild:null!=(j=null==(i=b.addChannelzChild)?void 0:i.bind(b))?j:a.addChannelzChild.bind(a),removeChannelzChild:null!=(l=null==(k=b.removeChannelzChild)?void 0:k.bind(b))?l:a.removeChannelzChild.bind(a)}};let c={},d=null;b.registerLoadBalancerType=function(a,b,d){c[a]={LoadBalancer:b,LoadBalancingConfig:d}},b.registerDefaultLoadBalancerType=function(a){d=a},b.createLoadBalancer=function(a,b){let d=a.getLoadBalancerName();return d in c?new c[d].LoadBalancer(b):null},b.isLoadBalancerNameRegistered=function(a){return a in c},b.getFirstUsableConfig=function(a,b=!1){for(let b of a)if(b.getLoadBalancerName()in c)return b;return b&&d?new c[d].LoadBalancingConfig:null},b.validateLoadBalancingConfig=function(a){if(null===a||"object"!=typeof a)throw Error("Load balancing config must be an object");let b=Object.keys(a);if(1!==b.length)throw Error("Provided load balancing config has multiple conflicting entries");let d=b[0];if(d in c)return c[d].LoadBalancingConfig.createFromJson(a[d]);throw Error(`Unrecognized load balancing config name ${d}`)}},5546:(a,b,c)=>{"use strict";var d=a.exports=c(52519);d.build="full",d.tokenize=c(43545),d.parse=c(52109),d.common=c(26345),d.Root._configure(d.Type,d.parse,d.common)},8129:(a,b)=>{"use strict";var c=b;c.length=function(a){for(var b=0,c=0,d=0;d<a.length;++d)(c=a.charCodeAt(d))<128?b+=1:c<2048?b+=2:(64512&c)==55296&&(64512&a.charCodeAt(d+1))==56320?(++d,b+=4):b+=3;return b},c.read=function(a,b,c){if(c-b<1)return"";for(var d,e=null,f=[],g=0;b<c;)(d=a[b++])<128?f[g++]=d:d>191&&d<224?f[g++]=(31&d)<<6|63&a[b++]:d>239&&d<365?(d=((7&d)<<18|(63&a[b++])<<12|(63&a[b++])<<6|63&a[b++])-65536,f[g++]=55296+(d>>10),f[g++]=56320+(1023&d)):f[g++]=(15&d)<<12|(63&a[b++])<<6|63&a[b++],g>8191&&((e||(e=[])).push(String.fromCharCode.apply(String,f)),g=0);return e?(g&&e.push(String.fromCharCode.apply(String,f.slice(0,g))),e.join("")):String.fromCharCode.apply(String,f.slice(0,g))},c.write=function(a,b,c){for(var d,e,f=c,g=0;g<a.length;++g)(d=a.charCodeAt(g))<128?b[c++]=d:(d<2048?b[c++]=d>>6|192:((64512&d)==55296&&(64512&(e=a.charCodeAt(g+1)))==56320?(d=65536+((1023&d)<<10)+(1023&e),++g,b[c++]=d>>18|240,b[c++]=d>>12&63|128):b[c++]=d>>12|224,b[c++]=d>>6&63|128),b[c++]=63&d|128);return c-f}},9758:(a,b,c)=>{"use strict";a.exports=j;var d,e=c(38575);((j.prototype=Object.create(e.prototype)).constructor=j).className="Field";var f=c(60081),g=c(56207),h=c(36544),i=/^required|optional|repeated$/;function j(a,b,c,d,f,j,k){if(h.isObject(d)?(k=f,j=d,d=f=void 0):h.isObject(f)&&(k=j,j=f,f=void 0),e.call(this,a,j),!h.isInteger(b)||b<0)throw TypeError("id must be a non-negative integer");if(!h.isString(c))throw TypeError("type must be a string");if(void 0!==d&&!i.test(d=d.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==f&&!h.isString(f))throw TypeError("extend must be a string");"proto3_optional"===d&&(d="optional"),this.rule=d&&"optional"!==d?d:void 0,this.type=c,this.id=b,this.extend=f||void 0,this.repeated="repeated"===d,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!h.Long&&void 0!==g.long[c],this.bytes="bytes"===c,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=k}j.fromJSON=function(a,b){var c=new j(a,b.id,b.type,b.rule,b.extend,b.options,b.comment);return b.edition&&(c._edition=b.edition),c._defaultEdition="proto3",c},Object.defineProperty(j.prototype,"required",{get:function(){return"LEGACY_REQUIRED"===this._features.field_presence}}),Object.defineProperty(j.prototype,"optional",{get:function(){return!this.required}}),Object.defineProperty(j.prototype,"delimited",{get:function(){return this.resolvedType instanceof d&&"DELIMITED"===this._features.message_encoding}}),Object.defineProperty(j.prototype,"packed",{get:function(){return"PACKED"===this._features.repeated_field_encoding}}),Object.defineProperty(j.prototype,"hasPresence",{get:function(){return!this.repeated&&!this.map&&(this.partOf||this.declaringField||this.extensionField||"IMPLICIT"!==this._features.field_presence)}}),j.prototype.setOption=function(a,b,c){return e.prototype.setOption.call(this,a,b,c)},j.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return h.toObject(["edition",this._editionToJSON(),"rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",b?this.comment:void 0])},j.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=g.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof d?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof f&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof f||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=h.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var a;h.base64.test(this.typeDefault)?h.base64.decode(this.typeDefault,a=h.newBuffer(h.base64.length(this.typeDefault)),0):h.utf8.write(this.typeDefault,a=h.newBuffer(h.utf8.length(this.typeDefault)),0),this.typeDefault=a}return this.map?this.defaultValue=h.emptyObject:this.repeated?this.defaultValue=h.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof d&&(this.parent.ctor.prototype[this.name]=this.defaultValue),e.prototype.resolve.call(this)},j.prototype._inferLegacyProtoFeatures=function(a){if("proto2"!==a&&"proto3"!==a)return{};var b={};if("required"===this.rule&&(b.field_presence="LEGACY_REQUIRED"),this.parent&&void 0===g.defaults[this.type]){var c=this.parent.get(this.type.split(".").pop());c&&c instanceof d&&c.group&&(b.message_encoding="DELIMITED")}return!0===this.getOption("packed")?b.repeated_field_encoding="PACKED":!1===this.getOption("packed")&&(b.repeated_field_encoding="EXPANDED"),b},j.prototype._resolveFeatures=function(a){return e.prototype._resolveFeatures.call(this,this._edition||a)},j.d=function(a,b,c,d){return"function"==typeof b?b=h.decorateType(b).name:b&&"object"==typeof b&&(b=h.decorateEnum(b).name),function(e,f){h.decorateType(e.constructor).add(new j(f,a,b,c,{default:d}))}},j._configure=function(a){d=a}},9874:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.deadlineToString=b.getRelativeTimeout=b.getDeadlineTimeoutString=b.minDeadline=void 0,b.minDeadline=function(...a){let b=1/0;for(let c of a){let a=c instanceof Date?c.getTime():c;a<b&&(b=a)}return b};let c=[["m",1],["S",1e3],["M",6e4],["H",36e5]];b.getDeadlineTimeoutString=function(a){let b=new Date().getTime();a instanceof Date&&(a=a.getTime());let d=Math.max(a-b,0);for(let[a,b]of c){let c=d/b;if(c<1e8)return String(Math.ceil(c))+a}throw Error("Deadline is too far in the future")};let d=0x7fffffff;b.getRelativeTimeout=function(a){let b=(a instanceof Date?a.getTime():a)-new Date().getTime();return b<0?0:b>d?1/0:b},b.deadlineToString=function(a){if(a instanceof Date)return a.toISOString();{let b=new Date(a);return Number.isNaN(b.getTime())?""+a:b.toISOString()}}},10059:(a,b,c)=>{"use strict";a.exports=g;var d=c(38575);((g.prototype=Object.create(d.prototype)).constructor=g).className="OneOf";var e=c(9758),f=c(36544);function g(a,b,c,e){if(Array.isArray(b)||(c=b,b=void 0),d.call(this,a,c),!(void 0===b||Array.isArray(b)))throw TypeError("fieldNames must be an Array");this.oneof=b||[],this.fieldsArray=[],this.comment=e}function h(a){if(a.parent)for(var b=0;b<a.fieldsArray.length;++b)a.fieldsArray[b].parent||a.parent.add(a.fieldsArray[b])}g.fromJSON=function(a,b){return new g(a,b.oneof,b.options,b.comment)},g.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return f.toObject(["options",this.options,"oneof",this.oneof,"comment",b?this.comment:void 0])},g.prototype.add=function(a){if(!(a instanceof e))throw TypeError("field must be a Field");return a.parent&&a.parent!==this.parent&&a.parent.remove(a),this.oneof.push(a.name),this.fieldsArray.push(a),a.partOf=this,h(this),this},g.prototype.remove=function(a){if(!(a instanceof e))throw TypeError("field must be a Field");var b=this.fieldsArray.indexOf(a);if(b<0)throw Error(a+" is not a member of "+this);return this.fieldsArray.splice(b,1),(b=this.oneof.indexOf(a.name))>-1&&this.oneof.splice(b,1),a.partOf=null,this},g.prototype.onAdd=function(a){d.prototype.onAdd.call(this,a);for(var b=this,c=0;c<this.oneof.length;++c){var e=a.get(this.oneof[c]);e&&!e.partOf&&(e.partOf=b,b.fieldsArray.push(e))}h(this)},g.prototype.onRemove=function(a){for(var b,c=0;c<this.fieldsArray.length;++c)(b=this.fieldsArray[c]).parent&&b.parent.remove(b);d.prototype.onRemove.call(this,a)},Object.defineProperty(g.prototype,"isProto3Optional",{get:function(){if(null==this.fieldsArray||1!==this.fieldsArray.length)return!1;var a=this.fieldsArray[0];return null!=a.options&&!0===a.options.proto3_optional}}),g.d=function(){for(var a=Array(arguments.length),b=0;b<arguments.length;)a[b]=arguments[b++];return function(b,c){f.decorateType(b.constructor).add(new g(c,a)),Object.defineProperty(b,c,{get:f.oneOfGetter(a),set:f.oneOfSetter(a)})}}},10356:a=>{"use strict";function b(a){return"undefined"!=typeof Float32Array?!function(){var b=new Float32Array([-0]),c=new Uint8Array(b.buffer),d=128===c[3];function e(a,d,e){b[0]=a,d[e]=c[0],d[e+1]=c[1],d[e+2]=c[2],d[e+3]=c[3]}function f(a,d,e){b[0]=a,d[e]=c[3],d[e+1]=c[2],d[e+2]=c[1],d[e+3]=c[0]}function g(a,d){return c[0]=a[d],c[1]=a[d+1],c[2]=a[d+2],c[3]=a[d+3],b[0]}function h(a,d){return c[3]=a[d],c[2]=a[d+1],c[1]=a[d+2],c[0]=a[d+3],b[0]}a.writeFloatLE=d?e:f,a.writeFloatBE=d?f:e,a.readFloatLE=d?g:h,a.readFloatBE=d?h:g}():!function(){function b(a,b,c,d){var e=+(b<0);if(e&&(b=-b),0===b)a(1/b>0?0:0x80000000,c,d);else if(isNaN(b))a(0x7fc00000,c,d);else if(b>34028234663852886e22)a((e<<31|0x7f800000)>>>0,c,d);else if(b<11754943508222875e-54)a((e<<31|Math.round(b/1401298464324817e-60))>>>0,c,d);else{var f=Math.floor(Math.log(b)/Math.LN2),g=8388607&Math.round(b*Math.pow(2,-f)*8388608);a((e<<31|f+127<<23|g)>>>0,c,d)}}function g(a,b,c){var d=a(b,c),e=(d>>31)*2+1,f=d>>>23&255,g=8388607&d;return 255===f?g?NaN:1/0*e:0===f?1401298464324817e-60*e*g:e*Math.pow(2,f-150)*(g+8388608)}a.writeFloatLE=b.bind(null,c),a.writeFloatBE=b.bind(null,d),a.readFloatLE=g.bind(null,e),a.readFloatBE=g.bind(null,f)}(),"undefined"!=typeof Float64Array?!function(){var b=new Float64Array([-0]),c=new Uint8Array(b.buffer),d=128===c[7];function e(a,d,e){b[0]=a,d[e]=c[0],d[e+1]=c[1],d[e+2]=c[2],d[e+3]=c[3],d[e+4]=c[4],d[e+5]=c[5],d[e+6]=c[6],d[e+7]=c[7]}function f(a,d,e){b[0]=a,d[e]=c[7],d[e+1]=c[6],d[e+2]=c[5],d[e+3]=c[4],d[e+4]=c[3],d[e+5]=c[2],d[e+6]=c[1],d[e+7]=c[0]}function g(a,d){return c[0]=a[d],c[1]=a[d+1],c[2]=a[d+2],c[3]=a[d+3],c[4]=a[d+4],c[5]=a[d+5],c[6]=a[d+6],c[7]=a[d+7],b[0]}function h(a,d){return c[7]=a[d],c[6]=a[d+1],c[5]=a[d+2],c[4]=a[d+3],c[3]=a[d+4],c[2]=a[d+5],c[1]=a[d+6],c[0]=a[d+7],b[0]}a.writeDoubleLE=d?e:f,a.writeDoubleBE=d?f:e,a.readDoubleLE=d?g:h,a.readDoubleBE=d?h:g}():!function(){function b(a,b,c,d,e,f){var g,h=+(d<0);if(h&&(d=-d),0===d)a(0,e,f+b),a(1/d>0?0:0x80000000,e,f+c);else if(isNaN(d))a(0,e,f+b),a(0x7ff80000,e,f+c);else if(d>17976931348623157e292)a(0,e,f+b),a((h<<31|0x7ff00000)>>>0,e,f+c);else if(d<22250738585072014e-324)a((g=d/5e-324)>>>0,e,f+b),a((h<<31|g/0x100000000)>>>0,e,f+c);else{var i=Math.floor(Math.log(d)/Math.LN2);1024===i&&(i=1023),a(0x10000000000000*(g=d*Math.pow(2,-i))>>>0,e,f+b),a((h<<31|i+1023<<20|1048576*g&1048575)>>>0,e,f+c)}}function g(a,b,c,d,e){var f=a(d,e+b),g=a(d,e+c),h=(g>>31)*2+1,i=g>>>20&2047,j=0x100000000*(1048575&g)+f;return 2047===i?j?NaN:1/0*h:0===i?5e-324*h*j:h*Math.pow(2,i-1075)*(j+0x10000000000000)}a.writeDoubleLE=b.bind(null,c,0,4),a.writeDoubleBE=b.bind(null,d,4,0),a.readDoubleLE=g.bind(null,e,0,4),a.readDoubleBE=g.bind(null,f,4,0)}(),a}function c(a,b,c){b[c]=255&a,b[c+1]=a>>>8&255,b[c+2]=a>>>16&255,b[c+3]=a>>>24}function d(a,b,c){b[c]=a>>>24,b[c+1]=a>>>16&255,b[c+2]=a>>>8&255,b[c+3]=255&a}function e(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24)>>>0}function f(a,b){return(a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3])>>>0}a.exports=b(b)},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12667:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Metadata=void 0;let d=c(35433),e=c(77797),f=c(98313),g=/^[0-9a-z_.-]+$/,h=/^[ -~]*$/;function i(a){return g.test(a)}function j(a){return h.test(a)}function k(a){return a.endsWith("-bin")}function l(a){return!a.startsWith("grpc-")}function m(a){return a.toLowerCase()}function n(a,b){if(!i(a))throw Error('Metadata key "'+a+'" contains illegal characters');if(null!=b)if(k(a)){if(!Buffer.isBuffer(b))throw Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(b))throw Error("keys that don't end with '-bin' must have String values");if(!j(b))throw Error('Metadata string value "'+b+'" contains illegal characters')}}class o{constructor(a={}){this.internalRepr=new Map,this.options=a}set(a,b){n(a=m(a),b),this.internalRepr.set(a,[b])}add(a,b){n(a=m(a),b);let c=this.internalRepr.get(a);void 0===c?this.internalRepr.set(a,[b]):c.push(b)}remove(a){a=m(a),this.internalRepr.delete(a)}get(a){return a=m(a),this.internalRepr.get(a)||[]}getMap(){let a={};for(let[b,c]of this.internalRepr)if(c.length>0){let d=c[0];a[b]=Buffer.isBuffer(d)?Buffer.from(d):d}return a}clone(){let a=new o(this.options),b=a.internalRepr;for(let[a,c]of this.internalRepr){let d=c.map(a=>Buffer.isBuffer(a)?Buffer.from(a):a);b.set(a,d)}return a}merge(a){for(let[b,c]of a.internalRepr){let a=(this.internalRepr.get(b)||[]).concat(c);this.internalRepr.set(b,a)}}setOptions(a){this.options=a}getOptions(){return this.options}toHttp2Headers(){let a={};for(let[b,c]of this.internalRepr)a[b]=c.map(p);return a}toJSON(){let a={};for(let[b,c]of this.internalRepr)a[b]=c;return a}static fromHttp2Headers(a){let b=new o;for(let c of Object.keys(a)){if(":"===c.charAt(0))continue;let g=a[c];try{k(c)?Array.isArray(g)?g.forEach(a=>{b.add(c,Buffer.from(a,"base64"))}):void 0!==g&&(l(c)?g.split(",").forEach(a=>{b.add(c,Buffer.from(a.trim(),"base64"))}):b.add(c,Buffer.from(g,"base64"))):Array.isArray(g)?g.forEach(a=>{b.add(c,a)}):void 0!==g&&b.add(c,g)}catch(b){let a=`Failed to add metadata entry ${c}: ${g}. ${(0,f.getErrorMessage)(b)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,d.log)(e.LogVerbosity.ERROR,a)}}return b}}b.Metadata=o;let p=a=>Buffer.isBuffer(a)?a.toString("base64"):a},13884:function(a,b,c){"use strict";var d=b;function e(a,b,c){for(var d=Object.keys(b),e=0;e<d.length;++e)void 0!==a[d[e]]&&c||(a[d[e]]=b[d[e]]);return a}function f(a){function b(a,c){if(!(this instanceof b))return new b(a,c);Object.defineProperty(this,"message",{get:function(){return a}}),Error.captureStackTrace?Error.captureStackTrace(this,b):Object.defineProperty(this,"stack",{value:Error().stack||""}),c&&e(this,c)}return b.prototype=Object.create(Error.prototype,{constructor:{value:b,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return a},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),b}d.asPromise=c(19275),d.base64=c(39833),d.EventEmitter=c(68320),d.float=c(10356),d.inquire=c(30015),d.utf8=c(8129),d.pool=c(59652),d.LongBits=c(73533),d.isNode=!!("undefined"!=typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),d.global=d.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,d.emptyArray=Object.freeze?Object.freeze([]):[],d.emptyObject=Object.freeze?Object.freeze({}):{},d.isInteger=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a},d.isString=function(a){return"string"==typeof a||a instanceof String},d.isObject=function(a){return a&&"object"==typeof a},d.isset=d.isSet=function(a,b){var c=a[b];return!!(null!=c&&a.hasOwnProperty(b))&&("object"!=typeof c||(Array.isArray(c)?c.length:Object.keys(c).length)>0)},d.Buffer=function(){try{var a=d.inquire("buffer").Buffer;return a.prototype.utf8Write?a:null}catch(a){return null}}(),d._Buffer_from=null,d._Buffer_allocUnsafe=null,d.newBuffer=function(a){return"number"==typeof a?d.Buffer?d._Buffer_allocUnsafe(a):new d.Array(a):d.Buffer?d._Buffer_from(a):"undefined"==typeof Uint8Array?a:new Uint8Array(a)},d.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,d.Long=d.global.dcodeIO&&d.global.dcodeIO.Long||d.global.Long||d.inquire("long"),d.key2Re=/^true|false|0|1$/,d.key32Re=/^-?(?:0|[1-9][0-9]*)$/,d.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,d.longToHash=function(a){return a?d.LongBits.from(a).toHash():d.LongBits.zeroHash},d.longFromHash=function(a,b){var c=d.LongBits.fromHash(a);return d.Long?d.Long.fromBits(c.lo,c.hi,b):c.toNumber(!!b)},d.merge=e,d.lcFirst=function(a){return a.charAt(0).toLowerCase()+a.substring(1)},d.newError=f,d.ProtocolError=f("ProtocolError"),d.oneOfGetter=function(a){for(var b={},c=0;c<a.length;++c)b[a[c]]=1;return function(){for(var a=Object.keys(this),c=a.length-1;c>-1;--c)if(1===b[a[c]]&&void 0!==this[a[c]]&&null!==this[a[c]])return a[c]}},d.oneOfSetter=function(a){return function(b){for(var c=0;c<a.length;++c)a[c]!==b&&delete this[a[c]]}},d.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},d._configure=function(){var a=d.Buffer;if(!a){d._Buffer_from=d._Buffer_allocUnsafe=null;return}d._Buffer_from=a.from!==Uint8Array.from&&a.from||function(b,c){return new a(b,c)},d._Buffer_allocUnsafe=a.allocUnsafe||function(b){return new a(b)}}},14230:(a,b,c)=>{"use strict";var d;d={value:!0},d={enumerable:!0,get:function(){return o}};let e=c(28706),f=c(33675),g=c(29294),h=c(63033),i=c(26906),j=c(11938),k=c(82831),l=c(30787),m=c(31716),n=c(49290);function o(){let a="cookies",b=g.workAsyncStorage.getStore(),c=h.workUnitAsyncStorage.getStore();if(b){if(c&&"after"===c.phase&&!(0,m.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${b.route} used "cookies" inside "after(...)". This is not supported. If you need this data inside an "after" callback, use "cookies" outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E88",enumerable:!1,configurable:!0});if(b.forceStatic)return t(p());if(b.dynamicShouldError)throw Object.defineProperty(new j.StaticGenBailoutError(`Route ${b.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`cookies\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E549",enumerable:!1,configurable:!0});if(c)switch(c.type){case"cache":let d=Object.defineProperty(Error(`Route ${b.route} used "cookies" inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "cookies" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E398",enumerable:!1,configurable:!0});throw Error.captureStackTrace(d,o),b.invalidDynamicUsageError??=d,d;case"unstable-cache":throw Object.defineProperty(Error(`Route ${b.route} used "cookies" inside a function cached with "unstable_cache(...)". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "cookies" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E157",enumerable:!1,configurable:!0});case"prerender":return r(b,c);case"prerender-client":let f="`cookies`";throw Object.defineProperty(new n.InvariantError(`${f} must not be used within a client component. Next.js should be preventing ${f} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,i.postponeWithTracking)(b.route,a,c.dynamicTracking);case"prerender-legacy":return(0,i.throwToInterruptStaticGeneration)(a,b,c);case"prerender-runtime":return(0,i.delayUntilRuntimeStage)(c,s(c.cookies));case"private-cache":return t(c.cookies);case"request":return(0,i.trackDynamicDataInDynamicRender)(c),t((0,e.areCookiesMutableInCurrentPhase)(c)?c.userspaceMutableCookies:c.cookies)}}(0,h.throwForMissingRequestStore)(a)}function p(){return e.RequestCookiesAdapter.seal(new f.RequestCookies(new Headers({})))}c(63036);let q=new WeakMap;function r(a,b){let c=q.get(b);if(c)return c;let d=(0,k.makeHangingPromise)(b.renderSignal,a.route,"`cookies()`");return q.set(b,d),d}function s(a){let b=q.get(a);if(b)return b;let c=Promise.resolve(a);return q.set(a,c),c}function t(a){let b=q.get(a);if(b)return b;let c=Promise.resolve(a);return q.set(a,c),Object.defineProperties(c,{[Symbol.iterator]:{value:a[Symbol.iterator]?a[Symbol.iterator].bind(a):w.bind(a)},size:{get:()=>a.size},get:{value:a.get.bind(a)},getAll:{value:a.getAll.bind(a)},has:{value:a.has.bind(a)},set:{value:a.set.bind(a)},delete:{value:a.delete.bind(a)},clear:{value:"function"==typeof a.clear?a.clear.bind(a):x.bind(a,c)},toString:{value:a.toString.bind(a)}}),c}let u=(0,l.createDedupedByCallsiteServerErrorLoggerDev)(v);function v(a,b){let c=a?`Route "${a}" `:"This route ";return Object.defineProperty(Error(`${c}used ${b}. \`cookies()\` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E223",enumerable:!1,configurable:!0})}function w(){return this.getAll().map(a=>[a.name,a]).values()}function x(a){for(let a of this.getAll())this.delete(a.name);return a}},14908:(a,b,c)=>{"use strict";var d;Object.defineProperty(b,"__esModule",{value:!0}),b.QueuePicker=b.UnavailablePicker=b.PickResultType=void 0;let e=c(12667),f=c(77797);!function(a){a[a.COMPLETE=0]="COMPLETE",a[a.QUEUE=1]="QUEUE",a[a.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",a[a.DROP=3]="DROP"}(d||(b.PickResultType=d={}));class g{constructor(a){this.status=Object.assign({code:f.Status.UNAVAILABLE,details:"No connection established",metadata:new e.Metadata},a)}pick(a){return{pickResultType:d.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}}b.UnavailablePicker=g;class h{constructor(a){this.loadBalancer=a,this.calledExitIdle=!1}pick(a){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:d.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}}b.QueuePicker=h},14952:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ChannelCredentials=void 0;let d=c(34631),e=c(53605),f=c(84549);function g(a,b){if(a&&!(a instanceof Buffer))throw TypeError(`${b}, if provided, must be a Buffer.`)}class h{constructor(a){this.callCredentials=a||e.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(a,b,c,e){var h;if(g(a,"Root certificate"),g(b,"Private key"),g(c,"Certificate chain"),b&&!c)throw Error("Private key must be given with accompanying certificate chain");if(!b&&c)throw Error("Certificate chain must be given with accompanying private key");return new j((0,d.createSecureContext)({ca:null!=(h=null!=a?a:(0,f.getDefaultRootsData)())?h:void 0,key:null!=b?b:void 0,cert:null!=c?c:void 0,ciphers:f.CIPHER_SUITES}),null!=e?e:{})}static createFromSecureContext(a,b){return new j(a,null!=b?b:{})}static createInsecure(){return new i}}b.ChannelCredentials=h;class i extends h{constructor(a){super(a)}compose(a){throw Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(a){return a instanceof i}}class j extends h{constructor(a,b){super(),this.secureContext=a,this.verifyOptions=b,this.connectionOptions={secureContext:a},(null==b?void 0:b.checkServerIdentity)&&(this.connectionOptions.checkServerIdentity=b.checkServerIdentity)}compose(a){return new k(this,this.callCredentials.compose(a))}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(a){return this===a||a instanceof j&&this.secureContext===a.secureContext&&this.verifyOptions.checkServerIdentity===a.verifyOptions.checkServerIdentity}}class k extends h{constructor(a,b){super(b),this.channelCredentials=a}compose(a){let b=this.callCredentials.compose(a);return new k(this.channelCredentials,b)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(a){return this===a||a instanceof k&&this.channelCredentials._equals(a.channelCredentials)&&this.callCredentials._equals(a.callCredentials)}}},14985:a=>{"use strict";a.exports=require("dns")},15981:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.getChannelzServiceDefinition=b.getChannelzHandlers=b.unregisterChannelzRef=b.registerChannelzSocket=b.registerChannelzServer=b.registerChannelzSubchannel=b.registerChannelzChannel=b.ChannelzCallTracker=b.ChannelzChildrenTracker=b.ChannelzTrace=void 0;let d=c(91645),e=c(40249),f=c(77797),g=c(74590),h=c(58279),i=c(42226);function j(a){return{channel_id:a.id,name:a.name}}function k(a){return{subchannel_id:a.id,name:a.name}}function l(a){return{server_id:a.id}}function m(a){return{socket_id:a.id,name:a.name}}let n=32;class o{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(a,b,c){let d=new Date;this.events.push({description:b,severity:a,timestamp:d,childChannel:(null==c?void 0:c.kind)==="channel"?c:void 0,childSubchannel:(null==c?void 0:c.kind)==="subchannel"?c:void 0}),this.events.length>=2*n&&(this.events=this.events.slice(n)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:B(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(a=>({description:a.description,severity:a.severity,timestamp:B(a.timestamp),channel_ref:a.childChannel?j(a.childChannel):null,subchannel_ref:a.childSubchannel?k(a.childSubchannel):null}))}}}b.ChannelzTrace=o;class p{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(a){var b,c,d;switch(a.kind){case"channel":{let c=null!=(b=this.channelChildren.get(a.id))?b:{ref:a,count:0};c.count+=1,this.channelChildren.set(a.id,c);break}case"subchannel":{let b=null!=(c=this.subchannelChildren.get(a.id))?c:{ref:a,count:0};b.count+=1,this.subchannelChildren.set(a.id,b);break}case"socket":{let b=null!=(d=this.socketChildren.get(a.id))?d:{ref:a,count:0};b.count+=1,this.socketChildren.set(a.id,b)}}}unrefChild(a){switch(a.kind){case"channel":{let b=this.channelChildren.get(a.id);void 0!==b&&(b.count-=1,0===b.count?this.channelChildren.delete(a.id):this.channelChildren.set(a.id,b));break}case"subchannel":{let b=this.subchannelChildren.get(a.id);void 0!==b&&(b.count-=1,0===b.count?this.subchannelChildren.delete(a.id):this.subchannelChildren.set(a.id,b));break}case"socket":{let b=this.socketChildren.get(a.id);void 0!==b&&(b.count-=1,0===b.count?this.socketChildren.delete(a.id):this.socketChildren.set(a.id,b))}}}getChildLists(){let a=[];for(let{ref:b}of this.channelChildren.values())a.push(b);let b=[];for(let{ref:a}of this.subchannelChildren.values())b.push(a);let c=[];for(let{ref:a}of this.socketChildren.values())c.push(a);return{channels:a,subchannels:b,sockets:c}}}b.ChannelzChildrenTracker=p;class q{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}}b.ChannelzCallTracker=q;let r=1;function s(){return r++}let t=[],u=[],v=[],w=[];function x(a){let b=Number.parseInt(a,16);return[b/256|0,b%256]}function y(a){return""===a?[]:[].concat(...a.split(":").map(a=>x(a)))}function z(a){if((0,d.isIPv4)(a))return Buffer.from(Uint8Array.from(a.split(".").map(a=>Number.parseInt(a))));if(!(0,d.isIPv6)(a))return null;{let b,c,d=a.indexOf("::");-1===d?(b=a,c=""):(b=a.substring(0,d),c=a.substring(d+2));let e=Buffer.from(y(b)),f=Buffer.from(y(c)),g=Buffer.alloc(16-e.length-f.length,0);return Buffer.concat([e,g,f])}}function A(a){switch(a){case e.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case e.ConnectivityState.IDLE:return{state:"IDLE"};case e.ConnectivityState.READY:return{state:"READY"};case e.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case e.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function B(a){if(!a)return null;let b=a.getTime();return{seconds:b/1e3|0,nanos:b%1e3*1e6}}function C(a){let b=a.getInfo();return{ref:j(a.ref),data:{target:b.target,state:A(b.state),calls_started:b.callTracker.callsStarted,calls_succeeded:b.callTracker.callsSucceeded,calls_failed:b.callTracker.callsFailed,last_call_started_timestamp:B(b.callTracker.lastCallStartedTimestamp),trace:b.trace.getTraceMessage()},channel_ref:b.children.channels.map(a=>j(a)),subchannel_ref:b.children.subchannels.map(a=>k(a))}}function D(a,b){let c=Number.parseInt(a.request.channel_id),d=t[c];if(void 0===d)return void b({code:f.Status.NOT_FOUND,details:"No channel data found for id "+c});b(null,{channel:C(d)})}function E(a,b){let c=Number.parseInt(a.request.max_results),d=[],e=Number.parseInt(a.request.start_channel_id);for(;e<t.length;e++){let a=t[e];if(void 0!==a&&(d.push(C(a)),d.length>=c))break}b(null,{channel:d,end:e>=v.length})}function F(a){let b=a.getInfo();return{ref:l(a.ref),data:{calls_started:b.callTracker.callsStarted,calls_succeeded:b.callTracker.callsSucceeded,calls_failed:b.callTracker.callsFailed,last_call_started_timestamp:B(b.callTracker.lastCallStartedTimestamp),trace:b.trace.getTraceMessage()},listen_socket:b.listenerChildren.sockets.map(a=>m(a))}}function G(a,b){let c=Number.parseInt(a.request.server_id),d=v[c];if(void 0===d)return void b({code:f.Status.NOT_FOUND,details:"No server data found for id "+c});b(null,{server:F(d)})}function H(a,b){let c=Number.parseInt(a.request.max_results),d=[],e=Number.parseInt(a.request.start_server_id);for(;e<v.length;e++){let a=v[e];if(void 0!==a&&(d.push(F(a)),d.length>=c))break}b(null,{server:d,end:e>=v.length})}function I(a,b){let c=Number.parseInt(a.request.subchannel_id),d=u[c];if(void 0===d)return void b({code:f.Status.NOT_FOUND,details:"No subchannel data found for id "+c});let e=d.getInfo();b(null,{subchannel:{ref:k(d.ref),data:{target:e.target,state:A(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:B(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},socket_ref:e.children.sockets.map(a=>m(a))}})}function J(a){var b;return(0,g.isTcpSubchannelAddress)(a)?{address:"tcpip_address",tcpip_address:{ip_address:null!=(b=z(a.host))?b:void 0,port:a.port}}:{address:"uds_address",uds_address:{filename:a.path}}}function K(a,b){var c,d,e,g,h;let i=Number.parseInt(a.request.socket_id),j=w[i];if(void 0===j)return void b({code:f.Status.NOT_FOUND,details:"No socket data found for id "+i});let k=j.getInfo(),l=k.security?{model:"tls",tls:{cipher_suite:k.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:null!=(c=k.security.cipherSuiteStandardName)?c:void 0,other_name:null!=(d=k.security.cipherSuiteOtherName)?d:void 0,local_certificate:null!=(e=k.security.localCertificate)?e:void 0,remote_certificate:null!=(g=k.security.remoteCertificate)?g:void 0}}:null;b(null,{socket:{ref:m(j.ref),local:k.localAddress?J(k.localAddress):null,remote:k.remoteAddress?J(k.remoteAddress):null,remote_name:null!=(h=k.remoteName)?h:void 0,security:l,data:{keep_alives_sent:k.keepAlivesSent,streams_started:k.streamsStarted,streams_succeeded:k.streamsSucceeded,streams_failed:k.streamsFailed,last_local_stream_created_timestamp:B(k.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:B(k.lastRemoteStreamCreatedTimestamp),messages_received:k.messagesReceived,messages_sent:k.messagesSent,last_message_received_timestamp:B(k.lastMessageReceivedTimestamp),last_message_sent_timestamp:B(k.lastMessageSentTimestamp),local_flow_control_window:k.localFlowControlWindow?{value:k.localFlowControlWindow}:null,remote_flow_control_window:k.remoteFlowControlWindow?{value:k.remoteFlowControlWindow}:null}}})}function L(a,b){let c=Number.parseInt(a.request.server_id),d=v[c];if(void 0===d)return void b({code:f.Status.NOT_FOUND,details:"No server data found for id "+c});let e=Number.parseInt(a.request.start_socket_id),g=Number.parseInt(a.request.max_results),h=d.getInfo().sessionChildren.sockets.sort((a,b)=>a.id-b.id),i=[],j=0;for(;j<h.length&&(!(h[j].id>=e)||(i.push(m(h[j])),!(i.length>=g)));j++);b(null,{socket_ref:i,end:j>=h.length})}function M(){return{GetChannel:D,GetTopChannels:E,GetServer:G,GetServers:H,GetSubchannel:I,GetSocket:K,GetServerSockets:L}}b.registerChannelzChannel=function(a,b,c){let d=s(),e={id:d,name:a,kind:"channel"};return c&&(t[d]={ref:e,getInfo:b}),e},b.registerChannelzSubchannel=function(a,b,c){let d=s(),e={id:d,name:a,kind:"subchannel"};return c&&(u[d]={ref:e,getInfo:b}),e},b.registerChannelzServer=function(a,b){let c=s(),d={id:c,kind:"server"};return b&&(v[c]={ref:d,getInfo:a}),d},b.registerChannelzSocket=function(a,b,c){let d=s(),e={id:d,name:a,kind:"socket"};return c&&(w[d]={ref:e,getInfo:b}),e},b.unregisterChannelzRef=function(a){switch(a.kind){case"channel":delete t[a.id];return;case"subchannel":delete u[a.id];return;case"server":delete v[a.id];return;case"socket":delete w[a.id];return}},b.getChannelzHandlers=M;let N=null;function O(){if(N)return N;let a=(0,c(69602).Yi)("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return N=(0,i.loadPackageDefinition)(a).grpc.channelz.v1.Channelz.service}b.getChannelzServiceDefinition=O,b.setup=function(){(0,h.registerAdminService)(O,M)}},18404:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.InterceptingListenerImpl=b.isInterceptingListener=void 0,b.isInterceptingListener=function(a){return void 0!==a.onReceiveMetadata&&1===a.onReceiveMetadata.length};class c{constructor(a,b){this.listener=a,this.nextListener=b,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(a){this.processingMetadata=!0,this.listener.onReceiveMetadata(a,a=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(a),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(a){this.processingMessage=!0,this.listener.onReceiveMessage(a,a=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=a,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(a),this.processPendingStatus())})}onReceiveStatus(a){this.listener.onReceiveStatus(a,a=>{this.processingMetadata||this.processingMessage?this.pendingStatus=a:this.nextListener.onReceiveStatus(a)})}}b.InterceptingListenerImpl=c},18677:(a,b,c)=>{"use strict";a.exports=l;var d,e,f,g=c(38575);((l.prototype=Object.create(g.prototype)).constructor=l).className="Namespace";var h=c(9758),i=c(36544),j=c(10059);function k(a,b){if(a&&a.length){for(var c={},d=0;d<a.length;++d)c[a[d].name]=a[d].toJSON(b);return c}}function l(a,b){g.call(this,a,b),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function m(a){a._nestedArray=null,a._lookupCache={};for(var b=a;b=b.parent;)b._lookupCache={};return a}l.fromJSON=function(a,b){return new l(a,b.options).addJSON(b.nested)},l.arrayToJSON=k,l.isReservedId=function(a,b){if(a){for(var c=0;c<a.length;++c)if("string"!=typeof a[c]&&a[c][0]<=b&&a[c][1]>b)return!0}return!1},l.isReservedName=function(a,b){if(a){for(var c=0;c<a.length;++c)if(a[c]===b)return!0}return!1},Object.defineProperty(l.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=i.toArray(this.nested))}}),l.prototype.toJSON=function(a){return i.toObject(["options",this.options,"nested",k(this.nestedArray,a)])},l.prototype.addJSON=function(a){var b=this;if(a)for(var c,g=Object.keys(a),i=0;i<g.length;++i)c=a[g[i]],b.add((void 0!==c.fields?d.fromJSON:void 0!==c.values?f.fromJSON:void 0!==c.methods?e.fromJSON:void 0!==c.id?h.fromJSON:l.fromJSON)(g[i],c));return this},l.prototype.get=function(a){return this.nested&&this.nested[a]||null},l.prototype.getEnum=function(a){if(this.nested&&this.nested[a]instanceof f)return this.nested[a].values;throw Error("no such enum: "+a)},l.prototype.add=function(a){if(!(a instanceof h&&void 0!==a.extend||a instanceof d||a instanceof j||a instanceof f||a instanceof e||a instanceof l))throw TypeError("object must be a valid nested object");if(this.nested){var b=this.get(a.name);if(b)if(b instanceof l&&a instanceof l&&!(b instanceof d||b instanceof e)){for(var c=b.nestedArray,g=0;g<c.length;++g)a.add(c[g]);this.remove(b),this.nested||(this.nested={}),a.setOptions(b.options,!0)}else throw Error("duplicate name '"+a.name+"' in "+this)}else this.nested={};this.nested[a.name]=a,this instanceof d||this instanceof e||this instanceof f||this instanceof h||a._edition||(a._edition=a._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var i=this;i=i.parent;)i._needsRecursiveFeatureResolution=!0,i._needsRecursiveResolve=!0;return a.onAdd(this),m(this)},l.prototype.remove=function(a){if(!(a instanceof g))throw TypeError("object must be a ReflectionObject");if(a.parent!==this)throw Error(a+" is not a member of "+this);return delete this.nested[a.name],Object.keys(this.nested).length||(this.nested=void 0),a.onRemove(this),m(this)},l.prototype.define=function(a,b){if(i.isString(a))a=a.split(".");else if(!Array.isArray(a))throw TypeError("illegal path");if(a&&a.length&&""===a[0])throw Error("path must be relative");for(var c=this;a.length>0;){var d=a.shift();if(c.nested&&c.nested[d]){if(!((c=c.nested[d])instanceof l))throw Error("path conflicts with non-namespace objects")}else c.add(c=new l(d))}return b&&c.addJSON(b),c},l.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var a=this.nestedArray,b=0;for(this.resolve();b<a.length;)a[b]instanceof l?a[b++].resolveAll():a[b++].resolve();return this._needsRecursiveResolve=!1,this},l.prototype._resolveFeaturesRecursive=function(a){return this._needsRecursiveFeatureResolution&&(this._needsRecursiveFeatureResolution=!1,a=this._edition||a,g.prototype._resolveFeaturesRecursive.call(this,a),this.nestedArray.forEach(b=>{b._resolveFeaturesRecursive(a)})),this},l.prototype.lookup=function(a,b,c){if("boolean"==typeof b?(c=b,b=void 0):b&&!Array.isArray(b)&&(b=[b]),i.isString(a)&&a.length){if("."===a)return this.root;a=a.split(".")}else if(!a.length)return this;var d=a.join(".");if(""===a[0])return this.root.lookup(a.slice(1),b);var e=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+d];if(e&&(!b||b.indexOf(e.constructor)>-1)||(e=this._lookupImpl(a,d))&&(!b||b.indexOf(e.constructor)>-1))return e;if(c)return null;for(var f=this;f.parent;){if((e=f.parent._lookupImpl(a,d))&&(!b||b.indexOf(e.constructor)>-1))return e;f=f.parent}return null},l.prototype._lookupImpl=function(a,b){if(Object.prototype.hasOwnProperty.call(this._lookupCache,b))return this._lookupCache[b];var c=this.get(a[0]),d=null;if(c)1===a.length?d=c:c instanceof l&&(a=a.slice(1),d=c._lookupImpl(a,a.join(".")));else for(var e=0;e<this.nestedArray.length;++e)this._nestedArray[e]instanceof l&&(c=this._nestedArray[e]._lookupImpl(a,b))&&(d=c);return this._lookupCache[b]=d,d},l.prototype.lookupType=function(a){var b=this.lookup(a,[d]);if(!b)throw Error("no such type: "+a);return b},l.prototype.lookupEnum=function(a){var b=this.lookup(a,[f]);if(!b)throw Error("no such Enum '"+a+"' in "+this);return b},l.prototype.lookupTypeOrEnum=function(a){var b=this.lookup(a,[d,f]);if(!b)throw Error("no such Type or Enum '"+a+"' in "+this);return b},l.prototype.lookupService=function(a){var b=this.lookup(a,[e]);if(!b)throw Error("no such Service '"+a+"' in "+this);return b},l._configure=function(a,b,c){d=a,e=b,f=c}},19275:a=>{"use strict";a.exports=function a(a,b){for(var c=Array(arguments.length-1),d=0,e=2,f=!0;e<arguments.length;)c[d++]=arguments[e++];return new Promise(function(e,g){c[d]=function(a){if(f)if(f=!1,a)g(a);else{for(var b=Array(arguments.length-1),c=0;c<b.length;)b[c++]=arguments[c];e.apply(null,b)}};try{a.apply(b||null,c)}catch(a){f&&(f=!1,g(a))}})}},19771:a=>{"use strict";a.exports=require("process")},21306:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getNextCallNumber=void 0;let c=0;b.getNextCallNumber=function(){return c++}},21820:a=>{"use strict";a.exports=require("os")},23220:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.uriToString=b.splitHostPort=b.parseUri=void 0;let c=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;b.parseUri=function(a){let b=c.exec(a);return null===b?null:{scheme:b[1],authority:b[2],path:b[3]}};let d=/^\d+$/;b.splitHostPort=function(a){if(a.startsWith("[")){let b=a.indexOf("]");if(-1===b)return null;let c=a.substring(1,b);if(-1===c.indexOf(":"))return null;if(!(a.length>b+1))return{host:c};if(":"!==a[b+1])return null;{let e=a.substring(b+2);return d.test(e)?{host:c,port:+e}:null}}{let b=a.split(":");return 2!==b.length?{host:a}:d.test(b[1])?{host:b[0],port:+b[1]}:null}},b.uriToString=function(a){let b="";return void 0!==a.scheme&&(b+=a.scheme+":"),void 0!==a.authority&&(b+="//"+a.authority+"/"),b+=a.path}},24775:a=>{"use strict";function b(a,c){"string"==typeof a&&(c=a,a=void 0);var d=[];function e(a){if("string"!=typeof a){var c=f();if(b.verbose&&console.log("codegen: "+c),c="return "+c,a){for(var g=Object.keys(a),h=Array(g.length+1),i=Array(g.length),j=0;j<g.length;)h[j]=g[j],i[j]=a[g[j++]];return h[j]=c,Function.apply(null,h).apply(null,i)}return Function(c)()}for(var k=Array(arguments.length-1),l=0;l<k.length;)k[l]=arguments[++l];if(l=0,a=a.replace(/%([%dfijs])/g,function(a,b){var c=k[l++];switch(b){case"d":case"f":return String(Number(c));case"i":return String(Math.floor(c));case"j":return JSON.stringify(c);case"s":return String(c)}return"%"}),l!==k.length)throw Error("parameter count mismatch");return d.push(a),e}function f(b){return"function "+(b||c||"")+"("+(a&&a.join(",")||"")+"){\n  "+d.join("\n  ")+"\n}"}return e.toString=f,e}a.exports=b,b.verbose=!1},24953:(a,b,c)=>{"use strict";a.exports=f;var d=c(38575);((f.prototype=Object.create(d.prototype)).constructor=f).className="Method";var e=c(36544);function f(a,b,c,f,g,h,i,j,k){if(e.isObject(g)?(i=g,g=h=void 0):e.isObject(h)&&(i=h,h=void 0),!(void 0===b||e.isString(b)))throw TypeError("type must be a string");if(!e.isString(c))throw TypeError("requestType must be a string");if(!e.isString(f))throw TypeError("responseType must be a string");d.call(this,a,i),this.type=b||"rpc",this.requestType=c,this.requestStream=!!g||void 0,this.responseType=f,this.responseStream=!!h||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=j,this.parsedOptions=k}f.fromJSON=function(a,b){return new f(a,b.type,b.requestType,b.responseType,b.requestStream,b.responseStream,b.options,b.comment,b.parsedOptions)},f.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return e.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",b?this.comment:void 0,"parsedOptions",this.parsedOptions])},f.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),d.prototype.resolve.call(this))}},25174:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.StatusBuilder=void 0;class c{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(a){return this.code=a,this}withDetails(a){return this.details=a,this}withMetadata(a){return this.metadata=a,this}build(){let a={};return null!==this.code&&(a.code=this.code),null!==this.details&&(a.details=this.details),null!==this.metadata&&(a.metadata=this.metadata),a}}b.StatusBuilder=c},25289:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.InternalChannel=void 0;let d=c(14952),e=c(70471),f=c(75046),g=c(14908),h=c(77797),i=c(91713),j=c(89293),k=c(66528),l=c(35433),m=c(78397),n=c(23220),o=c(40249),p=c(15981),q=c(34281),r=c(9874),s=c(55176),t=c(21306),u=c(90145),v=c(74981),w=c(87973),x=0x7fffffff,y=1e3,z=18e5,A=new Map,B=0x1000000,C=1048576;class D extends w.BaseSubchannelWrapper{constructor(a,b){super(a),this.channel=b,this.refCount=0,this.subchannelStateListener=(a,c,d,e)=>{b.throttleKeepalive(e)},a.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}}class E{constructor(a,b,c){var q,r,s,t,w,E,F,G;if(this.credentials=b,this.options=c,this.connectivityState=o.ConnectivityState.IDLE,this.currentPicker=new g.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new p.ChannelzCallTracker,this.childrenTracker=new p.ChannelzChildrenTracker,"string"!=typeof a)throw TypeError("Channel target must be a string");if(!(b instanceof d.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(c&&"object"!=typeof c)throw TypeError("Channel options must be an object");this.originalTarget=a;let H=(0,n.parseUri)(a);if(null===H)throw Error(`Could not parse target name "${a}"`);let I=(0,k.mapUriDefaultScheme)(H);if(null===I)throw Error(`Could not find a default scheme for target name "${a}"`);this.callRefTimer=setInterval(()=>{},x),null==(r=(q=this.callRefTimer).unref)||r.call(q),0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new p.ChannelzTrace,this.channelzRef=(0,p.registerChannelzChannel)(a,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,k.getDefaultAuthority)(I);let J=(0,m.mapProxyName)(I,c);this.target=J.target,this.options=Object.assign({},this.options,J.extraOptions),this.subchannelPool=(0,f.getSubchannelPool)((null!=(s=c["grpc.use_local_subchannel_pool"])?s:0)===0),this.retryBufferTracker=new v.MessageBufferTracker(null!=(t=c["grpc.retry_buffer_size"])?t:B,null!=(w=c["grpc.per_rpc_retry_buffer_size"])?w:C),this.keepaliveTime=null!=(E=c["grpc.keepalive_time_ms"])?E:-1,this.idleTimeoutMs=Math.max(null!=(F=c["grpc.client_idle_timeout_ms"])?F:z,y);let K={createSubchannel:(a,b)=>{let c=this.subchannelPool.getOrCreateSubchannel(this.target,a,Object.assign({},this.options,b),this.credentials);c.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",c.getChannelzRef());let d=new D(c,this);return this.wrappedSubchannels.add(d),d},updateState:(a,b)=>{this.currentPicker=b;let c=this.pickQueue.slice();for(let a of(this.pickQueue=[],c.length>0&&this.callRefTimerUnref(),c))a.doPick();this.updateState(a)},requestReresolution:()=>{throw Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:a=>{this.channelzEnabled&&this.childrenTracker.refChild(a)},removeChannelzChild:a=>{this.channelzEnabled&&this.childrenTracker.unrefChild(a)}};this.resolvingLoadBalancer=new e.ResolvingLoadBalancer(this.target,K,c,(a,b)=>{a.retryThrottling?A.set(this.getTarget(),new v.RetryThrottler(a.retryThrottling.maxTokens,a.retryThrottling.tokenRatio,A.get(this.getTarget()))):A.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=b,this.currentResolutionError=null,process.nextTick(()=>{let a=this.configSelectionQueue;for(let b of(this.configSelectionQueue=[],a.length>0&&this.callRefTimerUnref(),a))b.getConfig()})},a=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+a.code+' and details "'+a.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),null===this.configSelector&&(this.currentResolutionError=Object.assign(Object.assign({},(0,u.restrictControlPlaneStatusCode)(a.code,a.details)),{metadata:a.metadata}));let b=this.configSelectionQueue;for(let c of(this.configSelectionQueue=[],b.length>0&&this.callRefTimerUnref(),b))c.reportResolverError(a)}),this.filterStackFactory=new i.FilterStackFactory([new j.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(c,void 0,2));let L=Error();(0,l.trace)(h.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") Channel constructed \n"+(null==(G=L.stack)?void 0:G.substring(L.stack.indexOf("\n")+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(a,b){(0,l.trace)(null!=b?b:h.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,n.uriToString)(this.target)+" "+a)}callRefTimerRef(){var a,b,c,d;(null==(b=(a=this.callRefTimer).hasRef)?void 0:b.call(a))||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null==(d=(c=this.callRefTimer).ref)||d.call(c))}callRefTimerUnref(){var a,b;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null==(b=(a=this.callRefTimer).unref)||b.call(a))}removeConnectivityStateWatcher(a){let b=this.connectivityStateWatchers.findIndex(b=>b===a);b>=0&&this.connectivityStateWatchers.splice(b,1)}updateState(a){for(let b of((0,l.trace)(h.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,n.uriToString)(this.target)+" "+o.ConnectivityState[this.connectivityState]+" -> "+o.ConnectivityState[a]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+o.ConnectivityState[a]),this.connectivityState=a,this.connectivityStateWatchers.slice()))a!==b.currentState&&(b.timer&&clearTimeout(b.timer),this.removeConnectivityStateWatcher(b),b.callback());a!==o.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(a){if(a>this.keepaliveTime)for(let b of(this.keepaliveTime=a,this.wrappedSubchannels))b.throttleKeepalive(a)}removeWrappedSubchannel(a){this.wrappedSubchannels.delete(a)}doPick(a,b){return this.currentPicker.pick({metadata:a,extraPickInfo:b})}queueCallForPick(a){this.pickQueue.push(a),this.callRefTimerRef()}getConfig(a,b){return(this.resolvingLoadBalancer.exitIdle(),this.configSelector)?{type:"SUCCESS",config:this.configSelector(a,b)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(a){this.configSelectionQueue.push(a),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(o.ConnectivityState.IDLE),this.currentPicker=new g.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(a){var b,c;this.idleTimer=setTimeout(()=>{if(this.callCount>0)return void this.startIdleTimeout(this.idleTimeoutMs);let a=new Date().valueOf()-this.lastActivityTimestamp.valueOf();a>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-a)},a),null==(c=(b=this.idleTimer).unref)||c.call(b)}maybeStartIdleTimer(){this.connectivityState===o.ConnectivityState.SHUTDOWN||this.idleTimer||this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(a){this.channelzEnabled&&(a.code===h.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(a,b,c,d,e){let f=(0,t.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+f+'] method="'+b+'"'),new q.LoadBalancingCall(this,a,b,c,d,e,f)}createRetryingCall(a,b,c,d,e){let f=(0,t.getNextCallNumber)();return this.trace("createRetryingCall ["+f+'] method="'+b+'"'),new v.RetryingCall(this,a,b,c,d,e,f,this.retryBufferTracker,A.get(this.getTarget()))}createInnerCall(a,b,c,d,e){return 0===this.options["grpc.enable_retries"]?this.createLoadBalancingCall(a,b,c,d,e):this.createRetryingCall(a,b,c,d,e)}createResolvingCall(a,b,c,d,e){let f=(0,t.getNextCallNumber)();this.trace("createResolvingCall ["+f+'] method="'+a+'", deadline='+(0,r.deadlineToString)(b));let g={deadline:b,flags:null!=e?e:h.Propagate.DEFAULTS,host:null!=c?c:this.defaultAuthority,parentCall:d},i=new s.ResolvingCall(this,a,g,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),f);return this.onCallStart(),i.addStatusWatcher(a=>{this.onCallEnd(a)}),i}close(){this.resolvingLoadBalancer.destroy(),this.updateState(o.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,p.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,n.uriToString)(this.target)}getConnectivityState(a){let b=this.connectivityState;return a&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),b}watchConnectivityState(a,b,c){if(this.connectivityState===o.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");let d=null;if(b!==1/0){let a=b instanceof Date?b:new Date(b),f=new Date;if(b===-1/0||a<=f)return void process.nextTick(c,Error("Deadline passed without connectivity state change"));d=setTimeout(()=>{this.removeConnectivityStateWatcher(e),c(Error("Deadline passed without connectivity state change"))},a.getTime()-f.getTime())}let e={currentState:a,callback:c,timer:d};this.connectivityStateWatchers.push(e)}getChannelzRef(){return this.channelzRef}createCall(a,b,c,d,e){if("string"!=typeof a)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof b||b instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===o.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");return this.createResolvingCall(a,b,c,d,e)}}b.InternalChannel=E},26345:a=>{"use strict";a.exports=d;var b,c=/\/|\./;function d(a,b){c.test(a)||(a="google/protobuf/"+a+".proto",b={nested:{google:{nested:{protobuf:{nested:b}}}}}),d[a]=b}d("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),d("duration",{Duration:b={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),d("timestamp",{Timestamp:b}),d("empty",{Empty:{fields:{}}}),d("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),d("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),d("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),d.get=function(a){return d[a]||null}},26571:a=>{"use strict";a.exports={rE:"1.9.15"}},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},28507:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=void 0;let d=c(66528);class e{constructor(a,b,c){let d;this.listener=b,this.addresses=[],this.hasReturnedResult=!1,d=""===a.authority?"/"+a.path:a.path,this.addresses=[{path:d}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(a){return"localhost"}}b.setup=function(){(0,d.registerResolver)("unix",e)}},28706:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{MutableRequestCookiesAdapter:function(){return l},ReadonlyRequestCookiesError:function(){return g},RequestCookiesAdapter:function(){return h},appendMutableCookies:function(){return k},areCookiesMutableInCurrentPhase:function(){return n},createCookiesWithMutableAccessCheck:function(){return m},getModifiedCookieValues:function(){return j},responseCookiesToRequestCookies:function(){return p}});let d=c(33675),e=c(63036),f=c(29294);class g extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#options")}static callable(){throw new g}}class h{static seal(a){return new Proxy(a,{get(a,b,c){switch(b){case"clear":case"delete":case"set":return g.callable;default:return e.ReflectAdapter.get(a,b,c)}}})}}let i=Symbol.for("next.mutated.cookies");function j(a){let b=a[i];return b&&Array.isArray(b)&&0!==b.length?b:[]}function k(a,b){let c=j(b);if(0===c.length)return!1;let e=new d.ResponseCookies(a),f=e.getAll();for(let a of c)e.set(a);for(let a of f)e.set(a);return!0}class l{static wrap(a,b){let c=new d.ResponseCookies(new Headers);for(let b of a.getAll())c.set(b);let g=[],h=new Set,j=()=>{let a=f.workAsyncStorage.getStore();if(a&&(a.pathWasRevalidated=!0),g=c.getAll().filter(a=>h.has(a.name)),b){let a=[];for(let b of g){let c=new d.ResponseCookies(new Headers);c.set(b),a.push(c.toString())}b(a)}},k=new Proxy(c,{get(a,b,c){switch(b){case i:return g;case"delete":return function(...b){h.add("string"==typeof b[0]?b[0]:b[0].name);try{return a.delete(...b),k}finally{j()}};case"set":return function(...b){h.add("string"==typeof b[0]?b[0]:b[0].name);try{return a.set(...b),k}finally{j()}};default:return e.ReflectAdapter.get(a,b,c)}}});return k}}function m(a){let b=new Proxy(a.mutableCookies,{get(c,d,f){switch(d){case"delete":return function(...d){return o(a,"cookies().delete"),c.delete(...d),b};case"set":return function(...d){return o(a,"cookies().set"),c.set(...d),b};default:return e.ReflectAdapter.get(c,d,f)}}});return b}function n(a){return"action"===a.phase}function o(a,b){if(!n(a))throw new g}function p(a){let b=new d.RequestCookies(new Headers);for(let c of a.getAll())b.set(c);return b}},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29768:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=void 0;let d=c(91645),e=c(77797),f=c(12667),g=c(66528),h=c(23220),i=c(35433),j="ip_resolver";function k(a){i.trace(e.LogVerbosity.DEBUG,j,a)}let l="ipv4",m="ipv6",n=443;class o{constructor(a,b,c){var g;this.listener=b,this.addresses=[],this.error=null,this.hasReturnedResult=!1,k("Resolver constructed for target "+(0,h.uriToString)(a));let i=[];if(a.scheme!==l&&a.scheme!==m){this.error={code:e.Status.UNAVAILABLE,details:`Unrecognized scheme ${a.scheme} in IP resolver`,metadata:new f.Metadata};return}for(let b of a.path.split(",")){let c=(0,h.splitHostPort)(b);if(null===c||a.scheme===l&&!(0,d.isIPv4)(c.host)||a.scheme===m&&!(0,d.isIPv6)(c.host)){this.error={code:e.Status.UNAVAILABLE,details:`Failed to parse ${a.scheme} address ${b}`,metadata:new f.Metadata};return}i.push({host:c.host,port:null!=(g=c.port)?g:n})}this.addresses=i,k("Parsed "+a.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(a){return a.path.split(",")[0]}}b.setup=function(){(0,g.registerResolver)(l,o),(0,g.registerResolver)(m,o)}},30015:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},30422:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BackoffTimeout=void 0;let c=1e3,d=1.6,e=12e4,f=.2;function g(a,b){return Math.random()*(b-a)+a}class h{constructor(a,b){this.callback=a,this.initialDelay=c,this.multiplier=d,this.maxDelay=e,this.jitter=f,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,b&&(b.initialDelay&&(this.initialDelay=b.initialDelay),b.multiplier&&(this.multiplier=b.multiplier),b.jitter&&(this.jitter=b.jitter),b.maxDelay&&(this.maxDelay=b.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(a){var b,c;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},a),this.hasRef||null==(c=(b=this.timerId).unref)||c.call(b)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let a=Math.min(this.nextDelay*this.multiplier,this.maxDelay),b=a*this.jitter;this.nextDelay=a+g(-b,b)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let a=new Date,b=this.startTime;b.setMilliseconds(b.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),a<b?this.runTimer(b.getTime()-a.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var a,b;this.hasRef=!0,null==(b=(a=this.timerId).ref)||b.call(a)}unref(){var a,b;this.hasRef=!1,null==(b=(a=this.timerId).unref)||b.call(a)}getEndTime(){return this.endTime}}b.BackoffTimeout=h},30787:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return j}});let d=f(c(74515));function e(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(e=function(a){return a?c:b})(a)}function f(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=e(b);if(c&&c.has(a))return c.get(a);var d={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(d,g,h):d[g]=a[g]}return d.default=a,c&&c.set(a,d),d}let g={current:null},h="function"==typeof d.cache?d.cache:a=>a,i=console.warn;function j(a){return function(...b){i(a(...b))}}h(a=>{try{i(g.current)}finally{g.current=null}})},32003:a=>{"use strict";a.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"options":{"go_package":"google.golang.org/protobuf/types/descriptorpb","java_package":"com.google.protobuf","java_outer_classname":"DescriptorProtos","csharp_namespace":"Google.Protobuf.Reflection","objc_class_prefix":"GPB","cc_enable_arenas":true,"optimize_for":"SPEED"},"nested":{"FileDescriptorSet":{"edition":"proto2","fields":{"file":{"rule":"repeated","type":"FileDescriptorProto","id":1}},"extensions":[[536000000,536000000]]},"Edition":{"edition":"proto2","values":{"EDITION_UNKNOWN":0,"EDITION_LEGACY":900,"EDITION_PROTO2":998,"EDITION_PROTO3":999,"EDITION_2023":1000,"EDITION_2024":1001,"EDITION_1_TEST_ONLY":1,"EDITION_2_TEST_ONLY":2,"EDITION_99997_TEST_ONLY":99997,"EDITION_99998_TEST_ONLY":99998,"EDITION_99999_TEST_ONLY":99999,"EDITION_MAX":2147483647}},"FileDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"package":{"type":"string","id":2},"dependency":{"rule":"repeated","type":"string","id":3},"publicDependency":{"rule":"repeated","type":"int32","id":10},"weakDependency":{"rule":"repeated","type":"int32","id":11},"optionDependency":{"rule":"repeated","type":"string","id":15},"messageType":{"rule":"repeated","type":"DescriptorProto","id":4},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":5},"service":{"rule":"repeated","type":"ServiceDescriptorProto","id":6},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":7},"options":{"type":"FileOptions","id":8},"sourceCodeInfo":{"type":"SourceCodeInfo","id":9},"syntax":{"type":"string","id":12},"edition":{"type":"Edition","id":14}}},"DescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"field":{"rule":"repeated","type":"FieldDescriptorProto","id":2},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":6},"nestedType":{"rule":"repeated","type":"DescriptorProto","id":3},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":4},"extensionRange":{"rule":"repeated","type":"ExtensionRange","id":5},"oneofDecl":{"rule":"repeated","type":"OneofDescriptorProto","id":8},"options":{"type":"MessageOptions","id":7},"reservedRange":{"rule":"repeated","type":"ReservedRange","id":9},"reservedName":{"rule":"repeated","type":"string","id":10},"visibility":{"type":"SymbolVisibility","id":11}},"nested":{"ExtensionRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2},"options":{"type":"ExtensionRangeOptions","id":3}}},"ReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"ExtensionRangeOptions":{"edition":"proto2","fields":{"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999},"declaration":{"rule":"repeated","type":"Declaration","id":2,"options":{"retention":"RETENTION_SOURCE"}},"features":{"type":"FeatureSet","id":50},"verification":{"type":"VerificationState","id":3,"options":{"default":"UNVERIFIED","retention":"RETENTION_SOURCE"}}},"extensions":[[1000,536870911]],"nested":{"Declaration":{"fields":{"number":{"type":"int32","id":1},"fullName":{"type":"string","id":2},"type":{"type":"string","id":3},"reserved":{"type":"bool","id":5},"repeated":{"type":"bool","id":6}},"reserved":[[4,4]]},"VerificationState":{"values":{"DECLARATION":0,"UNVERIFIED":1}}}},"FieldDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":3},"label":{"type":"Label","id":4},"type":{"type":"Type","id":5},"typeName":{"type":"string","id":6},"extendee":{"type":"string","id":2},"defaultValue":{"type":"string","id":7},"oneofIndex":{"type":"int32","id":9},"jsonName":{"type":"string","id":10},"options":{"type":"FieldOptions","id":8},"proto3Optional":{"type":"bool","id":17}},"nested":{"Type":{"values":{"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Label":{"values":{"LABEL_OPTIONAL":1,"LABEL_REPEATED":3,"LABEL_REQUIRED":2}}}},"OneofDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"options":{"type":"OneofOptions","id":2}}},"EnumDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"value":{"rule":"repeated","type":"EnumValueDescriptorProto","id":2},"options":{"type":"EnumOptions","id":3},"reservedRange":{"rule":"repeated","type":"EnumReservedRange","id":4},"reservedName":{"rule":"repeated","type":"string","id":5},"visibility":{"type":"SymbolVisibility","id":6}},"nested":{"EnumReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"EnumValueDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"type":"EnumValueOptions","id":3}}},"ServiceDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"method":{"rule":"repeated","type":"MethodDescriptorProto","id":2},"options":{"type":"ServiceOptions","id":3}}},"MethodDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"inputType":{"type":"string","id":2},"outputType":{"type":"string","id":3},"options":{"type":"MethodOptions","id":4},"clientStreaming":{"type":"bool","id":5},"serverStreaming":{"type":"bool","id":6}}},"FileOptions":{"edition":"proto2","fields":{"javaPackage":{"type":"string","id":1},"javaOuterClassname":{"type":"string","id":8},"javaMultipleFiles":{"type":"bool","id":10},"javaGenerateEqualsAndHash":{"type":"bool","id":20,"options":{"deprecated":true}},"javaStringCheckUtf8":{"type":"bool","id":27},"optimizeFor":{"type":"OptimizeMode","id":9,"options":{"default":"SPEED"}},"goPackage":{"type":"string","id":11},"ccGenericServices":{"type":"bool","id":16},"javaGenericServices":{"type":"bool","id":17},"pyGenericServices":{"type":"bool","id":18},"deprecated":{"type":"bool","id":23},"ccEnableArenas":{"type":"bool","id":31,"options":{"default":true}},"objcClassPrefix":{"type":"string","id":36},"csharpNamespace":{"type":"string","id":37},"swiftPrefix":{"type":"string","id":39},"phpClassPrefix":{"type":"string","id":40},"phpNamespace":{"type":"string","id":41},"phpMetadataNamespace":{"type":"string","id":44},"rubyPackage":{"type":"string","id":45},"features":{"type":"FeatureSet","id":50},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[42,42],[38,38],"php_generic_services"],"nested":{"OptimizeMode":{"values":{"SPEED":1,"CODE_SIZE":2,"LITE_RUNTIME":3}}}},"MessageOptions":{"edition":"proto2","fields":{"messageSetWireFormat":{"type":"bool","id":1},"noStandardDescriptorAccessor":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"mapEntry":{"type":"bool","id":7},"deprecatedLegacyJsonFieldConflicts":{"type":"bool","id":11,"options":{"deprecated":true}},"features":{"type":"FeatureSet","id":12},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4],[5,5],[6,6],[8,8],[9,9]]},"FieldOptions":{"edition":"proto2","fields":{"ctype":{"type":"CType","id":1,"options":{"default":"STRING"}},"packed":{"type":"bool","id":2},"jstype":{"type":"JSType","id":6,"options":{"default":"JS_NORMAL"}},"lazy":{"type":"bool","id":5},"unverifiedLazy":{"type":"bool","id":15},"deprecated":{"type":"bool","id":3},"weak":{"type":"bool","id":10,"options":{"deprecated":true}},"debugRedact":{"type":"bool","id":16},"retention":{"type":"OptionRetention","id":17},"targets":{"rule":"repeated","type":"OptionTargetType","id":19},"editionDefaults":{"rule":"repeated","type":"EditionDefault","id":20},"features":{"type":"FeatureSet","id":21},"featureSupport":{"type":"FeatureSupport","id":22},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4],[18,18]],"nested":{"CType":{"values":{"STRING":0,"CORD":1,"STRING_PIECE":2}},"JSType":{"values":{"JS_NORMAL":0,"JS_STRING":1,"JS_NUMBER":2}},"OptionRetention":{"values":{"RETENTION_UNKNOWN":0,"RETENTION_RUNTIME":1,"RETENTION_SOURCE":2}},"OptionTargetType":{"values":{"TARGET_TYPE_UNKNOWN":0,"TARGET_TYPE_FILE":1,"TARGET_TYPE_EXTENSION_RANGE":2,"TARGET_TYPE_MESSAGE":3,"TARGET_TYPE_FIELD":4,"TARGET_TYPE_ONEOF":5,"TARGET_TYPE_ENUM":6,"TARGET_TYPE_ENUM_ENTRY":7,"TARGET_TYPE_SERVICE":8,"TARGET_TYPE_METHOD":9}},"EditionDefault":{"fields":{"edition":{"type":"Edition","id":3},"value":{"type":"string","id":2}}},"FeatureSupport":{"fields":{"editionIntroduced":{"type":"Edition","id":1},"editionDeprecated":{"type":"Edition","id":2},"deprecationWarning":{"type":"string","id":3},"editionRemoved":{"type":"Edition","id":4}}}}},"OneofOptions":{"edition":"proto2","fields":{"features":{"type":"FeatureSet","id":1},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumOptions":{"edition":"proto2","fields":{"allowAlias":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"deprecatedLegacyJsonFieldConflicts":{"type":"bool","id":6,"options":{"deprecated":true}},"features":{"type":"FeatureSet","id":7},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[5,5]]},"EnumValueOptions":{"edition":"proto2","fields":{"deprecated":{"type":"bool","id":1},"features":{"type":"FeatureSet","id":2},"debugRedact":{"type":"bool","id":3},"featureSupport":{"type":"FieldOptions.FeatureSupport","id":4},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"ServiceOptions":{"edition":"proto2","fields":{"features":{"type":"FeatureSet","id":34},"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"MethodOptions":{"edition":"proto2","fields":{"deprecated":{"type":"bool","id":33},"idempotencyLevel":{"type":"IdempotencyLevel","id":34,"options":{"default":"IDEMPOTENCY_UNKNOWN"}},"features":{"type":"FeatureSet","id":35},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"nested":{"IdempotencyLevel":{"values":{"IDEMPOTENCY_UNKNOWN":0,"NO_SIDE_EFFECTS":1,"IDEMPOTENT":2}}}},"UninterpretedOption":{"edition":"proto2","fields":{"name":{"rule":"repeated","type":"NamePart","id":2},"identifierValue":{"type":"string","id":3},"positiveIntValue":{"type":"uint64","id":4},"negativeIntValue":{"type":"int64","id":5},"doubleValue":{"type":"double","id":6},"stringValue":{"type":"bytes","id":7},"aggregateValue":{"type":"string","id":8}},"nested":{"NamePart":{"fields":{"namePart":{"rule":"required","type":"string","id":1},"isExtension":{"rule":"required","type":"bool","id":2}}}}},"FeatureSet":{"edition":"proto2","fields":{"fieldPresence":{"type":"FieldPresence","id":1,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_2023","edition_defaults.value":"EXPLICIT"}},"enumType":{"type":"EnumType","id":2,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"OPEN"}},"repeatedFieldEncoding":{"type":"RepeatedFieldEncoding","id":3,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"PACKED"}},"utf8Validation":{"type":"Utf8Validation","id":4,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"VERIFY"}},"messageEncoding":{"type":"MessageEncoding","id":5,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_LEGACY","edition_defaults.value":"LENGTH_PREFIXED"}},"jsonFormat":{"type":"JsonFormat","id":6,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"ALLOW"}},"enforceNamingStyle":{"type":"EnforceNamingStyle","id":7,"options":{"retention":"RETENTION_SOURCE","targets":"TARGET_TYPE_METHOD","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"STYLE2024"}},"defaultSymbolVisibility":{"type":"VisibilityFeature.DefaultSymbolVisibility","id":8,"options":{"retention":"RETENTION_SOURCE","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"EXPORT_TOP_LEVEL"}}},"extensions":[[1000,9994],[9995,9999],[10000,10000]],"reserved":[[999,999]],"nested":{"FieldPresence":{"values":{"FIELD_PRESENCE_UNKNOWN":0,"EXPLICIT":1,"IMPLICIT":2,"LEGACY_REQUIRED":3}},"EnumType":{"values":{"ENUM_TYPE_UNKNOWN":0,"OPEN":1,"CLOSED":2}},"RepeatedFieldEncoding":{"values":{"REPEATED_FIELD_ENCODING_UNKNOWN":0,"PACKED":1,"EXPANDED":2}},"Utf8Validation":{"values":{"UTF8_VALIDATION_UNKNOWN":0,"VERIFY":2,"NONE":3}},"MessageEncoding":{"values":{"MESSAGE_ENCODING_UNKNOWN":0,"LENGTH_PREFIXED":1,"DELIMITED":2}},"JsonFormat":{"values":{"JSON_FORMAT_UNKNOWN":0,"ALLOW":1,"LEGACY_BEST_EFFORT":2}},"EnforceNamingStyle":{"values":{"ENFORCE_NAMING_STYLE_UNKNOWN":0,"STYLE2024":1,"STYLE_LEGACY":2}},"VisibilityFeature":{"fields":{},"reserved":[[1,536870911]],"nested":{"DefaultSymbolVisibility":{"values":{"DEFAULT_SYMBOL_VISIBILITY_UNKNOWN":0,"EXPORT_ALL":1,"EXPORT_TOP_LEVEL":2,"LOCAL_ALL":3,"STRICT":4}}}}}},"FeatureSetDefaults":{"edition":"proto2","fields":{"defaults":{"rule":"repeated","type":"FeatureSetEditionDefault","id":1},"minimumEdition":{"type":"Edition","id":4},"maximumEdition":{"type":"Edition","id":5}},"nested":{"FeatureSetEditionDefault":{"fields":{"edition":{"type":"Edition","id":3},"overridableFeatures":{"type":"FeatureSet","id":4},"fixedFeatures":{"type":"FeatureSet","id":5}},"reserved":[[1,1],[2,2],"features"]}}},"SourceCodeInfo":{"edition":"proto2","fields":{"location":{"rule":"repeated","type":"Location","id":1}},"extensions":[[536000000,536000000]],"nested":{"Location":{"fields":{"path":{"rule":"repeated","type":"int32","id":1,"options":{"packed":true}},"span":{"rule":"repeated","type":"int32","id":2,"options":{"packed":true}},"leadingComments":{"type":"string","id":3},"trailingComments":{"type":"string","id":4},"leadingDetachedComments":{"rule":"repeated","type":"string","id":6}}}}},"GeneratedCodeInfo":{"edition":"proto2","fields":{"annotation":{"rule":"repeated","type":"Annotation","id":1}},"nested":{"Annotation":{"fields":{"path":{"rule":"repeated","type":"int32","id":1,"options":{"packed":true}},"sourceFile":{"type":"string","id":2},"begin":{"type":"int32","id":3},"end":{"type":"int32","id":4},"semantic":{"type":"Semantic","id":5}},"nested":{"Semantic":{"values":{"NONE":0,"SET":1,"ALIAS":2}}}}}},"SymbolVisibility":{"edition":"proto2","values":{"VISIBILITY_UNSET":0,"VISIBILITY_LOCAL":1,"VISIBILITY_EXPORT":2}}}}}}}}')},32592:(a,b,c)=>{"use strict";q={value:!0},q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=b.ex=q=q=q=q=q=q=b.OS=b.z3=void 0;let d=c(53605);q={enumerable:!0,get:function(){return d.CallCredentials}};let e=c(93023);q={enumerable:!0,get:function(){return e.ChannelImplementation}};let f=c(45069);q={enumerable:!0,get:function(){return f.CompressionAlgorithms}};let g=c(40249);q={enumerable:!0,get:function(){return g.ConnectivityState}};let h=c(14952);q={enumerable:!0,get:function(){return h.ChannelCredentials}};let i=c(92385);q={enumerable:!0,get:function(){return i.Client}};let j=c(77797);q={enumerable:!0,get:function(){return j.LogVerbosity}},q={enumerable:!0,get:function(){return j.Status}},q={enumerable:!0,get:function(){return j.Propagate}};let k=c(35433),l=c(42226);Object.defineProperty(b,"ex",{enumerable:!0,get:function(){return l.loadPackageDefinition}}),q={enumerable:!0,get:function(){return l.makeClientConstructor}},q={enumerable:!0,get:function(){return l.makeClientConstructor}};let m=c(12667);Object.defineProperty(b,"OS",{enumerable:!0,get:function(){return m.Metadata}});let n=c(67677);q={enumerable:!0,get:function(){return n.Server}};let o=c(43558);q={enumerable:!0,get:function(){return o.ServerCredentials}};let p=c(25174);q={enumerable:!0,get:function(){return p.StatusBuilder}},b.z3={combineChannelCredentials:(a,...b)=>b.reduce((a,b)=>a.compose(b),a),combineCallCredentials:(a,...b)=>b.reduce((a,b)=>a.compose(b),a),createInsecure:h.ChannelCredentials.createInsecure,createSsl:h.ChannelCredentials.createSsl,createFromSecureContext:h.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:d.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:d.CallCredentials.createFromGoogleCredential,createEmpty:d.CallCredentials.createEmpty},q=a=>a.close(),q=(a,b,c)=>a.waitForReady(b,c),q=(a,b)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},q=(a,b,c)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},q=a=>{k.setLogger(a)},q=a=>{k.setLoggerVerbosity(a)};var q=a=>i.Client.prototype.getChannel.call(a),r=c(44150);q={enumerable:!0,get:function(){return r.ListenerBuilder}},q={enumerable:!0,get:function(){return r.RequesterBuilder}},q={enumerable:!0,get:function(){return r.InterceptingCall}},q={enumerable:!0,get:function(){return r.InterceptorConfigurationError}};var s=c(15981);q={enumerable:!0,get:function(){return s.getChannelzServiceDefinition}},q={enumerable:!0,get:function(){return s.getChannelzHandlers}};var t=c(58279);q={enumerable:!0,get:function(){return t.addAdminServicesToServer}},q=c(39244);let u=c(53818),v=c(28507),w=c(29768),x=c(44636),y=c(63797),z=c(43890),A=c(15981);(()=>{u.setup(),v.setup(),w.setup(),x.setup(),y.setup(),z.setup(),A.setup()})()},33371:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ChildLoadBalancerHandler=void 0;let d=c(4825),e=c(40249),f="child_load_balancer_helper";class g{constructor(a){this.channelControlHelper=a,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(a){this.parent=a,this.child=null}createSubchannel(a,b){return this.parent.channelControlHelper.createSubchannel(a,b)}updateState(a,b){var c;if(this.calledByPendingChild()){if(a===e.ConnectivityState.CONNECTING)return;null==(c=this.parent.currentChild)||c.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(a,b)}requestReresolution(){var a;let b=null!=(a=this.parent.pendingChild)?a:this.parent.currentChild;this.child===b&&this.parent.channelControlHelper.requestReresolution()}setChild(a){this.child=a}addChannelzChild(a){this.parent.channelControlHelper.addChannelzChild(a)}removeChannelzChild(a){this.parent.channelControlHelper.removeChannelzChild(a)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(a,b){return a.getLoadBalancerName()!==b.getLoadBalancerName()}updateAddressList(a,b,c){let e;if(null===this.currentChild||null===this.latestConfig||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,b)){let a=new this.ChildPolicyHelper(this),c=(0,d.createLoadBalancer)(b,a);a.setChild(c),null===this.currentChild?(this.currentChild=c,e=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=c,e=this.pendingChild)}else e=null===this.pendingChild?this.currentChild:this.pendingChild;this.latestConfig=b,e.updateAddressList(a,b,c)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return f}}b.ChildLoadBalancerHandler=g},33873:a=>{"use strict";a.exports=require("path")},34281:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.LoadBalancingCall=void 0;let d=c(40249),e=c(77797),f=c(9874),g=c(12667),h=c(14908),i=c(23220),j=c(35433),k=c(90145),l=c(73496),m="load_balancing_call";class n{constructor(a,b,c,d,e,f,g){var h,j;this.channel=a,this.callConfig=b,this.methodName=c,this.host=d,this.credentials=e,this.deadline=f,this.callNumber=g,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let k=this.methodName.split("/"),l="";k.length>=2&&(l=k[1]);let m=null!=(j=null==(h=(0,i.splitHostPort)(this.host))?void 0:h.host)?j:"localhost";this.serviceUrl=`https://${m}/${l}`}trace(a){j.trace(e.LogVerbosity.DEBUG,m,"["+this.callNumber+"] "+a)}outputStatus(a,b){var c,d;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+a.code+' details="'+a.details+'"');let e=Object.assign(Object.assign({},a),{progress:b});null==(c=this.listener)||c.onReceiveStatus(e),null==(d=this.onCallEnded)||d.call(this,e.code)}}doPick(){var a,b;if(this.ended)return;if(!this.metadata)throw Error("doPick called before start");this.trace("Pick called");let c=this.channel.doPick(this.metadata,this.callConfig.pickInformation),i=c.subchannel?"("+c.subchannel.getChannelzRef().id+") "+c.subchannel.getAddress():""+c.subchannel;switch(this.trace("Pick result: "+h.PickResultType[c.pickResultType]+" subchannel: "+i+" status: "+(null==(a=c.status)?void 0:a.code)+" "+(null==(b=c.status)?void 0:b.details)),c.pickResultType){case h.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(a=>{var b,h,j;if(this.ended)return void this.trace("Credentials metadata generation finished after call ended");let k=this.metadata.clone();if(k.merge(a),k.get("authorization").length>1&&this.outputStatus({code:e.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new g.Metadata},"PROCESSED"),c.subchannel.getConnectivityState()!==d.ConnectivityState.READY){this.trace("Picked subchannel "+i+" has state "+d.ConnectivityState[c.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&k.set("grpc-timeout",(0,f.getDeadlineTimeoutString)(this.deadline));try{this.child=c.subchannel.getRealSubchannel().createCall(k,this.host,this.methodName,{onReceiveMetadata:a=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(a)},onReceiveMessage:a=>{this.trace("Received message"),this.listener.onReceiveMessage(a)},onReceiveStatus:a=>{this.trace("Received status"),a.rstCode===l.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(a,"REFUSED"):this.outputStatus(a,"PROCESSED")}})}catch(a){this.trace("Failed to start call on picked subchannel "+i+" with error "+a.message),this.outputStatus({code:e.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+a.message,metadata:new g.Metadata},"NOT_STARTED");return}null==(h=(b=this.callConfig).onCommitted)||h.call(b),null==(j=c.onCallStarted)||j.call(c),this.onCallEnded=c.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},a=>{let{code:b,details:c}=(0,k.restrictControlPlaneStatusCode)("number"==typeof a.code?a.code:e.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${a.message}`);this.outputStatus({code:b,details:c,metadata:new g.Metadata},"PROCESSED")});break;case h.PickResultType.DROP:let{code:j,details:m}=(0,k.restrictControlPlaneStatusCode)(c.status.code,c.status.details);setImmediate(()=>{this.outputStatus({code:j,details:m,metadata:c.status.metadata},"DROP")});break;case h.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:a,details:b}=(0,k.restrictControlPlaneStatusCode)(c.status.code,c.status.details);setImmediate(()=>{this.outputStatus({code:a,details:b,metadata:c.status.metadata},"PROCESSED")})}break;case h.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(a,b){var c;this.trace("cancelWithStatus code: "+a+' details: "'+b+'"'),null==(c=this.child)||c.cancelWithStatus(a,b),this.outputStatus({code:a,details:b,metadata:new g.Metadata},"PROCESSED")}getPeer(){var a,b;return null!=(b=null==(a=this.child)?void 0:a.getPeer())?b:this.channel.getTarget()}start(a,b){this.trace("start called"),this.listener=b,this.metadata=a,this.doPick()}sendMessageWithContext(a,b){this.trace("write() called with message of length "+b.length),this.child?this.child.sendMessageWithContext(a,b):this.pendingMessage={context:a,message:b}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(a){throw Error("Method not implemented.")}getCallNumber(){return this.callNumber}}b.LoadBalancingCall=n},34603:(a,b,c)=>{"use strict";var d;d={value:!0},Object.defineProperty(b,"b",{enumerable:!0,get:function(){return n}});let e=c(67675),f=c(29294),g=c(63033),h=c(26906),i=c(11938),j=c(82831),k=c(30787),l=c(31716),m=c(49290);function n(){let a="headers",b=f.workAsyncStorage.getStore(),c=g.workUnitAsyncStorage.getStore();if(b){if(c&&"after"===c.phase&&!(0,l.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${b.route} used "headers" inside "after(...)". This is not supported. If you need this data inside an "after" callback, use "headers" outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E367",enumerable:!1,configurable:!0});if(b.forceStatic)return q(e.HeadersAdapter.seal(new Headers({})));if(c)switch(c.type){case"cache":{let a=Object.defineProperty(Error(`Route ${b.route} used "headers" inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "headers" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E304",enumerable:!1,configurable:!0});throw Error.captureStackTrace(a,n),b.invalidDynamicUsageError??=a,a}case"private-cache":{let a=Object.defineProperty(Error(`Route ${b.route} used "headers" inside "use cache: private". Accessing "headers" inside a private cache scope is not supported. If you need this data inside a cached function use "headers" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E742",enumerable:!1,configurable:!0});throw Error.captureStackTrace(a,n),b.invalidDynamicUsageError??=a,a}case"unstable-cache":throw Object.defineProperty(Error(`Route ${b.route} used "headers" inside a function cached with "unstable_cache(...)". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "headers" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E127",enumerable:!1,configurable:!0})}if(b.dynamicShouldError)throw Object.defineProperty(new i.StaticGenBailoutError(`Route ${b.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`headers\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E525",enumerable:!1,configurable:!0});if(c)switch(c.type){case"prerender":case"prerender-runtime":return p(b,c);case"prerender-client":let d="`headers`";throw Object.defineProperty(new m.InvariantError(`${d} must not be used within a client component. Next.js should be preventing ${d} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,h.postponeWithTracking)(b.route,a,c.dynamicTracking);case"prerender-legacy":return(0,h.throwToInterruptStaticGeneration)(a,b,c);case"request":return(0,h.trackDynamicDataInDynamicRender)(c),q(c.headers)}}(0,g.throwForMissingRequestStore)(a)}c(63036);let o=new WeakMap;function p(a,b){let c=o.get(b);if(c)return c;let d=(0,j.makeHangingPromise)(b.renderSignal,a.route,"`headers()`");return o.set(b,d),d}function q(a){let b=o.get(a);if(b)return b;let c=Promise.resolve(a);return o.set(a,c),Object.defineProperties(c,{append:{value:a.append.bind(a)},delete:{value:a.delete.bind(a)},get:{value:a.get.bind(a)},has:{value:a.has.bind(a)},set:{value:a.set.bind(a)},getSetCookie:{value:a.getSetCookie.bind(a)},forEach:{value:a.forEach.bind(a)},keys:{value:a.keys.bind(a)},values:{value:a.values.bind(a)},entries:{value:a.entries.bind(a)},[Symbol.iterator]:{value:a[Symbol.iterator].bind(a)}}),c}let r=(0,k.createDedupedByCallsiteServerErrorLoggerDev)(s);function s(a,b){let c=a?`Route "${a}" `:"This route ";return Object.defineProperty(Error(`${c}used ${b}. \`headers()\` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E277",enumerable:!1,configurable:!0})}},34631:a=>{"use strict";a.exports=require("tls")},35433:(a,b,c)=>{"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),b.isTracerEnabled=b.trace=b.log=b.setLoggerVerbosity=b.setLogger=b.getLogger=void 0;let h=c(77797),i=c(19771),j=c(26571).rE,k={error:(a,...b)=>{console.error("E "+a,...b)},info:(a,...b)=>{console.error("I "+a,...b)},debug:(a,...b)=>{console.error("D "+a,...b)}},l=h.LogVerbosity.ERROR;switch((null!=(e=null!=(d=process.env.GRPC_NODE_VERBOSITY)?d:process.env.GRPC_VERBOSITY)?e:"").toUpperCase()){case"DEBUG":l=h.LogVerbosity.DEBUG;break;case"INFO":l=h.LogVerbosity.INFO;break;case"ERROR":l=h.LogVerbosity.ERROR;break;case"NONE":l=h.LogVerbosity.NONE}b.getLogger=()=>k,b.setLogger=a=>{k=a},b.setLoggerVerbosity=a=>{l=a},b.log=(a,...b)=>{let c;if(a>=l){switch(a){case h.LogVerbosity.DEBUG:c=k.debug;break;case h.LogVerbosity.INFO:c=k.info;break;case h.LogVerbosity.ERROR:c=k.error}c||(c=k.error),c&&c.bind(k)(...b)}};let m=null!=(g=null!=(f=process.env.GRPC_NODE_TRACE)?f:process.env.GRPC_TRACE)?g:"",n=new Set,o=new Set;for(let a of m.split(","))a.startsWith("-")?o.add(a.substring(1)):n.add(a);let p=n.has("all");function q(a,c,d){r(c)&&(0,b.log)(a,new Date().toISOString()+" | v"+j+" "+i.pid+" | "+c+" | "+d)}function r(a){return!o.has(a)&&(p||n.has(a))}b.trace=q,b.isTracerEnabled=r},35546:(a,b,c)=>{"use strict";a.exports=h;var d=c(60081),e=c(56207),f=c(36544);function g(a,b,c,d){return b.delimited?a("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",c,d,(b.id<<3|3)>>>0,(b.id<<3|4)>>>0):a("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",c,d,(b.id<<3|2)>>>0)}function h(a){for(var b,c,h=f.codegen(["m","w"],a.name+"$encode")("if(!w)")("w=Writer.create()"),i=a.fieldsArray.slice().sort(f.compareFieldsById),b=0;b<i.length;++b){var j=i[b].resolve(),k=a._fieldsArray.indexOf(j),l=j.resolvedType instanceof d?"int32":j.type,m=e.basic[l];c="m"+f.safeProp(j.name),j.map?(h("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",c,j.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",c)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(j.id<<3|2)>>>0,8|e.mapKey[j.keyType],j.keyType),void 0===m?h("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",k,c):h(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|m,l,c),h("}")("}")):j.repeated?(h("if(%s!=null&&%s.length){",c,c),j.packed&&void 0!==e.packed[l]?h("w.uint32(%i).fork()",(j.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",c)("w.%s(%s[i])",l,c)("w.ldelim()"):(h("for(var i=0;i<%s.length;++i)",c),void 0===m?g(h,j,k,c+"[i]"):h("w.uint32(%i).%s(%s[i])",(j.id<<3|m)>>>0,l,c)),h("}")):(j.optional&&h("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",c,j.name),void 0===m?g(h,j,k,c):h("w.uint32(%i).%s(%s)",(j.id<<3|m)>>>0,l,c))}return h("return w")}},35916:(a,b,c)=>{"use strict";var d;d={value:!0},d={enumerable:!0,get:function(){return l}};let e=c(63033),f=c(29294),g=c(26906),h=c(30787),i=c(11938),j=c(69168),k=c(49290);function l(){let a="draftMode",b=f.workAsyncStorage.getStore(),c=e.workUnitAsyncStorage.getStore();switch((!b||!c)&&(0,e.throwForMissingRequestStore)(a),c.type){case"prerender-runtime":return(0,g.delayUntilRuntimeStage)(c,m(c.draftMode,b));case"request":return m(c.draftMode,b);case"cache":case"private-cache":case"unstable-cache":let d=(0,e.getDraftModeProviderForCacheScope)(b,c);if(d)return m(d,b);case"prerender":case"prerender-client":case"prerender-ppr":case"prerender-legacy":return m(null,b);default:return c}}function m(a,b){let c,d=a??n,e=o.get(d);return e||(c=p(a),o.set(d,c),c)}c(63036);let n={},o=new WeakMap;function p(a){let b=new q(a),c=Promise.resolve(b);return Object.defineProperty(c,"isEnabled",{get:()=>b.isEnabled,enumerable:!0,configurable:!0}),c.enable=b.enable.bind(b),c.disable=b.disable.bind(b),c}class q{constructor(a){this._provider=a}get isEnabled(){return null!==this._provider&&this._provider.isEnabled}enable(){t("draftMode().enable()",this.enable),null!==this._provider&&this._provider.enable()}disable(){t("draftMode().disable()",this.disable),null!==this._provider&&this._provider.disable()}}let r=(0,h.createDedupedByCallsiteServerErrorLoggerDev)(s);function s(a,b){let c=a?`Route "${a}" `:"This route ";return Object.defineProperty(Error(`${c}used ${b}. \`draftMode()\` should be awaited before using its value. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E377",enumerable:!1,configurable:!0})}function t(a,b){let c=f.workAsyncStorage.getStore(),d=e.workUnitAsyncStorage.getStore();if(c){if((null==d?void 0:d.phase)==="after")throw Object.defineProperty(Error(`Route ${c.route} used "${a}" inside \`after\`. The enabled status of draftMode can be read inside \`after\` but you cannot enable or disable draftMode. See more info here: https://nextjs.org/docs/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E348",enumerable:!1,configurable:!0});if(c.dynamicShouldError)throw Object.defineProperty(new i.StaticGenBailoutError(`Route ${c.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${a}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(d)switch(d.type){case"cache":case"private-cache":{let d=Object.defineProperty(Error(`Route ${c.route} used "${a}" inside "use cache". The enabled status of draftMode can be read in caches but you must not enable or disable draftMode inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E246",enumerable:!1,configurable:!0});throw Error.captureStackTrace(d,b),c.invalidDynamicUsageError??=d,d}case"unstable-cache":throw Object.defineProperty(Error(`Route ${c.route} used "${a}" inside a function cached with "unstable_cache(...)". The enabled status of draftMode can be read in caches but you must not enable or disable draftMode inside a cache. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E259",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":{let b=Object.defineProperty(Error(`Route ${c.route} used ${a} without first calling \`await connection()\`. See more info here: https://nextjs.org/docs/messages/next-prerender-sync-headers`),"__NEXT_ERROR_CODE",{value:"E126",enumerable:!1,configurable:!0});return(0,g.abortAndThrowOnSynchronousRequestDataAccess)(c.route,a,b,d)}case"prerender-client":let e="`draftMode`";throw Object.defineProperty(new k.InvariantError(`${e} must not be used within a client component. Next.js should be preventing ${e} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,g.postponeWithTracking)(c.route,a,d.dynamicTracking);case"prerender-legacy":d.revalidate=0;let f=Object.defineProperty(new j.DynamicServerError(`Route ${c.route} couldn't be rendered statically because it used \`${a}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw c.dynamicUsageDescription=a,c.dynamicUsageStack=f.stack,f;case"request":(0,g.trackDynamicDataInDynamicRender)(d)}}}},36076:(a,b,c)=>{"use strict";let d,e;c.r(b),c.d(b,{handler:()=>BO,patchFetch:()=>BN,routeModule:()=>BJ,serverHooks:()=>BM,workAsyncStorage:()=>BK,workUnitAsyncStorage:()=>BL});var f,g,h,i,j,k={};c.r(k),c.d(k,{StripeAPIError:()=>ad,StripeAuthenticationError:()=>ae,StripeCardError:()=>ab,StripeConnectionError:()=>ah,StripeError:()=>aa,StripeIdempotencyError:()=>aj,StripeInvalidGrantError:()=>ak,StripeInvalidRequestError:()=>ac,StripePermissionError:()=>af,StripeRateLimitError:()=>ag,StripeSignatureVerificationError:()=>ai,StripeUnknownError:()=>al,TemporarySessionExpiredError:()=>am,generateV1Error:()=>$,generateV2Error:()=>_});var l={};c.r(l),c.d(l,{Account:()=>du,AccountLinks:()=>dw,AccountSessions:()=>dy,Accounts:()=>du,ApplePayDomains:()=>dA,ApplicationFees:()=>dC,Apps:()=>e8,Balance:()=>dE,BalanceTransactions:()=>dG,Billing:()=>e9,BillingPortal:()=>fa,Charges:()=>dI,Checkout:()=>fb,Climate:()=>fc,ConfirmationTokens:()=>dK,CountrySpecs:()=>dM,Coupons:()=>dO,CreditNotes:()=>dQ,CustomerSessions:()=>dS,Customers:()=>dU,Disputes:()=>dW,Entitlements:()=>fd,EphemeralKeys:()=>dY,Events:()=>d$,ExchangeRates:()=>d0,FileLinks:()=>d2,Files:()=>d6,FinancialConnections:()=>fe,Forwarding:()=>ff,Identity:()=>fg,InvoiceItems:()=>d8,InvoiceRenderingTemplates:()=>ea,Invoices:()=>ec,Issuing:()=>fh,Mandates:()=>ee,OAuth:()=>eh,PaymentIntents:()=>ej,PaymentLinks:()=>el,PaymentMethodConfigurations:()=>en,PaymentMethodDomains:()=>ep,PaymentMethods:()=>er,Payouts:()=>et,Plans:()=>ev,Prices:()=>ex,Products:()=>ez,PromotionCodes:()=>eB,Quotes:()=>eD,Radar:()=>fi,Refunds:()=>eF,Reporting:()=>fj,Reviews:()=>eH,SetupAttempts:()=>eJ,SetupIntents:()=>eL,ShippingRates:()=>eN,Sigma:()=>fk,Sources:()=>eP,SubscriptionItems:()=>eR,SubscriptionSchedules:()=>eT,Subscriptions:()=>eV,Tax:()=>fl,TaxCodes:()=>eX,TaxIds:()=>eZ,TaxRates:()=>e_,Terminal:()=>fm,TestHelpers:()=>fn,Tokens:()=>e1,Topups:()=>e3,Transfers:()=>e5,Treasury:()=>fo,V2:()=>fp,WebhookEndpoints:()=>e7});var m={};c.r(m),c.d(m,{POST:()=>BH});var n=c(95736),o=c(9117),p=c(4044),q=c(39326),r=c(32324),s=c(261),t=c(54290),u=c(85328),v=c(38928),w=c(46595),x=c(3421),y=c(17679),z=c(41681),A=c(63446),B=c(86439),C=c(51356);c(14230);var D=c(34603);c(35916);var E=c(55511),F=c(94735);class G{computeHMACSignature(a,b){throw Error("computeHMACSignature not implemented.")}computeHMACSignatureAsync(a,b){throw Error("computeHMACSignatureAsync not implemented.")}computeSHA256Async(a){throw Error("computeSHA256 not implemented.")}}class H extends Error{}class I extends G{computeHMACSignature(a,b){return E.createHmac("sha256",b).update(a,"utf8").digest("hex")}async computeHMACSignatureAsync(a,b){return await this.computeHMACSignature(a,b)}async computeSHA256Async(a){return new Uint8Array(await E.createHash("sha256").update(a).digest())}}var J=c(81630),K=c.t(J,2),L=c(55591),M=c.t(L,2);class N{getClientName(){throw Error("getClientName not implemented.")}makeRequest(a,b,c,d,e,f,g,h){throw Error("makeRequest not implemented.")}static makeTimeoutError(){let a=TypeError(N.TIMEOUT_ERROR_CODE);return a.code=N.TIMEOUT_ERROR_CODE,a}}N.CONNECTION_CLOSED_ERROR_CODES=["ECONNRESET","EPIPE"],N.TIMEOUT_ERROR_CODE="ETIMEDOUT";class O{constructor(a,b){this._statusCode=a,this._headers=b}getStatusCode(){return this._statusCode}getHeaders(){return this._headers}getRawResponse(){throw Error("getRawResponse not implemented.")}toStream(a){throw Error("toStream not implemented.")}toJSON(){throw Error("toJSON not implemented.")}}let P=J||K,Q=L||M,R=new P.Agent({keepAlive:!0}),S=new Q.Agent({keepAlive:!0});class T extends N{constructor(a){super(),this._agent=a}getClientName(){return"node"}makeRequest(a,b,c,d,e,f,g,h){let i="http"===g,j=this._agent;return j||(j=i?R:S),new Promise((g,k)=>{let l=(i?P:Q).request({host:a,port:b,path:c,method:d,agent:j,headers:e,ciphers:"DEFAULT:!aNULL:!eNULL:!LOW:!EXPORT:!SSLv2:!MD5"});l.setTimeout(h,()=>{l.destroy(N.makeTimeoutError())}),l.on("response",a=>{g(new U(a))}),l.on("error",a=>{k(a)}),l.once("socket",a=>{a.connecting?a.once(i?"connect":"secureConnect",()=>{l.write(f),l.end()}):(l.write(f),l.end())})})}}class U extends O{constructor(a){super(a.statusCode,a.headers||{}),this._res=a}getRawResponse(){return this._res}toStream(a){return this._res.once("end",()=>a()),this._res}toJSON(){return new Promise((a,b)=>{let c="";this._res.setEncoding("utf8"),this._res.on("data",a=>{c+=a}),this._res.once("end",()=>{try{a(JSON.parse(c))}catch(a){b(a)}})})}}class V extends N{constructor(a){if(super(),!a){if(!globalThis.fetch)throw Error("fetch() function not provided and is not defined in the global scope. You must provide a fetch implementation.");a=globalThis.fetch}globalThis.AbortController?this._fetchFn=V.makeFetchWithAbortTimeout(a):this._fetchFn=V.makeFetchWithRaceTimeout(a)}static makeFetchWithRaceTimeout(a){return(b,c,d)=>{let e,f=new Promise((a,b)=>{e=setTimeout(()=>{e=null,b(N.makeTimeoutError())},d)});return Promise.race([a(b,c),f]).finally(()=>{e&&clearTimeout(e)})}}static makeFetchWithAbortTimeout(a){return async(b,c,d)=>{let e=new AbortController,f=setTimeout(()=>{f=null,e.abort(N.makeTimeoutError())},d);try{return await a(b,Object.assign(Object.assign({},c),{signal:e.signal}))}catch(a){if("AbortError"===a.name)throw N.makeTimeoutError();throw a}finally{f&&clearTimeout(f)}}}getClientName(){return"fetch"}async makeRequest(a,b,c,d,e,f,g,h){let i="http"===g,j=new URL(c,`${i?"http":"https"}://${a}`);j.port=b;let k="POST"==d||"PUT"==d||"PATCH"==d,l=f||(k?"":void 0);return new W(await this._fetchFn(j.toString(),{method:d,headers:e,body:l},h))}}class W extends O{constructor(a){super(a.status,W._transformHeadersToObject(a.headers)),this._res=a}getRawResponse(){return this._res}toStream(a){return a(),this._res.body}toJSON(){return this._res.json()}static _transformHeadersToObject(a){let b={};for(let c of a){if(!Array.isArray(c)||2!=c.length)throw Error("Response objects produced by the fetch function given to FetchHttpClient do not have an iterable headers map. Response#headers should be an iterable object.");b[c[0]]=c[1]}return b}}class X extends G{constructor(a){super(),this.subtleCrypto=a||crypto.subtle}computeHMACSignature(a,b){throw new H("SubtleCryptoProvider cannot be used in a synchronous context.")}async computeHMACSignatureAsync(a,b){let c=new TextEncoder,d=await this.subtleCrypto.importKey("raw",c.encode(b),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),e=new Uint8Array(await this.subtleCrypto.sign("hmac",d,c.encode(a))),f=Array(e.length);for(let a=0;a<e.length;a++)f[a]=Y[e[a]];return f.join("")}async computeSHA256Async(a){return new Uint8Array(await this.subtleCrypto.digest("SHA-256",a))}}let Y=Array(256);for(let a=0;a<Y.length;a++)Y[a]=a.toString(16).padStart(2,"0");class Z{constructor(){this._fetchFn=null,this._agent=null}getUname(){throw Error("getUname not implemented.")}uuid4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{let b=16*Math.random()|0;return("x"===a?b:3&b|8).toString(16)})}secureCompare(a,b){if(a.length!==b.length)return!1;let c=a.length,d=0;for(let e=0;e<c;++e)d|=a.charCodeAt(e)^b.charCodeAt(e);return 0===d}createEmitter(){throw Error("createEmitter not implemented.")}tryBufferData(a){throw Error("tryBufferData not implemented.")}createNodeHttpClient(a){throw Error("createNodeHttpClient not implemented.")}createFetchHttpClient(a){return new V(a)}createDefaultHttpClient(){throw Error("createDefaultHttpClient not implemented.")}createNodeCryptoProvider(){throw Error("createNodeCryptoProvider not implemented.")}createSubtleCryptoProvider(a){return new X(a)}createDefaultCryptoProvider(){throw Error("createDefaultCryptoProvider not implemented.")}}let $=a=>{switch(a.type){case"card_error":return new ab(a);case"invalid_request_error":return new ac(a);case"api_error":return new ad(a);case"authentication_error":return new ae(a);case"rate_limit_error":return new ag(a);case"idempotency_error":return new aj(a);case"invalid_grant":return new ak(a);default:return new al(a)}},_=a=>"temporary_session_expired"===a.type?new am(a):"invalid_fields"===a.code?new ac(a):$(a);class aa extends Error{constructor(a={},b=null){super(a.message),this.type=b||this.constructor.name,this.raw=a,this.rawType=a.type,this.code=a.code,this.doc_url=a.doc_url,this.param=a.param,this.detail=a.detail,this.headers=a.headers,this.requestId=a.requestId,this.statusCode=a.statusCode,this.message=a.message,this.userMessage=a.user_message,this.charge=a.charge,this.decline_code=a.decline_code,this.payment_intent=a.payment_intent,this.payment_method=a.payment_method,this.payment_method_type=a.payment_method_type,this.setup_intent=a.setup_intent,this.source=a.source}}aa.generate=$;class ab extends aa{constructor(a={}){super(a,"StripeCardError")}}class ac extends aa{constructor(a={}){super(a,"StripeInvalidRequestError")}}class ad extends aa{constructor(a={}){super(a,"StripeAPIError")}}class ae extends aa{constructor(a={}){super(a,"StripeAuthenticationError")}}class af extends aa{constructor(a={}){super(a,"StripePermissionError")}}class ag extends aa{constructor(a={}){super(a,"StripeRateLimitError")}}class ah extends aa{constructor(a={}){super(a,"StripeConnectionError")}}class ai extends aa{constructor(a,b,c={}){super(c,"StripeSignatureVerificationError"),this.header=a,this.payload=b}}class aj extends aa{constructor(a={}){super(a,"StripeIdempotencyError")}}class ak extends aa{constructor(a={}){super(a,"StripeInvalidGrantError")}}class al extends aa{constructor(a={}){super(a,"StripeUnknownError")}}class am extends aa{constructor(a={}){super(a,"TemporarySessionExpiredError")}}var an=c(34563);let ao=["apiKey","idempotencyKey","stripeAccount","apiVersion","maxNetworkRetries","timeout","host","authenticator","stripeContext","additionalHeaders"];function ap(a){return a&&"object"==typeof a&&ao.some(b=>Object.prototype.hasOwnProperty.call(a,b))}function aq(a,b){return an.stringify(a,{serializeDate:a=>Math.floor(a.getTime()/1e3).toString(),arrayFormat:"v2"==b?"repeat":"indices"}).replace(/%5B/g,"[").replace(/%5D/g,"]")}let ar=(()=>{let a={"\n":"\\n",'"':'\\"',"\u2028":"\\u2028","\u2029":"\\u2029"};return b=>{let c=b.replace(/["\n\r\u2028\u2029]/g,b=>a[b]);return a=>c.replace(/\{([\s\S]+?)\}/g,(b,c)=>encodeURIComponent(a[c]||""))}})();function as(a){let b=a.match(/\{\w+\}/g);return b?b.map(a=>a.replace(/[{}]/g,"")):[]}function at(a){if(!Array.isArray(a)||!a[0]||"object"!=typeof a[0])return{};if(!ap(a[0]))return a.shift();let b=Object.keys(a[0]),c=b.filter(a=>ao.includes(a));return c.length>0&&c.length!==b.length&&aB(`Options found in arguments (${c.join(", ")}). Did you mean to pass an options object? See https://github.com/stripe/stripe-node/wiki/Passing-Options.`),{}}function au(a){let b={host:null,headers:{},settings:{}};if(a.length>0){let c=a[a.length-1];if("string"==typeof c)b.authenticator=aG(a.pop());else if(ap(c)){let c=Object.assign({},a.pop()),d=Object.keys(c).filter(a=>!ao.includes(a));if(d.length&&aB(`Invalid options found (${d.join(", ")}); ignoring.`),c.apiKey&&(b.authenticator=aG(c.apiKey)),c.idempotencyKey&&(b.headers["Idempotency-Key"]=c.idempotencyKey),c.stripeAccount&&(b.headers["Stripe-Account"]=c.stripeAccount),c.stripeContext){if(b.headers["Stripe-Account"])throw Error("Can't specify both stripeAccount and stripeContext.");b.headers["Stripe-Context"]=c.stripeContext}if(c.apiVersion&&(b.headers["Stripe-Version"]=c.apiVersion),Number.isInteger(c.maxNetworkRetries)&&(b.settings.maxNetworkRetries=c.maxNetworkRetries),Number.isInteger(c.timeout)&&(b.settings.timeout=c.timeout),c.host&&(b.host=c.host),c.authenticator){if(c.apiKey)throw Error("Can't specify both apiKey and authenticator.");if("function"!=typeof c.authenticator)throw Error("The authenticator must be a function receiving a request as the first parameter.");b.authenticator=c.authenticator}c.additionalHeaders&&(b.headers=c.additionalHeaders)}}return b}function av(a){let b=this,c=Object.prototype.hasOwnProperty.call(a,"constructor")?a.constructor:function(...a){b.apply(this,a)};return Object.assign(c,b),c.prototype=Object.create(b.prototype),Object.assign(c.prototype,a),c}function aw(a){if("object"!=typeof a)throw Error("Argument must be an object");return Object.keys(a).reduce((b,c)=>(null!=a[c]&&(b[c]=a[c]),b),{})}function ax(a){return a&&"object"==typeof a?Object.keys(a).reduce((b,c)=>(b[ay(c)]=a[c],b),{}):a}function ay(a){return a.split("-").map(a=>a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()).join("-")}function az(a,b){return b?a.then(a=>{setTimeout(()=>{b(null,a)},0)},a=>{setTimeout(()=>{b(a,null)},0)}):a}function aA(a){return"OAuth"===a?"oauth":a[0].toLowerCase()+a.substring(1)}function aB(a){return"function"!=typeof process.emitWarning?console.warn(`Stripe: ${a}`):process.emitWarning(a,"Stripe")}function aC(a){let b=typeof a;return("function"===b||"object"===b)&&!!a}function aD(a){let b={},c=(a,d)=>{Object.entries(a).forEach(([a,e])=>{let f=d?`${d}[${a}]`:a;if(aC(e))if(!(e instanceof Uint8Array)&&!Object.prototype.hasOwnProperty.call(e,"data"))return c(e,f);else b[f]=e;else b[f]=String(e)})};return c(a,null),b}function aE(a,b,c){if(!Number.isInteger(b))if(void 0!==c)return c;else throw Error(`${a} must be an integer`);return b}function aF(){return"undefined"==typeof process?{}:{lang_version:process.version,platform:process.platform}}function aG(a){let b=b=>(b.headers.Authorization="Bearer "+a,Promise.resolve());return b._apiKey=a,b}function aH(a){let b=new Uint8Array(a.reduce((a,b)=>a+b.length,0)),c=0;return a.forEach(a=>{b.set(a,c),c+=a.length}),b}function aI(a,b){return this[a]instanceof Date?Math.floor(this[a].getTime()/1e3).toString():b}function aJ(a){return JSON.stringify(a,aI)}function aK(a){return a&&a.startsWith("/v2")?"v2":"v1"}let aL=require("child_process");class aM extends aa{}class aN extends Z{constructor(){super(),this._exec=aL.exec,this._UNAME_CACHE=null}uuid4(){return E.randomUUID?E.randomUUID():super.uuid4()}getUname(){return this._UNAME_CACHE||(this._UNAME_CACHE=new Promise((a,b)=>{try{this._exec("uname -a",(b,c)=>{if(b)return a(null);a(c)})}catch(b){a(null)}})),this._UNAME_CACHE}secureCompare(a,b){if(!a||!b)throw Error("secureCompare must receive two arguments");if(a.length!==b.length)return!1;if(E.timingSafeEqual){let c=new TextEncoder,d=c.encode(a),e=c.encode(b);return E.timingSafeEqual(d,e)}return super.secureCompare(a,b)}createEmitter(){return new F.EventEmitter}tryBufferData(a){if(!(a.file.data instanceof F.EventEmitter))return Promise.resolve(a);let b=[];return new Promise((c,d)=>{a.file.data.on("data",a=>{b.push(a)}).once("end",()=>{let d=Object.assign({},a);d.file.data=aH(b),c(d)}).on("error",a=>{d(new aM({message:"An error occurred while attempting to process the file for upload.",detail:a}))})})}createNodeHttpClient(a){return new T(a)}createDefaultHttpClient(){return new T}createNodeCryptoProvider(){return new I}createDefaultCryptoProvider(){return this.createNodeCryptoProvider()}}let aO=60;class aP{constructor(a,b){this._stripe=a,this._maxBufferedRequestMetric=b}_addHeadersDirectlyToObject(a,b){a.requestId=b["request-id"],a.stripeAccount=a.stripeAccount||b["stripe-account"],a.apiVersion=a.apiVersion||b["stripe-version"],a.idempotencyKey=a.idempotencyKey||b["idempotency-key"]}_makeResponseEvent(a,b,c){let d=Date.now(),e=d-a.request_start_time;return aw({api_version:c["stripe-version"],account:c["stripe-account"],idempotency_key:c["idempotency-key"],method:a.method,path:a.path,status:b,request_id:this._getRequestId(c),elapsed:e,request_start_time:a.request_start_time,request_end_time:d})}_getRequestId(a){return a["request-id"]}_streamingResponseHandler(a,b,c){return d=>{let e=d.getHeaders(),f=()=>{let c=this._makeResponseEvent(a,d.getStatusCode(),e);this._stripe._emitter.emit("response",c),this._recordRequestMetrics(this._getRequestId(e),c.elapsed,b)},g=d.toStream(f);return this._addHeadersDirectlyToObject(g,e),c(null,g)}}_jsonResponseHandler(a,b,c,d){return e=>{let f=e.getHeaders(),g=this._getRequestId(f),h=e.getStatusCode(),i=this._makeResponseEvent(a,h,f);this._stripe._emitter.emit("response",i),e.toJSON().then(a=>{if(a.error){let c;throw"string"==typeof a.error&&(a.error={type:a.error,message:a.error_description}),a.error.headers=f,a.error.statusCode=h,a.error.requestId=g,c=401===h?new ae(a.error):403===h?new af(a.error):429===h?new ag(a.error):"v2"===b?_(a.error):$(a.error)}return a},a=>{throw new ad({message:"Invalid JSON received from the Stripe API",exception:a,requestId:f["request-id"]})}).then(a=>{this._recordRequestMetrics(g,i.elapsed,c);let b=e.getRawResponse();this._addHeadersDirectlyToObject(b,f),Object.defineProperty(a,"lastResponse",{enumerable:!1,writable:!1,value:b}),d(null,a)},a=>d(a,null))}}static _generateConnectionErrorMessage(a){return`An error occurred with our connection to Stripe.${a>0?` Request was retried ${a} times.`:""}`}static _shouldRetry(a,b,c,d){return!!(d&&0===b&&N.CONNECTION_CLOSED_ERROR_CODES.includes(d.code))||!(b>=c)&&(!a||"false"!==a.getHeaders()["stripe-should-retry"]&&!!("true"===a.getHeaders()["stripe-should-retry"]||409===a.getStatusCode()||a.getStatusCode()>=500))}_getSleepTimeInMS(a,b=null){let c=this._stripe.getInitialNetworkRetryDelay(),d=Math.min(c*Math.pow(2,a-1),this._stripe.getMaxNetworkRetryDelay());return d*=.5*(1+Math.random()),d=Math.max(c,d),Number.isInteger(b)&&b<=aO&&(d=Math.max(d,b)),1e3*d}_getMaxNetworkRetries(a={}){return void 0!==a.maxNetworkRetries&&Number.isInteger(a.maxNetworkRetries)?a.maxNetworkRetries:this._stripe.getMaxNetworkRetries()}_defaultIdempotencyKey(a,b,c){let d=this._getMaxNetworkRetries(b),e=()=>`stripe-node-retry-${this._stripe._platformFunctions.uuid4()}`;if("v2"===c){if("POST"===a||"DELETE"===a)return e()}else if("v1"===c&&"POST"===a&&d>0)return e();return null}_makeHeaders({contentType:a,contentLength:b,apiVersion:c,clientUserAgent:d,method:e,userSuppliedHeaders:f,userSuppliedSettings:g,stripeAccount:h,stripeContext:i,apiMode:j}){let k={Accept:"application/json","Content-Type":a,"User-Agent":this._getUserAgentString(j),"X-Stripe-Client-User-Agent":d,"X-Stripe-Client-Telemetry":this._getTelemetryHeader(),"Stripe-Version":c,"Stripe-Account":h,"Stripe-Context":i,"Idempotency-Key":this._defaultIdempotencyKey(e,g,j)},l="POST"==e||"PUT"==e||"PATCH"==e;return(l||b)&&(l||aB(`${e} method had non-zero contentLength but no payload is expected for this verb`),k["Content-Length"]=b),Object.assign(aw(k),ax(f))}_getUserAgentString(a){let b=this._stripe.getConstant("PACKAGE_VERSION"),c=this._stripe._appInfo?this._stripe.getAppInfoAsString():"";return`Stripe/${a} NodeBindings/${b} ${c}`.trim()}_getTelemetryHeader(){if(this._stripe.getTelemetryEnabled()&&this._stripe._prevRequestMetrics.length>0)return JSON.stringify({last_request_metrics:this._stripe._prevRequestMetrics.shift()})}_recordRequestMetrics(a,b,c){if(this._stripe.getTelemetryEnabled()&&a)if(this._stripe._prevRequestMetrics.length>this._maxBufferedRequestMetric)aB("Request metrics buffer is full, dropping telemetry message.");else{let d={request_id:a,request_duration_ms:b};c&&c.length>0&&(d.usage=c),this._stripe._prevRequestMetrics.push(d)}}_rawRequest(a,b,c,d){return new Promise((e,f)=>{let g;try{let e=a.toUpperCase();if("POST"!==e&&c&&0!==Object.keys(c).length)throw Error("rawRequest only supports params on POST requests. Please pass null and add your parameters to path.");let f=[].slice.call([c,d]),h=at(f),i=Object.assign({},h),j=au(f),k=j.headers,l=j.authenticator;g={requestMethod:e,requestPath:b,bodyData:i,queryData:{},authenticator:l,headers:k,host:null,streaming:!1,settings:{},usage:["raw_request"]}}catch(a){f(a);return}function h(a,b){a?f(a):e(b)}let{headers:i,settings:j}=g,k=g.authenticator;this._request(g.requestMethod,g.host,b,g.bodyData,k,{headers:i,settings:j,streaming:g.streaming},g.usage,h)})}_request(a,b,c,d,e,f,g=[],h,i=null){var j;let k;e=null!=(j=null!=e?e:this._stripe._authenticator)?j:null;let l=aK(c),m=(a,b,c,d,e)=>setTimeout(a,this._getSleepTimeInMS(d,e),b,c,d+1),n=(d,i,j)=>{let o=f.settings&&f.settings.timeout&&Number.isInteger(f.settings.timeout)&&f.settings.timeout>=0?f.settings.timeout:this._stripe.getApiField("timeout"),p={host:b||this._stripe.getApiField("host"),port:this._stripe.getApiField("port"),path:c,method:a,headers:Object.assign({},i),body:k,protocol:this._stripe.getApiField("protocol")};e(p).then(()=>{let b=this._stripe.getApiField("httpClient").makeRequest(p.host,p.port,p.path,p.method,p.headers,p.body,p.protocol,o),e=Date.now(),k=aw({api_version:d,account:i["Stripe-Account"],idempotency_key:i["Idempotency-Key"],method:a,path:c,request_start_time:e}),q=j||0,r=this._getMaxNetworkRetries(f.settings||{});this._stripe._emitter.emit("request",k),b.then(a=>aP._shouldRetry(a,q,r)?m(n,d,i,q,a.getHeaders()["retry-after"]):f.streaming&&400>a.getStatusCode()?this._streamingResponseHandler(k,g,h)(a):this._jsonResponseHandler(k,l,g,h)(a)).catch(a=>aP._shouldRetry(null,q,r,a)?m(n,d,i,q,null):h(new ah({message:a.code&&a.code===N.TIMEOUT_ERROR_CODE?`Request aborted due to timeout being reached (${o}ms)`:aP._generateConnectionErrorMessage(q),detail:a})))}).catch(a=>{throw new aa({message:"Unable to authenticate the request",exception:a})})},o=(b,c)=>{if(b)return h(b);k=c,this._stripe.getClientUserAgent(b=>{let c=this._stripe.getApiField("version"),d=this._makeHeaders({contentType:"v2"==l?"application/json":"application/x-www-form-urlencoded",contentLength:k.length,apiVersion:c,clientUserAgent:b,method:a,userSuppliedHeaders:f.headers,userSuppliedSettings:f.settings,stripeAccount:"v2"==l?null:this._stripe.getApiField("stripeAccount"),stripeContext:"v2"==l?this._stripe.getApiField("stripeContext"):null,apiMode:l});n(c,d,0)})};if(i)i(a,d,f.headers,o);else{let a;o(null,a="v2"==l?d?aJ(d):"":aq(d||{},l))}}}class aQ{constructor(a,b,c,d){this.index=0,this.pagePromise=a,this.promiseCache={currentPromise:null},this.requestArgs=b,this.spec=c,this.stripeResource=d}async iterate(a){if(!(a&&a.data&&"number"==typeof a.data.length))throw Error("Unexpected: Stripe API response does not have a well-formed `data` array.");let b=a1(this.requestArgs);if(this.index<a.data.length){let c=b?a.data.length-1-this.index:this.index,d=a.data[c];return this.index+=1,{value:d,done:!1}}if(a.has_more){this.index=0,this.pagePromise=this.getNextPage(a);let b=await this.pagePromise;return this.iterate(b)}return{done:!0,value:void 0}}getNextPage(a){throw Error("Unimplemented")}async _next(){return this.iterate(await this.pagePromise)}next(){if(this.promiseCache.currentPromise)return this.promiseCache.currentPromise;let a=(async()=>{let a=await this._next();return this.promiseCache.currentPromise=null,a})();return this.promiseCache.currentPromise=a,a}}class aR extends aQ{getNextPage(a){let b=a1(this.requestArgs),c=aZ(a,b);return this.stripeResource._makeRequest(this.requestArgs,this.spec,{[b?"ending_before":"starting_after"]:c})}}class aS extends aQ{getNextPage(a){if(!a.next_page)throw Error("Unexpected: Stripe API response does not have a well-formed `next_page` field, but `has_more` was true.");return this.stripeResource._makeRequest(this.requestArgs,this.spec,{page:a.next_page})}}class aT{constructor(a,b,c,d){this.currentPageIterator=(async()=>(await a).data[Symbol.iterator]())(),this.nextPageUrl=(async()=>(await a).next_page_url||null)(),this.requestArgs=b,this.spec=c,this.stripeResource=d}async turnPage(){let a=await this.nextPageUrl;if(!a)return null;this.spec.fullPath=a;let b=await this.stripeResource._makeRequest([],this.spec,{});return this.nextPageUrl=Promise.resolve(b.next_page_url),this.currentPageIterator=Promise.resolve(b.data[Symbol.iterator]()),this.currentPageIterator}async next(){{let a=(await this.currentPageIterator).next();if(!a.done)return{done:!1,value:a.value}}let a=await this.turnPage();if(!a)return{done:!0,value:void 0};let b=a.next();return b.done?{done:!0,value:void 0}:{done:!1,value:b.value}}}let aU=(a,b,c,d)=>{let e=aK(c.fullPath||c.path);return"v2"!==e&&"search"===c.methodType?aV(new aS(d,b,c,a)):"v2"!==e&&"list"===c.methodType?aV(new aR(d,b,c,a)):"v2"===e&&"list"===c.methodType?aV(new aT(d,b,c,a)):null},aV=a=>{let b=a$((...b)=>a.next(...b)),c=a_(b),d={autoPagingEach:b,autoPagingToArray:c,next:()=>a.next(),return:()=>({}),[aW()]:()=>d};return d};function aW(){return"undefined"!=typeof Symbol&&Symbol.asyncIterator?Symbol.asyncIterator:"@@asyncIterator"}function aX(a){if(a.length<2)return null;let b=a[1];if("function"!=typeof b)throw Error(`The second argument to autoPagingEach, if present, must be a callback function; received ${typeof b}`);return b}function aY(a){if(0===a.length)return;let b=a[0];if("function"!=typeof b)throw Error(`The first argument to autoPagingEach, if present, must be a callback function; received ${typeof b}`);if(2===b.length)return b;if(b.length>2)throw Error(`The \`onItem\` callback function passed to autoPagingEach must accept at most two arguments; got ${b}`);return function(a,c){c(b(a))}}function aZ(a,b){let c=b?0:a.data.length-1,d=a.data[c],e=d&&d.id;if(!e)throw Error("Unexpected: No `id` found on the last item while auto-paging a list.");return e}function a$(a){return function(){let b=[].slice.call(arguments),c=aY(b),d=aX(b);if(b.length>2)throw Error(`autoPagingEach takes up to two arguments; received ${b}`);return az(a0(a,c),d)}}function a_(a){return function(b,c){let d=b&&b.limit;if(!d)throw Error("You must pass a `limit` option to autoPagingToArray, e.g., `autoPagingToArray({limit: 1000});`.");if(d>1e4)throw Error("You cannot specify a limit of more than 10,000 items to fetch in `autoPagingToArray`; use `autoPagingEach` to iterate through longer lists.");return az(new Promise((b,c)=>{let e=[];a(a=>{if(e.push(a),e.length>=d)return!1}).then(()=>{b(e)}).catch(c)}),c)}}function a0(a,b){return new Promise((c,d)=>{function e(d){if(d.done)return void c();let f=d.value;return new Promise(a=>{b(f,a)}).then(b=>!1===b?e({done:!0,value:void 0}):a().then(e))}a().then(e).catch(d)})}function a1(a){return!!at([].slice.call(a)).ending_before}function a2(a){if(void 0!==a.path&&void 0!==a.fullPath)throw Error(`Method spec specified both a 'path' (${a.path}) and a 'fullPath' (${a.fullPath}).`);return function(...b){let c="function"==typeof b[b.length-1]&&b.pop();a.urlParams=as(a.fullPath||this.createResourcePathWithSymbols(a.path||""));let d=az(this._makeRequest(b,a,{}),c);return Object.assign(d,aU(this,b,a,d)),d}}function a3(a,b){if(this._stripe=a,b)throw Error("Support for curried url params was dropped in stripe-node v7.0.0. Instead, pass two ids.");this.basePath=ar(this.basePath||a.getApiField("basePath")),this.resourcePath=this.path,this.path=ar(this.path),this.initialize(...arguments)}function a4(a){let b={DEFAULT_TOLERANCE:300,signature:null,constructEvent(a,c,d,e,f,g){try{this.signature.verifyHeader(a,c,d,e||b.DEFAULT_TOLERANCE,f,g)}catch(a){throw a instanceof H&&(a.message+="\nUse `await constructEventAsync(...)` instead of `constructEvent(...)`"),a}return a instanceof Uint8Array?JSON.parse(new TextDecoder("utf8").decode(a)):JSON.parse(a)},async constructEventAsync(a,c,d,e,f,g){return await this.signature.verifyHeaderAsync(a,c,d,e||b.DEFAULT_TOLERANCE,f,g),a instanceof Uint8Array?JSON.parse(new TextDecoder("utf8").decode(a)):JSON.parse(a)},generateTestHeaderString:function(a){let b=j(a),c=b.signature||b.cryptoProvider.computeHMACSignature(b.payloadString,b.secret);return b.generateHeaderString(c)},generateTestHeaderStringAsync:async function(a){let b=j(a),c=b.signature||await b.cryptoProvider.computeHMACSignatureAsync(b.payloadString,b.secret);return b.generateHeaderString(c)}},c={EXPECTED_SCHEME:"v1",verifyHeader(a,b,c,g,h,j){let{decodedHeader:k,decodedPayload:l,details:m,suspectPayloadType:n}=e(a,b,this.EXPECTED_SCHEME),o=/\s/.test(c),p=(h=h||i()).computeHMACSignature(d(l,m),c);return f(l,k,m,p,g,n,o,j),!0},async verifyHeaderAsync(a,b,c,g,h,j){let{decodedHeader:k,decodedPayload:l,details:m,suspectPayloadType:n}=e(a,b,this.EXPECTED_SCHEME),o=/\s/.test(c);h=h||i();let p=await h.computeHMACSignatureAsync(d(l,m),c);return f(l,k,m,p,g,n,o,j)}};function d(a,b){return`${b.timestamp}.${a}`}function e(a,b,c){if(!a)throw new ai(b,a,{message:"No webhook payload was provided."});let d="string"!=typeof a&&!(a instanceof Uint8Array),e=new TextDecoder("utf8"),f=a instanceof Uint8Array?e.decode(a):a;if(Array.isArray(b))throw Error("Unexpected: An array was passed as a header, which should not be possible for the stripe-signature header.");if(null==b||""==b)throw new ai(b,a,{message:"No stripe-signature header value was provided."});let h=b instanceof Uint8Array?e.decode(b):b,i=g(h,c);if(!i||-1===i.timestamp)throw new ai(h,f,{message:"Unable to extract timestamp and signatures from header"});if(!i.signatures.length)throw new ai(h,f,{message:"No signatures found with expected scheme"});return{decodedPayload:f,decodedHeader:h,details:i,suspectPayloadType:d}}function f(b,c,d,e,f,g,h,i){let j=!!d.signatures.filter(a.secureCompare.bind(a,e)).length,k="\nLearn more about webhook signing and explore webhook integration examples for various frameworks at https://docs.stripe.com/webhooks/signature",l=h?"\n\nNote: The provided signing secret contains whitespace. This often indicates an extra newline or space is in the value":"";if(!j){if(g)throw new ai(c,b,{message:"Webhook payload must be provided as a string or a Buffer (https://nodejs.org/api/buffer.html) instance representing the _raw_ request body.Payload was provided as a parsed JavaScript object instead. \nSignature verification is impossible without access to the original signed material. \n"+k+"\n"+l});throw new ai(c,b,{message:"No signatures found matching the expected signature for payload. Are you passing the raw request body you received from Stripe? \n If a webhook request is being forwarded by a third-party tool, ensure that the exact request body, including JSON formatting and new line style, is preserved.\n"+k+"\n"+l})}let m=Math.floor(("number"==typeof i?i:Date.now())/1e3)-d.timestamp;if(f>0&&m>f)throw new ai(c,b,{message:"Timestamp outside the tolerance zone"});return!0}function g(a,b){return"string"!=typeof a?null:a.split(",").reduce((a,c)=>{let d=c.split("=");return"t"===d[0]&&(a.timestamp=parseInt(d[1],10)),d[0]===b&&a.signatures.push(d[1]),a},{timestamp:-1,signatures:[]})}let h=null;function i(){return h||(h=a.createDefaultCryptoProvider()),h}function j(a){if(!a)throw new aa({message:"Options are required"});let b=Math.floor(a.timestamp)||Math.floor(Date.now()/1e3),d=a.scheme||c.EXPECTED_SCHEME,e=a.cryptoProvider||i(),f=`${b}.${a.payload}`,g=a=>`t=${b},${d}=${a}`;return Object.assign(Object.assign({},a),{timestamp:b,scheme:d,cryptoProvider:e,payloadString:f,generateHeaderString:g})}return b.signature=c,b}a3.extend=av,a3.method=a2,a3.MAX_BUFFERED_REQUEST_METRICS=100,a3.prototype={_stripe:null,path:"",resourcePath:"",basePath:null,initialize(){},requestDataProcessor:null,validateRequest:null,createFullPath(a,b){let c=[this.basePath(b),this.path(b)];if("function"==typeof a){let d=a(b);d&&c.push(d)}else c.push(a);return this._joinUrlParts(c)},createResourcePathWithSymbols(a){return a?`/${this._joinUrlParts([this.resourcePath,a])}`:`/${this.resourcePath}`},_joinUrlParts:a=>a.join("/").replace(/\/{2,}/g,"/"),_getRequestOpts(a,b,c){var d;let e=(b.method||"GET").toUpperCase(),f=b.usage||[],g=b.urlParams||[],h=b.encode||(a=>a),i=!!b.fullPath,j=ar(i?b.fullPath:b.path||""),k=i?b.fullPath:this.createResourcePathWithSymbols(b.path),l=[].slice.call(a),m=g.reduce((a,b)=>{let c=l.shift();if("string"!=typeof c)throw Error(`Stripe: Argument "${b}" must be a string, but got: ${c} (on API request to \`${e} ${k}\`)`);return a[b]=c,a},{}),n=h(Object.assign({},at(l),c)),o=au(l),p=o.host||b.host,q=!!b.streaming;if(l.filter(a=>null!=a).length)throw Error(`Stripe: Unknown arguments (${l}). Did you mean to pass an options object? See https://github.com/stripe/stripe-node/wiki/Passing-Options. (on API request to ${e} \`${k}\`)`);let r=i?j(m):this.createFullPath(j,m),s=Object.assign(o.headers,b.headers);b.validator&&b.validator(n,{headers:s});let t="GET"===b.method||"DELETE"===b.method;return{requestMethod:e,requestPath:r,bodyData:t?null:n,queryData:t?n:{},authenticator:null!=(d=o.authenticator)?d:null,headers:s,host:null!=p?p:null,streaming:q,settings:o.settings,usage:f}},_makeRequest(a,b,c){return new Promise((d,e)=>{var f;let g;try{g=this._getRequestOpts(a,b,c)}catch(a){e(a);return}function h(a,c){a?e(a):d(b.transformResponseData?b.transformResponseData(c):c)}let i=0===Object.keys(g.queryData).length,j=[g.requestPath,i?"":"?",aq(g.queryData,aK(g.requestPath))].join(""),{headers:k,settings:l}=g;this._stripe._requestSender._request(g.requestMethod,g.host,j,g.bodyData,g.authenticator,{headers:k,settings:l,streaming:g.streaming},g.usage,h,null==(f=this.requestDataProcessor)?void 0:f.bind(this))})}};let a5="2025-02-24.acacia";function a6(a,b){for(let c in b){if(!Object.prototype.hasOwnProperty.call(b,c))continue;let d=c[0].toLowerCase()+c.substring(1),e=new b[c](a);this[d]=e}}function a7(a,b){return function(a){return new a6(a,b)}}let a8=a3.method,a9=a3.extend({retrieve:a8({method:"GET",fullPath:"/v1/financial_connections/accounts/{account}"}),list:a8({method:"GET",fullPath:"/v1/financial_connections/accounts",methodType:"list"}),disconnect:a8({method:"POST",fullPath:"/v1/financial_connections/accounts/{account}/disconnect"}),listOwners:a8({method:"GET",fullPath:"/v1/financial_connections/accounts/{account}/owners",methodType:"list"}),refresh:a8({method:"POST",fullPath:"/v1/financial_connections/accounts/{account}/refresh"}),subscribe:a8({method:"POST",fullPath:"/v1/financial_connections/accounts/{account}/subscribe"}),unsubscribe:a8({method:"POST",fullPath:"/v1/financial_connections/accounts/{account}/unsubscribe"})}),ba=a3.method,bb=a3.extend({retrieve:ba({method:"GET",fullPath:"/v1/entitlements/active_entitlements/{id}"}),list:ba({method:"GET",fullPath:"/v1/entitlements/active_entitlements",methodType:"list"})}),bc=a3.method,bd=a3.extend({create:bc({method:"POST",fullPath:"/v1/billing/alerts"}),retrieve:bc({method:"GET",fullPath:"/v1/billing/alerts/{id}"}),list:bc({method:"GET",fullPath:"/v1/billing/alerts",methodType:"list"}),activate:bc({method:"POST",fullPath:"/v1/billing/alerts/{id}/activate"}),archive:bc({method:"POST",fullPath:"/v1/billing/alerts/{id}/archive"}),deactivate:bc({method:"POST",fullPath:"/v1/billing/alerts/{id}/deactivate"})}),be=a3.method,bf=a3.extend({create:be({method:"POST",fullPath:"/v1/test_helpers/issuing/authorizations"}),capture:be({method:"POST",fullPath:"/v1/test_helpers/issuing/authorizations/{authorization}/capture"}),expire:be({method:"POST",fullPath:"/v1/test_helpers/issuing/authorizations/{authorization}/expire"}),finalizeAmount:be({method:"POST",fullPath:"/v1/test_helpers/issuing/authorizations/{authorization}/finalize_amount"}),increment:be({method:"POST",fullPath:"/v1/test_helpers/issuing/authorizations/{authorization}/increment"}),respond:be({method:"POST",fullPath:"/v1/test_helpers/issuing/authorizations/{authorization}/fraud_challenges/respond"}),reverse:be({method:"POST",fullPath:"/v1/test_helpers/issuing/authorizations/{authorization}/reverse"})}),bg=a3.method,bh=a3.extend({retrieve:bg({method:"GET",fullPath:"/v1/issuing/authorizations/{authorization}"}),update:bg({method:"POST",fullPath:"/v1/issuing/authorizations/{authorization}"}),list:bg({method:"GET",fullPath:"/v1/issuing/authorizations",methodType:"list"}),approve:bg({method:"POST",fullPath:"/v1/issuing/authorizations/{authorization}/approve"}),decline:bg({method:"POST",fullPath:"/v1/issuing/authorizations/{authorization}/decline"})}),bi=a3.method,bj=a3.extend({create:bi({method:"POST",fullPath:"/v1/tax/calculations"}),retrieve:bi({method:"GET",fullPath:"/v1/tax/calculations/{calculation}"}),listLineItems:bi({method:"GET",fullPath:"/v1/tax/calculations/{calculation}/line_items",methodType:"list"})}),bk=a3.method,bl=a3.extend({create:bk({method:"POST",fullPath:"/v1/issuing/cardholders"}),retrieve:bk({method:"GET",fullPath:"/v1/issuing/cardholders/{cardholder}"}),update:bk({method:"POST",fullPath:"/v1/issuing/cardholders/{cardholder}"}),list:bk({method:"GET",fullPath:"/v1/issuing/cardholders",methodType:"list"})}),bm=a3.method,bn=a3.extend({deliverCard:bm({method:"POST",fullPath:"/v1/test_helpers/issuing/cards/{card}/shipping/deliver"}),failCard:bm({method:"POST",fullPath:"/v1/test_helpers/issuing/cards/{card}/shipping/fail"}),returnCard:bm({method:"POST",fullPath:"/v1/test_helpers/issuing/cards/{card}/shipping/return"}),shipCard:bm({method:"POST",fullPath:"/v1/test_helpers/issuing/cards/{card}/shipping/ship"}),submitCard:bm({method:"POST",fullPath:"/v1/test_helpers/issuing/cards/{card}/shipping/submit"})}),bo=a3.method,bp=a3.extend({create:bo({method:"POST",fullPath:"/v1/issuing/cards"}),retrieve:bo({method:"GET",fullPath:"/v1/issuing/cards/{card}"}),update:bo({method:"POST",fullPath:"/v1/issuing/cards/{card}"}),list:bo({method:"GET",fullPath:"/v1/issuing/cards",methodType:"list"})}),bq=a3.method,br=a3.extend({create:bq({method:"POST",fullPath:"/v1/billing_portal/configurations"}),retrieve:bq({method:"GET",fullPath:"/v1/billing_portal/configurations/{configuration}"}),update:bq({method:"POST",fullPath:"/v1/billing_portal/configurations/{configuration}"}),list:bq({method:"GET",fullPath:"/v1/billing_portal/configurations",methodType:"list"})}),bs=a3.method,bt=a3.extend({create:bs({method:"POST",fullPath:"/v1/terminal/configurations"}),retrieve:bs({method:"GET",fullPath:"/v1/terminal/configurations/{configuration}"}),update:bs({method:"POST",fullPath:"/v1/terminal/configurations/{configuration}"}),list:bs({method:"GET",fullPath:"/v1/terminal/configurations",methodType:"list"}),del:bs({method:"DELETE",fullPath:"/v1/terminal/configurations/{configuration}"})}),bu=a3.method,bv=a3.extend({create:bu({method:"POST",fullPath:"/v1/test_helpers/confirmation_tokens"})}),bw=a3.method,bx=a3.extend({create:bw({method:"POST",fullPath:"/v1/terminal/connection_tokens"})}),by=a3.method,bz=a3.extend({retrieve:by({method:"GET",fullPath:"/v1/billing/credit_balance_summary"})}),bA=a3.method,bB=a3.extend({retrieve:bA({method:"GET",fullPath:"/v1/billing/credit_balance_transactions/{id}"}),list:bA({method:"GET",fullPath:"/v1/billing/credit_balance_transactions",methodType:"list"})}),bC=a3.method,bD=a3.extend({create:bC({method:"POST",fullPath:"/v1/billing/credit_grants"}),retrieve:bC({method:"GET",fullPath:"/v1/billing/credit_grants/{id}"}),update:bC({method:"POST",fullPath:"/v1/billing/credit_grants/{id}"}),list:bC({method:"GET",fullPath:"/v1/billing/credit_grants",methodType:"list"}),expire:bC({method:"POST",fullPath:"/v1/billing/credit_grants/{id}/expire"}),voidGrant:bC({method:"POST",fullPath:"/v1/billing/credit_grants/{id}/void"})}),bE=a3.method,bF=a3.extend({create:bE({method:"POST",fullPath:"/v1/treasury/credit_reversals"}),retrieve:bE({method:"GET",fullPath:"/v1/treasury/credit_reversals/{credit_reversal}"}),list:bE({method:"GET",fullPath:"/v1/treasury/credit_reversals",methodType:"list"})}),bG=a3.method,bH=a3.extend({fundCashBalance:bG({method:"POST",fullPath:"/v1/test_helpers/customers/{customer}/fund_cash_balance"})}),bI=a3.method,bJ=a3.extend({create:bI({method:"POST",fullPath:"/v1/treasury/debit_reversals"}),retrieve:bI({method:"GET",fullPath:"/v1/treasury/debit_reversals/{debit_reversal}"}),list:bI({method:"GET",fullPath:"/v1/treasury/debit_reversals",methodType:"list"})}),bK=a3.method,bL=a3.extend({create:bK({method:"POST",fullPath:"/v1/issuing/disputes"}),retrieve:bK({method:"GET",fullPath:"/v1/issuing/disputes/{dispute}"}),update:bK({method:"POST",fullPath:"/v1/issuing/disputes/{dispute}"}),list:bK({method:"GET",fullPath:"/v1/issuing/disputes",methodType:"list"}),submit:bK({method:"POST",fullPath:"/v1/issuing/disputes/{dispute}/submit"})}),bM=a3.method,bN=a3.extend({retrieve:bM({method:"GET",fullPath:"/v1/radar/early_fraud_warnings/{early_fraud_warning}"}),list:bM({method:"GET",fullPath:"/v1/radar/early_fraud_warnings",methodType:"list"})}),bO=a3.method,bP=a3.extend({create:bO({method:"POST",fullPath:"/v2/core/event_destinations"}),retrieve:bO({method:"GET",fullPath:"/v2/core/event_destinations/{id}"}),update:bO({method:"POST",fullPath:"/v2/core/event_destinations/{id}"}),list:bO({method:"GET",fullPath:"/v2/core/event_destinations",methodType:"list"}),del:bO({method:"DELETE",fullPath:"/v2/core/event_destinations/{id}"}),disable:bO({method:"POST",fullPath:"/v2/core/event_destinations/{id}/disable"}),enable:bO({method:"POST",fullPath:"/v2/core/event_destinations/{id}/enable"}),ping:bO({method:"POST",fullPath:"/v2/core/event_destinations/{id}/ping"})}),bQ=a3.method,bR=a3.extend({retrieve(...a){return bQ({method:"GET",fullPath:"/v2/core/events/{id}",transformResponseData:a=>this.addFetchRelatedObjectIfNeeded(a)}).apply(this,a)},list(...a){return bQ({method:"GET",fullPath:"/v2/core/events",methodType:"list",transformResponseData:a=>Object.assign(Object.assign({},a),{data:a.data.map(this.addFetchRelatedObjectIfNeeded.bind(this))})}).apply(this,a)},addFetchRelatedObjectIfNeeded(a){return a.related_object&&a.related_object.url?Object.assign(Object.assign({},a),{fetchRelatedObject:()=>bQ({method:"GET",fullPath:a.related_object.url}).apply(this,[{stripeAccount:a.context}])}):a}}),bS=a3.method,bT=a3.extend({create:bS({method:"POST",fullPath:"/v1/entitlements/features"}),retrieve:bS({method:"GET",fullPath:"/v1/entitlements/features/{id}"}),update:bS({method:"POST",fullPath:"/v1/entitlements/features/{id}"}),list:bS({method:"GET",fullPath:"/v1/entitlements/features",methodType:"list"})}),bU=a3.method,bV=a3.extend({create:bU({method:"POST",fullPath:"/v1/treasury/financial_accounts"}),retrieve:bU({method:"GET",fullPath:"/v1/treasury/financial_accounts/{financial_account}"}),update:bU({method:"POST",fullPath:"/v1/treasury/financial_accounts/{financial_account}"}),list:bU({method:"GET",fullPath:"/v1/treasury/financial_accounts",methodType:"list"}),close:bU({method:"POST",fullPath:"/v1/treasury/financial_accounts/{financial_account}/close"}),retrieveFeatures:bU({method:"GET",fullPath:"/v1/treasury/financial_accounts/{financial_account}/features"}),updateFeatures:bU({method:"POST",fullPath:"/v1/treasury/financial_accounts/{financial_account}/features"})}),bW=a3.method,bX=a3.extend({fail:bW({method:"POST",fullPath:"/v1/test_helpers/treasury/inbound_transfers/{id}/fail"}),returnInboundTransfer:bW({method:"POST",fullPath:"/v1/test_helpers/treasury/inbound_transfers/{id}/return"}),succeed:bW({method:"POST",fullPath:"/v1/test_helpers/treasury/inbound_transfers/{id}/succeed"})}),bY=a3.method,bZ=a3.extend({create:bY({method:"POST",fullPath:"/v1/treasury/inbound_transfers"}),retrieve:bY({method:"GET",fullPath:"/v1/treasury/inbound_transfers/{id}"}),list:bY({method:"GET",fullPath:"/v1/treasury/inbound_transfers",methodType:"list"}),cancel:bY({method:"POST",fullPath:"/v1/treasury/inbound_transfers/{inbound_transfer}/cancel"})}),b$=a3.method,b_=a3.extend({create:b$({method:"POST",fullPath:"/v1/terminal/locations"}),retrieve:b$({method:"GET",fullPath:"/v1/terminal/locations/{location}"}),update:b$({method:"POST",fullPath:"/v1/terminal/locations/{location}"}),list:b$({method:"GET",fullPath:"/v1/terminal/locations",methodType:"list"}),del:b$({method:"DELETE",fullPath:"/v1/terminal/locations/{location}"})}),b0=a3.method,b1=a3.extend({create:b0({method:"POST",fullPath:"/v1/billing/meter_event_adjustments"})}),b2=a3.method,b3=a3.extend({create:b2({method:"POST",fullPath:"/v2/billing/meter_event_adjustments"})}),b4=a3.method,b5=a3.extend({create:b4({method:"POST",fullPath:"/v2/billing/meter_event_session"})}),b6=a3.method,b7=a3.extend({create:b6({method:"POST",fullPath:"/v2/billing/meter_event_stream",host:"meter-events.stripe.com"})}),b8=a3.method,b9=a3.extend({create:b8({method:"POST",fullPath:"/v1/billing/meter_events"})}),ca=a3.method,cb=a3.extend({create:ca({method:"POST",fullPath:"/v2/billing/meter_events"})}),cc=a3.method,cd=a3.extend({create:cc({method:"POST",fullPath:"/v1/billing/meters"}),retrieve:cc({method:"GET",fullPath:"/v1/billing/meters/{id}"}),update:cc({method:"POST",fullPath:"/v1/billing/meters/{id}"}),list:cc({method:"GET",fullPath:"/v1/billing/meters",methodType:"list"}),deactivate:cc({method:"POST",fullPath:"/v1/billing/meters/{id}/deactivate"}),listEventSummaries:cc({method:"GET",fullPath:"/v1/billing/meters/{id}/event_summaries",methodType:"list"}),reactivate:cc({method:"POST",fullPath:"/v1/billing/meters/{id}/reactivate"})}),ce=a3.method,cf=a3.extend({create:ce({method:"POST",fullPath:"/v1/climate/orders"}),retrieve:ce({method:"GET",fullPath:"/v1/climate/orders/{order}"}),update:ce({method:"POST",fullPath:"/v1/climate/orders/{order}"}),list:ce({method:"GET",fullPath:"/v1/climate/orders",methodType:"list"}),cancel:ce({method:"POST",fullPath:"/v1/climate/orders/{order}/cancel"})}),cg=a3.method,ch=a3.extend({update:cg({method:"POST",fullPath:"/v1/test_helpers/treasury/outbound_payments/{id}"}),fail:cg({method:"POST",fullPath:"/v1/test_helpers/treasury/outbound_payments/{id}/fail"}),post:cg({method:"POST",fullPath:"/v1/test_helpers/treasury/outbound_payments/{id}/post"}),returnOutboundPayment:cg({method:"POST",fullPath:"/v1/test_helpers/treasury/outbound_payments/{id}/return"})}),ci=a3.method,cj=a3.extend({create:ci({method:"POST",fullPath:"/v1/treasury/outbound_payments"}),retrieve:ci({method:"GET",fullPath:"/v1/treasury/outbound_payments/{id}"}),list:ci({method:"GET",fullPath:"/v1/treasury/outbound_payments",methodType:"list"}),cancel:ci({method:"POST",fullPath:"/v1/treasury/outbound_payments/{id}/cancel"})}),ck=a3.method,cl=a3.extend({update:ck({method:"POST",fullPath:"/v1/test_helpers/treasury/outbound_transfers/{outbound_transfer}"}),fail:ck({method:"POST",fullPath:"/v1/test_helpers/treasury/outbound_transfers/{outbound_transfer}/fail"}),post:ck({method:"POST",fullPath:"/v1/test_helpers/treasury/outbound_transfers/{outbound_transfer}/post"}),returnOutboundTransfer:ck({method:"POST",fullPath:"/v1/test_helpers/treasury/outbound_transfers/{outbound_transfer}/return"})}),cm=a3.method,cn=a3.extend({create:cm({method:"POST",fullPath:"/v1/treasury/outbound_transfers"}),retrieve:cm({method:"GET",fullPath:"/v1/treasury/outbound_transfers/{outbound_transfer}"}),list:cm({method:"GET",fullPath:"/v1/treasury/outbound_transfers",methodType:"list"}),cancel:cm({method:"POST",fullPath:"/v1/treasury/outbound_transfers/{outbound_transfer}/cancel"})}),co=a3.method,cp=a3.extend({activate:co({method:"POST",fullPath:"/v1/test_helpers/issuing/personalization_designs/{personalization_design}/activate"}),deactivate:co({method:"POST",fullPath:"/v1/test_helpers/issuing/personalization_designs/{personalization_design}/deactivate"}),reject:co({method:"POST",fullPath:"/v1/test_helpers/issuing/personalization_designs/{personalization_design}/reject"})}),cq=a3.method,cr=a3.extend({create:cq({method:"POST",fullPath:"/v1/issuing/personalization_designs"}),retrieve:cq({method:"GET",fullPath:"/v1/issuing/personalization_designs/{personalization_design}"}),update:cq({method:"POST",fullPath:"/v1/issuing/personalization_designs/{personalization_design}"}),list:cq({method:"GET",fullPath:"/v1/issuing/personalization_designs",methodType:"list"})}),cs=a3.method,ct=a3.extend({retrieve:cs({method:"GET",fullPath:"/v1/issuing/physical_bundles/{physical_bundle}"}),list:cs({method:"GET",fullPath:"/v1/issuing/physical_bundles",methodType:"list"})}),cu=a3.method,cv=a3.extend({retrieve:cu({method:"GET",fullPath:"/v1/climate/products/{product}"}),list:cu({method:"GET",fullPath:"/v1/climate/products",methodType:"list"})}),cw=a3.method,cx=a3.extend({presentPaymentMethod:cw({method:"POST",fullPath:"/v1/test_helpers/terminal/readers/{reader}/present_payment_method"})}),cy=a3.method,cz=a3.extend({create:cy({method:"POST",fullPath:"/v1/terminal/readers"}),retrieve:cy({method:"GET",fullPath:"/v1/terminal/readers/{reader}"}),update:cy({method:"POST",fullPath:"/v1/terminal/readers/{reader}"}),list:cy({method:"GET",fullPath:"/v1/terminal/readers",methodType:"list"}),del:cy({method:"DELETE",fullPath:"/v1/terminal/readers/{reader}"}),cancelAction:cy({method:"POST",fullPath:"/v1/terminal/readers/{reader}/cancel_action"}),processPaymentIntent:cy({method:"POST",fullPath:"/v1/terminal/readers/{reader}/process_payment_intent"}),processSetupIntent:cy({method:"POST",fullPath:"/v1/terminal/readers/{reader}/process_setup_intent"}),refundPayment:cy({method:"POST",fullPath:"/v1/terminal/readers/{reader}/refund_payment"}),setReaderDisplay:cy({method:"POST",fullPath:"/v1/terminal/readers/{reader}/set_reader_display"})}),cA=a3.method,cB=a3.extend({create:cA({method:"POST",fullPath:"/v1/test_helpers/treasury/received_credits"})}),cC=a3.method,cD=a3.extend({retrieve:cC({method:"GET",fullPath:"/v1/treasury/received_credits/{id}"}),list:cC({method:"GET",fullPath:"/v1/treasury/received_credits",methodType:"list"})}),cE=a3.method,cF=a3.extend({create:cE({method:"POST",fullPath:"/v1/test_helpers/treasury/received_debits"})}),cG=a3.method,cH=a3.extend({retrieve:cG({method:"GET",fullPath:"/v1/treasury/received_debits/{id}"}),list:cG({method:"GET",fullPath:"/v1/treasury/received_debits",methodType:"list"})}),cI=a3.method,cJ=a3.extend({expire:cI({method:"POST",fullPath:"/v1/test_helpers/refunds/{refund}/expire"})}),cK=a3.method,cL=a3.extend({create:cK({method:"POST",fullPath:"/v1/tax/registrations"}),retrieve:cK({method:"GET",fullPath:"/v1/tax/registrations/{id}"}),update:cK({method:"POST",fullPath:"/v1/tax/registrations/{id}"}),list:cK({method:"GET",fullPath:"/v1/tax/registrations",methodType:"list"})}),cM=a3.method,cN=a3.extend({create:cM({method:"POST",fullPath:"/v1/reporting/report_runs"}),retrieve:cM({method:"GET",fullPath:"/v1/reporting/report_runs/{report_run}"}),list:cM({method:"GET",fullPath:"/v1/reporting/report_runs",methodType:"list"})}),cO=a3.method,cP=a3.extend({retrieve:cO({method:"GET",fullPath:"/v1/reporting/report_types/{report_type}"}),list:cO({method:"GET",fullPath:"/v1/reporting/report_types",methodType:"list"})}),cQ=a3.method,cR=a3.extend({create:cQ({method:"POST",fullPath:"/v1/forwarding/requests"}),retrieve:cQ({method:"GET",fullPath:"/v1/forwarding/requests/{id}"}),list:cQ({method:"GET",fullPath:"/v1/forwarding/requests",methodType:"list"})}),cS=a3.method,cT=a3.extend({retrieve:cS({method:"GET",fullPath:"/v1/sigma/scheduled_query_runs/{scheduled_query_run}"}),list:cS({method:"GET",fullPath:"/v1/sigma/scheduled_query_runs",methodType:"list"})}),cU=a3.method,cV=a3.extend({create:cU({method:"POST",fullPath:"/v1/apps/secrets"}),list:cU({method:"GET",fullPath:"/v1/apps/secrets",methodType:"list"}),deleteWhere:cU({method:"POST",fullPath:"/v1/apps/secrets/delete"}),find:cU({method:"GET",fullPath:"/v1/apps/secrets/find"})}),cW=a3.method,cX=a3.extend({create:cW({method:"POST",fullPath:"/v1/billing_portal/sessions"})}),cY=a3.method,cZ=a3.extend({create:cY({method:"POST",fullPath:"/v1/checkout/sessions"}),retrieve:cY({method:"GET",fullPath:"/v1/checkout/sessions/{session}"}),update:cY({method:"POST",fullPath:"/v1/checkout/sessions/{session}"}),list:cY({method:"GET",fullPath:"/v1/checkout/sessions",methodType:"list"}),expire:cY({method:"POST",fullPath:"/v1/checkout/sessions/{session}/expire"}),listLineItems:cY({method:"GET",fullPath:"/v1/checkout/sessions/{session}/line_items",methodType:"list"})}),c$=a3.method,c_=a3.extend({create:c$({method:"POST",fullPath:"/v1/financial_connections/sessions"}),retrieve:c$({method:"GET",fullPath:"/v1/financial_connections/sessions/{session}"})}),c0=a3.method,c1=a3.extend({retrieve:c0({method:"GET",fullPath:"/v1/tax/settings"}),update:c0({method:"POST",fullPath:"/v1/tax/settings"})}),c2=a3.method,c3=a3.extend({retrieve:c2({method:"GET",fullPath:"/v1/climate/suppliers/{supplier}"}),list:c2({method:"GET",fullPath:"/v1/climate/suppliers",methodType:"list"})}),c4=a3.method,c5=a3.extend({create:c4({method:"POST",fullPath:"/v1/test_helpers/test_clocks"}),retrieve:c4({method:"GET",fullPath:"/v1/test_helpers/test_clocks/{test_clock}"}),list:c4({method:"GET",fullPath:"/v1/test_helpers/test_clocks",methodType:"list"}),del:c4({method:"DELETE",fullPath:"/v1/test_helpers/test_clocks/{test_clock}"}),advance:c4({method:"POST",fullPath:"/v1/test_helpers/test_clocks/{test_clock}/advance"})}),c6=a3.method,c7=a3.extend({retrieve:c6({method:"GET",fullPath:"/v1/issuing/tokens/{token}"}),update:c6({method:"POST",fullPath:"/v1/issuing/tokens/{token}"}),list:c6({method:"GET",fullPath:"/v1/issuing/tokens",methodType:"list"})}),c8=a3.method,c9=a3.extend({retrieve:c8({method:"GET",fullPath:"/v1/treasury/transaction_entries/{id}"}),list:c8({method:"GET",fullPath:"/v1/treasury/transaction_entries",methodType:"list"})}),da=a3.method,db=a3.extend({createForceCapture:da({method:"POST",fullPath:"/v1/test_helpers/issuing/transactions/create_force_capture"}),createUnlinkedRefund:da({method:"POST",fullPath:"/v1/test_helpers/issuing/transactions/create_unlinked_refund"}),refund:da({method:"POST",fullPath:"/v1/test_helpers/issuing/transactions/{transaction}/refund"})}),dc=a3.method,dd=a3.extend({retrieve:dc({method:"GET",fullPath:"/v1/financial_connections/transactions/{transaction}"}),list:dc({method:"GET",fullPath:"/v1/financial_connections/transactions",methodType:"list"})}),de=a3.method,df=a3.extend({retrieve:de({method:"GET",fullPath:"/v1/issuing/transactions/{transaction}"}),update:de({method:"POST",fullPath:"/v1/issuing/transactions/{transaction}"}),list:de({method:"GET",fullPath:"/v1/issuing/transactions",methodType:"list"})}),dg=a3.method,dh=a3.extend({retrieve:dg({method:"GET",fullPath:"/v1/tax/transactions/{transaction}"}),createFromCalculation:dg({method:"POST",fullPath:"/v1/tax/transactions/create_from_calculation"}),createReversal:dg({method:"POST",fullPath:"/v1/tax/transactions/create_reversal"}),listLineItems:dg({method:"GET",fullPath:"/v1/tax/transactions/{transaction}/line_items",methodType:"list"})}),di=a3.method,dj=a3.extend({retrieve:di({method:"GET",fullPath:"/v1/treasury/transactions/{id}"}),list:di({method:"GET",fullPath:"/v1/treasury/transactions",methodType:"list"})}),dk=a3.method,dl=a3.extend({create:dk({method:"POST",fullPath:"/v1/radar/value_list_items"}),retrieve:dk({method:"GET",fullPath:"/v1/radar/value_list_items/{item}"}),list:dk({method:"GET",fullPath:"/v1/radar/value_list_items",methodType:"list"}),del:dk({method:"DELETE",fullPath:"/v1/radar/value_list_items/{item}"})}),dm=a3.method,dn=a3.extend({create:dm({method:"POST",fullPath:"/v1/radar/value_lists"}),retrieve:dm({method:"GET",fullPath:"/v1/radar/value_lists/{value_list}"}),update:dm({method:"POST",fullPath:"/v1/radar/value_lists/{value_list}"}),list:dm({method:"GET",fullPath:"/v1/radar/value_lists",methodType:"list"}),del:dm({method:"DELETE",fullPath:"/v1/radar/value_lists/{value_list}"})}),dp=a3.method,dq=a3.extend({retrieve:dp({method:"GET",fullPath:"/v1/identity/verification_reports/{report}"}),list:dp({method:"GET",fullPath:"/v1/identity/verification_reports",methodType:"list"})}),dr=a3.method,ds=a3.extend({create:dr({method:"POST",fullPath:"/v1/identity/verification_sessions"}),retrieve:dr({method:"GET",fullPath:"/v1/identity/verification_sessions/{session}"}),update:dr({method:"POST",fullPath:"/v1/identity/verification_sessions/{session}"}),list:dr({method:"GET",fullPath:"/v1/identity/verification_sessions",methodType:"list"}),cancel:dr({method:"POST",fullPath:"/v1/identity/verification_sessions/{session}/cancel"}),redact:dr({method:"POST",fullPath:"/v1/identity/verification_sessions/{session}/redact"})}),dt=a3.method,du=a3.extend({create:dt({method:"POST",fullPath:"/v1/accounts"}),retrieve(a,...b){return"string"==typeof a?dt({method:"GET",fullPath:"/v1/accounts/{id}"}).apply(this,[a,...b]):(null==a&&[].shift.apply([a,...b]),dt({method:"GET",fullPath:"/v1/account"}).apply(this,[a,...b]))},update:dt({method:"POST",fullPath:"/v1/accounts/{account}"}),list:dt({method:"GET",fullPath:"/v1/accounts",methodType:"list"}),del:dt({method:"DELETE",fullPath:"/v1/accounts/{account}"}),createExternalAccount:dt({method:"POST",fullPath:"/v1/accounts/{account}/external_accounts"}),createLoginLink:dt({method:"POST",fullPath:"/v1/accounts/{account}/login_links"}),createPerson:dt({method:"POST",fullPath:"/v1/accounts/{account}/persons"}),deleteExternalAccount:dt({method:"DELETE",fullPath:"/v1/accounts/{account}/external_accounts/{id}"}),deletePerson:dt({method:"DELETE",fullPath:"/v1/accounts/{account}/persons/{person}"}),listCapabilities:dt({method:"GET",fullPath:"/v1/accounts/{account}/capabilities",methodType:"list"}),listExternalAccounts:dt({method:"GET",fullPath:"/v1/accounts/{account}/external_accounts",methodType:"list"}),listPersons:dt({method:"GET",fullPath:"/v1/accounts/{account}/persons",methodType:"list"}),reject:dt({method:"POST",fullPath:"/v1/accounts/{account}/reject"}),retrieveCurrent:dt({method:"GET",fullPath:"/v1/account"}),retrieveCapability:dt({method:"GET",fullPath:"/v1/accounts/{account}/capabilities/{capability}"}),retrieveExternalAccount:dt({method:"GET",fullPath:"/v1/accounts/{account}/external_accounts/{id}"}),retrievePerson:dt({method:"GET",fullPath:"/v1/accounts/{account}/persons/{person}"}),updateCapability:dt({method:"POST",fullPath:"/v1/accounts/{account}/capabilities/{capability}"}),updateExternalAccount:dt({method:"POST",fullPath:"/v1/accounts/{account}/external_accounts/{id}"}),updatePerson:dt({method:"POST",fullPath:"/v1/accounts/{account}/persons/{person}"})}),dv=a3.method,dw=a3.extend({create:dv({method:"POST",fullPath:"/v1/account_links"})}),dx=a3.method,dy=a3.extend({create:dx({method:"POST",fullPath:"/v1/account_sessions"})}),dz=a3.method,dA=a3.extend({create:dz({method:"POST",fullPath:"/v1/apple_pay/domains"}),retrieve:dz({method:"GET",fullPath:"/v1/apple_pay/domains/{domain}"}),list:dz({method:"GET",fullPath:"/v1/apple_pay/domains",methodType:"list"}),del:dz({method:"DELETE",fullPath:"/v1/apple_pay/domains/{domain}"})}),dB=a3.method,dC=a3.extend({retrieve:dB({method:"GET",fullPath:"/v1/application_fees/{id}"}),list:dB({method:"GET",fullPath:"/v1/application_fees",methodType:"list"}),createRefund:dB({method:"POST",fullPath:"/v1/application_fees/{id}/refunds"}),listRefunds:dB({method:"GET",fullPath:"/v1/application_fees/{id}/refunds",methodType:"list"}),retrieveRefund:dB({method:"GET",fullPath:"/v1/application_fees/{fee}/refunds/{id}"}),updateRefund:dB({method:"POST",fullPath:"/v1/application_fees/{fee}/refunds/{id}"})}),dD=a3.method,dE=a3.extend({retrieve:dD({method:"GET",fullPath:"/v1/balance"})}),dF=a3.method,dG=a3.extend({retrieve:dF({method:"GET",fullPath:"/v1/balance_transactions/{id}"}),list:dF({method:"GET",fullPath:"/v1/balance_transactions",methodType:"list"})}),dH=a3.method,dI=a3.extend({create:dH({method:"POST",fullPath:"/v1/charges"}),retrieve:dH({method:"GET",fullPath:"/v1/charges/{charge}"}),update:dH({method:"POST",fullPath:"/v1/charges/{charge}"}),list:dH({method:"GET",fullPath:"/v1/charges",methodType:"list"}),capture:dH({method:"POST",fullPath:"/v1/charges/{charge}/capture"}),search:dH({method:"GET",fullPath:"/v1/charges/search",methodType:"search"})}),dJ=a3.method,dK=a3.extend({retrieve:dJ({method:"GET",fullPath:"/v1/confirmation_tokens/{confirmation_token}"})}),dL=a3.method,dM=a3.extend({retrieve:dL({method:"GET",fullPath:"/v1/country_specs/{country}"}),list:dL({method:"GET",fullPath:"/v1/country_specs",methodType:"list"})}),dN=a3.method,dO=a3.extend({create:dN({method:"POST",fullPath:"/v1/coupons"}),retrieve:dN({method:"GET",fullPath:"/v1/coupons/{coupon}"}),update:dN({method:"POST",fullPath:"/v1/coupons/{coupon}"}),list:dN({method:"GET",fullPath:"/v1/coupons",methodType:"list"}),del:dN({method:"DELETE",fullPath:"/v1/coupons/{coupon}"})}),dP=a3.method,dQ=a3.extend({create:dP({method:"POST",fullPath:"/v1/credit_notes"}),retrieve:dP({method:"GET",fullPath:"/v1/credit_notes/{id}"}),update:dP({method:"POST",fullPath:"/v1/credit_notes/{id}"}),list:dP({method:"GET",fullPath:"/v1/credit_notes",methodType:"list"}),listLineItems:dP({method:"GET",fullPath:"/v1/credit_notes/{credit_note}/lines",methodType:"list"}),listPreviewLineItems:dP({method:"GET",fullPath:"/v1/credit_notes/preview/lines",methodType:"list"}),preview:dP({method:"GET",fullPath:"/v1/credit_notes/preview"}),voidCreditNote:dP({method:"POST",fullPath:"/v1/credit_notes/{id}/void"})}),dR=a3.method,dS=a3.extend({create:dR({method:"POST",fullPath:"/v1/customer_sessions"})}),dT=a3.method,dU=a3.extend({create:dT({method:"POST",fullPath:"/v1/customers"}),retrieve:dT({method:"GET",fullPath:"/v1/customers/{customer}"}),update:dT({method:"POST",fullPath:"/v1/customers/{customer}"}),list:dT({method:"GET",fullPath:"/v1/customers",methodType:"list"}),del:dT({method:"DELETE",fullPath:"/v1/customers/{customer}"}),createBalanceTransaction:dT({method:"POST",fullPath:"/v1/customers/{customer}/balance_transactions"}),createFundingInstructions:dT({method:"POST",fullPath:"/v1/customers/{customer}/funding_instructions"}),createSource:dT({method:"POST",fullPath:"/v1/customers/{customer}/sources"}),createTaxId:dT({method:"POST",fullPath:"/v1/customers/{customer}/tax_ids"}),deleteDiscount:dT({method:"DELETE",fullPath:"/v1/customers/{customer}/discount"}),deleteSource:dT({method:"DELETE",fullPath:"/v1/customers/{customer}/sources/{id}"}),deleteTaxId:dT({method:"DELETE",fullPath:"/v1/customers/{customer}/tax_ids/{id}"}),listBalanceTransactions:dT({method:"GET",fullPath:"/v1/customers/{customer}/balance_transactions",methodType:"list"}),listCashBalanceTransactions:dT({method:"GET",fullPath:"/v1/customers/{customer}/cash_balance_transactions",methodType:"list"}),listPaymentMethods:dT({method:"GET",fullPath:"/v1/customers/{customer}/payment_methods",methodType:"list"}),listSources:dT({method:"GET",fullPath:"/v1/customers/{customer}/sources",methodType:"list"}),listTaxIds:dT({method:"GET",fullPath:"/v1/customers/{customer}/tax_ids",methodType:"list"}),retrieveBalanceTransaction:dT({method:"GET",fullPath:"/v1/customers/{customer}/balance_transactions/{transaction}"}),retrieveCashBalance:dT({method:"GET",fullPath:"/v1/customers/{customer}/cash_balance"}),retrieveCashBalanceTransaction:dT({method:"GET",fullPath:"/v1/customers/{customer}/cash_balance_transactions/{transaction}"}),retrievePaymentMethod:dT({method:"GET",fullPath:"/v1/customers/{customer}/payment_methods/{payment_method}"}),retrieveSource:dT({method:"GET",fullPath:"/v1/customers/{customer}/sources/{id}"}),retrieveTaxId:dT({method:"GET",fullPath:"/v1/customers/{customer}/tax_ids/{id}"}),search:dT({method:"GET",fullPath:"/v1/customers/search",methodType:"search"}),updateBalanceTransaction:dT({method:"POST",fullPath:"/v1/customers/{customer}/balance_transactions/{transaction}"}),updateCashBalance:dT({method:"POST",fullPath:"/v1/customers/{customer}/cash_balance"}),updateSource:dT({method:"POST",fullPath:"/v1/customers/{customer}/sources/{id}"}),verifySource:dT({method:"POST",fullPath:"/v1/customers/{customer}/sources/{id}/verify"})}),dV=a3.method,dW=a3.extend({retrieve:dV({method:"GET",fullPath:"/v1/disputes/{dispute}"}),update:dV({method:"POST",fullPath:"/v1/disputes/{dispute}"}),list:dV({method:"GET",fullPath:"/v1/disputes",methodType:"list"}),close:dV({method:"POST",fullPath:"/v1/disputes/{dispute}/close"})}),dX=a3.method,dY=a3.extend({create:dX({method:"POST",fullPath:"/v1/ephemeral_keys",validator:(a,b)=>{if(!b.headers||!b.headers["Stripe-Version"])throw Error("Passing apiVersion in a separate options hash is required to create an ephemeral key. See https://stripe.com/docs/api/versioning?lang=node")}}),del:dX({method:"DELETE",fullPath:"/v1/ephemeral_keys/{key}"})}),dZ=a3.method,d$=a3.extend({retrieve:dZ({method:"GET",fullPath:"/v1/events/{id}"}),list:dZ({method:"GET",fullPath:"/v1/events",methodType:"list"})}),d_=a3.method,d0=a3.extend({retrieve:d_({method:"GET",fullPath:"/v1/exchange_rates/{rate_id}"}),list:d_({method:"GET",fullPath:"/v1/exchange_rates",methodType:"list"})}),d1=a3.method,d2=a3.extend({create:d1({method:"POST",fullPath:"/v1/file_links"}),retrieve:d1({method:"GET",fullPath:"/v1/file_links/{link}"}),update:d1({method:"POST",fullPath:"/v1/file_links/{link}"}),list:d1({method:"GET",fullPath:"/v1/file_links",methodType:"list"})}),d3=(a,b,c)=>{let d=(Math.round(1e16*Math.random())+Math.round(1e16*Math.random())).toString();c["Content-Type"]=`multipart/form-data; boundary=${d}`;let e=new TextEncoder,f=new Uint8Array(0),g=e.encode("\r\n");function h(a){let b=f,c=a instanceof Uint8Array?a:new Uint8Array(e.encode(a));(f=new Uint8Array(b.length+c.length+2)).set(b),f.set(c,b.length),f.set(g,f.length-2)}function i(a){return`"${a.replace(/"|"/g,"%22").replace(/\r\n|\r|\n/g," ")}"`}let j=aD(b);for(let a in j){if(!Object.prototype.hasOwnProperty.call(j,a))continue;let b=j[a];if(h(`--${d}`),Object.prototype.hasOwnProperty.call(b,"data")){let c=b;h(`Content-Disposition: form-data; name=${i(a)}; filename=${i(c.name||"blob")}`),h(`Content-Type: ${c.type||"application/octet-stream"}`),h(""),h(c.data)}else h(`Content-Disposition: form-data; name=${i(a)}`),h(""),h(b)}return h(`--${d}--`),f};function d4(a,b,c,d){if(b=b||{},"POST"!==a)return d(null,aq(b));this._stripe._platformFunctions.tryBufferData(b).then(b=>d(null,d3(a,b,c))).catch(a=>d(a,null))}let d5=a3.method,d6=a3.extend({create:d5({method:"POST",fullPath:"/v1/files",headers:{"Content-Type":"multipart/form-data"},host:"files.stripe.com"}),retrieve:d5({method:"GET",fullPath:"/v1/files/{file}"}),list:d5({method:"GET",fullPath:"/v1/files",methodType:"list"}),requestDataProcessor:d4}),d7=a3.method,d8=a3.extend({create:d7({method:"POST",fullPath:"/v1/invoiceitems"}),retrieve:d7({method:"GET",fullPath:"/v1/invoiceitems/{invoiceitem}"}),update:d7({method:"POST",fullPath:"/v1/invoiceitems/{invoiceitem}"}),list:d7({method:"GET",fullPath:"/v1/invoiceitems",methodType:"list"}),del:d7({method:"DELETE",fullPath:"/v1/invoiceitems/{invoiceitem}"})}),d9=a3.method,ea=a3.extend({retrieve:d9({method:"GET",fullPath:"/v1/invoice_rendering_templates/{template}"}),list:d9({method:"GET",fullPath:"/v1/invoice_rendering_templates",methodType:"list"}),archive:d9({method:"POST",fullPath:"/v1/invoice_rendering_templates/{template}/archive"}),unarchive:d9({method:"POST",fullPath:"/v1/invoice_rendering_templates/{template}/unarchive"})}),eb=a3.method,ec=a3.extend({create:eb({method:"POST",fullPath:"/v1/invoices"}),retrieve:eb({method:"GET",fullPath:"/v1/invoices/{invoice}"}),update:eb({method:"POST",fullPath:"/v1/invoices/{invoice}"}),list:eb({method:"GET",fullPath:"/v1/invoices",methodType:"list"}),del:eb({method:"DELETE",fullPath:"/v1/invoices/{invoice}"}),addLines:eb({method:"POST",fullPath:"/v1/invoices/{invoice}/add_lines"}),createPreview:eb({method:"POST",fullPath:"/v1/invoices/create_preview"}),finalizeInvoice:eb({method:"POST",fullPath:"/v1/invoices/{invoice}/finalize"}),listLineItems:eb({method:"GET",fullPath:"/v1/invoices/{invoice}/lines",methodType:"list"}),listUpcomingLines:eb({method:"GET",fullPath:"/v1/invoices/upcoming/lines",methodType:"list"}),markUncollectible:eb({method:"POST",fullPath:"/v1/invoices/{invoice}/mark_uncollectible"}),pay:eb({method:"POST",fullPath:"/v1/invoices/{invoice}/pay"}),removeLines:eb({method:"POST",fullPath:"/v1/invoices/{invoice}/remove_lines"}),retrieveUpcoming:eb({method:"GET",fullPath:"/v1/invoices/upcoming"}),search:eb({method:"GET",fullPath:"/v1/invoices/search",methodType:"search"}),sendInvoice:eb({method:"POST",fullPath:"/v1/invoices/{invoice}/send"}),updateLines:eb({method:"POST",fullPath:"/v1/invoices/{invoice}/update_lines"}),updateLineItem:eb({method:"POST",fullPath:"/v1/invoices/{invoice}/lines/{line_item_id}"}),voidInvoice:eb({method:"POST",fullPath:"/v1/invoices/{invoice}/void"})}),ed=a3.method,ee=a3.extend({retrieve:ed({method:"GET",fullPath:"/v1/mandates/{mandate}"})}),ef=a3.method,eg="connect.stripe.com",eh=a3.extend({basePath:"/",authorizeUrl(a,b){a=a||{};let c="oauth/authorize";return(b=b||{}).express&&(c=`express/${c}`),a.response_type||(a.response_type="code"),a.client_id||(a.client_id=this._stripe.getClientId()),a.scope||(a.scope="read_write"),`https://${eg}/${c}?${aq(a)}`},token:ef({method:"POST",path:"oauth/token",host:eg}),deauthorize(a,...b){return a.client_id||(a.client_id=this._stripe.getClientId()),ef({method:"POST",path:"oauth/deauthorize",host:eg}).apply(this,[a,...b])}}),ei=a3.method,ej=a3.extend({create:ei({method:"POST",fullPath:"/v1/payment_intents"}),retrieve:ei({method:"GET",fullPath:"/v1/payment_intents/{intent}"}),update:ei({method:"POST",fullPath:"/v1/payment_intents/{intent}"}),list:ei({method:"GET",fullPath:"/v1/payment_intents",methodType:"list"}),applyCustomerBalance:ei({method:"POST",fullPath:"/v1/payment_intents/{intent}/apply_customer_balance"}),cancel:ei({method:"POST",fullPath:"/v1/payment_intents/{intent}/cancel"}),capture:ei({method:"POST",fullPath:"/v1/payment_intents/{intent}/capture"}),confirm:ei({method:"POST",fullPath:"/v1/payment_intents/{intent}/confirm"}),incrementAuthorization:ei({method:"POST",fullPath:"/v1/payment_intents/{intent}/increment_authorization"}),search:ei({method:"GET",fullPath:"/v1/payment_intents/search",methodType:"search"}),verifyMicrodeposits:ei({method:"POST",fullPath:"/v1/payment_intents/{intent}/verify_microdeposits"})}),ek=a3.method,el=a3.extend({create:ek({method:"POST",fullPath:"/v1/payment_links"}),retrieve:ek({method:"GET",fullPath:"/v1/payment_links/{payment_link}"}),update:ek({method:"POST",fullPath:"/v1/payment_links/{payment_link}"}),list:ek({method:"GET",fullPath:"/v1/payment_links",methodType:"list"}),listLineItems:ek({method:"GET",fullPath:"/v1/payment_links/{payment_link}/line_items",methodType:"list"})}),em=a3.method,en=a3.extend({create:em({method:"POST",fullPath:"/v1/payment_method_configurations"}),retrieve:em({method:"GET",fullPath:"/v1/payment_method_configurations/{configuration}"}),update:em({method:"POST",fullPath:"/v1/payment_method_configurations/{configuration}"}),list:em({method:"GET",fullPath:"/v1/payment_method_configurations",methodType:"list"})}),eo=a3.method,ep=a3.extend({create:eo({method:"POST",fullPath:"/v1/payment_method_domains"}),retrieve:eo({method:"GET",fullPath:"/v1/payment_method_domains/{payment_method_domain}"}),update:eo({method:"POST",fullPath:"/v1/payment_method_domains/{payment_method_domain}"}),list:eo({method:"GET",fullPath:"/v1/payment_method_domains",methodType:"list"}),validate:eo({method:"POST",fullPath:"/v1/payment_method_domains/{payment_method_domain}/validate"})}),eq=a3.method,er=a3.extend({create:eq({method:"POST",fullPath:"/v1/payment_methods"}),retrieve:eq({method:"GET",fullPath:"/v1/payment_methods/{payment_method}"}),update:eq({method:"POST",fullPath:"/v1/payment_methods/{payment_method}"}),list:eq({method:"GET",fullPath:"/v1/payment_methods",methodType:"list"}),attach:eq({method:"POST",fullPath:"/v1/payment_methods/{payment_method}/attach"}),detach:eq({method:"POST",fullPath:"/v1/payment_methods/{payment_method}/detach"})}),es=a3.method,et=a3.extend({create:es({method:"POST",fullPath:"/v1/payouts"}),retrieve:es({method:"GET",fullPath:"/v1/payouts/{payout}"}),update:es({method:"POST",fullPath:"/v1/payouts/{payout}"}),list:es({method:"GET",fullPath:"/v1/payouts",methodType:"list"}),cancel:es({method:"POST",fullPath:"/v1/payouts/{payout}/cancel"}),reverse:es({method:"POST",fullPath:"/v1/payouts/{payout}/reverse"})}),eu=a3.method,ev=a3.extend({create:eu({method:"POST",fullPath:"/v1/plans"}),retrieve:eu({method:"GET",fullPath:"/v1/plans/{plan}"}),update:eu({method:"POST",fullPath:"/v1/plans/{plan}"}),list:eu({method:"GET",fullPath:"/v1/plans",methodType:"list"}),del:eu({method:"DELETE",fullPath:"/v1/plans/{plan}"})}),ew=a3.method,ex=a3.extend({create:ew({method:"POST",fullPath:"/v1/prices"}),retrieve:ew({method:"GET",fullPath:"/v1/prices/{price}"}),update:ew({method:"POST",fullPath:"/v1/prices/{price}"}),list:ew({method:"GET",fullPath:"/v1/prices",methodType:"list"}),search:ew({method:"GET",fullPath:"/v1/prices/search",methodType:"search"})}),ey=a3.method,ez=a3.extend({create:ey({method:"POST",fullPath:"/v1/products"}),retrieve:ey({method:"GET",fullPath:"/v1/products/{id}"}),update:ey({method:"POST",fullPath:"/v1/products/{id}"}),list:ey({method:"GET",fullPath:"/v1/products",methodType:"list"}),del:ey({method:"DELETE",fullPath:"/v1/products/{id}"}),createFeature:ey({method:"POST",fullPath:"/v1/products/{product}/features"}),deleteFeature:ey({method:"DELETE",fullPath:"/v1/products/{product}/features/{id}"}),listFeatures:ey({method:"GET",fullPath:"/v1/products/{product}/features",methodType:"list"}),retrieveFeature:ey({method:"GET",fullPath:"/v1/products/{product}/features/{id}"}),search:ey({method:"GET",fullPath:"/v1/products/search",methodType:"search"})}),eA=a3.method,eB=a3.extend({create:eA({method:"POST",fullPath:"/v1/promotion_codes"}),retrieve:eA({method:"GET",fullPath:"/v1/promotion_codes/{promotion_code}"}),update:eA({method:"POST",fullPath:"/v1/promotion_codes/{promotion_code}"}),list:eA({method:"GET",fullPath:"/v1/promotion_codes",methodType:"list"})}),eC=a3.method,eD=a3.extend({create:eC({method:"POST",fullPath:"/v1/quotes"}),retrieve:eC({method:"GET",fullPath:"/v1/quotes/{quote}"}),update:eC({method:"POST",fullPath:"/v1/quotes/{quote}"}),list:eC({method:"GET",fullPath:"/v1/quotes",methodType:"list"}),accept:eC({method:"POST",fullPath:"/v1/quotes/{quote}/accept"}),cancel:eC({method:"POST",fullPath:"/v1/quotes/{quote}/cancel"}),finalizeQuote:eC({method:"POST",fullPath:"/v1/quotes/{quote}/finalize"}),listComputedUpfrontLineItems:eC({method:"GET",fullPath:"/v1/quotes/{quote}/computed_upfront_line_items",methodType:"list"}),listLineItems:eC({method:"GET",fullPath:"/v1/quotes/{quote}/line_items",methodType:"list"}),pdf:eC({method:"GET",fullPath:"/v1/quotes/{quote}/pdf",host:"files.stripe.com",streaming:!0})}),eE=a3.method,eF=a3.extend({create:eE({method:"POST",fullPath:"/v1/refunds"}),retrieve:eE({method:"GET",fullPath:"/v1/refunds/{refund}"}),update:eE({method:"POST",fullPath:"/v1/refunds/{refund}"}),list:eE({method:"GET",fullPath:"/v1/refunds",methodType:"list"}),cancel:eE({method:"POST",fullPath:"/v1/refunds/{refund}/cancel"})}),eG=a3.method,eH=a3.extend({retrieve:eG({method:"GET",fullPath:"/v1/reviews/{review}"}),list:eG({method:"GET",fullPath:"/v1/reviews",methodType:"list"}),approve:eG({method:"POST",fullPath:"/v1/reviews/{review}/approve"})}),eI=a3.method,eJ=a3.extend({list:eI({method:"GET",fullPath:"/v1/setup_attempts",methodType:"list"})}),eK=a3.method,eL=a3.extend({create:eK({method:"POST",fullPath:"/v1/setup_intents"}),retrieve:eK({method:"GET",fullPath:"/v1/setup_intents/{intent}"}),update:eK({method:"POST",fullPath:"/v1/setup_intents/{intent}"}),list:eK({method:"GET",fullPath:"/v1/setup_intents",methodType:"list"}),cancel:eK({method:"POST",fullPath:"/v1/setup_intents/{intent}/cancel"}),confirm:eK({method:"POST",fullPath:"/v1/setup_intents/{intent}/confirm"}),verifyMicrodeposits:eK({method:"POST",fullPath:"/v1/setup_intents/{intent}/verify_microdeposits"})}),eM=a3.method,eN=a3.extend({create:eM({method:"POST",fullPath:"/v1/shipping_rates"}),retrieve:eM({method:"GET",fullPath:"/v1/shipping_rates/{shipping_rate_token}"}),update:eM({method:"POST",fullPath:"/v1/shipping_rates/{shipping_rate_token}"}),list:eM({method:"GET",fullPath:"/v1/shipping_rates",methodType:"list"})}),eO=a3.method,eP=a3.extend({create:eO({method:"POST",fullPath:"/v1/sources"}),retrieve:eO({method:"GET",fullPath:"/v1/sources/{source}"}),update:eO({method:"POST",fullPath:"/v1/sources/{source}"}),listSourceTransactions:eO({method:"GET",fullPath:"/v1/sources/{source}/source_transactions",methodType:"list"}),verify:eO({method:"POST",fullPath:"/v1/sources/{source}/verify"})}),eQ=a3.method,eR=a3.extend({create:eQ({method:"POST",fullPath:"/v1/subscription_items"}),retrieve:eQ({method:"GET",fullPath:"/v1/subscription_items/{item}"}),update:eQ({method:"POST",fullPath:"/v1/subscription_items/{item}"}),list:eQ({method:"GET",fullPath:"/v1/subscription_items",methodType:"list"}),del:eQ({method:"DELETE",fullPath:"/v1/subscription_items/{item}"}),createUsageRecord:eQ({method:"POST",fullPath:"/v1/subscription_items/{subscription_item}/usage_records"}),listUsageRecordSummaries:eQ({method:"GET",fullPath:"/v1/subscription_items/{subscription_item}/usage_record_summaries",methodType:"list"})}),eS=a3.method,eT=a3.extend({create:eS({method:"POST",fullPath:"/v1/subscription_schedules"}),retrieve:eS({method:"GET",fullPath:"/v1/subscription_schedules/{schedule}"}),update:eS({method:"POST",fullPath:"/v1/subscription_schedules/{schedule}"}),list:eS({method:"GET",fullPath:"/v1/subscription_schedules",methodType:"list"}),cancel:eS({method:"POST",fullPath:"/v1/subscription_schedules/{schedule}/cancel"}),release:eS({method:"POST",fullPath:"/v1/subscription_schedules/{schedule}/release"})}),eU=a3.method,eV=a3.extend({create:eU({method:"POST",fullPath:"/v1/subscriptions"}),retrieve:eU({method:"GET",fullPath:"/v1/subscriptions/{subscription_exposed_id}"}),update:eU({method:"POST",fullPath:"/v1/subscriptions/{subscription_exposed_id}"}),list:eU({method:"GET",fullPath:"/v1/subscriptions",methodType:"list"}),cancel:eU({method:"DELETE",fullPath:"/v1/subscriptions/{subscription_exposed_id}"}),deleteDiscount:eU({method:"DELETE",fullPath:"/v1/subscriptions/{subscription_exposed_id}/discount"}),resume:eU({method:"POST",fullPath:"/v1/subscriptions/{subscription}/resume"}),search:eU({method:"GET",fullPath:"/v1/subscriptions/search",methodType:"search"})}),eW=a3.method,eX=a3.extend({retrieve:eW({method:"GET",fullPath:"/v1/tax_codes/{id}"}),list:eW({method:"GET",fullPath:"/v1/tax_codes",methodType:"list"})}),eY=a3.method,eZ=a3.extend({create:eY({method:"POST",fullPath:"/v1/tax_ids"}),retrieve:eY({method:"GET",fullPath:"/v1/tax_ids/{id}"}),list:eY({method:"GET",fullPath:"/v1/tax_ids",methodType:"list"}),del:eY({method:"DELETE",fullPath:"/v1/tax_ids/{id}"})}),e$=a3.method,e_=a3.extend({create:e$({method:"POST",fullPath:"/v1/tax_rates"}),retrieve:e$({method:"GET",fullPath:"/v1/tax_rates/{tax_rate}"}),update:e$({method:"POST",fullPath:"/v1/tax_rates/{tax_rate}"}),list:e$({method:"GET",fullPath:"/v1/tax_rates",methodType:"list"})}),e0=a3.method,e1=a3.extend({create:e0({method:"POST",fullPath:"/v1/tokens"}),retrieve:e0({method:"GET",fullPath:"/v1/tokens/{token}"})}),e2=a3.method,e3=a3.extend({create:e2({method:"POST",fullPath:"/v1/topups"}),retrieve:e2({method:"GET",fullPath:"/v1/topups/{topup}"}),update:e2({method:"POST",fullPath:"/v1/topups/{topup}"}),list:e2({method:"GET",fullPath:"/v1/topups",methodType:"list"}),cancel:e2({method:"POST",fullPath:"/v1/topups/{topup}/cancel"})}),e4=a3.method,e5=a3.extend({create:e4({method:"POST",fullPath:"/v1/transfers"}),retrieve:e4({method:"GET",fullPath:"/v1/transfers/{transfer}"}),update:e4({method:"POST",fullPath:"/v1/transfers/{transfer}"}),list:e4({method:"GET",fullPath:"/v1/transfers",methodType:"list"}),createReversal:e4({method:"POST",fullPath:"/v1/transfers/{id}/reversals"}),listReversals:e4({method:"GET",fullPath:"/v1/transfers/{id}/reversals",methodType:"list"}),retrieveReversal:e4({method:"GET",fullPath:"/v1/transfers/{transfer}/reversals/{id}"}),updateReversal:e4({method:"POST",fullPath:"/v1/transfers/{transfer}/reversals/{id}"})}),e6=a3.method,e7=a3.extend({create:e6({method:"POST",fullPath:"/v1/webhook_endpoints"}),retrieve:e6({method:"GET",fullPath:"/v1/webhook_endpoints/{webhook_endpoint}"}),update:e6({method:"POST",fullPath:"/v1/webhook_endpoints/{webhook_endpoint}"}),list:e6({method:"GET",fullPath:"/v1/webhook_endpoints",methodType:"list"}),del:e6({method:"DELETE",fullPath:"/v1/webhook_endpoints/{webhook_endpoint}"})}),e8=a7("apps",{Secrets:cV}),e9=a7("billing",{Alerts:bd,CreditBalanceSummary:bz,CreditBalanceTransactions:bB,CreditGrants:bD,MeterEventAdjustments:b1,MeterEvents:b9,Meters:cd}),fa=a7("billingPortal",{Configurations:br,Sessions:cX}),fb=a7("checkout",{Sessions:cZ}),fc=a7("climate",{Orders:cf,Products:cv,Suppliers:c3}),fd=a7("entitlements",{ActiveEntitlements:bb,Features:bT}),fe=a7("financialConnections",{Accounts:a9,Sessions:c_,Transactions:dd}),ff=a7("forwarding",{Requests:cR}),fg=a7("identity",{VerificationReports:dq,VerificationSessions:ds}),fh=a7("issuing",{Authorizations:bh,Cardholders:bl,Cards:bp,Disputes:bL,PersonalizationDesigns:cr,PhysicalBundles:ct,Tokens:c7,Transactions:df}),fi=a7("radar",{EarlyFraudWarnings:bN,ValueListItems:dl,ValueLists:dn}),fj=a7("reporting",{ReportRuns:cN,ReportTypes:cP}),fk=a7("sigma",{ScheduledQueryRuns:cT}),fl=a7("tax",{Calculations:bj,Registrations:cL,Settings:c1,Transactions:dh}),fm=a7("terminal",{Configurations:bt,ConnectionTokens:bx,Locations:b_,Readers:cz}),fn=a7("testHelpers",{ConfirmationTokens:bv,Customers:bH,Refunds:cJ,TestClocks:c5,Issuing:a7("issuing",{Authorizations:bf,Cards:bn,PersonalizationDesigns:cp,Transactions:db}),Terminal:a7("terminal",{Readers:cx}),Treasury:a7("treasury",{InboundTransfers:bX,OutboundPayments:ch,OutboundTransfers:cl,ReceivedCredits:cB,ReceivedDebits:cF})}),fo=a7("treasury",{CreditReversals:bF,DebitReversals:bJ,FinancialAccounts:bV,InboundTransfers:bZ,OutboundPayments:cj,OutboundTransfers:cn,ReceivedCredits:cD,ReceivedDebits:cH,TransactionEntries:c9,Transactions:dj}),fp=a7("v2",{Billing:a7("billing",{MeterEventAdjustments:b3,MeterEventSession:b5,MeterEventStream:b7,MeterEvents:cb}),Core:a7("core",{EventDestinations:bP,Events:bR})}),fq="api.stripe.com",fr="443",fs="/v1/",ft=a5,fu=8e4,fv=5,fw=.5,fx=["name","version","url","partner_id"],fy=["authenticator","apiVersion","typescript","maxNetworkRetries","httpAgent","httpClient","timeout","host","port","protocol","telemetry","appInfo","stripeAccount","stripeContext"],fz=a=>new aP(a,a3.MAX_BUFFERED_REQUEST_METRICS),fA=function(a,b=fz){function c(b=a){return a4(b)}function d(e,f={}){if(!(this instanceof d))return new d(e,f);let g=this._getPropsFromConfig(f);this._platformFunctions=a,Object.defineProperty(this,"_emitter",{value:this._platformFunctions.createEmitter(),enumerable:!1,configurable:!1,writable:!1}),this.VERSION=d.PACKAGE_VERSION,this.on=this._emitter.on.bind(this._emitter),this.once=this._emitter.once.bind(this._emitter),this.off=this._emitter.removeListener.bind(this._emitter);let h=g.httpAgent||null;this._api={host:g.host||fq,port:g.port||fr,protocol:g.protocol||"https",basePath:fs,version:g.apiVersion||ft,timeout:aE("timeout",g.timeout,fu),maxNetworkRetries:aE("maxNetworkRetries",g.maxNetworkRetries,2),agent:h,httpClient:g.httpClient||(h?this._platformFunctions.createNodeHttpClient(h):this._platformFunctions.createDefaultHttpClient()),dev:!1,stripeAccount:g.stripeAccount||null,stripeContext:g.stripeContext||null};let i=g.typescript||!1;i!==d.USER_AGENT.typescript&&(d.USER_AGENT.typescript=i),g.appInfo&&this._setAppInfo(g.appInfo),this._prepResources(),this._setAuthenticator(e,g.authenticator),this.errors=k,this.webhooks=c(),this._prevRequestMetrics=[],this._enableTelemetry=!1!==g.telemetry,this._requestSender=b(this),this.StripeResource=d.StripeResource}return d.PACKAGE_VERSION="17.7.0",d.USER_AGENT=Object.assign({bindings_version:d.PACKAGE_VERSION,lang:"node",publisher:"stripe",uname:null,typescript:!1},aF()),d.StripeResource=a3,d.resources=l,d.HttpClient=N,d.HttpClientResponse=O,d.CryptoProvider=G,d.webhooks=Object.assign(c,a4(a)),d.errors=k,d.createNodeHttpClient=a.createNodeHttpClient,d.createFetchHttpClient=a.createFetchHttpClient,d.createNodeCryptoProvider=a.createNodeCryptoProvider,d.createSubtleCryptoProvider=a.createSubtleCryptoProvider,d.prototype={_appInfo:void 0,on:null,off:null,once:null,VERSION:null,StripeResource:null,webhooks:null,errors:null,_api:null,_prevRequestMetrics:null,_emitter:null,_enableTelemetry:null,_requestSender:null,_platformFunctions:null,rawRequest(a,b,c,d){return this._requestSender._rawRequest(a,b,c,d)},_setAuthenticator(a,b){if(a&&b)throw Error("Can't specify both apiKey and authenticator");if(!a&&!b)throw Error("Neither apiKey nor config.authenticator provided");this._authenticator=a?aG(a):b},_setAppInfo(a){if(a&&"object"!=typeof a)throw Error("AppInfo must be an object.");if(a&&!a.name)throw Error("AppInfo.name is required");a=a||{},this._appInfo=fx.reduce((b,c)=>("string"==typeof a[c]&&((b=b||{})[c]=a[c]),b),void 0)},_setApiField(a,b){this._api[a]=b},getApiField(a){return this._api[a]},setClientId(a){this._clientId=a},getClientId(){return this._clientId},getConstant:a=>{switch(a){case"DEFAULT_HOST":return fq;case"DEFAULT_PORT":return fr;case"DEFAULT_BASE_PATH":return fs;case"DEFAULT_API_VERSION":return ft;case"DEFAULT_TIMEOUT":return fu;case"MAX_NETWORK_RETRY_DELAY_SEC":return fv;case"INITIAL_NETWORK_RETRY_DELAY_SEC":return fw}return d[a]},getMaxNetworkRetries(){return this.getApiField("maxNetworkRetries")},_setApiNumberField(a,b,c){let d=aE(a,b,c);this._setApiField(a,d)},getMaxNetworkRetryDelay:()=>fv,getInitialNetworkRetryDelay:()=>fw,getClientUserAgent(a){return this.getClientUserAgentSeeded(d.USER_AGENT,a)},getClientUserAgentSeeded(a,b){this._platformFunctions.getUname().then(c=>{var d;let e={};for(let b in a)Object.prototype.hasOwnProperty.call(a,b)&&(e[b]=encodeURIComponent(null!=(d=a[b])?d:"null"));e.uname=encodeURIComponent(c||"UNKNOWN");let f=this.getApiField("httpClient");f&&(e.httplib=encodeURIComponent(f.getClientName())),this._appInfo&&(e.application=this._appInfo),b(JSON.stringify(e))})},getAppInfoAsString(){if(!this._appInfo)return"";let a=this._appInfo.name;return this._appInfo.version&&(a+=`/${this._appInfo.version}`),this._appInfo.url&&(a+=` (${this._appInfo.url})`),a},getTelemetryEnabled(){return this._enableTelemetry},_prepResources(){for(let a in l)Object.prototype.hasOwnProperty.call(l,a)&&(this[aA(a)]=new l[a](this))},_getPropsFromConfig(a){if(!a)return{};let b="string"==typeof a;if(!(a===Object(a)&&!Array.isArray(a))&&!b)throw Error("Config must either be an object or a string");if(b)return{apiVersion:a};if(Object.keys(a).filter(a=>!fy.includes(a)).length>0)throw Error(`Config object may only contain the following: ${fy.join(", ")}`);return a},parseThinEvent(a,b,c,d,e,f){return this.webhooks.constructEvent(a,b,c,d,e,f)}},d}(new aN),fB=()=>void 0,fC={NODE_CLIENT:!1,SDK_VERSION:"${JSCORE_VERSION}"},fD=function(a){return Error("Firebase Database ("+fC.SDK_VERSION+") INTERNAL ASSERT FAILED: "+a)},fE=function(a){let b=[],c=0;for(let d=0;d<a.length;d++){let e=a.charCodeAt(d);e<128?b[c++]=e:(e<2048?b[c++]=e>>6|192:((64512&e)==55296&&d+1<a.length&&(64512&a.charCodeAt(d+1))==56320?(e=65536+((1023&e)<<10)+(1023&a.charCodeAt(++d)),b[c++]=e>>18|240,b[c++]=e>>12&63|128):b[c++]=e>>12|224,b[c++]=e>>6&63|128),b[c++]=63&e|128)}return b},fF=function(a){let b=[],c=0,d=0;for(;c<a.length;){let e=a[c++];if(e<128)b[d++]=String.fromCharCode(e);else if(e>191&&e<224){let f=a[c++];b[d++]=String.fromCharCode((31&e)<<6|63&f)}else if(e>239&&e<365){let f=a[c++],g=((7&e)<<18|(63&f)<<12|(63&a[c++])<<6|63&a[c++])-65536;b[d++]=String.fromCharCode(55296+(g>>10)),b[d++]=String.fromCharCode(56320+(1023&g))}else{let f=a[c++],g=a[c++];b[d++]=String.fromCharCode((15&e)<<12|(63&f)<<6|63&g)}}return b.join("")},fG={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(a,b){if(!Array.isArray(a))throw Error("encodeByteArray takes an array as a parameter");this.init_();let c=b?this.byteToCharMapWebSafe_:this.byteToCharMap_,d=[];for(let b=0;b<a.length;b+=3){let e=a[b],f=b+1<a.length,g=f?a[b+1]:0,h=b+2<a.length,i=h?a[b+2]:0,j=e>>2,k=(3&e)<<4|g>>4,l=(15&g)<<2|i>>6,m=63&i;!h&&(m=64,f||(l=64)),d.push(c[j],c[k],c[l],c[m])}return d.join("")},encodeString(a,b){return this.HAS_NATIVE_SUPPORT&&!b?btoa(a):this.encodeByteArray(fE(a),b)},decodeString(a,b){return this.HAS_NATIVE_SUPPORT&&!b?atob(a):fF(this.decodeStringToByteArray(a,b))},decodeStringToByteArray(a,b){this.init_();let c=b?this.charToByteMapWebSafe_:this.charToByteMap_,d=[];for(let b=0;b<a.length;){let e=c[a.charAt(b++)],f=b<a.length?c[a.charAt(b)]:0,g=++b<a.length?c[a.charAt(b)]:64,h=++b<a.length?c[a.charAt(b)]:64;if(++b,null==e||null==f||null==g||null==h)throw new fH;let i=e<<2|f>>4;if(d.push(i),64!==g){let a=f<<4&240|g>>2;if(d.push(a),64!==h){let a=g<<6&192|h;d.push(a)}}}return d},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let a=0;a<this.ENCODED_VALS.length;a++)this.byteToCharMap_[a]=this.ENCODED_VALS.charAt(a),this.charToByteMap_[this.byteToCharMap_[a]]=a,this.byteToCharMapWebSafe_[a]=this.ENCODED_VALS_WEBSAFE.charAt(a),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[a]]=a,a>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(a)]=a,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(a)]=a)}}};class fH extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let fI=function(a){let b=fE(a);return fG.encodeByteArray(b,!0)},fJ=function(a){return fI(a).replace(/\./g,"")},fK=function(a){try{return fG.decodeString(a,!0)}catch(a){console.error("base64Decode failed: ",a)}return null};function fL(a){return"__proto__"!==a}function fM(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("Unable to locate global object.")}let fN=()=>fM().__FIREBASE_DEFAULTS__,fO=()=>{if("undefined"==typeof process||void 0===process.env)return;let a=process.env.__FIREBASE_DEFAULTS__;if(a)return JSON.parse(a)},fP=()=>{let a;if("undefined"==typeof document)return;try{a=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(a){return}let b=a&&fK(a[1]);return b&&JSON.parse(b)},fQ=()=>{try{return fB()||fN()||fO()||fP()}catch(a){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${a}`);return}},fR=a=>{var b,c;return null==(c=null==(b=fQ())?void 0:b.emulatorHosts)?void 0:c[a]},fS=a=>{let b=fR(a);if(!b)return;let c=b.lastIndexOf(":");if(c<=0||c+1===b.length)throw Error(`Invalid host ${b} with no separate hostname and port!`);let d=parseInt(b.substring(c+1),10);return"["===b[0]?[b.substring(1,c-1),d]:[b.substring(0,c),d]},fT=()=>{var a;return null==(a=fQ())?void 0:a.config};class fU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((a,b)=>{this.resolve=a,this.reject=b})}wrapCallback(a){return(b,c)=>{b?this.reject(b):this.resolve(c),"function"==typeof a&&(this.promise.catch(()=>{}),1===a.length?a(b):a(b,c))}}}function fV(a){try{return(a.startsWith("http://")||a.startsWith("https://")?new URL(a).hostname:a).endsWith(".cloudworkstations.dev")}catch(a){return!1}}async function fW(a){return(await fetch(a,{credentials:"include"})).ok}function fX(a,b){if(a.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let c={alg:"none",type:"JWT"},d=b||"demo-project",e=a.iat||0,f=a.sub||a.user_id;if(!f)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let g=Object.assign({iss:`https://securetoken.google.com/${d}`,aud:d,iat:e,exp:e+3600,auth_time:e,sub:f,user_id:f,firebase:{sign_in_provider:"custom",identities:{}}},a),h="";return[fJ(JSON.stringify(c)),fJ(JSON.stringify(g)),h].join(".")}let fY={};function fZ(){let a={prod:[],emulator:[]};for(let b of Object.keys(fY))fY[b]?a.emulator.push(b):a.prod.push(b);return a}function f$(a){let b=document.getElementById(a),c=!1;return b||((b=document.createElement("div")).setAttribute("id",a),c=!0),{created:c,element:b}}let f_=!1;function f0(a,b){if("undefined"==typeof window||"undefined"==typeof document||!fV(window.location.host)||fY[a]===b||fY[a]||f_)return;function c(a){return`__firebase__banner__${a}`}fY[a]=b;let d="__firebase__banner",e=fZ().prod.length>0;function f(){let a=document.getElementById(d);a&&a.remove()}function g(a){a.style.display="flex",a.style.background="#7faaf0",a.style.position="fixed",a.style.bottom="5px",a.style.left="5px",a.style.padding=".5em",a.style.borderRadius="5px",a.style.alignItems="center"}function h(a,b){a.setAttribute("width","24"),a.setAttribute("id",b),a.setAttribute("height","24"),a.setAttribute("viewBox","0 0 24 24"),a.setAttribute("fill","none"),a.style.marginLeft="-6px"}function i(){let a=document.createElement("span");return a.style.cursor="pointer",a.style.marginLeft="16px",a.style.fontSize="24px",a.innerHTML=" &times;",a.onclick=()=>{f_=!0,f()},a}function j(a,b){a.setAttribute("id",b),a.innerText="Learn more",a.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",a.setAttribute("target","__blank"),a.style.paddingLeft="5px",a.style.textDecoration="underline"}function k(){let a=f$(d),b=c("text"),f=document.getElementById(b)||document.createElement("span"),k=c("learnmore"),l=document.getElementById(k)||document.createElement("a"),m=c("preprendIcon"),n=document.getElementById(m)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(a.created){let b=a.element;g(b),j(l,k);let c=i();h(n,m),b.append(n,f,l,c),document.body.appendChild(b)}e?(f.innerText="Preview backend disconnected.",n.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(n.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,f.innerText="Preview backend running in this workspace."),f.setAttribute("id",b)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",k):k()}function f1(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function f2(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f1())}function f3(){var a;let b=null==(a=fQ())?void 0:a.forceEnvironment;if("node"===b)return!0;if("browser"===b)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(a){return!1}}function f4(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function f5(){let a="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof a&&void 0!==a.id}function f6(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function f7(){return!f3()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function f8(){return!f3()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function f9(){try{return"object"==typeof indexedDB}catch(a){return!1}}function ga(){return new Promise((a,b)=>{try{let c=!0,d="validate-browser-context-for-indexeddb-analytics-module",e=self.indexedDB.open(d);e.onsuccess=()=>{e.result.close(),c||self.indexedDB.deleteDatabase(d),a(!0)},e.onupgradeneeded=()=>{c=!1},e.onerror=()=>{var a;b((null==(a=e.error)?void 0:a.message)||"")}}catch(a){b(a)}})}let gb="FirebaseError";class gc extends Error{constructor(a,b,c){super(b),this.code=a,this.customData=c,this.name=gb,Object.setPrototypeOf(this,gc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gd.prototype.create)}}class gd{constructor(a,b,c){this.service=a,this.serviceName=b,this.errors=c}create(a,...b){let c=b[0]||{},d=`${this.service}/${a}`,e=this.errors[a],f=e?ge(e,c):"Error",g=`${this.serviceName}: ${f} (${d}).`;return new gc(d,g,c)}}function ge(a,b){return a.replace(gf,(a,c)=>{let d=b[c];return null!=d?String(d):`<${c}?>`})}let gf=/\{\$([^}]+)}/g;function gg(a){return JSON.parse(a)}function gh(a,b){if(a===b)return!0;let c=Object.keys(a),d=Object.keys(b);for(let e of c){if(!d.includes(e))return!1;let c=a[e],f=b[e];if(gi(c)&&gi(f)){if(!gh(c,f))return!1}else if(c!==f)return!1}for(let a of d)if(!c.includes(a))return!1;return!0}function gi(a){return null!==a&&"object"==typeof a}function gj(a){let b=[];for(let[c,d]of Object.entries(a))Array.isArray(d)?d.forEach(a=>{b.push(encodeURIComponent(c)+"="+encodeURIComponent(a))}):b.push(encodeURIComponent(c)+"="+encodeURIComponent(d));return b.length?"&"+b.join("&"):""}function gk(a){let b={};return a.replace(/^\?/,"").split("&").forEach(a=>{if(a){let[c,d]=a.split("=");b[decodeURIComponent(c)]=decodeURIComponent(d)}}),b}function gl(a){let b=a.indexOf("?");if(!b)return"";let c=a.indexOf("#",b);return a.substring(b,c>0?c:void 0)}function gm(a,b){let c=new gn(a,b);return c.subscribe.bind(c)}class gn{constructor(a,b){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=b,this.task.then(()=>{a(this)}).catch(a=>{this.error(a)})}next(a){this.forEachObserver(b=>{b.next(a)})}error(a){this.forEachObserver(b=>{b.error(a)}),this.close(a)}complete(){this.forEachObserver(a=>{a.complete()}),this.close()}subscribe(a,b,c){let d;if(void 0===a&&void 0===b&&void 0===c)throw Error("Missing Observer.");void 0===(d=go(a,["next","error","complete"])?a:{next:a,error:b,complete:c}).next&&(d.next=gp),void 0===d.error&&(d.error=gp),void 0===d.complete&&(d.complete=gp);let e=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?d.error(this.finalError):d.complete()}catch(a){}}),this.observers.push(d),e}unsubscribeOne(a){void 0!==this.observers&&void 0!==this.observers[a]&&(delete this.observers[a],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(a){if(!this.finalized)for(let b=0;b<this.observers.length;b++)this.sendOne(b,a)}sendOne(a,b){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[a])try{b(this.observers[a])}catch(a){"undefined"!=typeof console&&console.error&&console.error(a)}})}close(a){this.finalized||(this.finalized=!0,void 0!==a&&(this.finalError=a),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function go(a,b){if("object"!=typeof a||null===a)return!1;for(let c of b)if(c in a&&"function"==typeof a[c])return!0;return!1}function gp(){}function gq(a){return a&&a._delegate?a._delegate:a}fC.NODE_CLIENT=!0;class gr{constructor(a,b,c){this.name=a,this.instanceFactory=b,this.type=c,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(a){return this.instantiationMode=a,this}setMultipleInstances(a){return this.multipleInstances=a,this}setServiceProps(a){return this.serviceProps=a,this}setInstanceCreatedCallback(a){return this.onInstanceCreated=a,this}}let gs="[DEFAULT]";class gt{constructor(a,b){this.name=a,this.container=b,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(a){let b=this.normalizeInstanceIdentifier(a);if(!this.instancesDeferred.has(b)){let a=new fU;if(this.instancesDeferred.set(b,a),this.isInitialized(b)||this.shouldAutoInitialize())try{let c=this.getOrInitializeService({instanceIdentifier:b});c&&a.resolve(c)}catch(a){}}return this.instancesDeferred.get(b).promise}getImmediate(a){var b;let c=this.normalizeInstanceIdentifier(null==a?void 0:a.identifier),d=null!=(b=null==a?void 0:a.optional)&&b;if(this.isInitialized(c)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:c})}catch(a){if(d)return null;throw a}if(d)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(a){if(a.name!==this.name)throw Error(`Mismatching Component ${a.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=a,this.shouldAutoInitialize()){if(gv(a))try{this.getOrInitializeService({instanceIdentifier:gs})}catch(a){}for(let[a,b]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(a);try{let a=this.getOrInitializeService({instanceIdentifier:c});b.resolve(a)}catch(a){}}}}clearInstance(a=gs){this.instancesDeferred.delete(a),this.instancesOptions.delete(a),this.instances.delete(a)}async delete(){let a=Array.from(this.instances.values());await Promise.all([...a.filter(a=>"INTERNAL"in a).map(a=>a.INTERNAL.delete()),...a.filter(a=>"_delete"in a).map(a=>a._delete())])}isComponentSet(){return null!=this.component}isInitialized(a=gs){return this.instances.has(a)}getOptions(a=gs){return this.instancesOptions.get(a)||{}}initialize(a={}){let{options:b={}}=a,c=this.normalizeInstanceIdentifier(a.instanceIdentifier);if(this.isInitialized(c))throw Error(`${this.name}(${c}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let d=this.getOrInitializeService({instanceIdentifier:c,options:b});for(let[a,b]of this.instancesDeferred.entries())c===this.normalizeInstanceIdentifier(a)&&b.resolve(d);return d}onInit(a,b){var c;let d=this.normalizeInstanceIdentifier(b),e=null!=(c=this.onInitCallbacks.get(d))?c:new Set;e.add(a),this.onInitCallbacks.set(d,e);let f=this.instances.get(d);return f&&a(f,d),()=>{e.delete(a)}}invokeOnInitCallbacks(a,b){let c=this.onInitCallbacks.get(b);if(c)for(let d of c)try{d(a,b)}catch(a){}}getOrInitializeService({instanceIdentifier:a,options:b={}}){let c=this.instances.get(a);if(!c&&this.component&&(c=this.component.instanceFactory(this.container,{instanceIdentifier:gu(a),options:b}),this.instances.set(a,c),this.instancesOptions.set(a,b),this.invokeOnInitCallbacks(c,a),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,a,c)}catch(a){}return c||null}normalizeInstanceIdentifier(a=gs){return this.component?this.component.multipleInstances?a:gs:a}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function gu(a){return a===gs?void 0:a}function gv(a){return"EAGER"===a.instantiationMode}class gw{constructor(a){this.name=a,this.providers=new Map}addComponent(a){let b=this.getProvider(a.name);if(b.isComponentSet())throw Error(`Component ${a.name} has already been registered with ${this.name}`);b.setComponent(a)}addOrOverwriteComponent(a){this.getProvider(a.name).isComponentSet()&&this.providers.delete(a.name),this.addComponent(a)}getProvider(a){if(this.providers.has(a))return this.providers.get(a);let b=new gt(a,this);return this.providers.set(a,b),b}getProviders(){return Array.from(this.providers.values())}}let gx=[];!function(a){a[a.DEBUG=0]="DEBUG",a[a.VERBOSE=1]="VERBOSE",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.SILENT=5]="SILENT"}(f||(f={}));let gy={debug:f.DEBUG,verbose:f.VERBOSE,info:f.INFO,warn:f.WARN,error:f.ERROR,silent:f.SILENT},gz=f.INFO,gA={[f.DEBUG]:"log",[f.VERBOSE]:"log",[f.INFO]:"info",[f.WARN]:"warn",[f.ERROR]:"error"},gB=(a,b,...c)=>{if(b<a.logLevel)return;let d=new Date().toISOString(),e=gA[b];if(e)console[e](`[${d}]  ${a.name}:`,...c);else throw Error(`Attempted to log a message with an invalid logType (value: ${b})`)};class gC{constructor(a){this.name=a,this._logLevel=gz,this._logHandler=gB,this._userLogHandler=null,gx.push(this)}get logLevel(){return this._logLevel}set logLevel(a){if(!(a in f))throw TypeError(`Invalid value "${a}" assigned to \`logLevel\``);this._logLevel=a}setLogLevel(a){this._logLevel="string"==typeof a?gy[a]:a}get logHandler(){return this._logHandler}set logHandler(a){if("function"!=typeof a)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=a}get userLogHandler(){return this._userLogHandler}set userLogHandler(a){this._userLogHandler=a}debug(...a){this._userLogHandler&&this._userLogHandler(this,f.DEBUG,...a),this._logHandler(this,f.DEBUG,...a)}log(...a){this._userLogHandler&&this._userLogHandler(this,f.VERBOSE,...a),this._logHandler(this,f.VERBOSE,...a)}info(...a){this._userLogHandler&&this._userLogHandler(this,f.INFO,...a),this._logHandler(this,f.INFO,...a)}warn(...a){this._userLogHandler&&this._userLogHandler(this,f.WARN,...a),this._logHandler(this,f.WARN,...a)}error(...a){this._userLogHandler&&this._userLogHandler(this,f.ERROR,...a),this._logHandler(this,f.ERROR,...a)}}let gD=(a,b)=>b.some(b=>a instanceof b);function gE(){return d||(d=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function gF(){return e||(e=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let gG=new WeakMap,gH=new WeakMap,gI=new WeakMap,gJ=new WeakMap,gK=new WeakMap;function gL(a){let b=new Promise((b,c)=>{let d=()=>{a.removeEventListener("success",e),a.removeEventListener("error",f)},e=()=>{b(gR(a.result)),d()},f=()=>{c(a.error),d()};a.addEventListener("success",e),a.addEventListener("error",f)});return b.then(b=>{b instanceof IDBCursor&&gG.set(b,a)}).catch(()=>{}),gK.set(b,a),b}function gM(a){if(gH.has(a))return;let b=new Promise((b,c)=>{let d=()=>{a.removeEventListener("complete",e),a.removeEventListener("error",f),a.removeEventListener("abort",f)},e=()=>{b(),d()},f=()=>{c(a.error||new DOMException("AbortError","AbortError")),d()};a.addEventListener("complete",e),a.addEventListener("error",f),a.addEventListener("abort",f)});gH.set(a,b)}let gN={get(a,b,c){if(a instanceof IDBTransaction){if("done"===b)return gH.get(a);if("objectStoreNames"===b)return a.objectStoreNames||gI.get(a);if("store"===b)return c.objectStoreNames[1]?void 0:c.objectStore(c.objectStoreNames[0])}return gR(a[b])},set:(a,b,c)=>(a[b]=c,!0),has:(a,b)=>a instanceof IDBTransaction&&("done"===b||"store"===b)||b in a};function gO(a){gN=a(gN)}function gP(a){return a!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?gF().includes(a)?function(...b){return a.apply(gS(this),b),gR(gG.get(this))}:function(...b){return gR(a.apply(gS(this),b))}:function(b,...c){let d=a.call(gS(this),b,...c);return gI.set(d,b.sort?b.sort():[b]),gR(d)}}function gQ(a){return"function"==typeof a?gP(a):(a instanceof IDBTransaction&&gM(a),gD(a,gE()))?new Proxy(a,gN):a}function gR(a){if(a instanceof IDBRequest)return gL(a);if(gJ.has(a))return gJ.get(a);let b=gQ(a);return b!==a&&(gJ.set(a,b),gK.set(b,a)),b}let gS=a=>gK.get(a);function gT(a,b,{blocked:c,upgrade:d,blocking:e,terminated:f}={}){let g=indexedDB.open(a,b),h=gR(g);return d&&g.addEventListener("upgradeneeded",a=>{d(gR(g.result),a.oldVersion,a.newVersion,gR(g.transaction),a)}),c&&g.addEventListener("blocked",a=>c(a.oldVersion,a.newVersion,a)),h.then(a=>{f&&a.addEventListener("close",()=>f()),e&&a.addEventListener("versionchange",a=>e(a.oldVersion,a.newVersion,a))}).catch(()=>{}),h}let gU=["get","getKey","getAll","getAllKeys","count"],gV=["put","add","delete","clear"],gW=new Map;function gX(a,b){if(!(a instanceof IDBDatabase&&!(b in a)&&"string"==typeof b))return;if(gW.get(b))return gW.get(b);let c=b.replace(/FromIndex$/,""),d=b!==c,e=gV.includes(c);if(!(c in(d?IDBIndex:IDBObjectStore).prototype)||!(e||gU.includes(c)))return;let f=async function(a,...b){let f=this.transaction(a,e?"readwrite":"readonly"),g=f.store;return d&&(g=g.index(b.shift())),(await Promise.all([g[c](...b),e&&f.done]))[0]};return gW.set(b,f),f}gO(a=>({...a,get:(b,c,d)=>gX(b,c)||a.get(b,c,d),has:(b,c)=>!!gX(b,c)||a.has(b,c)}));class gY{constructor(a){this.container=a}getPlatformInfoString(){return this.container.getProviders().map(a=>{if(!gZ(a))return null;{let b=a.getImmediate();return`${b.library}/${b.version}`}}).filter(a=>a).join(" ")}}function gZ(a){let b=a.getComponent();return(null==b?void 0:b.type)==="VERSION"}let g$="@firebase/app",g_="0.13.2",g0=new gC("@firebase/app"),g1="11.10.0",g2="[DEFAULT]",g3={[g$]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},g4=new Map,g5=new Map,g6=new Map;function g7(a,b){try{a.container.addComponent(b)}catch(c){g0.debug(`Component ${b.name} failed to register with FirebaseApp ${a.name}`,c)}}function g8(a){let b=a.name;if(g6.has(b))return g0.debug(`There were multiple attempts to register component ${b}.`),!1;for(let c of(g6.set(b,a),g4.values()))g7(c,a);for(let b of g5.values())g7(b,a);return!0}function g9(a,b){let c=a.container.getProvider("heartbeat").getImmediate({optional:!0});return c&&c.triggerHeartbeat(),a.container.getProvider(b)}function ha(a){return null!=a&&void 0!==a.settings}let hb=new gd("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class hc{constructor(a,b,c){this._isDeleted=!1,this._options=Object.assign({},a),this._config=Object.assign({},b),this._name=b.name,this._automaticDataCollectionEnabled=b.automaticDataCollectionEnabled,this._container=c,this.container.addComponent(new gr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(a){this.checkDestroyed(),this._automaticDataCollectionEnabled=a}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(a){this._isDeleted=a}checkDestroyed(){if(this.isDeleted)throw hb.create("app-deleted",{appName:this._name})}}function hd(a,b){let c=fK(a.split(".")[1]);return null===c?void console.error(`FirebaseServerApp ${b} is invalid: second part could not be parsed.`):void 0===JSON.parse(c).exp?void console.error(`FirebaseServerApp ${b} is invalid: expiration claim could not be parsed`):void(1e3*JSON.parse(c).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${b} is invalid: the token has expired.`))}let he=g1;function hf(a,b={}){let c=a;"object"!=typeof b&&(b={name:b});let d=Object.assign({name:g2,automaticDataCollectionEnabled:!0},b),e=d.name;if("string"!=typeof e||!e)throw hb.create("bad-app-name",{appName:String(e)});if(c||(c=fT()),!c)throw hb.create("no-options");let f=g4.get(e);if(f)if(gh(c,f.options)&&gh(d,f.config))return f;else throw hb.create("duplicate-app",{appName:e});let g=new gw(e);for(let a of g6.values())g.addComponent(a);let h=new hc(c,d,g);return g4.set(e,h),h}function hg(a=g2){let b=g4.get(a);if(!b&&a===g2&&fT())return hf();if(!b)throw hb.create("no-app",{appName:a});return b}function hh(){return Array.from(g4.values())}async function hi(a){let b=!1,c=a.name;g4.has(c)?(b=!0,g4.delete(c)):g5.has(c)&&0>=a.decRefCount()&&(g5.delete(c),b=!0),b&&(await Promise.all(a.container.getProviders().map(a=>a.delete())),a.isDeleted=!0)}function hj(a,b,c){var d;let e=null!=(d=g3[a])?d:a;c&&(e+=`-${c}`);let f=e.match(/\s|\//),g=b.match(/\s|\//);if(f||g){let a=[`Unable to register library "${e}" with version "${b}":`];f&&a.push(`library name "${e}" contains illegal characters (whitespace or "/")`),f&&g&&a.push("and"),g&&a.push(`version name "${b}" contains illegal characters (whitespace or "/")`),g0.warn(a.join(" "));return}g8(new gr(`${e}-version`,()=>({library:e,version:b}),"VERSION"))}let hk="firebase-heartbeat-database",hl=1,hm="firebase-heartbeat-store",hn=null;function ho(){return hn||(hn=gT(hk,hl,{upgrade:(a,b)=>{if(0===b)try{a.createObjectStore(hm)}catch(a){console.warn(a)}}}).catch(a=>{throw hb.create("idb-open",{originalErrorMessage:a.message})})),hn}async function hp(a){try{let b=(await ho()).transaction(hm),c=await b.objectStore(hm).get(hr(a));return await b.done,c}catch(a){if(a instanceof gc)g0.warn(a.message);else{let b=hb.create("idb-get",{originalErrorMessage:null==a?void 0:a.message});g0.warn(b.message)}}}async function hq(a,b){try{let c=(await ho()).transaction(hm,"readwrite"),d=c.objectStore(hm);await d.put(b,hr(a)),await c.done}catch(a){if(a instanceof gc)g0.warn(a.message);else{let b=hb.create("idb-set",{originalErrorMessage:null==a?void 0:a.message});g0.warn(b.message)}}}function hr(a){return`${a.name}!${a.options.appId}`}let hs=1024,ht=30;class hu{constructor(a){this.container=a,this._heartbeatsCache=null;let b=this.container.getProvider("app").getImmediate();this._storage=new hx(b),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var a,b;try{let c=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),d=hv();if((null==(a=this._heartbeatsCache)?void 0:a.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,(null==(b=this._heartbeatsCache)?void 0:b.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===d||this._heartbeatsCache.heartbeats.some(a=>a.date===d))return;if(this._heartbeatsCache.heartbeats.push({date:d,agent:c}),this._heartbeatsCache.heartbeats.length>ht){let a=hz(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){g0.warn(a)}}async getHeartbeatsHeader(){var a;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,(null==(a=this._heartbeatsCache)?void 0:a.heartbeats)==null||0===this._heartbeatsCache.heartbeats.length)return"";let b=hv(),{heartbeatsToSend:c,unsentEntries:d}=hw(this._heartbeatsCache.heartbeats),e=fJ(JSON.stringify({version:2,heartbeats:c}));return this._heartbeatsCache.lastSentHeartbeatDate=b,d.length>0?(this._heartbeatsCache.heartbeats=d,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),e}catch(a){return g0.warn(a),""}}}function hv(){return new Date().toISOString().substring(0,10)}function hw(a,b=hs){let c=[],d=a.slice();for(let e of a){let a=c.find(a=>a.agent===e.agent);if(a){if(a.dates.push(e.date),hy(c)>b){a.dates.pop();break}}else if(c.push({agent:e.agent,dates:[e.date]}),hy(c)>b){c.pop();break}d=d.slice(1)}return{heartbeatsToSend:c,unsentEntries:d}}class hx{constructor(a){this.app=a,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!f9()&&ga().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let a=await hp(this.app);return(null==a?void 0:a.heartbeats)?a:{heartbeats:[]}}}async overwrite(a){var b;if(await this._canUseIndexedDBPromise){let c=await this.read();return hq(this.app,{lastSentHeartbeatDate:null!=(b=a.lastSentHeartbeatDate)?b:c.lastSentHeartbeatDate,heartbeats:a.heartbeats})}}async add(a){var b;if(await this._canUseIndexedDBPromise){let c=await this.read();return hq(this.app,{lastSentHeartbeatDate:null!=(b=a.lastSentHeartbeatDate)?b:c.lastSentHeartbeatDate,heartbeats:[...c.heartbeats,...a.heartbeats]})}}}function hy(a){return fJ(JSON.stringify({version:2,heartbeats:a})).length}function hz(a){if(0===a.length)return -1;let b=0,c=a[0].date;for(let d=1;d<a.length;d++)a[d].date<c&&(c=a[d].date,b=d);return b}!function(a){g8(new gr("platform-logger",a=>new gY(a),"PRIVATE")),g8(new gr("heartbeat",a=>new hu(a),"PRIVATE")),hj(g$,g_,""),hj(g$,g_,"esm2017"),hj("fire-js","")}("");let hA="type.googleapis.com/google.protobuf.Int64Value",hB="type.googleapis.com/google.protobuf.UInt64Value";function hC(a,b){let c={};for(let d in a)a.hasOwnProperty(d)&&(c[d]=b(a[d]));return c}function hD(a){if(null==a)return null;if(a instanceof Number&&(a=a.valueOf()),"number"==typeof a&&isFinite(a)||!0===a||!1===a||"[object String]"===Object.prototype.toString.call(a))return a;if(a instanceof Date)return a.toISOString();if(Array.isArray(a))return a.map(a=>hD(a));if("function"==typeof a||"object"==typeof a)return hC(a,a=>hD(a));throw Error("Data cannot be encoded in JSON: "+a)}function hE(a){if(null==a)return a;if(a["@type"])switch(a["@type"]){case hA:case hB:{let b=Number(a.value);if(isNaN(b))throw Error("Data cannot be decoded from JSON: "+a);return b}default:throw Error("Data cannot be decoded from JSON: "+a)}return Array.isArray(a)?a.map(a=>hE(a)):"function"==typeof a||"object"==typeof a?hC(a,a=>hE(a)):a}let hF="functions",hG={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class hH extends gc{constructor(a,b,c){super(`${hF}/${a}`,b||""),this.details=c,Object.setPrototypeOf(this,hH.prototype)}}function hI(a){if(a>=200&&a<300)return"ok";switch(a){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function hJ(a,b){let c,d=hI(a),e=d;try{let a=b&&b.error;if(a){let b=a.status;if("string"==typeof b){if(!hG[b])return new hH("internal","internal");d=hG[b],e=b}let f=a.message;"string"==typeof f&&(e=f),c=a.details,void 0!==c&&(c=hE(c))}}catch(a){}return"ok"===d?null:new hH(d,e,c)}class hK{constructor(a,b,c,d){this.app=a,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,ha(a)&&a.settings.appCheckToken&&(this.serverAppAppCheckToken=a.settings.appCheckToken),this.auth=b.getImmediate({optional:!0}),this.messaging=c.getImmediate({optional:!0}),this.auth||b.get().then(a=>this.auth=a,()=>{}),this.messaging||c.get().then(a=>this.messaging=a,()=>{}),this.appCheck||null==d||d.get().then(a=>this.appCheck=a,()=>{})}async getAuthToken(){if(this.auth)try{let a=await this.auth.getToken();return null==a?void 0:a.accessToken}catch(a){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(a){return}}async getAppCheckToken(a){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){let b=a?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return b.error?null:b.token}return null}async getContext(a){let b=await this.getAuthToken();return{authToken:b,messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(a)}}}let hL="us-central1",hM=/^data: (.*?)(?:\n|$)/;function hN(a){let b=null;return{promise:new Promise((c,d)=>{b=setTimeout(()=>{d(new hH("deadline-exceeded","deadline-exceeded"))},a)}),cancel:()=>{b&&clearTimeout(b)}}}class hO{constructor(a,b,c,d,e=hL,f=(...a)=>fetch(...a)){this.app=a,this.fetchImpl=f,this.emulatorOrigin=null,this.contextProvider=new hK(a,b,c,d),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{let a=new URL(e);this.customDomain=a.origin+("/"===a.pathname?"":a.pathname),this.region=hL}catch(a){this.customDomain=null,this.region=e}}_delete(){return this.deleteService()}_url(a){let b=this.app.options.projectId;if(null!==this.emulatorOrigin){let c=this.emulatorOrigin;return`${c}/${b}/${this.region}/${a}`}return null!==this.customDomain?`${this.customDomain}/${a}`:`https://${this.region}-${b}.cloudfunctions.net/${a}`}}function hP(a,b,c){let d=fV(b);a.emulatorOrigin=`http${d?"s":""}://${b}:${c}`,d&&(fW(a.emulatorOrigin),f0("Functions",!0))}function hQ(a,b,c){let d=d=>hT(a,b,d,c||{});return d.stream=(c,d)=>hV(a,b,c,d),d}async function hR(a,b,c,d){let e;c["Content-Type"]="application/json";try{e=await d(a,{method:"POST",body:JSON.stringify(b),headers:c})}catch(a){return{status:0,json:null}}let f=null;try{f=await e.json()}catch(a){}return{status:e.status,json:f}}async function hS(a,b){let c={},d=await a.contextProvider.getContext(b.limitedUseAppCheckTokens);return d.authToken&&(c.Authorization="Bearer "+d.authToken),d.messagingToken&&(c["Firebase-Instance-ID-Token"]=d.messagingToken),null!==d.appCheckToken&&(c["X-Firebase-AppCheck"]=d.appCheckToken),c}function hT(a,b,c,d){let e=a._url(b);return hU(a,e,c,d)}async function hU(a,b,c,d){let e={data:c=hD(c)},f=await hS(a,d),g=hN(d.timeout||7e4),h=await Promise.race([hR(b,e,f,a.fetchImpl),g.promise,a.cancelAllRequests]);if(g.cancel(),!h)throw new hH("cancelled","Firebase Functions instance was deleted.");let i=hJ(h.status,h.json);if(i)throw i;if(!h.json)throw new hH("internal","Response is not valid JSON object.");let j=h.json.data;if(void 0===j&&(j=h.json.result),void 0===j)throw new hH("internal","Response is missing data field.");return{data:hE(j)}}function hV(a,b,c,d){let e=a._url(b);return hW(a,e,c,d||{})}async function hW(a,b,c,d){var e;let f,g,h,i={data:c=hD(c)},j=await hS(a,d);j["Content-Type"]="application/json",j.Accept="text/event-stream";try{f=await a.fetchImpl(b,{method:"POST",body:JSON.stringify(i),headers:j,signal:null==d?void 0:d.signal})}catch(b){if(b instanceof Error&&"AbortError"===b.name){let a=new hH("cancelled","Request was cancelled.");return{data:Promise.reject(a),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(a)})}}}let a=hJ(0,null);return{data:Promise.reject(a),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(a)})}}}let k=new Promise((a,b)=>{g=a,h=b});null==(e=null==d?void 0:d.signal)||e.addEventListener("abort",()=>{let a=new hH("cancelled","Request was cancelled.");h(a)});let l=hX(f.body.getReader(),g,h,null==d?void 0:d.signal);return{stream:{[Symbol.asyncIterator](){let a=l.getReader();return{async next(){let{value:b,done:c}=await a.read();return{value:b,done:c}},return:async()=>(await a.cancel(),{done:!0,value:void 0})}}},data:k}}function hX(a,b,c,d){let e=(a,d)=>{let e=a.match(hM);if(!e)return;let f=e[1];try{let a=JSON.parse(f);if("result"in a)return void b(hE(a.result));if("message"in a)return void d.enqueue(hE(a.message));if("error"in a){let b=hJ(0,a);d.error(b),c(b);return}}catch(a){if(a instanceof hH){d.error(a),c(a);return}}},f=new TextDecoder;return new ReadableStream({start(b){let g="";return h();async function h(){if(null==d?void 0:d.aborted){let a=new hH("cancelled","Request was cancelled");return b.error(a),c(a),Promise.resolve()}try{let{value:i,done:j}=await a.read();if(j){g.trim()&&e(g.trim(),b),b.close();return}if(null==d?void 0:d.aborted){let d=new hH("cancelled","Request was cancelled");b.error(d),c(d),await a.cancel();return}let k=(g+=f.decode(i,{stream:!0})).split("\n");for(let a of(g=k.pop()||"",k))a.trim()&&e(a.trim(),b);return h()}catch(d){let a=d instanceof hH?d:hJ(0,null);b.error(a),c(a)}}},cancel:()=>a.cancel()})}let hY="@firebase/functions",hZ="0.12.9",h$="auth-internal",h_="app-check-internal",h0="messaging-internal";function h1(a=hg(),b=hL){let c=g9(gq(a),hF).getImmediate({identifier:b}),d=fS("functions");return d&&h2(c,...d),c}function h2(a,b,c){hP(gq(a),b,c)}function h3(a,b,c){return hQ(gq(a),b,c)}(function a(a){g8(new gr(hF,(a,{instanceIdentifier:b})=>{let c=a.getProvider("app").getImmediate(),d=a.getProvider(h$);return new hO(c,d,a.getProvider(h0),a.getProvider(h_),b)},"PUBLIC").setMultipleInstances(!0)),hj(hY,hZ,a),hj(hY,hZ,"esm2017")})(),hj("firebase","11.10.0","app");var h4=function(a,b){return(h4=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])})(a,b)};function h5(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}var h6=Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]};function h7(a){var b="function"==typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"==typeof a.length)return{next:function(){return a&&d>=a.length&&(a=void 0),{value:a&&a[d++],done:!a}}};throw TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}function h8(a,b){var c="function"==typeof Symbol&&a[Symbol.iterator];if(!c)return a;var d,e,f=c.call(a),g=[];try{for(;(void 0===b||b-- >0)&&!(d=f.next()).done;)g.push(d.value)}catch(a){e={error:a}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(e)throw e.error}}return g}function h9(a){return this instanceof h9?(this.v=a,this):new h9(a)}var ia=Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b},ib=function(a){return(ib=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[b.length]=c);return b})(a)},ic="function"==typeof SuppressedError?SuppressedError:function(a,b,c){var d=Error(c);return d.name="SuppressedError",d.error=a,d.suppressed=b,d};function id(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}let ie=id,ig=new gd("auth","Firebase",id()),ih=new gC("@firebase/auth");function ii(a,...b){ih.logLevel<=f.WARN&&ih.warn(`Auth (${he}): ${a}`,...b)}function ij(a,...b){ih.logLevel<=f.ERROR&&ih.error(`Auth (${he}): ${a}`,...b)}function ik(a,...b){throw ip(a,...b)}function il(a,...b){return ip(a,...b)}function im(a,b,c){return new gd("auth","Firebase",Object.assign(Object.assign({},ie()),{[b]:c})).create(b,{appName:a.name})}function io(a){return im(a,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ip(a,...b){if("string"!=typeof a){let c=b[0],d=[...b.slice(1)];return d[0]&&(d[0].appName=a.name),a._errorFactory.create(c,...d)}return ig.create(a,...b)}function iq(a,b,...c){if(!a)throw ip(b,...c)}function ir(a){let b="INTERNAL ASSERTION FAILED: "+a;throw ij(b),Error(b)}function is(a,b){a||ir(b)}function it(){return"http:"===iu()||"https:"===iu()}function iu(){var a;return"undefined"!=typeof self&&(null==(a=self.location)?void 0:a.protocol)||null}function iv(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(it()||f5()||"connection"in navigator))||navigator.onLine}function iw(){if("undefined"==typeof navigator)return null;let a=navigator;return a.languages&&a.languages[0]||a.language||null}class ix{constructor(a,b){this.shortDelay=a,this.longDelay=b,is(b>a,"Short delay should be less than long delay!"),this.isMobile=f2()||f6()}get(){return iv()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function iy(a,b){is(a.emulator,"Emulator should always be set here");let{url:c}=a.emulator;return b?`${c}${b.startsWith("/")?b.slice(1):b}`:c}class iz{static initialize(a,b,c){this.fetchImpl=a,b&&(this.headersImpl=b),c&&(this.responseImpl=c)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void ir("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void ir("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void ir("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}let iA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},iB=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],iC=new ix(3e4,6e4);function iD(a,b){return a.tenantId&&!b.tenantId?Object.assign(Object.assign({},b),{tenantId:a.tenantId}):b}async function iE(a,b,c,d,e={}){return iF(a,e,async()=>{let e={},f={};d&&("GET"===b?f=d:e={body:JSON.stringify(d)});let g=gj(Object.assign({key:a.config.apiKey},f)).slice(1),h=await a._getAdditionalHeaders();h["Content-Type"]="application/json",a.languageCode&&(h["X-Firebase-Locale"]=a.languageCode);let i=Object.assign({method:b,headers:h},e);return f4()||(i.referrerPolicy="no-referrer"),a.emulatorConfig&&fV(a.emulatorConfig.host)&&(i.credentials="include"),iz.fetch()(await iH(a,a.config.apiHost,c,g),i)})}async function iF(a,b,c){a._canInitEmulator=!1;let d=Object.assign(Object.assign({},iA),b);try{let b=new iJ(a),e=await Promise.race([c(),b.promise]);b.clearNetworkTimeout();let f=await e.json();if("needConfirmation"in f)throw iK(a,"account-exists-with-different-credential",f);if(e.ok&&!("errorMessage"in f))return f;{let[b,c]=(e.ok?f.errorMessage:f.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===b)throw iK(a,"credential-already-in-use",f);if("EMAIL_EXISTS"===b)throw iK(a,"email-already-in-use",f);if("USER_DISABLED"===b)throw iK(a,"user-disabled",f);let g=d[b]||b.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw im(a,g,c);ik(a,g)}}catch(b){if(b instanceof gc)throw b;ik(a,"network-request-failed",{message:String(b)})}}async function iG(a,b,c,d,e={}){let f=await iE(a,b,c,d,e);return"mfaPendingCredential"in f&&ik(a,"multi-factor-auth-required",{_serverResponse:f}),f}async function iH(a,b,c,d){let e=`${b}${c}?${d}`,f=a,g=f.config.emulator?iy(a.config,e):`${a.config.apiScheme}://${e}`;return iB.includes(c)&&(await f._persistenceManagerAvailable,"COOKIE"===f._getPersistenceType())?f._getPersistence()._getFinalTarget(g).toString():g}function iI(a){switch(a){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class iJ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(a){this.auth=a,this.timer=null,this.promise=new Promise((a,b)=>{this.timer=setTimeout(()=>b(il(this.auth,"network-request-failed")),iC.get())})}}function iK(a,b,c){let d={appName:a.name};c.email&&(d.email=c.email),c.phoneNumber&&(d.phoneNumber=c.phoneNumber);let e=il(a,b,d);return e.customData._tokenResponse=c,e}function iL(a){return void 0!==a&&void 0!==a.enterprise}class iM{constructor(a){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===a.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=a.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=a.recaptchaEnforcementState}getProviderEnforcementState(a){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let b of this.recaptchaEnforcementState)if(b.provider&&b.provider===a)return iI(b.enforcementState);return null}isProviderEnabled(a){return"ENFORCE"===this.getProviderEnforcementState(a)||"AUDIT"===this.getProviderEnforcementState(a)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function iN(a,b){return iE(a,"GET","/v2/recaptchaConfig",iD(a,b))}async function iO(a,b){return iE(a,"POST","/v1/accounts:delete",b)}async function iP(a,b){return iE(a,"POST","/v1/accounts:lookup",b)}function iQ(a){if(a)try{let b=new Date(Number(a));if(!isNaN(b.getTime()))return b.toUTCString()}catch(a){}}async function iR(a,b=!1){let c=gq(a),d=await c.getIdToken(b),e=iT(d);iq(e&&e.exp&&e.auth_time&&e.iat,c.auth,"internal-error");let f="object"==typeof e.firebase?e.firebase:void 0,g=null==f?void 0:f.sign_in_provider;return{claims:e,token:d,authTime:iQ(iS(e.auth_time)),issuedAtTime:iQ(iS(e.iat)),expirationTime:iQ(iS(e.exp)),signInProvider:g||null,signInSecondFactor:(null==f?void 0:f.sign_in_second_factor)||null}}function iS(a){return 1e3*Number(a)}function iT(a){let[b,c,d]=a.split(".");if(void 0===b||void 0===c||void 0===d)return ij("JWT malformed, contained fewer than 3 sections"),null;try{let a=fK(c);if(!a)return ij("Failed to decode base64 JWT payload"),null;return JSON.parse(a)}catch(a){return ij("Caught error parsing JWT payload as JSON",null==a?void 0:a.toString()),null}}function iU(a){let b=iT(a);return iq(b,"internal-error"),iq(void 0!==b.exp,"internal-error"),iq(void 0!==b.iat,"internal-error"),Number(b.exp)-Number(b.iat)}async function iV(a,b,c=!1){if(c)return b;try{return await b}catch(b){throw b instanceof gc&&iW(b)&&a.auth.currentUser===a&&await a.auth.signOut(),b}}function iW({code:a}){return"auth/user-disabled"===a||"auth/user-token-expired"===a}class iX{constructor(a){this.user=a,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(a){var b;if(!a)return this.errorBackoff=3e4,Math.max(0,(null!=(b=this.user.stsTokenManager.expirationTime)?b:0)-Date.now()-3e5);{let a=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),a}}schedule(a=!1){if(!this.isRunning)return;let b=this.getInterval(a);this.timerId=setTimeout(async()=>{await this.iteration()},b)}async iteration(){try{await this.user.getIdToken(!0)}catch(a){(null==a?void 0:a.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class iY{constructor(a,b){this.createdAt=a,this.lastLoginAt=b,this._initializeTime()}_initializeTime(){this.lastSignInTime=iQ(this.lastLoginAt),this.creationTime=iQ(this.createdAt)}_copy(a){this.createdAt=a.createdAt,this.lastLoginAt=a.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function iZ(a){var b;let c=a.auth,d=await a.getIdToken(),e=await iV(a,iP(c,{idToken:d}));iq(null==e?void 0:e.users.length,c,"internal-error");let f=e.users[0];a._notifyReloadListener(f);let g=(null==(b=f.providerUserInfo)?void 0:b.length)?i0(f.providerUserInfo):[],h=i_(a.providerData,g),i=a.isAnonymous,j=!(a.email&&f.passwordHash)&&!(null==h?void 0:h.length),k=!!i&&j;Object.assign(a,{uid:f.localId,displayName:f.displayName||null,photoURL:f.photoUrl||null,email:f.email||null,emailVerified:f.emailVerified||!1,phoneNumber:f.phoneNumber||null,tenantId:f.tenantId||null,providerData:h,metadata:new iY(f.createdAt,f.lastLoginAt),isAnonymous:k})}async function i$(a){let b=gq(a);await iZ(b),await b.auth._persistUserIfCurrent(b),b.auth._notifyListenersIfCurrent(b)}function i_(a,b){return[...a.filter(a=>!b.some(b=>b.providerId===a.providerId)),...b]}function i0(a){return a.map(a=>{var{providerId:b}=a,c=h5(a,["providerId"]);return{providerId:b,uid:c.rawId||"",displayName:c.displayName||null,email:c.email||null,phoneNumber:c.phoneNumber||null,photoURL:c.photoUrl||null}})}async function i1(a,b){let c=await iF(a,{},async()=>{let c=gj({grant_type:"refresh_token",refresh_token:b}).slice(1),{tokenApiHost:d,apiKey:e}=a.config,f=await iH(a,d,"/v1/token",`key=${e}`),g=await a._getAdditionalHeaders();g["Content-Type"]="application/x-www-form-urlencoded";let h={method:"POST",headers:g,body:c};return a.emulatorConfig&&fV(a.emulatorConfig.host)&&(h.credentials="include"),iz.fetch()(f,h)});return{accessToken:c.access_token,expiresIn:c.expires_in,refreshToken:c.refresh_token}}async function i2(a,b){return iE(a,"POST","/v2/accounts:revokeToken",iD(a,b))}class i3{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(a){iq(a.idToken,"internal-error"),iq(void 0!==a.idToken,"internal-error"),iq(void 0!==a.refreshToken,"internal-error");let b="expiresIn"in a&&void 0!==a.expiresIn?Number(a.expiresIn):iU(a.idToken);this.updateTokensAndExpiration(a.idToken,a.refreshToken,b)}updateFromIdToken(a){iq(0!==a.length,"internal-error");let b=iU(a);this.updateTokensAndExpiration(a,null,b)}async getToken(a,b=!1){return b||!this.accessToken||this.isExpired?(iq(this.refreshToken,a,"user-token-expired"),this.refreshToken)?(await this.refresh(a,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(a,b){let{accessToken:c,refreshToken:d,expiresIn:e}=await i1(a,b);this.updateTokensAndExpiration(c,d,Number(e))}updateTokensAndExpiration(a,b,c){this.refreshToken=b||null,this.accessToken=a||null,this.expirationTime=Date.now()+1e3*c}static fromJSON(a,b){let{refreshToken:c,accessToken:d,expirationTime:e}=b,f=new i3;return c&&(iq("string"==typeof c,"internal-error",{appName:a}),f.refreshToken=c),d&&(iq("string"==typeof d,"internal-error",{appName:a}),f.accessToken=d),e&&(iq("number"==typeof e,"internal-error",{appName:a}),f.expirationTime=e),f}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(a){this.accessToken=a.accessToken,this.refreshToken=a.refreshToken,this.expirationTime=a.expirationTime}_clone(){return Object.assign(new i3,this.toJSON())}_performRefresh(){return ir("not implemented")}}function i4(a,b){iq("string"==typeof a||void 0===a,"internal-error",{appName:b})}class i5{constructor(a){var{uid:b,auth:c,stsTokenManager:d}=a,e=h5(a,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new iX(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=b,this.auth=c,this.stsTokenManager=d,this.accessToken=d.accessToken,this.displayName=e.displayName||null,this.email=e.email||null,this.emailVerified=e.emailVerified||!1,this.phoneNumber=e.phoneNumber||null,this.photoURL=e.photoURL||null,this.isAnonymous=e.isAnonymous||!1,this.tenantId=e.tenantId||null,this.providerData=e.providerData?[...e.providerData]:[],this.metadata=new iY(e.createdAt||void 0,e.lastLoginAt||void 0)}async getIdToken(a){let b=await iV(this,this.stsTokenManager.getToken(this.auth,a));return iq(b,this.auth,"internal-error"),this.accessToken!==b&&(this.accessToken=b,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),b}getIdTokenResult(a){return iR(this,a)}reload(){return i$(this)}_assign(a){this!==a&&(iq(this.uid===a.uid,this.auth,"internal-error"),this.displayName=a.displayName,this.photoURL=a.photoURL,this.email=a.email,this.emailVerified=a.emailVerified,this.phoneNumber=a.phoneNumber,this.isAnonymous=a.isAnonymous,this.tenantId=a.tenantId,this.providerData=a.providerData.map(a=>Object.assign({},a)),this.metadata._copy(a.metadata),this.stsTokenManager._assign(a.stsTokenManager))}_clone(a){let b=new i5(Object.assign(Object.assign({},this),{auth:a,stsTokenManager:this.stsTokenManager._clone()}));return b.metadata._copy(this.metadata),b}_onReload(a){iq(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=a,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(a){this.reloadListener?this.reloadListener(a):this.reloadUserInfo=a}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(a,b=!1){let c=!1;a.idToken&&a.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(a),c=!0),b&&await iZ(this),await this.auth._persistUserIfCurrent(this),c&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ha(this.auth.app))return Promise.reject(io(this.auth));let a=await this.getIdToken();return await iV(this,iO(this.auth,{idToken:a})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(a=>Object.assign({},a)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(a,b){var c,d,e,f,g,h,i,j;let k=null!=(c=b.displayName)?c:void 0,l=null!=(d=b.email)?d:void 0,m=null!=(e=b.phoneNumber)?e:void 0,n=null!=(f=b.photoURL)?f:void 0,o=null!=(g=b.tenantId)?g:void 0,p=null!=(h=b._redirectEventId)?h:void 0,q=null!=(i=b.createdAt)?i:void 0,r=null!=(j=b.lastLoginAt)?j:void 0,{uid:s,emailVerified:t,isAnonymous:u,providerData:v,stsTokenManager:w}=b;iq(s&&w,a,"internal-error");let x=i3.fromJSON(this.name,w);iq("string"==typeof s,a,"internal-error"),i4(k,a.name),i4(l,a.name),iq("boolean"==typeof t,a,"internal-error"),iq("boolean"==typeof u,a,"internal-error"),i4(m,a.name),i4(n,a.name),i4(o,a.name),i4(p,a.name),i4(q,a.name),i4(r,a.name);let y=new i5({uid:s,auth:a,email:l,emailVerified:t,displayName:k,isAnonymous:u,photoURL:n,phoneNumber:m,tenantId:o,stsTokenManager:x,createdAt:q,lastLoginAt:r});return v&&Array.isArray(v)&&(y.providerData=v.map(a=>Object.assign({},a))),p&&(y._redirectEventId=p),y}static async _fromIdTokenResponse(a,b,c=!1){let d=new i3;d.updateFromServerResponse(b);let e=new i5({uid:b.localId,auth:a,stsTokenManager:d,isAnonymous:c});return await iZ(e),e}static async _fromGetAccountInfoResponse(a,b,c){let d=b.users[0];iq(void 0!==d.localId,"internal-error");let e=void 0!==d.providerUserInfo?i0(d.providerUserInfo):[],f=!(d.email&&d.passwordHash)&&!(null==e?void 0:e.length),g=new i3;g.updateFromIdToken(c);let h=new i5({uid:d.localId,auth:a,stsTokenManager:g,isAnonymous:f});return Object.assign(h,{uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:e,metadata:new iY(d.createdAt,d.lastLoginAt),isAnonymous:!(d.email&&d.passwordHash)&&!(null==e?void 0:e.length)}),h}}let i6=new Map;function i7(a){is(a instanceof Function,"Expected a class definition");let b=i6.get(a);return b?is(b instanceof a,"Instance stored in cache mismatched with class"):(b=new a,i6.set(a,b)),b}class i8{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(a,b){this.storage[a]=b}async _get(a){let b=this.storage[a];return void 0===b?null:b}async _remove(a){delete this.storage[a]}_addListener(a,b){}_removeListener(a,b){}}i8.type="NONE";let i9=i8;function ja(a,b,c){return`firebase:${a}:${b}:${c}`}class jb{constructor(a,b,c){this.persistence=a,this.auth=b,this.userKey=c;let{config:d,name:e}=this.auth;this.fullUserKey=ja(this.userKey,d.apiKey,e),this.fullPersistenceKey=ja("persistence",d.apiKey,e),this.boundEventHandler=b._onStorageEvent.bind(b),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(a){return this.persistence._set(this.fullUserKey,a.toJSON())}async getCurrentUser(){let a=await this.persistence._get(this.fullUserKey);if(!a)return null;if("string"==typeof a){let b=await iP(this.auth,{idToken:a}).catch(()=>void 0);return b?i5._fromGetAccountInfoResponse(this.auth,b,a):null}return i5._fromJSON(this.auth,a)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(a){if(this.persistence===a)return;let b=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=a,b)return this.setCurrentUser(b)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(a,b,c="authUser"){if(!b.length)return new jb(i7(i9),a,c);let d=(await Promise.all(b.map(async a=>{if(await a._isAvailable())return a}))).filter(a=>a),e=d[0]||i7(i9),f=ja(c,a.config.apiKey,a.name),g=null;for(let c of b)try{let b=await c._get(f);if(b){let d;if("string"==typeof b){let c=await iP(a,{idToken:b}).catch(()=>void 0);if(!c)break;d=await i5._fromGetAccountInfoResponse(a,c,b)}else d=i5._fromJSON(a,b);c!==e&&(g=d),e=c;break}}catch(a){}let h=d.filter(a=>a._shouldAllowMigration);return e._shouldAllowMigration&&h.length&&(e=h[0],g&&await e._set(f,g.toJSON()),await Promise.all(b.map(async a=>{if(a!==e)try{await a._remove(f)}catch(a){}}))),new jb(e,a,c)}}function jc(a){let b=a.toLowerCase();if(b.includes("opera/")||b.includes("opr/")||b.includes("opios/"))return"Opera";{if(jg(b))return"IEMobile";if(b.includes("msie")||b.includes("trident/"))return"IE";if(b.includes("edge/"))return"Edge";if(jd(b))return"Firefox";if(b.includes("silk/"))return"Silk";if(ji(b))return"Blackberry";if(jj(b))return"Webos";if(je(b))return"Safari";if((b.includes("chrome/")||jf(b))&&!b.includes("edge/"))return"Chrome";if(jh(b))return"Android";let c=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,d=a.match(c);if((null==d?void 0:d.length)===2)return d[1]}return"Other"}function jd(a=f1()){return/firefox\//i.test(a)}function je(a=f1()){let b=a.toLowerCase();return b.includes("safari/")&&!b.includes("chrome/")&&!b.includes("crios/")&&!b.includes("android")}function jf(a=f1()){return/crios\//i.test(a)}function jg(a=f1()){return/iemobile/i.test(a)}function jh(a=f1()){return/android/i.test(a)}function ji(a=f1()){return/blackberry/i.test(a)}function jj(a=f1()){return/webos/i.test(a)}function jk(a,b=[]){let c;switch(a){case"Browser":c=jc(f1());break;case"Worker":c=`${jc(f1())}-${a}`;break;default:c=a}let d=b.length?b.join(","):"FirebaseCore-web";return`${c}/JsCore/${he}/${d}`}class jl{constructor(a){this.auth=a,this.queue=[]}pushCallback(a,b){let c=b=>new Promise((c,d)=>{try{let d=a(b);c(d)}catch(a){d(a)}});c.onAbort=b,this.queue.push(c);let d=this.queue.length-1;return()=>{this.queue[d]=()=>Promise.resolve()}}async runMiddleware(a){if(this.auth.currentUser===a)return;let b=[];try{for(let c of this.queue)await c(a),c.onAbort&&b.push(c.onAbort)}catch(a){for(let a of(b.reverse(),b))try{a()}catch(a){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==a?void 0:a.message})}}}async function jm(a,b={}){return iE(a,"GET","/v2/passwordPolicy",iD(a,b))}let jn=6;class jo{constructor(a){var b,c,d,e;let f=a.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!=(b=f.minPasswordLength)?b:jn,f.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=f.maxPasswordLength),void 0!==f.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=f.containsLowercaseCharacter),void 0!==f.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=f.containsUppercaseCharacter),void 0!==f.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=f.containsNumericCharacter),void 0!==f.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=f.containsNonAlphanumericCharacter),this.enforcementState=a.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!=(d=null==(c=a.allowedNonAlphanumericCharacters)?void 0:c.join(""))?d:"",this.forceUpgradeOnSignin=null!=(e=a.forceUpgradeOnSignin)&&e,this.schemaVersion=a.schemaVersion}validatePassword(a){var b,c,d,e,f,g;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(a,h),this.validatePasswordCharacterOptions(a,h),h.isValid&&(h.isValid=null==(b=h.meetsMinPasswordLength)||b),h.isValid&&(h.isValid=null==(c=h.meetsMaxPasswordLength)||c),h.isValid&&(h.isValid=null==(d=h.containsLowercaseLetter)||d),h.isValid&&(h.isValid=null==(e=h.containsUppercaseLetter)||e),h.isValid&&(h.isValid=null==(f=h.containsNumericCharacter)||f),h.isValid&&(h.isValid=null==(g=h.containsNonAlphanumericCharacter)||g),h}validatePasswordLengthOptions(a,b){let c=this.customStrengthOptions.minPasswordLength,d=this.customStrengthOptions.maxPasswordLength;c&&(b.meetsMinPasswordLength=a.length>=c),d&&(b.meetsMaxPasswordLength=a.length<=d)}validatePasswordCharacterOptions(a,b){let c;this.updatePasswordCharacterOptionsStatuses(b,!1,!1,!1,!1);for(let d=0;d<a.length;d++)c=a.charAt(d),this.updatePasswordCharacterOptionsStatuses(b,c>="a"&&c<="z",c>="A"&&c<="Z",c>="0"&&c<="9",this.allowedNonAlphanumericCharacters.includes(c))}updatePasswordCharacterOptionsStatuses(a,b,c,d,e){this.customStrengthOptions.containsLowercaseLetter&&(a.containsLowercaseLetter||(a.containsLowercaseLetter=b)),this.customStrengthOptions.containsUppercaseLetter&&(a.containsUppercaseLetter||(a.containsUppercaseLetter=c)),this.customStrengthOptions.containsNumericCharacter&&(a.containsNumericCharacter||(a.containsNumericCharacter=d)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(a.containsNonAlphanumericCharacter||(a.containsNonAlphanumericCharacter=e))}}class jp{constructor(a,b,c,d){this.app=a,this.heartbeatServiceProvider=b,this.appCheckServiceProvider=c,this.config=d,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jr(this),this.idTokenSubscription=new jr(this),this.beforeStateQueue=new jl(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ig,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=a.name,this.clientVersion=d.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(a,b){return b&&(this._popupRedirectResolver=i7(b)),this._initializationPromise=this.queue(async()=>{var c,d,e;if(!this._deleted){if(this.persistenceManager=await jb.create(this,a),null==(c=this._resolvePersistenceManagerAvailable)||c.call(this),!this._deleted){if(null==(d=this._popupRedirectResolver)?void 0:d._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(a){}await this.initializeCurrentUser(b),this.lastNotifiedUid=(null==(e=this.currentUser)?void 0:e.uid)||null,this._deleted||(this._isInitialized=!0)}}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let a=await this.assertedPersistence.getCurrentUser();if(this.currentUser||a){if(this.currentUser&&a&&this.currentUser.uid===a.uid){this._currentUser._assign(a),await this.currentUser.getIdToken();return}await this._updateCurrentUser(a,!0)}}async initializeCurrentUserFromIdToken(a){try{let b=await iP(this,{idToken:a}),c=await i5._fromGetAccountInfoResponse(this,b,a);await this.directlySetCurrentUser(c)}catch(a){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",a),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(a){var b;if(ha(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(b=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(b,b))}):this.directlySetCurrentUser(null)}let c=await this.assertedPersistence.getCurrentUser(),d=c,e=!1;if(a&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let c=null==(b=this.redirectUser)?void 0:b._redirectEventId,f=null==d?void 0:d._redirectEventId,g=await this.tryRedirectSignIn(a);(!c||c===f)&&(null==g?void 0:g.user)&&(d=g.user,e=!0)}if(!d)return this.directlySetCurrentUser(null);if(!d._redirectEventId){if(e)try{await this.beforeStateQueue.runMiddleware(d)}catch(a){d=c,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return d?this.reloadAndSetCurrentUserOrClear(d):this.directlySetCurrentUser(null)}return(iq(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===d._redirectEventId)?this.directlySetCurrentUser(d):this.reloadAndSetCurrentUserOrClear(d)}async tryRedirectSignIn(a){let b=null;try{b=await this._popupRedirectResolver._completeRedirectFn(this,a,!0)}catch(a){await this._setRedirectUser(null)}return b}async reloadAndSetCurrentUserOrClear(a){try{await iZ(a)}catch(a){if((null==a?void 0:a.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(a)}useDeviceLanguage(){this.languageCode=iw()}async _delete(){this._deleted=!0}async updateCurrentUser(a){if(ha(this.app))return Promise.reject(io(this));let b=a?gq(a):null;return b&&iq(b.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(b&&b._clone(this))}async _updateCurrentUser(a,b=!1){if(!this._deleted)return a&&iq(this.tenantId===a.tenantId,this,"tenant-id-mismatch"),b||await this.beforeStateQueue.runMiddleware(a),this.queue(async()=>{await this.directlySetCurrentUser(a),this.notifyAuthListeners()})}async signOut(){return ha(this.app)?Promise.reject(io(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(a){return ha(this.app)?Promise.reject(io(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(i7(a))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(a){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let b=this._getPasswordPolicyInternal();return b.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):b.validatePassword(a)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let a=new jo(await jm(this));null===this.tenantId?this._projectPasswordPolicy=a:this._tenantPasswordPolicies[this.tenantId]=a}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(a){this._errorFactory=new gd("auth","Firebase",a())}onAuthStateChanged(a,b,c){return this.registerStateListener(this.authStateSubscription,a,b,c)}beforeAuthStateChanged(a,b){return this.beforeStateQueue.pushCallback(a,b)}onIdTokenChanged(a,b,c){return this.registerStateListener(this.idTokenSubscription,a,b,c)}authStateReady(){return new Promise((a,b)=>{if(this.currentUser)a();else{let c=this.onAuthStateChanged(()=>{c(),a()},b)}})}async revokeAccessToken(a){if(this.currentUser){let b={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:a,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(b.tenantId=this.tenantId),await i2(this,b)}}toJSON(){var a;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null==(a=this._currentUser)?void 0:a.toJSON()}}async _setRedirectUser(a,b){let c=await this.getOrInitRedirectPersistenceManager(b);return null===a?c.removeCurrentUser():c.setCurrentUser(a)}async getOrInitRedirectPersistenceManager(a){if(!this.redirectPersistenceManager){let b=a&&i7(a)||this._popupRedirectResolver;iq(b,this,"argument-error"),this.redirectPersistenceManager=await jb.create(this,[i7(b._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(a){var b,c;return(this._isInitialized&&await this.queue(async()=>{}),(null==(b=this._currentUser)?void 0:b._redirectEventId)===a)?this._currentUser:(null==(c=this.redirectUser)?void 0:c._redirectEventId)===a?this.redirectUser:null}async _persistUserIfCurrent(a){if(a===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(a))}_notifyListenersIfCurrent(a){a===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var a,b;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let c=null!=(b=null==(a=this.currentUser)?void 0:a.uid)?b:null;this.lastNotifiedUid!==c&&(this.lastNotifiedUid=c,this.authStateSubscription.next(this.currentUser))}registerStateListener(a,b,c,d){if(this._deleted)return()=>{};let e="function"==typeof b?b:b.next.bind(b),f=!1,g=this._isInitialized?Promise.resolve():this._initializationPromise;if(iq(g,this,"internal-error"),g.then(()=>{f||e(this.currentUser)}),"function"==typeof b){let e=a.addObserver(b,c,d);return()=>{f=!0,e()}}{let c=a.addObserver(b);return()=>{f=!0,c()}}}async directlySetCurrentUser(a){this.currentUser&&this.currentUser!==a&&this._currentUser._stopProactiveRefresh(),a&&this.isProactiveRefreshEnabled&&a._startProactiveRefresh(),this.currentUser=a,a?await this.assertedPersistence.setCurrentUser(a):await this.assertedPersistence.removeCurrentUser()}queue(a){return this.operations=this.operations.then(a,a),this.operations}get assertedPersistence(){return iq(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(a){!a||this.frameworks.includes(a)||(this.frameworks.push(a),this.frameworks.sort(),this.clientVersion=jk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var a;let b={"X-Client-Version":this.clientVersion};this.app.options.appId&&(b["X-Firebase-gmpid"]=this.app.options.appId);let c=await (null==(a=this.heartbeatServiceProvider.getImmediate({optional:!0}))?void 0:a.getHeartbeatsHeader());c&&(b["X-Firebase-Client"]=c);let d=await this._getAppCheckToken();return d&&(b["X-Firebase-AppCheck"]=d),b}async _getAppCheckToken(){var a;if(ha(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let b=await (null==(a=this.appCheckServiceProvider.getImmediate({optional:!0}))?void 0:a.getToken());return(null==b?void 0:b.error)&&ii(`Error while retrieving App Check token: ${b.error}`),null==b?void 0:b.token}}function jq(a){return gq(a)}class jr{constructor(a){this.auth=a,this.observer=null,this.addObserver=gm(a=>this.observer=a)}get next(){return iq(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let js={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function jt(a){return js.loadJS(a)}function ju(){return js.recaptchaEnterpriseScript}class jv{constructor(){this.enterprise=new jw}ready(a){a()}execute(a,b){return Promise.resolve("token")}render(a,b){return""}}class jw{ready(a){a()}execute(a,b){return Promise.resolve("token")}render(a,b){return""}}let jx="recaptcha-enterprise",jy="NO_RECAPTCHA";class jz{constructor(a){this.type=jx,this.auth=jq(a)}async verify(a="verify",b=!1){async function c(a){if(!b){if(null==a.tenantId&&null!=a._agentRecaptchaConfig)return a._agentRecaptchaConfig.siteKey;if(null!=a.tenantId&&void 0!==a._tenantRecaptchaConfigs[a.tenantId])return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(b,c)=>{iN(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(void 0===d.recaptchaKey)c(Error("recaptcha Enterprise site key undefined"));else{let c=new iM(d);return null==a.tenantId?a._agentRecaptchaConfig=c:a._tenantRecaptchaConfigs[a.tenantId]=c,b(c.siteKey)}}).catch(a=>{c(a)})})}function d(b,c,d){let e=window.grecaptcha;iL(e)?e.enterprise.ready(()=>{e.enterprise.execute(b,{action:a}).then(a=>{c(a)}).catch(()=>{c(jy)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new jv().execute("siteKey",{action:"verify"}):new Promise((a,e)=>{c(this.auth).then(c=>{if(!b&&iL(window.grecaptcha))d(c,a,e);else{if("undefined"==typeof window)return void e(Error("RecaptchaVerifier is only supported in browser"));let b=ju();0!==b.length&&(b+=c),jt(b).then(()=>{d(c,a,e)}).catch(a=>{e(a)})}}).catch(a=>{e(a)})})}}async function jA(a,b,c,d=!1,e=!1){let f,g=new jz(a);if(e)f=jy;else try{f=await g.verify(c)}catch(a){f=await g.verify(c,!0)}let h=Object.assign({},b);if("mfaSmsEnrollment"===c||"mfaSmsSignIn"===c){if("phoneEnrollmentInfo"in h){let a=h.phoneEnrollmentInfo.phoneNumber,b=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:a,recaptchaToken:b,captchaResponse:f,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){let a=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:a,captchaResponse:f,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return d?Object.assign(h,{captchaResp:f}):Object.assign(h,{captchaResponse:f}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function jB(a,b,c,d,e){var f,g;if("EMAIL_PASSWORD_PROVIDER"===e)if(null==(f=a._getRecaptchaConfig())||!f.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return d(a,b).catch(async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{console.log(`${c} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let e=await jA(a,b,c,"getOobCode"===c);return d(a,e)}});else{let e=await jA(a,b,c,"getOobCode"===c);return d(a,e)}if("PHONE_PROVIDER"!==e)return Promise.reject(e+" provider is not supported.");if(null==(g=a._getRecaptchaConfig())?void 0:g.isProviderEnabled("PHONE_PROVIDER")){let e=await jA(a,b,c);return d(a,e).catch(async e=>{var f;if((null==(f=a._getRecaptchaConfig())?void 0:f.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&("auth/missing-recaptcha-token"===e.code||"auth/invalid-app-credential"===e.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${c} flow.`);let e=await jA(a,b,c,!1,!0);return d(a,e)}return Promise.reject(e)})}{let e=await jA(a,b,c,!1,!0);return d(a,e)}}function jC(a,b){let c=g9(a,"auth");if(c.isInitialized()){let a=c.getImmediate();if(gh(c.getOptions(),null!=b?b:{}))return a;ik(a,"already-initialized")}return c.initialize({options:b})}function jD(a,b){let c=(null==b?void 0:b.persistence)||[],d=(Array.isArray(c)?c:[c]).map(i7);(null==b?void 0:b.errorMap)&&a._updateErrorMap(b.errorMap),a._initializeWithPersistence(d,null==b?void 0:b.popupRedirectResolver)}function jE(a,b,c){let d=jq(a);iq(/^https?:\/\//.test(b),d,"invalid-emulator-scheme");let e=!!(null==c?void 0:c.disableWarnings),f=jF(b),{host:g,port:h}=jG(b),i=null===h?"":`:${h}`,j={url:`${f}//${g}${i}/`},k=Object.freeze({host:g,port:h,protocol:f.replace(":",""),options:Object.freeze({disableWarnings:e})});if(!d._canInitEmulator){iq(d.config.emulator&&d.emulatorConfig,d,"emulator-config-failed"),iq(gh(j,d.config.emulator)&&gh(k,d.emulatorConfig),d,"emulator-config-failed");return}d.config.emulator=j,d.emulatorConfig=k,d.settings.appVerificationDisabledForTesting=!0,fV(g)?(fW(`${f}//${g}${i}`),f0("Auth",!0)):e||jI()}function jF(a){let b=a.indexOf(":");return b<0?"":a.substr(0,b+1)}function jG(a){let b=jF(a),c=/(\/\/)?([^?#/]+)/.exec(a.substr(b.length));if(!c)return{host:"",port:null};let d=c[2].split("@").pop()||"",e=/^(\[[^\]]+\])(:|$)/.exec(d);if(e){let a=e[1];return{host:a,port:jH(d.substr(a.length+1))}}{let[a,b]=d.split(":");return{host:a,port:jH(b)}}}function jH(a){if(!a)return null;let b=Number(a);return isNaN(b)?null:b}function jI(){function a(){let a=document.createElement("p"),b=a.style;a.innerText="Running in emulator mode. Do not use with production credentials.",b.position="fixed",b.width="100%",b.backgroundColor="#ffffff",b.border=".1em solid #000000",b.color="#b50000",b.bottom="0px",b.left="0px",b.margin="0px",b.zIndex="10000",b.textAlign="center",a.classList.add("firebase-emulator-warning"),document.body.appendChild(a)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a())}class jJ{constructor(a,b){this.providerId=a,this.signInMethod=b}toJSON(){return ir("not implemented")}_getIdTokenResponse(a){return ir("not implemented")}_linkToIdToken(a,b){return ir("not implemented")}_getReauthenticationResolver(a){return ir("not implemented")}}async function jK(a,b){return iE(a,"POST","/v1/accounts:resetPassword",iD(a,b))}async function jL(a,b){return iE(a,"POST","/v1/accounts:update",b)}async function jM(a,b){return iE(a,"POST","/v1/accounts:signUp",b)}async function jN(a,b){return iG(a,"POST","/v1/accounts:signInWithPassword",iD(a,b))}async function jO(a,b){return iE(a,"POST","/v1/accounts:sendOobCode",iD(a,b))}async function jP(a,b){return iG(a,"POST","/v1/accounts:signInWithEmailLink",iD(a,b))}async function jQ(a,b){return iG(a,"POST","/v1/accounts:signInWithEmailLink",iD(a,b))}class jR extends jJ{constructor(a,b,c,d=null){super("password",c),this._email=a,this._password=b,this._tenantId=d}static _fromEmailAndPassword(a,b){return new jR(a,b,"password")}static _fromEmailAndCode(a,b,c=null){return new jR(a,b,"emailLink",c)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(a){let b="string"==typeof a?JSON.parse(a):a;if((null==b?void 0:b.email)&&(null==b?void 0:b.password)){if("password"===b.signInMethod)return this._fromEmailAndPassword(b.email,b.password);else if("emailLink"===b.signInMethod)return this._fromEmailAndCode(b.email,b.password,b.tenantId)}return null}async _getIdTokenResponse(a){switch(this.signInMethod){case"password":return jB(a,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",jN,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return jP(a,{email:this._email,oobCode:this._password});default:ik(a,"internal-error")}}async _linkToIdToken(a,b){switch(this.signInMethod){case"password":return jB(a,{idToken:b,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",jM,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return jQ(a,{idToken:b,email:this._email,oobCode:this._password});default:ik(a,"internal-error")}}_getReauthenticationResolver(a){return this._getIdTokenResponse(a)}}async function jS(a,b){return iG(a,"POST","/v1/accounts:signInWithIdp",iD(a,b))}let jT="http://localhost";class jU extends jJ{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(a){let b=new jU(a.providerId,a.signInMethod);return a.idToken||a.accessToken?(a.idToken&&(b.idToken=a.idToken),a.accessToken&&(b.accessToken=a.accessToken),a.nonce&&!a.pendingToken&&(b.nonce=a.nonce),a.pendingToken&&(b.pendingToken=a.pendingToken)):a.oauthToken&&a.oauthTokenSecret?(b.accessToken=a.oauthToken,b.secret=a.oauthTokenSecret):ik("argument-error"),b}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(a){let b="string"==typeof a?JSON.parse(a):a,{providerId:c,signInMethod:d}=b,e=h5(b,["providerId","signInMethod"]);if(!c||!d)return null;let f=new jU(c,d);return f.idToken=e.idToken||void 0,f.accessToken=e.accessToken||void 0,f.secret=e.secret,f.nonce=e.nonce,f.pendingToken=e.pendingToken||null,f}_getIdTokenResponse(a){return jS(a,this.buildRequest())}_linkToIdToken(a,b){let c=this.buildRequest();return c.idToken=b,jS(a,c)}_getReauthenticationResolver(a){let b=this.buildRequest();return b.autoCreate=!1,jS(a,b)}buildRequest(){let a={requestUri:jT,returnSecureToken:!0};if(this.pendingToken)a.pendingToken=this.pendingToken;else{let b={};this.idToken&&(b.id_token=this.idToken),this.accessToken&&(b.access_token=this.accessToken),this.secret&&(b.oauth_token_secret=this.secret),b.providerId=this.providerId,this.nonce&&!this.pendingToken&&(b.nonce=this.nonce),a.postBody=gj(b)}return a}}async function jV(a,b){return iG(a,"POST","/v1/accounts:signInWithPhoneNumber",iD(a,b))}async function jW(a,b){let c=await iG(a,"POST","/v1/accounts:signInWithPhoneNumber",iD(a,b));if(c.temporaryProof)throw iK(a,"account-exists-with-different-credential",c);return c}let jX={USER_NOT_FOUND:"user-not-found"};async function jY(a,b){return iG(a,"POST","/v1/accounts:signInWithPhoneNumber",iD(a,Object.assign(Object.assign({},b),{operation:"REAUTH"})),jX)}class jZ extends jJ{constructor(a){super("phone","phone"),this.params=a}static _fromVerification(a,b){return new jZ({verificationId:a,verificationCode:b})}static _fromTokenResponse(a,b){return new jZ({phoneNumber:a,temporaryProof:b})}_getIdTokenResponse(a){return jV(a,this._makeVerificationRequest())}_linkToIdToken(a,b){return jW(a,Object.assign({idToken:b},this._makeVerificationRequest()))}_getReauthenticationResolver(a){return jY(a,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:a,phoneNumber:b,verificationId:c,verificationCode:d}=this.params;return a&&b?{temporaryProof:a,phoneNumber:b}:{sessionInfo:c,code:d}}toJSON(){let a={providerId:this.providerId};return this.params.phoneNumber&&(a.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(a.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(a.verificationCode=this.params.verificationCode),this.params.verificationId&&(a.verificationId=this.params.verificationId),a}static fromJSON(a){"string"==typeof a&&(a=JSON.parse(a));let{verificationId:b,verificationCode:c,phoneNumber:d,temporaryProof:e}=a;return c||b||d||e?new jZ({verificationId:b,verificationCode:c,phoneNumber:d,temporaryProof:e}):null}}function j$(a){switch(a){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function j_(a){let b=gk(gl(a)).link,c=b?gk(gl(b)).deep_link_id:null,d=gk(gl(a)).deep_link_id;return(d?gk(gl(d)).link:null)||d||c||b||a}class j0{constructor(a){var b,c,d,e,f,g;let h=gk(gl(a)),i=null!=(b=h.apiKey)?b:null,j=null!=(c=h.oobCode)?c:null,k=j$(null!=(d=h.mode)?d:null);iq(i&&j&&k,"argument-error"),this.apiKey=i,this.operation=k,this.code=j,this.continueUrl=null!=(e=h.continueUrl)?e:null,this.languageCode=null!=(f=h.lang)?f:null,this.tenantId=null!=(g=h.tenantId)?g:null}static parseLink(a){let b=j_(a);try{return new j0(b)}catch(a){return null}}}class j1{constructor(){this.providerId=j1.PROVIDER_ID}static credential(a,b){return jR._fromEmailAndPassword(a,b)}static credentialWithLink(a,b){let c=j0.parseLink(b);return iq(c,"argument-error"),jR._fromEmailAndCode(a,c.code,c.tenantId)}}j1.PROVIDER_ID="password",j1.EMAIL_PASSWORD_SIGN_IN_METHOD="password",j1.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class j2{constructor(a){this.providerId=a,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(a){this.defaultLanguageCode=a}setCustomParameters(a){return this.customParameters=a,this}getCustomParameters(){return this.customParameters}}class j3 extends j2{constructor(){super(...arguments),this.scopes=[]}addScope(a){return this.scopes.includes(a)||this.scopes.push(a),this}getScopes(){return[...this.scopes]}}class j4 extends null{static credentialFromJSON(a){let b="string"==typeof a?JSON.parse(a):a;return iq("providerId"in b&&"signInMethod"in b,"argument-error"),jU._fromParams(b)}credential(a){return this._credential(Object.assign(Object.assign({},a),{nonce:a.rawNonce}))}_credential(a){return iq(a.idToken||a.accessToken,"argument-error"),jU._fromParams(Object.assign(Object.assign({},a),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(a){return j4.oauthCredentialFromTaggedObject(a)}static credentialFromError(a){return j4.oauthCredentialFromTaggedObject(a.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;let{oauthIdToken:b,oauthAccessToken:c,oauthTokenSecret:d,pendingToken:e,nonce:f,providerId:g}=a;if(!c&&!d&&!b&&!e||!g)return null;try{return new j4(g)._credential({idToken:b,accessToken:c,nonce:f,pendingToken:e})}catch(a){return null}}}class j5 extends j3{constructor(){super("facebook.com")}static credential(a){return jU._fromParams({providerId:j5.PROVIDER_ID,signInMethod:j5.FACEBOOK_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return j5.credentialFromTaggedObject(a)}static credentialFromError(a){return j5.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return j5.credential(a.oauthAccessToken)}catch(a){return null}}}j5.FACEBOOK_SIGN_IN_METHOD="facebook.com",j5.PROVIDER_ID="facebook.com";class j6 extends j3{constructor(){super("google.com"),this.addScope("profile")}static credential(a,b){return jU._fromParams({providerId:j6.PROVIDER_ID,signInMethod:j6.GOOGLE_SIGN_IN_METHOD,idToken:a,accessToken:b})}static credentialFromResult(a){return j6.credentialFromTaggedObject(a)}static credentialFromError(a){return j6.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;let{oauthIdToken:b,oauthAccessToken:c}=a;if(!b&&!c)return null;try{return j6.credential(b,c)}catch(a){return null}}}j6.GOOGLE_SIGN_IN_METHOD="google.com",j6.PROVIDER_ID="google.com";class j7 extends j3{constructor(){super("github.com")}static credential(a){return jU._fromParams({providerId:j7.PROVIDER_ID,signInMethod:j7.GITHUB_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return j7.credentialFromTaggedObject(a)}static credentialFromError(a){return j7.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return j7.credential(a.oauthAccessToken)}catch(a){return null}}}j7.GITHUB_SIGN_IN_METHOD="github.com",j7.PROVIDER_ID="github.com";let j8="http://localhost";class j9 extends jJ{constructor(a,b){super(a,a),this.pendingToken=b}_getIdTokenResponse(a){return jS(a,this.buildRequest())}_linkToIdToken(a,b){let c=this.buildRequest();return c.idToken=b,jS(a,c)}_getReauthenticationResolver(a){let b=this.buildRequest();return b.autoCreate=!1,jS(a,b)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(a){let{providerId:b,signInMethod:c,pendingToken:d}="string"==typeof a?JSON.parse(a):a;return b&&c&&d&&b===c?new j9(b,d):null}static _create(a,b){return new j9(a,b)}buildRequest(){return{requestUri:j8,returnSecureToken:!0,pendingToken:this.pendingToken}}}let ka="saml.";class kb extends j2{constructor(a){iq(a.startsWith(ka),"argument-error"),super(a)}static credentialFromResult(a){return kb.samlCredentialFromTaggedObject(a)}static credentialFromError(a){return kb.samlCredentialFromTaggedObject(a.customData||{})}static credentialFromJSON(a){let b=j9.fromJSON(a);return iq(b,"argument-error"),b}static samlCredentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;let{pendingToken:b,providerId:c}=a;if(!b||!c)return null;try{return j9._create(c,b)}catch(a){return null}}}class kc extends j3{constructor(){super("twitter.com")}static credential(a,b){return jU._fromParams({providerId:kc.PROVIDER_ID,signInMethod:kc.TWITTER_SIGN_IN_METHOD,oauthToken:a,oauthTokenSecret:b})}static credentialFromResult(a){return kc.credentialFromTaggedObject(a)}static credentialFromError(a){return kc.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;let{oauthAccessToken:b,oauthTokenSecret:c}=a;if(!b||!c)return null;try{return kc.credential(b,c)}catch(a){return null}}}kc.TWITTER_SIGN_IN_METHOD="twitter.com",kc.PROVIDER_ID="twitter.com";class kd{constructor(a){this.user=a.user,this.providerId=a.providerId,this._tokenResponse=a._tokenResponse,this.operationType=a.operationType}static async _fromIdTokenResponse(a,b,c,d=!1){return new kd({user:await i5._fromIdTokenResponse(a,c,d),providerId:ke(c),_tokenResponse:c,operationType:b})}static async _forOperation(a,b,c){return await a._updateTokensIfNecessary(c,!0),new kd({user:a,providerId:ke(c),_tokenResponse:c,operationType:b})}}function ke(a){return a.providerId?a.providerId:"phoneNumber"in a?"phone":null}class kf extends gc{constructor(a,b,c,d){var e;super(b.code,b.message),this.operationType=c,this.user=d,Object.setPrototypeOf(this,kf.prototype),this.customData={appName:a.name,tenantId:null!=(e=a.tenantId)?e:void 0,_serverResponse:b.customData._serverResponse,operationType:c}}static _fromErrorAndOperation(a,b,c,d){return new kf(a,b,c,d)}}function kg(a,b,c,d){return("reauthenticate"===b?c._getReauthenticationResolver(a):c._getIdTokenResponse(a)).catch(c=>{if("auth/multi-factor-auth-required"===c.code)throw kf._fromErrorAndOperation(a,c,b,d);throw c})}function kh(a){return new Set(a.map(({providerId:a})=>a).filter(a=>!!a))}async function ki(a,b,c=!1){if(_isFirebaseServerApp(a.app))return Promise.reject(io(a));let d="signIn",e=await kg(a,d,b),f=await kd._fromIdTokenResponse(a,d,e);return c||await a._updateCurrentUser(f.user),f}class kj{constructor(a,b){this.factorId=a,this.uid=b.mfaEnrollmentId,this.enrollmentTime=new Date(b.enrolledAt).toUTCString(),this.displayName=b.displayName}static _fromServerResponse(a,b){return"phoneInfo"in b?kk._fromServerResponse(a,b):"totpInfo"in b?kl._fromServerResponse(a,b):ik(a,"internal-error")}}class kk extends kj{constructor(a){super("phone",a),this.phoneNumber=a.phoneInfo}static _fromServerResponse(a,b){return new kk(b)}}class kl extends kj{constructor(a){super("totp",a)}static _fromServerResponse(a,b){return new kl(b)}}class km{constructor(a,b,c={}){this.isNewUser=a,this.providerId=b,this.profile=c}}class kn extends km{constructor(a,b,c,d){super(a,b,c),this.username=d}}class ko extends km{constructor(a,b){super(a,"facebook.com",b)}}class kp extends kn{constructor(a,b){super(a,"github.com",b,"string"==typeof(null==b?void 0:b.login)?null==b?void 0:b.login:null)}}class kq extends km{constructor(a,b){super(a,"google.com",b)}}class kr extends kn{constructor(a,b,c){super(a,"twitter.com",b,c)}}class ks{constructor(a,b,c){this.type=a,this.credential=b,this.user=c}static _fromIdtoken(a,b){return new ks("enroll",a,b)}static _fromMfaPendingCredential(a){return new ks("signin",a)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(a){var b,c;if(null==a?void 0:a.multiFactorSession){if(null==(b=a.multiFactorSession)?void 0:b.pendingCredential)return ks._fromMfaPendingCredential(a.multiFactorSession.pendingCredential);else if(null==(c=a.multiFactorSession)?void 0:c.idToken)return ks._fromIdtoken(a.multiFactorSession.idToken)}return null}}class kt{constructor(a,b,c){this.session=a,this.hints=b,this.signInResolver=c}static _fromError(a,b){let c=jq(a),d=b.customData._serverResponse,e=(d.mfaInfo||[]).map(a=>kj._fromServerResponse(c,a));iq(d.mfaPendingCredential,c,"internal-error");let f=ks._fromMfaPendingCredential(d.mfaPendingCredential);return new kt(f,e,async a=>{let e=await a._process(c,f);delete d.mfaInfo,delete d.mfaPendingCredential;let g=Object.assign(Object.assign({},d),{idToken:e.idToken,refreshToken:e.refreshToken});switch(b.operationType){case"signIn":let h=await kd._fromIdTokenResponse(c,b.operationType,g);return await c._updateCurrentUser(h.user),h;case"reauthenticate":return iq(b.user,c,"internal-error"),kd._forOperation(b.user,b.operationType,g);default:ik(c,"internal-error")}})}async resolveSignIn(a){let b=a;return this.signInResolver(b)}}function ku(a,b){return iE(a,"POST","/v2/accounts/mfaEnrollment:start",iD(a,b))}function kv(a,b){return iE(a,"POST","/v2/accounts/mfaEnrollment:finalize",iD(a,b))}function kw(a,b){return iE(a,"POST","/v2/accounts/mfaEnrollment:withdraw",iD(a,b))}class kx{constructor(a){this.user=a,this.enrolledFactors=[],a._onReload(b=>{b.mfaInfo&&(this.enrolledFactors=b.mfaInfo.map(b=>kj._fromServerResponse(a.auth,b)))})}static _fromUser(a){return new kx(a)}async getSession(){return ks._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(a,b){let c=a,d=await this.getSession(),e=await iV(this.user,c._process(this.user.auth,d,b));return await this.user._updateTokensIfNecessary(e),this.user.reload()}async unenroll(a){let b="string"==typeof a?a:a.uid,c=await this.user.getIdToken();try{let a=await iV(this.user,kw(this.user.auth,{idToken:c,mfaEnrollmentId:b}));this.enrolledFactors=this.enrolledFactors.filter(({uid:a})=>a!==b),await this.user._updateTokensIfNecessary(a),await this.user.reload()}catch(a){throw a}}}new WeakMap;var ky="@firebase/auth",kz="1.10.8";class kA{constructor(a){this.auth=a,this.internalListeners=new Map}getUid(){var a;return this.assertAuthConfigured(),(null==(a=this.auth.currentUser)?void 0:a.uid)||null}async getToken(a){return(this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser)?{accessToken:await this.auth.currentUser.getIdToken(a)}:null}addAuthTokenListener(a){if(this.assertAuthConfigured(),this.internalListeners.has(a))return;let b=this.auth.onIdTokenChanged(b=>{a((null==b?void 0:b.stsTokenManager.accessToken)||null)});this.internalListeners.set(a,b),this.updateProactiveRefresh()}removeAuthTokenListener(a){this.assertAuthConfigured();let b=this.internalListeners.get(a);b&&(this.internalListeners.delete(a),b(),this.updateProactiveRefresh())}assertAuthConfigured(){iq(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function kB(a){switch(a){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kC(a){g8(new gr("auth",(b,{options:c})=>{let d=b.getProvider("app").getImmediate(),e=b.getProvider("heartbeat"),f=b.getProvider("app-check-internal"),{apiKey:g,authDomain:h}=d.options;iq(g&&!g.includes(":"),"invalid-api-key",{appName:d.name});let i=new jp(d,e,f,{apiKey:g,authDomain:h,clientPlatform:a,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jk(a)});return jD(i,c),i},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((a,b,c)=>{a.getProvider("auth-internal").initialize()})),g8(new gr("auth-internal",a=>new kA(jq(a.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),hj(ky,kz,kB(a)),hj(ky,kz,"esm2017")}function kD(a=hg()){let b=g9(a,"auth");if(b.isInitialized())return b.getImmediate();let c=jC(a),d=fR("auth");return d&&jE(c,`http://${d}`),c}function kE(a,b){return iE(a,"POST","/v2/accounts/mfaSignIn:finalize",iD(a,b))}iz.initialize(fetch,Headers,Response),kC("Node"),il("operation-not-supported-in-this-environment"),jp.prototype.setPersistence=async()=>{};class kF{constructor(a){this.factorId=a}_process(a,b,c){switch(b.type){case"enroll":return this._finalizeEnroll(a,b.credential,c);case"signin":return this._finalizeSignIn(a,b.credential);default:return ir("unexpected MultiFactorSessionType")}}}class kG{static assertionForEnrollment(a,b){return kH._fromSecret(a,b)}static assertionForSignIn(a,b){return kH._fromEnrollmentId(a,b)}static async generateSecret(a){var b;let c=a;iq(void 0!==(null==(b=c.user)?void 0:b.auth),"internal-error");let d=await ku(c.user.auth,{idToken:c.credential,totpEnrollmentInfo:{}});return kI._fromStartTotpMfaEnrollmentResponse(d,c.user.auth)}}kG.FACTOR_ID="totp";class kH extends kF{constructor(a,b,c){super("totp"),this.otp=a,this.enrollmentId=b,this.secret=c}static _fromSecret(a,b){return new kH(b,void 0,a)}static _fromEnrollmentId(a,b){return new kH(b,a)}async _finalizeEnroll(a,b,c){return iq(void 0!==this.secret,a,"argument-error"),kv(a,{idToken:b,displayName:c,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(a,b){iq(void 0!==this.enrollmentId&&void 0!==this.otp,a,"argument-error");let c={verificationCode:this.otp};return kE(a,{mfaPendingCredential:b,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:c})}}class kI{constructor(a,b,c,d,e,f,g){this.sessionInfo=f,this.auth=g,this.secretKey=a,this.hashingAlgorithm=b,this.codeLength=c,this.codeIntervalSeconds=d,this.enrollmentCompletionDeadline=e}static _fromStartTotpMfaEnrollmentResponse(a,b){return new kI(a.totpSessionInfo.sharedSecretKey,a.totpSessionInfo.hashingAlgorithm,a.totpSessionInfo.verificationCodeLength,a.totpSessionInfo.periodSec,new Date(a.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),a.totpSessionInfo.sessionInfo,b)}_makeTotpVerificationInfo(a){return{sessionInfo:this.sessionInfo,verificationCode:a}}generateQrCodeUrl(a,b){var c;let d=!1;return(kJ(a)||kJ(b))&&(d=!0),d&&(kJ(a)&&(a=(null==(c=this.auth.currentUser)?void 0:c.email)||"unknownuser"),kJ(b)&&(b=this.auth.name)),`otpauth://totp/${b}:${a}?secret=${this.secretKey}&issuer=${b}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function kJ(a){return void 0===a||(null==a?void 0:a.length)===0}var kK=c(28354),kL="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},kM={};(function(){function a(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function b(a,b,c){c||(c=0);var d=Array(16);if("string"==typeof b)for(var e=0;16>e;++e)d[e]=b.charCodeAt(c++)|b.charCodeAt(c++)<<8|b.charCodeAt(c++)<<16|b.charCodeAt(c++)<<24;else for(e=0;16>e;++e)d[e]=b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24;b=a.g[0],c=a.g[1],e=a.g[2];var f=a.g[3],g=b+(f^c&(e^f))+d[0]+0xd76aa478|0;g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[1]+0xe8c7b756|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[2]+0x242070db|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[3]+0xc1bdceee|0,g=b+(f^(c=e+(g<<22|g>>>10))&(e^f))+d[4]+0xf57c0faf|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[5]+0x4787c62a|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[6]+0xa8304613|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[7]+0xfd469501|0,g=b+(f^(c=e+(g<<22|g>>>10))&(e^f))+d[8]+0x698098d8|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[9]+0x8b44f7af|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[10]+0xffff5bb1|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[11]+0x895cd7be|0,g=b+(f^(c=e+(g<<22|g>>>10))&(e^f))+d[12]+0x6b901122|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[13]+0xfd987193|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[14]+0xa679438e|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[15]+0x49b40821|0,c=e+(g<<22|g>>>10),g=b+(e^f&(c^e))+d[1]+0xf61e2562|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[6]+0xc040b340|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[11]+0x265e5a51|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[0]+0xe9b6c7aa|0,c=e+(g<<20|g>>>12),g=b+(e^f&(c^e))+d[5]+0xd62f105d|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[10]+0x2441453|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[15]+0xd8a1e681|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[4]+0xe7d3fbc8|0,c=e+(g<<20|g>>>12),g=b+(e^f&(c^e))+d[9]+0x21e1cde6|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[14]+0xc33707d6|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[3]+0xf4d50d87|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[8]+0x455a14ed|0,c=e+(g<<20|g>>>12),g=b+(e^f&(c^e))+d[13]+0xa9e3e905|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[2]+0xfcefa3f8|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[7]+0x676f02d9|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[12]+0x8d2a4c8a|0,g=b+((c=e+(g<<20|g>>>12))^e^f)+d[5]+0xfffa3942|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[8]+0x8771f681|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[11]+0x6d9d6122|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[14]+0xfde5380c|0,g=b+((c=e+(g<<23|g>>>9))^e^f)+d[1]+0xa4beea44|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[4]+0x4bdecfa9|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[7]+0xf6bb4b60|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[10]+0xbebfbc70|0,g=b+((c=e+(g<<23|g>>>9))^e^f)+d[13]+0x289b7ec6|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[0]+0xeaa127fa|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[3]+0xd4ef3085|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[6]+0x4881d05|0,g=b+((c=e+(g<<23|g>>>9))^e^f)+d[9]+0xd9d4d039|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[12]+0xe6db99e5|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[15]+0x1fa27cf8|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[2]+0xc4ac5665|0,c=e+(g<<23|g>>>9),g=b+(e^(c|~f))+d[0]+0xf4292244|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[7]+0x432aff97|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[14]+0xab9423a7|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[5]+0xfc93a039|0,c=e+(g<<21|g>>>11),g=b+(e^(c|~f))+d[12]+0x655b59c3|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[3]+0x8f0ccc92|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[10]+0xffeff47d|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[1]+0x85845dd1|0,c=e+(g<<21|g>>>11),g=b+(e^(c|~f))+d[8]+0x6fa87e4f|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[15]+0xfe2ce6e0|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[6]+0xa3014314|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[13]+0x4e0811a1|0,c=e+(g<<21|g>>>11),g=b+(e^(c|~f))+d[4]+0xf7537e82|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[11]+0xbd3af235|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[2]+0x2ad7d2bb|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[9]+0xeb86d391|0,a.g[0]=a.g[0]+b|0,a.g[1]=a.g[1]+(e+(g<<21|g>>>11))|0,a.g[2]=a.g[2]+e|0,a.g[3]=a.g[3]+f|0}function c(a,b){var c=f;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b(a)}function d(a,b){this.h=b;for(var c=[],d=!0,e=a.length-1;0<=e;e--){var f=0|a[e];d&&f==b||(c[e]=f,d=!1)}this.g=c}(function(a,b){function c(){}c.prototype=b.prototype,a.D=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.C=function(a,c,d){for(var e=Array(arguments.length-2),f=2;f<arguments.length;f++)e[f-2]=arguments[f];return b.prototype[c].apply(a,e)}})(a,function(){this.blockSize=-1}),a.prototype.s=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},a.prototype.u=function(a,c){void 0===c&&(c=a.length);for(var d=c-this.blockSize,e=this.B,f=this.h,g=0;g<c;){if(0==f)for(;g<=d;)b(this,a,g),g+=this.blockSize;if("string"==typeof a){for(;g<c;)if(e[f++]=a.charCodeAt(g++),f==this.blockSize){b(this,e),f=0;break}}else for(;g<c;)if(e[f++]=a[g++],f==this.blockSize){b(this,e),f=0;break}}this.h=f,this.o+=c},a.prototype.v=function(){var a=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);a[0]=128;for(var b=1;b<a.length-8;++b)a[b]=0;var c=8*this.o;for(b=a.length-8;b<a.length;++b)a[b]=255&c,c/=256;for(this.u(a),a=Array(16),b=c=0;4>b;++b)for(var d=0;32>d;d+=8)a[c++]=this.g[b]>>>d&255;return a};var e,f={};function i(a){return -128<=a&&128>a?c(a,function(a){return new d([0|a],0>a?-1:0)}):new d([0|a],0>a?-1:0)}function j(a){if(isNaN(a)||!isFinite(a))return l;if(0>a)return q(j(-a));for(var b=[],c=1,e=0;a>=c;e++)b[e]=a/c|0,c*=0x100000000;return new d(b,0)}function k(a,b){if(0==a.length)throw Error("number format error: empty string");if(2>(b=b||10)||36<b)throw Error("radix out of range: "+b);if("-"==a.charAt(0))return q(k(a.substring(1),b));if(0<=a.indexOf("-"))throw Error('number format error: interior "-" character');for(var c=j(Math.pow(b,8)),d=l,e=0;e<a.length;e+=8){var f=Math.min(8,a.length-e),g=parseInt(a.substring(e,e+f),b);8>f?(f=j(Math.pow(b,f)),d=d.j(f).add(j(g))):d=(d=d.j(c)).add(j(g))}return d}var l=i(0),m=i(1),n=i(0x1000000);function o(a){if(0!=a.h)return!1;for(var b=0;b<a.g.length;b++)if(0!=a.g[b])return!1;return!0}function p(a){return -1==a.h}function q(a){for(var b=a.g.length,c=[],e=0;e<b;e++)c[e]=~a.g[e];return new d(c,~a.h).add(m)}function r(a,b){return a.add(q(b))}function s(a,b){for(;(65535&a[b])!=a[b];)a[b+1]+=a[b]>>>16,a[b]&=65535,b++}function t(a,b){this.g=a,this.h=b}function u(a,b){if(o(b))throw Error("division by zero");if(o(a))return new t(l,l);if(p(a))return b=u(q(a),b),new t(q(b.g),q(b.h));if(p(b))return b=u(a,q(b)),new t(q(b.g),b.h);if(30<a.g.length){if(p(a)||p(b))throw Error("slowDivide_ only works with positive integers.");for(var c=m,d=b;0>=d.l(a);)c=v(c),d=v(d);var e=w(c,1),f=w(d,1);for(d=w(d,2),c=w(c,2);!o(d);){var g=f.add(d);0>=g.l(a)&&(e=e.add(c),f=g),d=w(d,1),c=w(c,1)}return b=r(a,e.j(b)),new t(e,b)}for(e=l;0<=a.l(b);){for(d=48>=(d=Math.ceil(Math.log(c=Math.max(1,Math.floor(a.m()/b.m())))/Math.LN2))?1:Math.pow(2,d-48),g=(f=j(c)).j(b);p(g)||0<g.l(a);)c-=d,g=(f=j(c)).j(b);o(f)&&(f=m),e=e.add(f),a=r(a,g)}return new t(e,a)}function v(a){for(var b=a.g.length+1,c=[],e=0;e<b;e++)c[e]=a.i(e)<<1|a.i(e-1)>>>31;return new d(c,a.h)}function w(a,b){var c=b>>5;b%=32;for(var e=a.g.length-c,f=[],g=0;g<e;g++)f[g]=0<b?a.i(g+c)>>>b|a.i(g+c+1)<<32-b:a.i(g+c);return new d(f,a.h)}(e=d.prototype).m=function(){if(p(this))return-q(this).m();for(var a=0,b=1,c=0;c<this.g.length;c++){var d=this.i(c);a+=(0<=d?d:0x100000000+d)*b,b*=0x100000000}return a},e.toString=function(a){if(2>(a=a||10)||36<a)throw Error("radix out of range: "+a);if(o(this))return"0";if(p(this))return"-"+q(this).toString(a);for(var b=j(Math.pow(a,6)),c=this,d="";;){var e=u(c,b).g,f=((0<(c=r(c,e.j(b))).g.length?c.g[0]:c.h)>>>0).toString(a);if(o(c=e))return f+d;for(;6>f.length;)f="0"+f;d=f+d}},e.i=function(a){return 0>a?0:a<this.g.length?this.g[a]:this.h},e.l=function(a){return p(a=r(this,a))?-1:+!o(a)},e.abs=function(){return p(this)?q(this):this},e.add=function(a){for(var b=Math.max(this.g.length,a.g.length),c=[],e=0,f=0;f<=b;f++){var g=e+(65535&this.i(f))+(65535&a.i(f)),h=(g>>>16)+(this.i(f)>>>16)+(a.i(f)>>>16);e=h>>>16,g&=65535,h&=65535,c[f]=h<<16|g}return new d(c,-0x80000000&c[c.length-1]?-1:0)},e.j=function(a){if(o(this)||o(a))return l;if(p(this))return p(a)?q(this).j(q(a)):q(q(this).j(a));if(p(a))return q(this.j(q(a)));if(0>this.l(n)&&0>a.l(n))return j(this.m()*a.m());for(var b=this.g.length+a.g.length,c=[],e=0;e<2*b;e++)c[e]=0;for(e=0;e<this.g.length;e++)for(var f=0;f<a.g.length;f++){var g=this.i(e)>>>16,h=65535&this.i(e),i=a.i(f)>>>16,k=65535&a.i(f);c[2*e+2*f]+=h*k,s(c,2*e+2*f),c[2*e+2*f+1]+=g*k,s(c,2*e+2*f+1),c[2*e+2*f+1]+=h*i,s(c,2*e+2*f+1),c[2*e+2*f+2]+=g*i,s(c,2*e+2*f+2)}for(e=0;e<b;e++)c[e]=c[2*e+1]<<16|c[2*e];for(e=b;e<2*b;e++)c[e]=0;return new d(c,0)},e.A=function(a){return u(this,a).h},e.and=function(a){for(var b=Math.max(this.g.length,a.g.length),c=[],e=0;e<b;e++)c[e]=this.i(e)&a.i(e);return new d(c,this.h&a.h)},e.or=function(a){for(var b=Math.max(this.g.length,a.g.length),c=[],e=0;e<b;e++)c[e]=this.i(e)|a.i(e);return new d(c,this.h|a.h)},e.xor=function(a){for(var b=Math.max(this.g.length,a.g.length),c=[],e=0;e<b;e++)c[e]=this.i(e)^a.i(e);return new d(c,this.h^a.h)},a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,h=kM.Md5=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=j,d.fromString=k,g=kM.Integer=d}).apply(void 0!==kL?kL:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var kN=c(32592),kO=c(69602);let kP="@firebase/firestore",kQ="4.8.0";class kR{constructor(a){this.uid=a}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(a){return a.uid===this.uid}}kR.UNAUTHENTICATED=new kR(null),kR.GOOGLE_CREDENTIALS=new kR("google-credentials-uid"),kR.FIRST_PARTY=new kR("first-party-uid"),kR.MOCK_USER=new kR("mock-user");let kS="11.10.0";function kT(a){kS=a}function kU(a){return(0,kK.inspect)(a,{depth:100})}let kV=new gC("@firebase/firestore");function kW(){return kV.logLevel}function kX(a,...b){if(kV.logLevel<=f.DEBUG){let c=b.map(k$);kV.debug(`Firestore (${kS}): ${a}`,...c)}}function kY(a,...b){if(kV.logLevel<=f.ERROR){let c=b.map(k$);kV.error(`Firestore (${kS}): ${a}`,...c)}}function kZ(a,...b){if(kV.logLevel<=f.WARN){let c=b.map(k$);kV.warn(`Firestore (${kS}): ${a}`,...c)}}function k$(a){if("string"==typeof a)return a;try{return kU(a)}catch(b){return a}}function k_(a,b,c){let d="Unexpected state";"string"==typeof b?d=b:c=b,k0(a,d,c)}function k0(a,b,c){let d=`FIRESTORE (${kS}) INTERNAL ASSERTION FAILED: ${b} (ID: ${a.toString(16)})`;if(void 0!==c)try{let a=JSON.stringify(c);d+=" CONTEXT: "+a}catch(a){d+=" CONTEXT: "+c}throw kY(d),Error(d)}function k1(a,b,c,d){let e="Unexpected state";"string"==typeof c?e=c:d=c,a||k0(b,e,d)}function k2(a,b){return a}let k3={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k4 extends gc{constructor(a,b){super(a,b),this.code=a,this.message=b,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class k5{constructor(){this.promise=new Promise((a,b)=>{this.resolve=a,this.reject=b})}}class k6{constructor(a,b){this.user=b,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${a}`)}}class k7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(a,b){a.enqueueRetryable(()=>b(kR.UNAUTHENTICATED))}shutdown(){}}class k8{constructor(a){this.token=a,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(a,b){this.changeListener=b,a.enqueueRetryable(()=>b(this.token.user))}shutdown(){this.changeListener=null}}class k9{constructor(a){this.authProvider=a,this.currentUser=kR.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(a,b){k1(void 0===this.tokenListener,42304);let c=this.tokenCounter,d=a=>this.tokenCounter!==c?(c=this.tokenCounter,b(a)):Promise.resolve(),e=new k5;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),e.resolve(),e=new k5,a.enqueueRetryable(()=>d(this.currentUser))};let f=()=>{let b=e;a.enqueueRetryable(async()=>{await b.promise,await d(this.currentUser)})},g=a=>{kX("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=a,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),f())};this.authProvider.onInit(a=>g(a)),setTimeout(()=>{if(!this.auth){let a=this.authProvider.getImmediate({optional:!0});a?g(a):(kX("FirebaseAuthCredentialsProvider","Auth not yet detected"),e.resolve(),e=new k5)}},0),f()}getToken(){let a=this.tokenCounter,b=this.forceRefresh;return(this.forceRefresh=!1,this.auth)?this.auth.getToken(b).then(b=>this.tokenCounter!==a?(kX("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):b?(k1("string"==typeof b.accessToken,31837,{tokenData:b}),new k6(b.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let a=this.auth&&this.auth.getUid();return k1(null===a||"string"==typeof a,2055,{currentUid:a}),new kR(a)}}class la{constructor(a,b,c){this.sessionIndex=a,this.iamToken=b,this.authTokenFactory=c,this.type="FirstParty",this.user=kR.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let a=this.getAuthToken();return a&&this._headers.set("Authorization",a),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}}class lb{constructor(a,b,c){this.sessionIndex=a,this.iamToken=b,this.authTokenFactory=c}getToken(){return Promise.resolve(new la(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(a,b){a.enqueueRetryable(()=>b(kR.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class lc{constructor(a){this.value=a,this.type="AppCheck",this.headers=new Map,a&&a.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ld{constructor(a,b){this.appCheckProvider=b,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null,this.serverAppAppCheckToken=null,ha(a)&&a.settings.appCheckToken&&(this.serverAppAppCheckToken=a.settings.appCheckToken)}start(a,b){k1(void 0===this.tokenListener,3512);let c=a=>{null!=a.error&&kX("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);let c=a.token!==this.latestAppCheckToken;return this.latestAppCheckToken=a.token,kX("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?b(a.token):Promise.resolve()};this.tokenListener=b=>{a.enqueueRetryable(()=>c(b))};let d=a=>{kX("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(a=>d(a)),setTimeout(()=>{if(!this.appCheck){let a=this.appCheckProvider.getImmediate({optional:!0});a?d(a):kX("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.serverAppAppCheckToken)return Promise.resolve(new lc(this.serverAppAppCheckToken));let a=this.forceRefresh;return(this.forceRefresh=!1,this.appCheck)?this.appCheck.getToken(a).then(a=>a?(k1("string"==typeof a.token,44558,{tokenResult:a}),this.latestAppCheckToken=a.token,new lc(a.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}}function le(a){if(!a)return new k7;switch(a.type){case"firstParty":return new lb(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new k4(k3.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function lf(a){return(0,E.randomBytes)(a)}function lg(){return new kK.TextEncoder}function lh(){return new TextDecoder("utf-8")}class li{static newId(){let a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=Math.floor(256/a.length)*a.length,c="",d=20;for(;c.length<d;){let e=lf(40);for(let f=0;f<e.length;++f)c.length<d&&e[f]<b&&(c+=a.charAt(e[f]%a.length))}return c}}function lj(a,b){return a<b?-1:+(a>b)}function lk(a,b){let c=0;for(;c<a.length&&c<b.length;){let d=a.codePointAt(c),e=b.codePointAt(c);if(d!==e)if(d<128&&e<128)return lj(d,e);else{let f=lg(),g=lm(f.encode(ll(a,c)),f.encode(ll(b,c)));if(0!==g)return g;return lj(d,e)}c+=d>65535?2:1}return lj(a.length,b.length)}function ll(a,b){return a.codePointAt(b)>65535?a.substring(b,b+2):a.substring(b,b+1)}function lm(a,b){for(let c=0;c<a.length&&c<b.length;++c)if(a[c]!==b[c])return lj(a[c],b[c]);return lj(a.length,b.length)}function ln(a,b,c){return a.length===b.length&&a.every((a,d)=>c(a,b[d]))}function lo(a){return a+"\0"}let lp="__name__";class lq{constructor(a,b,c){void 0===b?b=0:b>a.length&&k_(637,{offset:b,range:a.length}),void 0===c?c=a.length-b:c>a.length-b&&k_(1746,{length:c,range:a.length-b}),this.segments=a,this.offset=b,this.len=c}get length(){return this.len}isEqual(a){return 0===lq.comparator(this,a)}child(a){let b=this.segments.slice(this.offset,this.limit());return a instanceof lq?a.forEach(a=>{b.push(a)}):b.push(a),this.construct(b)}limit(){return this.offset+this.length}popFirst(a){return a=void 0===a?1:a,this.construct(this.segments,this.offset+a,this.length-a)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(a){return this.segments[this.offset+a]}isEmpty(){return 0===this.length}isPrefixOf(a){if(a.length<this.length)return!1;for(let b=0;b<this.length;b++)if(this.get(b)!==a.get(b))return!1;return!0}isImmediateParentOf(a){if(this.length+1!==a.length)return!1;for(let b=0;b<this.length;b++)if(this.get(b)!==a.get(b))return!1;return!0}forEach(a){for(let b=this.offset,c=this.limit();b<c;b++)a(this.segments[b])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(a,b){let c=Math.min(a.length,b.length);for(let d=0;d<c;d++){let c=lq.compareSegments(a.get(d),b.get(d));if(0!==c)return c}return lj(a.length,b.length)}static compareSegments(a,b){let c=lq.isNumericId(a),d=lq.isNumericId(b);return c&&!d?-1:!c&&d?1:c&&d?lq.extractNumericId(a).compare(lq.extractNumericId(b)):lk(a,b)}static isNumericId(a){return a.startsWith("__id")&&a.endsWith("__")}static extractNumericId(a){return g.fromString(a.substring(4,a.length-2))}}class lr extends lq{construct(a,b,c){return new lr(a,b,c)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...a){let b=[];for(let c of a){if(c.indexOf("//")>=0)throw new k4(k3.INVALID_ARGUMENT,`Invalid segment (${c}). Paths must not contain // in them.`);b.push(...c.split("/").filter(a=>a.length>0))}return new lr(b)}static emptyPath(){return new lr([])}}let ls=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class lt extends lq{construct(a,b,c){return new lt(a,b,c)}static isValidIdentifier(a){return ls.test(a)}canonicalString(){return this.toArray().map(a=>(a=a.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),lt.isValidIdentifier(a)||(a="`"+a+"`"),a)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===lp}static keyField(){return new lt([lp])}static fromServerFormat(a){let b=[],c="",d=0,e=()=>{if(0===c.length)throw new k4(k3.INVALID_ARGUMENT,`Invalid field path (${a}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);b.push(c),c=""},f=!1;for(;d<a.length;){let b=a[d];if("\\"===b){if(d+1===a.length)throw new k4(k3.INVALID_ARGUMENT,"Path has trailing escape character: "+a);let b=a[d+1];if("\\"!==b&&"."!==b&&"`"!==b)throw new k4(k3.INVALID_ARGUMENT,"Path has invalid escape sequence: "+a);c+=b,d+=2}else"`"===b?f=!f:"."!==b||f?c+=b:e(),d++}if(e(),f)throw new k4(k3.INVALID_ARGUMENT,"Unterminated ` in path: "+a);return new lt(b)}static emptyPath(){return new lt([])}}class lu{constructor(a){this.path=a}static fromPath(a){return new lu(lr.fromString(a))}static fromName(a){return new lu(lr.fromString(a).popFirst(5))}static empty(){return new lu(lr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(a){return this.path.length>=2&&this.path.get(this.path.length-2)===a}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(a){return null!==a&&0===lr.comparator(this.path,a.path)}toString(){return this.path.toString()}static comparator(a,b){return lr.comparator(a.path,b.path)}static isDocumentKey(a){return a.length%2==0}static fromSegments(a){return new lu(new lr(a.slice()))}}function lv(a,b,c){if(!c)throw new k4(k3.INVALID_ARGUMENT,`Function ${a}() cannot be called with an empty ${b}.`)}function lw(a,b,c,d){if(!0===b&&!0===d)throw new k4(k3.INVALID_ARGUMENT,`${a} and ${c} cannot be used together.`)}function lx(a){if(!lu.isDocumentKey(a))throw new k4(k3.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${a} has ${a.length}.`)}function ly(a){return"object"==typeof a&&null!==a&&(Object.getPrototypeOf(a)===Object.prototype||null===Object.getPrototypeOf(a))}function lz(a){if(void 0===a)return"undefined";if(null===a)return"null";if("string"==typeof a)return a.length>20&&(a=`${a.substring(0,20)}...`),JSON.stringify(a);if("number"==typeof a||"boolean"==typeof a)return""+a;if("object"==typeof a)if(a instanceof Array)return"an array";else{let b=lA(a);return b?`a custom ${b} object`:"an object"}else if("function"==typeof a)return"a function";else return k_(12329,{type:typeof a})}function lA(a){return a.constructor?a.constructor.name:null}function lB(a,b){if("_delegate"in a&&(a=a._delegate),!(a instanceof b))if(b.name===a.constructor.name)throw new k4(k3.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");else{let c=lz(a);throw new k4(k3.INVALID_ARGUMENT,`Expected type '${b.name}', but it was: ${c}`)}return a}function lC(a,b){let c={typeString:a};return b&&(c.value=b),c}function lD(a,b){let c;if(!ly(a))throw new k4(k3.INVALID_ARGUMENT,"JSON must be an object");for(let d in b)if(b[d]){let e=b[d].typeString,f="value"in b[d]?{value:b[d].value}:void 0;if(!(d in a)){c=`JSON missing required field: '${d}'`;break}let g=a[d];if(e&&typeof g!==e){c=`JSON field '${d}' must be a ${e}.`;break}if(void 0!==f&&g!==f.value){c=`Expected '${d}' field to equal '${f.value}'`;break}}if(c)throw new k4(k3.INVALID_ARGUMENT,c);return!0}let lE=-0xe7791f700,lF=1e6;class lG{static now(){return lG.fromMillis(Date.now())}static fromDate(a){return lG.fromMillis(a.getTime())}static fromMillis(a){let b=Math.floor(a/1e3),c=Math.floor((a-1e3*b)*lF);return new lG(b,c)}constructor(a,b){if(this.seconds=a,this.nanoseconds=b,b<0||b>=1e9)throw new k4(k3.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+b);if(a<lE||a>=0x3afff44180)throw new k4(k3.INVALID_ARGUMENT,"Timestamp seconds out of range: "+a)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/lF}_compareTo(a){return this.seconds===a.seconds?lj(this.nanoseconds,a.nanoseconds):lj(this.seconds,a.seconds)}isEqual(a){return a.seconds===this.seconds&&a.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:lG._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(a){if(lD(a,lG._jsonSchema))return new lG(a.seconds,a.nanoseconds)}valueOf(){return String(this.seconds-lE).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}lG._jsonSchemaVersion="firestore/timestamp/1.0",lG._jsonSchema={type:lC("string",lG._jsonSchemaVersion),seconds:lC("number"),nanoseconds:lC("number")};class lH{static fromTimestamp(a){return new lH(a)}static min(){return new lH(new lG(0,0))}static max(){return new lH(new lG(0x3afff4417f,1e9-1))}constructor(a){this.timestamp=a}compareTo(a){return this.timestamp._compareTo(a.timestamp)}isEqual(a){return this.timestamp.isEqual(a.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}let lI=-1,lJ=0;class lK{constructor(a,b,c,d){this.indexId=a,this.collectionGroup=b,this.fields=c,this.indexState=d}}function lL(a){return a.fields.find(a=>2===a.kind)}function lM(a){return a.fields.filter(a=>2!==a.kind)}function lN(a){let b=lM(a);return 0===b.length?0:b[b.length-1].kind}function lO(a,b){let c=lj(a.collectionGroup,b.collectionGroup);if(0!==c)return c;for(let d=0;d<Math.min(a.fields.length,b.fields.length);++d)if(0!==(c=lR(a.fields[d],b.fields[d])))return c;return lj(a.fields.length,b.fields.length)}function lP(a){return`id=${a.indexId}|cg=${a.collectionGroup}|f=${a.fields.map(a=>`${a.fieldPath}:${a.kind}`).join(",")}`}lK.UNKNOWN_ID=-1;class lQ{constructor(a,b){this.fieldPath=a,this.kind=b}}function lR(a,b){let c=lt.comparator(a.fieldPath,b.fieldPath);return 0!==c?c:lj(a.kind,b.kind)}class lS{constructor(a,b){this.sequenceNumber=a,this.offset=b}static empty(){return new lS(lJ,lV.min())}}function lT(a,b){let c=a.toTimestamp().seconds,d=a.toTimestamp().nanoseconds+1;return new lV(lH.fromTimestamp(1e9===d?new lG(c+1,0):new lG(c,d)),lu.empty(),b)}function lU(a){return new lV(a.readTime,a.key,lI)}class lV{constructor(a,b,c){this.readTime=a,this.documentKey=b,this.largestBatchId=c}static min(){return new lV(lH.min(),lu.empty(),lI)}static max(){return new lV(lH.max(),lu.empty(),lI)}}function lW(a,b){let c=a.readTime.compareTo(b.readTime);return 0!==c||0!==(c=lu.comparator(a.documentKey,b.documentKey))?c:lj(a.largestBatchId,b.largestBatchId)}let lX="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lY{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(a){this.onCommittedListeners.push(a)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(a=>a())}}async function lZ(a){if(a.code===k3.FAILED_PRECONDITION&&a.message===lX)kX("LocalStore","Unexpectedly lost primary lease");else throw a}class l${constructor(a){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,a(a=>{this.isDone=!0,this.result=a,this.nextCallback&&this.nextCallback(a)},a=>{this.isDone=!0,this.error=a,this.catchCallback&&this.catchCallback(a)})}catch(a){return this.next(void 0,a)}next(a,b){return(this.callbackAttached&&k_(59440),this.callbackAttached=!0,this.isDone)?this.error?this.wrapFailure(b,this.error):this.wrapSuccess(a,this.result):new l$((c,d)=>{this.nextCallback=b=>{this.wrapSuccess(a,b).next(c,d)},this.catchCallback=a=>{this.wrapFailure(b,a).next(c,d)}})}toPromise(){return new Promise((a,b)=>{this.next(a,b)})}wrapUserFunction(a){try{let b=a();if(b instanceof l$)return b;return l$.resolve(b)}catch(a){return l$.reject(a)}}wrapSuccess(a,b){return a?this.wrapUserFunction(()=>a(b)):l$.resolve(b)}wrapFailure(a,b){return a?this.wrapUserFunction(()=>a(b)):l$.reject(b)}static resolve(a){return new l$((b,c)=>{b(a)})}static reject(a){return new l$((b,c)=>{c(a)})}static waitFor(a){return new l$((b,c)=>{let d=0,e=0,f=!1;a.forEach(a=>{++d,a.next(()=>{++e,f&&e===d&&b()},a=>c(a))}),f=!0,e===d&&b()})}static or(a){let b=l$.resolve(!1);for(let c of a)b=b.next(a=>a?l$.resolve(a):c());return b}static forEach(a,b){let c=[];return a.forEach((a,d)=>{c.push(b.call(this,a,d))}),this.waitFor(c)}static mapArray(a,b){return new l$((c,d)=>{let e=a.length,f=Array(e),g=0;for(let h=0;h<e;h++){let i=h;b(a[i]).next(a=>{f[i]=a,++g===e&&c(f)},a=>d(a))}})}static doWhile(a,b){return new l$((c,d)=>{let e=()=>{!0===a()?b().next(()=>{e()},d):c()};e()})}}let l_="SimpleDb",l0=3;class l1{static open(a,b,c,d){try{return new l1(b,a.transaction(d,c))}catch(a){throw new l5(b,a)}}constructor(a,b){this.action=a,this.transaction=b,this.aborted=!1,this.completionDeferred=new k5,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{b.error?this.completionDeferred.reject(new l5(a,b.error)):this.completionDeferred.resolve()},this.transaction.onerror=b=>{let c=ma(b.target.error);this.completionDeferred.reject(new l5(a,c))}}get completionPromise(){return this.completionDeferred.promise}abort(a){a&&this.completionDeferred.reject(a),this.aborted||(kX(l_,"Aborting transaction:",a?a.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let a=this.transaction;this.aborted||"function"!=typeof a.commit||a.commit()}store(a){return new l7(this.transaction.objectStore(a))}}class l2{static delete(a){return kX(l_,"Removing database:",a),l8(fM().indexedDB.deleteDatabase(a)).toPromise()}static isAvailable(){if(!f9())return!1;if(l2.isMockPersistence())return!0;let a=f1(),b=l2.getIOSVersion(a),c=0<b&&b<10,d=l3(a),e=0<d&&d<4.5;return!(a.indexOf("MSIE ")>0||a.indexOf("Trident/")>0||a.indexOf("Edge/")>0)&&!c&&!e}static isMockPersistence(){var a;return"undefined"!=typeof process&&(null==(a=process.env)?void 0:a.USE_MOCK_PERSISTENCE)==="YES"}static getStore(a,b){return a.store(b)}static getIOSVersion(a){let b=a.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(b?b[1].split("_").slice(0,2).join("."):"-1")}constructor(a,b,c){this.name=a,this.version=b,this.schemaConverter=c,this.lastClosedDbVersion=null,12.2===l2.getIOSVersion(f1())&&kY("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async ensureDb(a){return this.db||(kX(l_,"Opening database:",this.name),this.db=await new Promise((b,c)=>{let d=indexedDB.open(this.name,this.version);d.onsuccess=a=>{b(a.target.result)},d.onblocked=()=>{c(new l5(a,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},d.onerror=b=>{let d=b.target.error;"VersionError"===d.name?c(new k4(k3.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===d.name?c(new k4(k3.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+d)):c(new l5(a,d))},d.onupgradeneeded=a=>{kX(l_,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);let b=a.target.result;if(null!==this.lastClosedDbVersion&&this.lastClosedDbVersion!==a.oldVersion)throw Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.lastClosedDbVersion}, event.oldVersion=${a.oldVersion}, event.newVersion=${a.newVersion}, db.version=${b.version}`);this.schemaConverter.createOrUpgrade(b,d.transaction,a.oldVersion,this.version).next(()=>{kX(l_,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",a=>{let b=a.target;this.lastClosedDbVersion=b.version},{passive:!0})),this.db.addEventListener("versionchange",a=>{var b;null===a.newVersion&&(kZ('Received "versionchange" event with newVersion===null; notifying the registered DatabaseDeletedListener, if any'),null==(b=this.databaseDeletedListener)||b.call(this))},{passive:!0}),this.db}setDatabaseDeletedListener(a){if(this.databaseDeletedListener)throw Error("setDatabaseDeletedListener() may only be called once, and it has already been called");this.databaseDeletedListener=a}async runTransaction(a,b,c,d){let e="readonly"===b,f=0;for(;;){++f;try{this.db=await this.ensureDb(a);let b=l1.open(this.db,a,e?"readonly":"readwrite",c),f=d(b).next(a=>(b.maybeCommit(),a)).catch(a=>(b.abort(a),l$.reject(a))).toPromise();return f.catch(()=>{}),await b.completionPromise,f}catch(c){let a=c,b="FirebaseError"!==a.name&&f<l0;if(kX(l_,"Transaction failed with error:",a.message,"Retrying:",b),this.close(),!b)return Promise.reject(a)}}}close(){this.db&&this.db.close(),this.db=void 0}}function l3(a){let b=a.match(/Android ([\d.]+)/i);return Number(b?b[1].split(".").slice(0,2).join("."):"-1")}class l4{constructor(a){this.dbCursor=a,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(a){this.dbCursor=a}done(){this.shouldStop=!0}skip(a){this.nextKey=a}delete(){return l8(this.dbCursor.delete())}}class l5 extends k4{constructor(a,b){super(k3.UNAVAILABLE,`IndexedDB transaction '${a}' failed: ${b}`),this.name="IndexedDbTransactionError"}}function l6(a){return"IndexedDbTransactionError"===a.name}class l7{constructor(a){this.store=a}put(a,b){let c;return void 0!==b?(kX(l_,"PUT",this.store.name,a,b),c=this.store.put(b,a)):(kX(l_,"PUT",this.store.name,"<auto-key>",a),c=this.store.put(a)),l8(c)}add(a){return kX(l_,"ADD",this.store.name,a,a),l8(this.store.add(a))}get(a){return l8(this.store.get(a)).next(b=>(void 0===b&&(b=null),kX(l_,"GET",this.store.name,a,b),b))}delete(a){return kX(l_,"DELETE",this.store.name,a),l8(this.store.delete(a))}count(){return kX(l_,"COUNT",this.store.name),l8(this.store.count())}loadAll(a,b){let c=this.options(a,b),d=c.index?this.store.index(c.index):this.store;if("function"==typeof d.getAll){let a=d.getAll(c.range);return new l$((b,c)=>{a.onerror=a=>{c(a.target.error)},a.onsuccess=a=>{b(a.target.result)}})}{let a=this.cursor(c),b=[];return this.iterateCursor(a,(a,c)=>{b.push(c)}).next(()=>b)}}loadFirst(a,b){let c=this.store.getAll(a,null===b?void 0:b);return new l$((a,b)=>{c.onerror=a=>{b(a.target.error)},c.onsuccess=b=>{a(b.target.result)}})}deleteAll(a,b){kX(l_,"DELETE ALL",this.store.name);let c=this.options(a,b);c.keysOnly=!1;let d=this.cursor(c);return this.iterateCursor(d,(a,b,c)=>c.delete())}iterate(a,b){let c;b?c=a:(c={},b=a);let d=this.cursor(c);return this.iterateCursor(d,b)}iterateSerial(a){let b=this.cursor({});return new l$((c,d)=>{b.onerror=a=>{d(ma(a.target.error))},b.onsuccess=b=>{let d=b.target.result;if(!d)return void c();a(d.primaryKey,d.value).next(a=>{a?d.continue():c()})}})}iterateCursor(a,b){let c=[];return new l$((d,e)=>{a.onerror=a=>{e(a.target.error)},a.onsuccess=a=>{let e=a.target.result;if(!e)return void d();let f=new l4(e),g=b(e.primaryKey,e.value,f);if(g instanceof l$){let a=g.catch(a=>(f.done(),l$.reject(a)));c.push(a)}f.isDone?d():null===f.skipToKey?e.continue():e.continue(f.skipToKey)}}).next(()=>l$.waitFor(c))}options(a,b){let c;return void 0!==a&&("string"==typeof a?c=a:b=a),{index:c,range:b}}cursor(a){let b="next";if(a.reverse&&(b="prev"),!a.index)return this.store.openCursor(a.range,b);{let c=this.store.index(a.index);return a.keysOnly?c.openKeyCursor(a.range,b):c.openCursor(a.range,b)}}}function l8(a){return new l$((b,c)=>{a.onsuccess=a=>{b(a.target.result)},a.onerror=a=>{c(ma(a.target.error))}})}let l9=!1;function ma(a){let b=l2.getIOSVersion(f1());if(b>=12.2&&b<13){let b="An internal error was encountered in the Indexed Database server";if(a.message.indexOf(b)>=0){let a=new k4("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${b}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return l9||(l9=!0,setTimeout(()=>{throw a},0)),a}}return a}let mb="IndexBackfiller",mc=15e3,md=6e4,me=50;class mf{constructor(a,b){this.asyncQueue=a,this.backfiller=b,this.task=null}start(){this.schedule(mc)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}schedule(a){kX(mb,`Scheduled in ${a}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",a,async()=>{this.task=null;try{let a=await this.backfiller.backfill();kX(mb,`Documents written: ${a}`)}catch(a){l6(a)?kX(mb,"Ignoring IndexedDB error during index backfill: ",a):await lZ(a)}await this.schedule(md)})}}class mg{constructor(a,b){this.localStore=a,this.persistence=b}async backfill(a=me){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",b=>this.writeIndexEntries(b,a))}writeIndexEntries(a,b){let c=new Set,d=b,e=!0;return l$.doWhile(()=>!0===e&&d>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(a).next(b=>{if(!(null===b||c.has(b)))return kX(mb,`Processing collection: ${b}`),this.writeEntriesForCollectionGroup(a,b,d).next(a=>{d-=a,c.add(b)});e=!1})).next(()=>b-d)}writeEntriesForCollectionGroup(a,b,c){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(a,b).next(d=>this.localStore.localDocuments.getNextDocuments(a,b,d,c).next(c=>{let e=c.changes;return this.localStore.indexManager.updateIndexEntries(a,e).next(()=>this.getNewOffset(d,c)).next(c=>(kX(mb,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(a,b,c))).next(()=>e.size)}))}getNewOffset(a,b){let c=a;return b.changes.forEach((a,b)=>{let d=lU(b);lW(d,c)>0&&(c=d)}),new lV(c.readTime,c.documentKey,Math.max(b.batchId,a.largestBatchId))}}class mh{constructor(a,b){this.previousValue=a,b&&(b.sequenceNumberHandler=a=>this.setPreviousValue(a),this.writeNewSequenceNumber=a=>b.writeSequenceNumber(a))}setPreviousValue(a){return this.previousValue=Math.max(a,this.previousValue),this.previousValue}next(){let a=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(a),a}}mh.INVALID=-1;let mi="\x01",mj="\x01",mk="\x10",ml="\x11";function mm(a){let b="";for(let c=0;c<a.length;c++)b.length>0&&(b=mo(b)),b=mn(a.get(c),b);return mo(b)}function mn(a,b){let c=b,d=a.length;for(let b=0;b<d;b++){let d=a.charAt(b);switch(d){case"\0":c+=mi+mk;break;case mi:c+=mi+ml;break;default:c+=d}}return c}function mo(a){return a+mi+mj}function mp(a){let b=a.length;if(k1(b>=2,64408,{path:a}),2===b)return k1(a.charAt(0)===mi&&a.charAt(1)===mj,56145,{path:a}),lr.emptyPath();let c=b-2,d=[],e="";for(let f=0;f<b;){let b=a.indexOf(mi,f);switch((b<0||b>c)&&k_(50515,{path:a}),a.charAt(b+1)){case mj:let g,h=a.substring(f,b);0===e.length?g=h:(e+=h,g=e,e=""),d.push(g);break;case mk:e+=a.substring(f,b),e+="\0";break;case ml:e+=a.substring(f,b+1);break;default:k_(61167,{path:a})}f=b+2}return new lr(d)}let mq="remoteDocuments",mr="owner",ms="owner",mt="mutationQueues",mu="userId",mv="mutations",mw="batchId",mx="userMutationsIndex",my=["userId","batchId"];function mz(a){return[a]}function mA(a,b){return[a,mm(b)]}function mB(a,b,c){return[a,mm(b),c]}let mC={},mD="documentMutations",mE="remoteDocumentsV14",mF=["prefixPath","collectionGroup","readTime","documentId"],mG="documentKeyIndex",mH=["prefixPath","collectionGroup","documentId"],mI="collectionGroupIndex",mJ=["collectionGroup","readTime","prefixPath","documentId"],mK="remoteDocumentGlobal",mL="remoteDocumentGlobalKey",mM="targets",mN="targetId",mO="queryTargetsIndex",mP=["canonicalId","targetId"],mQ="targetDocuments",mR=["targetId","path"],mS="documentTargetsIndex",mT=["path","targetId"],mU="targetGlobalKey",mV="targetGlobal",mW="collectionParents",mX=["collectionId","parent"],mY="clientMetadata",mZ="clientId",m$="bundles",m_="bundleId",m0="namedQueries",m1="name",m2="indexConfiguration",m3="indexId",m4="collectionGroupIndex",m5="collectionGroup",m6="indexState",m7=["indexId","uid"],m8="sequenceNumberIndex",m9=["uid","sequenceNumber"],na="indexEntries",nb=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],nc="documentKeyIndex",nd=["indexId","uid","orderedDocumentKey"],ne="documentOverlays",nf=["userId","collectionPath","documentId"],ng="collectionPathOverlayIndex",nh=["userId","collectionPath","largestBatchId"],ni="collectionGroupOverlayIndex",nj=["userId","collectionGroup","largestBatchId"],nk="globals",nl="name",nm=[mt,mv,mD,mq,mM,mr,mV,mQ,mY,mK,mW,m$,m0],nn=[...nm,ne],no=[mt,mv,mD,mE,mM,mr,mV,mQ,mY,mK,mW,m$,m0,ne],np=no,nq=[...np,m2,m6,na],nr=nq,ns=[...nq,nk],nt=ns;function nu(a){return 18===a?nt:17===a?ns:16===a?nr:15===a?nq:14===a?np:13===a?no:12===a?nn:11===a?nm:void k_(60245)}class nv extends lY{constructor(a,b){super(),this.simpleDbTransaction=a,this.currentSequenceNumber=b}}function nw(a,b){let c=k2(a);return l2.getStore(c.simpleDbTransaction,b)}function nx(a){let b=0;for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b++;return b}function ny(a,b){for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b(c,a[c])}function nz(a,b){let c=[];for(let d in a)Object.prototype.hasOwnProperty.call(a,d)&&c.push(b(a[d],d,a));return c}function nA(a){for(let b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0}class nB{constructor(a,b){this.comparator=a,this.root=b||nD.EMPTY}insert(a,b){return new nB(this.comparator,this.root.insert(a,b,this.comparator).copy(null,null,nD.BLACK,null,null))}remove(a){return new nB(this.comparator,this.root.remove(a,this.comparator).copy(null,null,nD.BLACK,null,null))}get(a){let b=this.root;for(;!b.isEmpty();){let c=this.comparator(a,b.key);if(0===c)return b.value;c<0?b=b.left:c>0&&(b=b.right)}return null}indexOf(a){let b=0,c=this.root;for(;!c.isEmpty();){let d=this.comparator(a,c.key);if(0===d)return b+c.left.size;d<0?c=c.left:(b+=c.left.size+1,c=c.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(a){return this.root.inorderTraversal(a)}forEach(a){this.inorderTraversal((b,c)=>(a(b,c),!1))}toString(){let a=[];return this.inorderTraversal((b,c)=>(a.push(`${b}:${c}`),!1)),`{${a.join(", ")}}`}reverseTraversal(a){return this.root.reverseTraversal(a)}getIterator(){return new nC(this.root,null,this.comparator,!1)}getIteratorFrom(a){return new nC(this.root,a,this.comparator,!1)}getReverseIterator(){return new nC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(a){return new nC(this.root,a,this.comparator,!0)}}class nC{constructor(a,b,c,d){this.isReverse=d,this.nodeStack=[];let e=1;for(;!a.isEmpty();)if(e=b?c(a.key,b):1,b&&d&&(e*=-1),e<0)a=this.isReverse?a.left:a.right;else if(0===e){this.nodeStack.push(a);break}else this.nodeStack.push(a),a=this.isReverse?a.right:a.left}getNext(){let a=this.nodeStack.pop(),b={key:a.key,value:a.value};if(this.isReverse)for(a=a.left;!a.isEmpty();)this.nodeStack.push(a),a=a.right;else for(a=a.right;!a.isEmpty();)this.nodeStack.push(a),a=a.left;return b}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let a=this.nodeStack[this.nodeStack.length-1];return{key:a.key,value:a.value}}}class nD{constructor(a,b,c,d,e){this.key=a,this.value=b,this.color=null!=c?c:nD.RED,this.left=null!=d?d:nD.EMPTY,this.right=null!=e?e:nD.EMPTY,this.size=this.left.size+1+this.right.size}copy(a,b,c,d,e){return new nD(null!=a?a:this.key,null!=b?b:this.value,null!=c?c:this.color,null!=d?d:this.left,null!=e?e:this.right)}isEmpty(){return!1}inorderTraversal(a){return this.left.inorderTraversal(a)||a(this.key,this.value)||this.right.inorderTraversal(a)}reverseTraversal(a){return this.right.reverseTraversal(a)||a(this.key,this.value)||this.left.reverseTraversal(a)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(a,b,c){let d=this,e=c(a,d.key);return(d=e<0?d.copy(null,null,null,d.left.insert(a,b,c),null):0===e?d.copy(null,b,null,null,null):d.copy(null,null,null,null,d.right.insert(a,b,c))).fixUp()}removeMin(){if(this.left.isEmpty())return nD.EMPTY;let a=this;return a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),(a=a.copy(null,null,null,a.left.removeMin(),null)).fixUp()}remove(a,b){let c,d=this;if(0>b(a,d.key))d.left.isEmpty()||d.left.isRed()||d.left.left.isRed()||(d=d.moveRedLeft()),d=d.copy(null,null,null,d.left.remove(a,b),null);else{if(d.left.isRed()&&(d=d.rotateRight()),d.right.isEmpty()||d.right.isRed()||d.right.left.isRed()||(d=d.moveRedRight()),0===b(a,d.key))if(d.right.isEmpty())return nD.EMPTY;else c=d.right.min(),d=d.copy(c.key,c.value,null,null,d.right.removeMin());d=d.copy(null,null,null,null,d.right.remove(a,b))}return d.fixUp()}isRed(){return this.color}fixUp(){let a=this;return a.right.isRed()&&!a.left.isRed()&&(a=a.rotateLeft()),a.left.isRed()&&a.left.left.isRed()&&(a=a.rotateRight()),a.left.isRed()&&a.right.isRed()&&(a=a.colorFlip()),a}moveRedLeft(){let a=this.colorFlip();return a.right.left.isRed()&&(a=(a=(a=a.copy(null,null,null,null,a.right.rotateRight())).rotateLeft()).colorFlip()),a}moveRedRight(){let a=this.colorFlip();return a.left.left.isRed()&&(a=(a=a.rotateRight()).colorFlip()),a}rotateLeft(){let a=this.copy(null,null,nD.RED,null,this.right.left);return this.right.copy(null,null,this.color,a,null)}rotateRight(){let a=this.copy(null,null,nD.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,a)}colorFlip(){let a=this.left.copy(null,null,!this.left.color,null,null),b=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,a,b)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw k_(43730,{key:this.key,value:this.value});if(this.right.isRed())throw k_(14113,{key:this.key,value:this.value});let a=this.left.check();if(a===this.right.check())return a+ +!this.isRed();throw k_(27949)}}nD.EMPTY=null,nD.RED=!0,nD.BLACK=!1;class nE{constructor(){this.size=0}get key(){throw k_(57766)}get value(){throw k_(16141)}get color(){throw k_(16727)}get left(){throw k_(29726)}get right(){throw k_(36894)}copy(a,b,c,d,e){return this}insert(a,b,c){return new nD(a,b)}remove(a,b){return this}isEmpty(){return!0}inorderTraversal(a){return!1}reverseTraversal(a){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}}nD.EMPTY=new nE;class nF{constructor(a){this.comparator=a,this.data=new nB(this.comparator)}has(a){return null!==this.data.get(a)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(a){return this.data.indexOf(a)}forEach(a){this.data.inorderTraversal((b,c)=>(a(b),!1))}forEachInRange(a,b){let c=this.data.getIteratorFrom(a[0]);for(;c.hasNext();){let d=c.getNext();if(this.comparator(d.key,a[1])>=0)return;b(d.key)}}forEachWhile(a,b){let c;for(c=void 0!==b?this.data.getIteratorFrom(b):this.data.getIterator();c.hasNext();)if(!a(c.getNext().key))return}firstAfterOrEqual(a){let b=this.data.getIteratorFrom(a);return b.hasNext()?b.getNext().key:null}getIterator(){return new nG(this.data.getIterator())}getIteratorFrom(a){return new nG(this.data.getIteratorFrom(a))}add(a){return this.copy(this.data.remove(a).insert(a,!0))}delete(a){return this.has(a)?this.copy(this.data.remove(a)):this}isEmpty(){return this.data.isEmpty()}unionWith(a){let b=this;return b.size<a.size&&(b=a,a=this),a.forEach(a=>{b=b.add(a)}),b}isEqual(a){if(!(a instanceof nF)||this.size!==a.size)return!1;let b=this.data.getIterator(),c=a.data.getIterator();for(;b.hasNext();){let a=b.getNext().key,d=c.getNext().key;if(0!==this.comparator(a,d))return!1}return!0}toArray(){let a=[];return this.forEach(b=>{a.push(b)}),a}toString(){let a=[];return this.forEach(b=>a.push(b)),"SortedSet("+a.toString()+")"}copy(a){let b=new nF(this.comparator);return b.data=a,b}}class nG{constructor(a){this.iter=a}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function nH(a,b,c,d,e){let f=a.getIterator(),g=b.getIterator(),h=nI(f),i=nI(g);for(;h||i;){let a=!1,b=!1;if(h&&i){let d=c(h,i);d<0?b=!0:d>0&&(a=!0)}else null!=h?b=!0:a=!0;a?(d(i),i=nI(g)):b?(e(h),h=nI(f)):(h=nI(f),i=nI(g))}}function nI(a){return a.hasNext()?a.getNext():void 0}class nJ{constructor(a){this.fields=a,a.sort(lt.comparator)}static empty(){return new nJ([])}unionWith(a){let b=new nF(lt.comparator);for(let a of this.fields)b=b.add(a);for(let c of a)b=b.add(c);return new nJ(b.toArray())}covers(a){for(let b of this.fields)if(b.isPrefixOf(a))return!0;return!1}isEqual(a){return ln(this.fields,a.fields,(a,b)=>a.isEqual(b))}}function nK(a){return Buffer.from(a,"base64").toString("binary")}function nL(a){return Buffer.from(a,"binary").toString("base64")}class nM{constructor(a){this.binaryString=a}static fromBase64String(a){return new nM(nK(a))}static fromUint8Array(a){return new nM(nN(a))}[Symbol.iterator](){let a=0;return{next:()=>a<this.binaryString.length?{value:this.binaryString.charCodeAt(a++),done:!1}:{value:void 0,done:!0}}}toBase64(){return nL(this.binaryString)}toUint8Array(){return nO(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(a){return lj(this.binaryString,a.binaryString)}isEqual(a){return this.binaryString===a.binaryString}}function nN(a){let b="";for(let c=0;c<a.length;++c)b+=String.fromCharCode(a[c]);return b}function nO(a){let b=new Uint8Array(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}nM.EMPTY_BYTE_STRING=new nM("");let nP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function nQ(a){if(k1(!!a,39018),"string"==typeof a){let b=0,c=nP.exec(a);if(k1(!!c,46558,{timestamp:a}),c[1]){let a=c[1];b=Number(a=(a+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(a).getTime()/1e3),nanos:b}}return{seconds:nR(a.seconds),nanos:nR(a.nanos)}}function nR(a){return"number"==typeof a?a:"string"==typeof a?Number(a):0}function nS(a){return"string"==typeof a?nM.fromBase64String(a):nM.fromUint8Array(a)}let nT="server_timestamp",nU="__type__",nV="__previous_value__",nW="__local_write_time__";function nX(a){var b,c;return(null==(c=((null==(b=null==a?void 0:a.mapValue)?void 0:b.fields)||{})[nU])?void 0:c.stringValue)===nT}function nY(a,b){let c={fields:{[nU]:{stringValue:nT},[nW]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return b&&nX(b)&&(b=nZ(b)),b&&(c.fields[nV]=b),{mapValue:c}}function nZ(a){let b=a.mapValue.fields[nV];return nX(b)?nZ(b):b}function n$(a){let b=nQ(a.mapValue.fields[nW].timestampValue);return new lG(b.seconds,b.nanos)}class n_{constructor(a,b,c,d,e,f,g,h,i,j){this.databaseId=a,this.appId=b,this.persistenceKey=c,this.host=d,this.ssl=e,this.forceLongPolling=f,this.autoDetectLongPolling=g,this.longPollingOptions=h,this.useFetchStreams=i,this.isUsingEmulator=j}}let n0="(default)";class n1{constructor(a,b){this.projectId=a,this.database=b||n0}static empty(){return new n1("","")}get isDefaultDatabase(){return this.database===n0}isEqual(a){return a instanceof n1&&a.projectId===this.projectId&&a.database===this.database}}function n2(a,b){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new k4(k3.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new n1(a.options.projectId,b)}let n3=-1;function n4(a){return null==a}function n5(a){return 0===a&&1/a==-1/0}function n6(a){return"number"==typeof a&&Number.isInteger(a)&&!n5(a)&&a<=Number.MAX_SAFE_INTEGER&&a>=Number.MIN_SAFE_INTEGER}let n7="__type__",n8="__max__",n9={mapValue:{fields:{__type__:{stringValue:n8}}}},oa="__vector__",ob="value",oc={nullValue:"NULL_VALUE"};function od(a){return"nullValue"in a?0:"booleanValue"in a?1:"integerValue"in a||"doubleValue"in a?2:"timestampValue"in a?3:"stringValue"in a?5:"bytesValue"in a?6:"referenceValue"in a?7:"geoPointValue"in a?8:"arrayValue"in a?9:"mapValue"in a?nX(a)?4:oP(a)?0x1fffffffffffff:oN(a)?10:11:k_(28295,{value:a})}function oe(a,b){if(a===b)return!0;let c=od(a);if(c!==od(b))return!1;switch(c){case 0:case 0x1fffffffffffff:return!0;case 1:return a.booleanValue===b.booleanValue;case 4:return n$(a).isEqual(n$(b));case 3:return of(a,b);case 5:return a.stringValue===b.stringValue;case 6:return oh(a,b);case 7:return a.referenceValue===b.referenceValue;case 8:return og(a,b);case 2:return oi(a,b);case 9:return ln(a.arrayValue.values||[],b.arrayValue.values||[],oe);case 10:case 11:return oj(a,b);default:return k_(52216,{left:a})}}function of(a,b){if("string"==typeof a.timestampValue&&"string"==typeof b.timestampValue&&a.timestampValue.length===b.timestampValue.length)return a.timestampValue===b.timestampValue;let c=nQ(a.timestampValue),d=nQ(b.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos}function og(a,b){return nR(a.geoPointValue.latitude)===nR(b.geoPointValue.latitude)&&nR(a.geoPointValue.longitude)===nR(b.geoPointValue.longitude)}function oh(a,b){return nS(a.bytesValue).isEqual(nS(b.bytesValue))}function oi(a,b){if("integerValue"in a&&"integerValue"in b)return nR(a.integerValue)===nR(b.integerValue);if("doubleValue"in a&&"doubleValue"in b){let c=nR(a.doubleValue),d=nR(b.doubleValue);return c===d?n5(c)===n5(d):isNaN(c)&&isNaN(d)}return!1}function oj(a,b){let c=a.mapValue.fields||{},d=b.mapValue.fields||{};if(nx(c)!==nx(d))return!1;for(let a in c)if(c.hasOwnProperty(a)&&(void 0===d[a]||!oe(c[a],d[a])))return!1;return!0}function ok(a,b){return void 0!==(a.values||[]).find(a=>oe(a,b))}function ol(a,b){if(a===b)return 0;let c=od(a),d=od(b);if(c!==d)return lj(c,d);switch(c){case 0:case 0x1fffffffffffff:return 0;case 1:return lj(a.booleanValue,b.booleanValue);case 2:return om(a,b);case 3:return on(a.timestampValue,b.timestampValue);case 4:return on(n$(a),n$(b));case 5:return lk(a.stringValue,b.stringValue);case 6:return oq(a.bytesValue,b.bytesValue);case 7:return oo(a.referenceValue,b.referenceValue);case 8:return op(a.geoPointValue,b.geoPointValue);case 9:return or(a.arrayValue,b.arrayValue);case 10:return os(a.mapValue,b.mapValue);case 11:return ot(a.mapValue,b.mapValue);default:throw k_(23264,{leftType:c})}}function om(a,b){let c=nR(a.integerValue||a.doubleValue),d=nR(b.integerValue||b.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1}function on(a,b){if("string"==typeof a&&"string"==typeof b&&a.length===b.length)return lj(a,b);let c=nQ(a),d=nQ(b),e=lj(c.seconds,d.seconds);return 0!==e?e:lj(c.nanos,d.nanos)}function oo(a,b){let c=a.split("/"),d=b.split("/");for(let a=0;a<c.length&&a<d.length;a++){let b=lj(c[a],d[a]);if(0!==b)return b}return lj(c.length,d.length)}function op(a,b){let c=lj(nR(a.latitude),nR(b.latitude));return 0!==c?c:lj(nR(a.longitude),nR(b.longitude))}function oq(a,b){let c=nS(a),d=nS(b);return c.compareTo(d)}function or(a,b){let c=a.values||[],d=b.values||[];for(let a=0;a<c.length&&a<d.length;++a){let b=ol(c[a],d[a]);if(b)return b}return lj(c.length,d.length)}function os(a,b){var c,d,e,f;let g=a.fields||{},h=b.fields||{},i=null==(c=g[ob])?void 0:c.arrayValue,j=null==(d=h[ob])?void 0:d.arrayValue,k=lj((null==(e=null==i?void 0:i.values)?void 0:e.length)||0,(null==(f=null==j?void 0:j.values)?void 0:f.length)||0);return 0!==k?k:or(i,j)}function ot(a,b){if(a===n9.mapValue&&b===n9.mapValue)return 0;if(a===n9.mapValue)return 1;if(b===n9.mapValue)return -1;let c=a.fields||{},d=Object.keys(c),e=b.fields||{},f=Object.keys(e);d.sort(),f.sort();for(let a=0;a<d.length&&a<f.length;++a){let b=lk(d[a],f[a]);if(0!==b)return b;let g=ol(c[d[a]],e[f[a]]);if(0!==g)return g}return lj(d.length,f.length)}function ou(a){return ov(a)}function ov(a){if("nullValue"in a)return"null";if("booleanValue"in a)return""+a.booleanValue;if("integerValue"in a)return""+a.integerValue;if("doubleValue"in a)return""+a.doubleValue;if("timestampValue"in a)return ox(a.timestampValue);else if("stringValue"in a)return a.stringValue;else if("bytesValue"in a)return ow(a.bytesValue);else if("referenceValue"in a)return oz(a.referenceValue);else if("geoPointValue"in a)return oy(a.geoPointValue);else if("arrayValue"in a)return oB(a.arrayValue);else if("mapValue"in a)return oA(a.mapValue);else return k_(61005,{value:a})}function ow(a){return nS(a).toBase64()}function ox(a){let b=nQ(a);return`time(${b.seconds},${b.nanos})`}function oy(a){return`geo(${a.latitude},${a.longitude})`}function oz(a){return lu.fromName(a).toString()}function oA(a){let b=Object.keys(a.fields||{}).sort(),c="{",d=!0;for(let e of b)d?d=!1:c+=",",c+=`${e}:${ov(a.fields[e])}`;return c+"}"}function oB(a){let b="[",c=!0;for(let d of a.values||[])c?c=!1:b+=",",b+=ov(d);return b+"]"}function oC(a){switch(od(a)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let b=nZ(a);return b?16+oC(b):16;case 5:return 2*a.stringValue.length;case 6:return nS(a.bytesValue).approximateByteSize();case 7:return a.referenceValue.length;case 9:return oE(a.arrayValue);case 10:case 11:return oD(a.mapValue);default:throw k_(13486,{value:a})}}function oD(a){let b=0;return ny(a.fields,(a,c)=>{b+=a.length+oC(c)}),b}function oE(a){return(a.values||[]).reduce((a,b)=>a+oC(b),0)}function oF(a,b){return{referenceValue:`projects/${a.projectId}/databases/${a.database}/documents/${b.path.canonicalString()}`}}function oG(a){return!!a&&"integerValue"in a}function oH(a){return!!a&&"doubleValue"in a}function oI(a){return oG(a)||oH(a)}function oJ(a){return!!a&&"arrayValue"in a}function oK(a){return!!a&&"nullValue"in a}function oL(a){return!!a&&"doubleValue"in a&&isNaN(Number(a.doubleValue))}function oM(a){return!!a&&"mapValue"in a}function oN(a){var b,c;return(null==(c=((null==(b=null==a?void 0:a.mapValue)?void 0:b.fields)||{})[n7])?void 0:c.stringValue)===oa}function oO(a){if(a.geoPointValue)return{geoPointValue:Object.assign({},a.geoPointValue)};if(a.timestampValue&&"object"==typeof a.timestampValue)return{timestampValue:Object.assign({},a.timestampValue)};if(a.mapValue){let b={mapValue:{fields:{}}};return ny(a.mapValue.fields,(a,c)=>b.mapValue.fields[a]=oO(c)),b}{if(!a.arrayValue)return Object.assign({},a);let b={arrayValue:{values:[]}};for(let c=0;c<(a.arrayValue.values||[]).length;++c)b.arrayValue.values[c]=oO(a.arrayValue.values[c]);return b}}function oP(a){return(((a.mapValue||{}).fields||{}).__type__||{}).stringValue===n8}let oQ={mapValue:{fields:{[n7]:{stringValue:oa},[ob]:{arrayValue:{}}}}};function oR(a){if("nullValue"in a)return oc;if("booleanValue"in a)return{booleanValue:!1};if("integerValue"in a||"doubleValue"in a)return{doubleValue:NaN};if("timestampValue"in a)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("stringValue"in a)return{stringValue:""};else if("bytesValue"in a)return{bytesValue:""};else if("referenceValue"in a)return oF(n1.empty(),lu.empty());else if("geoPointValue"in a)return{geoPointValue:{latitude:-90,longitude:-180}};else if("arrayValue"in a)return{arrayValue:{}};else if(!("mapValue"in a))return k_(35942,{value:a});else return oN(a)?oQ:{mapValue:{}}}function oS(a){if("nullValue"in a)return{booleanValue:!1};if("booleanValue"in a)return{doubleValue:NaN};if("integerValue"in a||"doubleValue"in a)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("timestampValue"in a)return{stringValue:""};if("stringValue"in a)return{bytesValue:""};else if("bytesValue"in a)return oF(n1.empty(),lu.empty());else if("referenceValue"in a)return{geoPointValue:{latitude:-90,longitude:-180}};else if("geoPointValue"in a)return{arrayValue:{}};else if("arrayValue"in a)return oQ;else if(!("mapValue"in a))return k_(61959,{value:a});else return oN(a)?{mapValue:{}}:n9}function oT(a,b){let c=ol(a.value,b.value);return 0!==c?c:a.inclusive&&!b.inclusive?-1:!a.inclusive&&b.inclusive?1:0}function oU(a,b){let c=ol(a.value,b.value);return 0!==c?c:a.inclusive&&!b.inclusive?1:!a.inclusive&&b.inclusive?-1:0}class oV{constructor(a){this.value=a}static empty(){return new oV({mapValue:{}})}field(a){if(a.isEmpty())return this.value;{let b=this.value;for(let c=0;c<a.length-1;++c)if(!oM(b=(b.mapValue.fields||{})[a.get(c)]))return null;return(b=(b.mapValue.fields||{})[a.lastSegment()])||null}}set(a,b){this.getFieldsMap(a.popLast())[a.lastSegment()]=oO(b)}setAll(a){let b=lt.emptyPath(),c={},d=[];a.forEach((a,e)=>{if(!b.isImmediateParentOf(e)){let a=this.getFieldsMap(b);this.applyChanges(a,c,d),c={},d=[],b=e.popLast()}a?c[e.lastSegment()]=oO(a):d.push(e.lastSegment())});let e=this.getFieldsMap(b);this.applyChanges(e,c,d)}delete(a){let b=this.field(a.popLast());oM(b)&&b.mapValue.fields&&delete b.mapValue.fields[a.lastSegment()]}isEqual(a){return oe(this.value,a.value)}getFieldsMap(a){let b=this.value;b.mapValue.fields||(b.mapValue={fields:{}});for(let c=0;c<a.length;++c){let d=b.mapValue.fields[a.get(c)];oM(d)&&d.mapValue.fields||(d={mapValue:{fields:{}}},b.mapValue.fields[a.get(c)]=d),b=d}return b.mapValue.fields}applyChanges(a,b,c){for(let d of(ny(b,(b,c)=>a[b]=c),c))delete a[d]}clone(){return new oV(oO(this.value))}}function oW(a){let b=[];return ny(a.fields,(a,c)=>{let d=new lt([a]);if(oM(c)){let a=oW(c.mapValue).fields;if(0===a.length)b.push(d);else for(let c of a)b.push(d.child(c))}else b.push(d)}),new nJ(b)}class oX{constructor(a,b,c,d,e,f,g){this.key=a,this.documentType=b,this.version=c,this.readTime=d,this.createTime=e,this.data=f,this.documentState=g}static newInvalidDocument(a){return new oX(a,0,lH.min(),lH.min(),lH.min(),oV.empty(),0)}static newFoundDocument(a,b,c,d){return new oX(a,1,b,lH.min(),c,d,0)}static newNoDocument(a,b){return new oX(a,2,b,lH.min(),lH.min(),oV.empty(),0)}static newUnknownDocument(a,b){return new oX(a,3,b,lH.min(),lH.min(),oV.empty(),2)}convertToFoundDocument(a,b){return this.createTime.isEqual(lH.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=a),this.version=a,this.documentType=1,this.data=b,this.documentState=0,this}convertToNoDocument(a){return this.version=a,this.documentType=2,this.data=oV.empty(),this.documentState=0,this}convertToUnknownDocument(a){return this.version=a,this.documentType=3,this.data=oV.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lH.min(),this}setReadTime(a){return this.readTime=a,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(a){return a instanceof oX&&this.key.isEqual(a.key)&&this.version.isEqual(a.version)&&this.documentType===a.documentType&&this.documentState===a.documentState&&this.data.isEqual(a.data)}mutableCopy(){return new oX(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}function oY(a,b,c){let d=b.data.field(a),e=c.data.field(a);return null!==d&&null!==e?ol(d,e):k_(42886)}class oZ{constructor(a,b){this.position=a,this.inclusive=b}}function o$(a,b,c){let d=0;for(let e=0;e<a.position.length;e++){let f=b[e],g=a.position[e];if(d=f.field.isKeyField()?lu.comparator(lu.fromName(g.referenceValue),c.key):ol(g,c.data.field(f.field)),"desc"===f.dir&&(d*=-1),0!==d)break}return d}function o_(a,b,c){let d=o$(a,b,c);return a.inclusive?d>=0:d>0}function o0(a,b,c){let d=o$(a,b,c);return a.inclusive?d<=0:d<0}function o1(a,b){if(null===a)return null===b;if(null===b||a.inclusive!==b.inclusive||a.position.length!==b.position.length)return!1;for(let c=0;c<a.position.length;c++)if(!oe(a.position[c],b.position[c]))return!1;return!0}class o2{constructor(a,b="asc"){this.field=a,this.dir=b}}function o3(a){return a.field.canonicalString()+a.dir}function o4(a){return`${a.field.canonicalString()} (${a.dir})`}function o5(a,b){return a.dir===b.dir&&a.field.isEqual(b.field)}class o6{}class o7 extends o6{constructor(a,b,c){super(),this.field=a,this.op=b,this.value=c}static create(a,b,c){if(a.isKeyField())if("in"===b||"not-in"===b)return this.createKeyFieldInFilter(a,b,c);else return new pl(a,b,c);if("array-contains"===b)return new pp(a,c);if("in"===b)return new pq(a,c);if("not-in"===b)return new pr(a,c);if("array-contains-any"===b)return new ps(a,c);else return new o7(a,b,c)}static createKeyFieldInFilter(a,b,c){return"in"===b?new pm(a,c):new pn(a,c)}matches(a){let b=a.data.field(this.field);return"!="===this.op?null!==b&&void 0===b.nullValue&&this.matchesComparison(ol(b,this.value)):null!==b&&od(this.value)===od(b)&&this.matchesComparison(ol(b,this.value))}matchesComparison(a){switch(this.op){case"<":return a<0;case"<=":return a<=0;case"==":return 0===a;case"!=":return 0!==a;case">":return a>0;case">=":return a>=0;default:return k_(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class o8 extends o6{constructor(a,b){super(),this.filters=a,this.op=b,this.memoizedFlattenedFilters=null}static create(a,b){return new o8(a,b)}matches(a){return o9(this)?void 0===this.filters.find(b=>!b.matches(a)):void 0!==this.filters.find(b=>b.matches(a))}getFlattenedFilters(){return null!==this.memoizedFlattenedFilters||(this.memoizedFlattenedFilters=this.filters.reduce((a,b)=>a.concat(b.getFlattenedFilters()),[])),this.memoizedFlattenedFilters}getFilters(){return Object.assign([],this.filters)}}function o9(a){return"and"===a.op}function pa(a){return"or"===a.op}function pb(a){return pc(a)&&o9(a)}function pc(a){for(let b of a.filters)if(b instanceof o8)return!1;return!0}function pd(a){if(a instanceof o7)return a.field.canonicalString()+a.op.toString()+ou(a.value);{if(pb(a))return a.filters.map(a=>pd(a)).join(",");let b=a.filters.map(a=>pd(a)).join(",");return`${a.op}(${b})`}}function pe(a,b){return a instanceof o7?pf(a,b):a instanceof o8?pg(a,b):void k_(19439)}function pf(a,b){return b instanceof o7&&a.op===b.op&&a.field.isEqual(b.field)&&oe(a.value,b.value)}function pg(a,b){return b instanceof o8&&a.op===b.op&&a.filters.length===b.filters.length&&a.filters.reduce((a,c,d)=>a&&pe(c,b.filters[d]),!0)}function ph(a,b){let c=a.filters.concat(b);return o8.create(c,a.op)}function pi(a){return a instanceof o7?pk(a):a instanceof o8?pj(a):"Filter"}function pj(a){return a.op.toString()+" {"+a.getFilters().map(pi).join(" ,")+"}"}function pk(a){return`${a.field.canonicalString()} ${a.op} ${ou(a.value)}`}class pl extends o7{constructor(a,b,c){super(a,b,c),this.key=lu.fromName(c.referenceValue)}matches(a){let b=lu.comparator(a.key,this.key);return this.matchesComparison(b)}}class pm extends o7{constructor(a,b){super(a,"in",b),this.keys=po("in",b)}matches(a){return this.keys.some(b=>b.isEqual(a.key))}}class pn extends o7{constructor(a,b){super(a,"not-in",b),this.keys=po("not-in",b)}matches(a){return!this.keys.some(b=>b.isEqual(a.key))}}function po(a,b){var c;return((null==(c=b.arrayValue)?void 0:c.values)||[]).map(a=>lu.fromName(a.referenceValue))}class pp extends o7{constructor(a,b){super(a,"array-contains",b)}matches(a){let b=a.data.field(this.field);return oJ(b)&&ok(b.arrayValue,this.value)}}class pq extends o7{constructor(a,b){super(a,"in",b)}matches(a){let b=a.data.field(this.field);return null!==b&&ok(this.value.arrayValue,b)}}class pr extends o7{constructor(a,b){super(a,"not-in",b)}matches(a){if(ok(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let b=a.data.field(this.field);return null!==b&&void 0===b.nullValue&&!ok(this.value.arrayValue,b)}}class ps extends o7{constructor(a,b){super(a,"array-contains-any",b)}matches(a){let b=a.data.field(this.field);return!!oJ(b)&&!!b.arrayValue.values&&b.arrayValue.values.some(a=>ok(this.value.arrayValue,a))}}class pt{constructor(a,b=null,c=[],d=[],e=null,f=null,g=null){this.path=a,this.collectionGroup=b,this.orderBy=c,this.filters=d,this.limit=e,this.startAt=f,this.endAt=g,this.memoizedCanonicalId=null}}function pu(a,b=null,c=[],d=[],e=null,f=null,g=null){return new pt(a,b,c,d,e,f,g)}function pv(a){let b=k2(a);if(null===b.memoizedCanonicalId){let a=b.path.canonicalString();null!==b.collectionGroup&&(a+="|cg:"+b.collectionGroup),a+="|f:",a+=b.filters.map(a=>pd(a)).join(","),a+="|ob:",a+=b.orderBy.map(a=>o3(a)).join(","),n4(b.limit)||(a+="|l:",a+=b.limit),b.startAt&&(a+="|lb:",a+=b.startAt.inclusive?"b:":"a:",a+=b.startAt.position.map(a=>ou(a)).join(",")),b.endAt&&(a+="|ub:",a+=b.endAt.inclusive?"a:":"b:",a+=b.endAt.position.map(a=>ou(a)).join(",")),b.memoizedCanonicalId=a}return b.memoizedCanonicalId}function pw(a){let b=a.path.canonicalString();return null!==a.collectionGroup&&(b+=" collectionGroup="+a.collectionGroup),a.filters.length>0&&(b+=`, filters: [${a.filters.map(a=>pi(a)).join(", ")}]`),n4(a.limit)||(b+=", limit: "+a.limit),a.orderBy.length>0&&(b+=`, orderBy: [${a.orderBy.map(a=>o4(a)).join(", ")}]`),a.startAt&&(b+=", startAt: ",b+=a.startAt.inclusive?"b:":"a:",b+=a.startAt.position.map(a=>ou(a)).join(",")),a.endAt&&(b+=", endAt: ",b+=a.endAt.inclusive?"a:":"b:",b+=a.endAt.position.map(a=>ou(a)).join(",")),`Target(${b})`}function px(a,b){if(a.limit!==b.limit||a.orderBy.length!==b.orderBy.length)return!1;for(let c=0;c<a.orderBy.length;c++)if(!o5(a.orderBy[c],b.orderBy[c]))return!1;if(a.filters.length!==b.filters.length)return!1;for(let c=0;c<a.filters.length;c++)if(!pe(a.filters[c],b.filters[c]))return!1;return a.collectionGroup===b.collectionGroup&&!!a.path.isEqual(b.path)&&!!o1(a.startAt,b.startAt)&&o1(a.endAt,b.endAt)}function py(a){return lu.isDocumentKey(a.path)&&null===a.collectionGroup&&0===a.filters.length}function pz(a,b){return a.filters.filter(a=>a instanceof o7&&a.field.isEqual(b))}function pA(a,b){let c=lL(b);if(void 0===c)return null;for(let b of pz(a,c.fieldPath))switch(b.op){case"array-contains-any":return b.value.arrayValue.values||[];case"array-contains":return[b.value]}return null}function pB(a,b){let c=new Map;for(let d of lM(b))for(let b of pz(a,d.fieldPath))switch(b.op){case"==":case"in":c.set(d.fieldPath.canonicalString(),b.value);break;case"not-in":case"!=":return c.set(d.fieldPath.canonicalString(),b.value),Array.from(c.values())}return null}function pC(a,b){let c=[],d=!0;for(let e of lM(b)){let b=0===e.kind?pE(a,e.fieldPath,a.startAt):pF(a,e.fieldPath,a.startAt);c.push(b.value),d&&(d=b.inclusive)}return new oZ(c,d)}function pD(a,b){let c=[],d=!0;for(let e of lM(b)){let b=0===e.kind?pF(a,e.fieldPath,a.endAt):pE(a,e.fieldPath,a.endAt);c.push(b.value),d&&(d=b.inclusive)}return new oZ(c,d)}function pE(a,b,c){let d=oc,e=!0;for(let c of pz(a,b)){let a=oc,b=!0;switch(c.op){case"<":case"<=":a=oR(c.value);break;case"==":case"in":case">=":a=c.value;break;case">":a=c.value,b=!1;break;case"!=":case"not-in":a=oc}0>oT({value:d,inclusive:e},{value:a,inclusive:b})&&(d=a,e=b)}if(null!==c){for(let f=0;f<a.orderBy.length;++f)if(a.orderBy[f].field.isEqual(b)){let a=c.position[f];0>oT({value:d,inclusive:e},{value:a,inclusive:c.inclusive})&&(d=a,e=c.inclusive);break}}return{value:d,inclusive:e}}function pF(a,b,c){let d=n9,e=!0;for(let c of pz(a,b)){let a=n9,b=!0;switch(c.op){case">=":case">":a=oS(c.value),b=!1;break;case"==":case"in":case"<=":a=c.value;break;case"<":a=c.value,b=!1;break;case"!=":case"not-in":a=n9}oU({value:d,inclusive:e},{value:a,inclusive:b})>0&&(d=a,e=b)}if(null!==c){for(let f=0;f<a.orderBy.length;++f)if(a.orderBy[f].field.isEqual(b)){let a=c.position[f];oU({value:d,inclusive:e},{value:a,inclusive:c.inclusive})>0&&(d=a,e=c.inclusive);break}}return{value:d,inclusive:e}}function pG(a){let b=new nF(lt.comparator),c=!1;for(let d of a.filters)for(let a of d.getFlattenedFilters())a.field.isKeyField()||("array-contains"===a.op||"array-contains-any"===a.op?c=!0:b=b.add(a.field));for(let c of a.orderBy)c.field.isKeyField()||(b=b.add(c.field));return b.size+ +!!c}function pH(a){return null!==a.limit}class pI{constructor(a,b=null,c=[],d=[],e=null,f="F",g=null,h=null){this.path=a,this.collectionGroup=b,this.explicitOrderBy=c,this.filters=d,this.limit=e,this.limitType=f,this.startAt=g,this.endAt=h,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}}function pJ(a,b,c,d,e,f,g,h){return new pI(a,b,c,d,e,f,g,h)}function pK(a){return new pI(a)}function pL(a,b){return new pI(b,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}function pM(a){return 0===a.filters.length&&null===a.limit&&null==a.startAt&&null==a.endAt&&(0===a.explicitOrderBy.length||1===a.explicitOrderBy.length&&a.explicitOrderBy[0].field.isKeyField())}function pN(a){let b=new nF(lt.comparator);return a.filters.forEach(a=>{a.getFlattenedFilters().forEach(a=>{a.isInequality()&&(b=b.add(a.field))})}),b}function pO(a){return lu.isDocumentKey(a.path)&&null===a.collectionGroup&&0===a.filters.length}function pP(a){return null!==a.collectionGroup}function pQ(a){let b=k2(a);if(null===b.memoizedNormalizedOrderBy){b.memoizedNormalizedOrderBy=[];let a=new Set;for(let c of b.explicitOrderBy)b.memoizedNormalizedOrderBy.push(c),a.add(c.field.canonicalString());let c=b.explicitOrderBy.length>0?b.explicitOrderBy[b.explicitOrderBy.length-1].dir:"asc";pN(b).forEach(d=>{a.has(d.canonicalString())||d.isKeyField()||b.memoizedNormalizedOrderBy.push(new o2(d,c))}),a.has(lt.keyField().canonicalString())||b.memoizedNormalizedOrderBy.push(new o2(lt.keyField(),c))}return b.memoizedNormalizedOrderBy}function pR(a){let b=k2(a);return b.memoizedTarget||(b.memoizedTarget=pT(b,pQ(a))),b.memoizedTarget}function pS(a){let b=k2(a);return b.memoizedAggregateTarget||(b.memoizedAggregateTarget=pT(b,a.explicitOrderBy)),b.memoizedAggregateTarget}function pT(a,b){if("F"===a.limitType)return pu(a.path,a.collectionGroup,b,a.filters,a.limit,a.startAt,a.endAt);{b=b.map(a=>{let b="desc"===a.dir?"asc":"desc";return new o2(a.field,b)});let c=a.endAt?new oZ(a.endAt.position,a.endAt.inclusive):null,d=a.startAt?new oZ(a.startAt.position,a.startAt.inclusive):null;return pu(a.path,a.collectionGroup,b,a.filters,a.limit,c,d)}}function pU(a,b){let c=a.filters.concat([b]);return new pI(a.path,a.collectionGroup,a.explicitOrderBy.slice(),c,a.limit,a.limitType,a.startAt,a.endAt)}function pV(a,b){let c=a.explicitOrderBy.concat([b]);return new pI(a.path,a.collectionGroup,c,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}function pW(a,b,c){return new pI(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),b,c,a.startAt,a.endAt)}function pX(a,b){return new pI(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,b,a.endAt)}function pY(a,b){return new pI(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,b)}function pZ(a,b){return px(pR(a),pR(b))&&a.limitType===b.limitType}function p$(a){return`${pv(pR(a))}|lt:${a.limitType}`}function p_(a){return`Query(target=${pw(pR(a))}; limitType=${a.limitType})`}function p0(a,b){return b.isFoundDocument()&&p1(a,b)&&p2(a,b)&&p3(a,b)&&p4(a,b)}function p1(a,b){let c=b.key.path;return null!==a.collectionGroup?b.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(c):lu.isDocumentKey(a.path)?a.path.isEqual(c):a.path.isImmediateParentOf(c)}function p2(a,b){for(let c of pQ(a))if(!c.field.isKeyField()&&null===b.data.field(c.field))return!1;return!0}function p3(a,b){for(let c of a.filters)if(!c.matches(b))return!1;return!0}function p4(a,b){return(!a.startAt||!!o0(a.startAt,pQ(a),b))&&(!a.endAt||!!o_(a.endAt,pQ(a),b))}function p5(a){return a.collectionGroup||(a.path.length%2==1?a.path.lastSegment():a.path.get(a.path.length-2))}function p6(a){return(b,c)=>{let d=!1;for(let e of pQ(a)){let a=p7(e,b,c);if(0!==a)return a;d=d||e.field.isKeyField()}return 0}}function p7(a,b,c){let d=a.field.isKeyField()?lu.comparator(b.key,c.key):oY(a.field,b,c);switch(a.dir){case"asc":return d;case"desc":return -1*d;default:return k_(19790,{direction:a.dir})}}class p8{constructor(a,b){this.mapKeyFn=a,this.equalsFn=b,this.inner={},this.innerSize=0}get(a){let b=this.mapKeyFn(a),c=this.inner[b];if(void 0!==c){for(let[b,d]of c)if(this.equalsFn(b,a))return d}}has(a){return void 0!==this.get(a)}set(a,b){let c=this.mapKeyFn(a),d=this.inner[c];if(void 0===d){this.inner[c]=[[a,b]],this.innerSize++;return}for(let c=0;c<d.length;c++)if(this.equalsFn(d[c][0],a)){d[c]=[a,b];return}d.push([a,b]),this.innerSize++}delete(a){let b=this.mapKeyFn(a),c=this.inner[b];if(void 0===c)return!1;for(let d=0;d<c.length;d++)if(this.equalsFn(c[d][0],a))return 1===c.length?delete this.inner[b]:c.splice(d,1),this.innerSize--,!0;return!1}forEach(a){ny(this.inner,(b,c)=>{for(let[b,d]of c)a(b,d)})}isEmpty(){return nA(this.inner)}size(){return this.innerSize}}let p9=new nB(lu.comparator);function qa(){return p9}let qb=new nB(lu.comparator);function qc(...a){let b=qb;for(let c of a)b=b.insert(c.key,c);return b}function qd(){return qh()}function qe(a){let b=qb;return a.forEach((a,c)=>b=b.insert(a,c.overlayedDocument)),b}function qf(){return qh()}function qg(){return qh()}function qh(){return new p8(a=>a.toString(),(a,b)=>a.isEqual(b))}let qi=new nB(lu.comparator);function qj(){return qi}let qk=new nF(lu.comparator);function ql(...a){let b=qk;for(let c of a)b=b.add(c);return b}let qm=new nF(lj);function qn(){return qm}function qo(a,b){if(a.useProto3Json){if(isNaN(b))return{doubleValue:"NaN"};else if(b===1/0)return{doubleValue:"Infinity"};else if(b===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:n5(b)?"-0":b}}function qp(a){return{integerValue:""+a}}function qq(a,b){return n6(b)?qp(b):qo(a,b)}class qr{constructor(){this._=void 0}}function qs(a,b,c){return a instanceof qw?nY(c,b):a instanceof qx?qy(a,b):a instanceof qz?qA(a,b):qC(a,b)}function qt(a,b,c){return a instanceof qx?qy(a,b):a instanceof qz?qA(a,b):c}function qu(a,b){return a instanceof qB?oI(b)?b:{integerValue:0}:null}function qv(a,b){return a instanceof qx&&b instanceof qx||a instanceof qz&&b instanceof qz?ln(a.elements,b.elements,oe):a instanceof qB&&b instanceof qB?oe(a.operand,b.operand):a instanceof qw&&b instanceof qw}class qw extends qr{}class qx extends qr{constructor(a){super(),this.elements=a}}function qy(a,b){let c=qE(b);for(let b of a.elements)c.some(a=>oe(a,b))||c.push(b);return{arrayValue:{values:c}}}class qz extends qr{constructor(a){super(),this.elements=a}}function qA(a,b){let c=qE(b);for(let b of a.elements)c=c.filter(a=>!oe(a,b));return{arrayValue:{values:c}}}class qB extends qr{constructor(a,b){super(),this.serializer=a,this.operand=b}}function qC(a,b){let c=qu(a,b),d=qD(c)+qD(a.operand);return oG(c)&&oG(a.operand)?qp(d):qo(a.serializer,d)}function qD(a){return nR(a.integerValue||a.doubleValue)}function qE(a){return oJ(a)&&a.arrayValue.values?a.arrayValue.values.slice():[]}class qF{constructor(a,b){this.field=a,this.transform=b}}function qG(a,b){return a.field.isEqual(b.field)&&qv(a.transform,b.transform)}function qH(a,b){return void 0===a&&void 0===b||!!a&&!!b&&ln(a,b,(a,b)=>qG(a,b))}class qI{constructor(a,b){this.version=a,this.transformResults=b}}class qJ{constructor(a,b){this.updateTime=a,this.exists=b}static none(){return new qJ}static exists(a){return new qJ(void 0,a)}static updateTime(a){return new qJ(a)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(a){return this.exists===a.exists&&(this.updateTime?!!a.updateTime&&this.updateTime.isEqual(a.updateTime):!a.updateTime)}}function qK(a,b){return void 0!==a.updateTime?b.isFoundDocument()&&b.version.isEqual(a.updateTime):void 0===a.exists||a.exists===b.isFoundDocument()}class qL{}function qM(a,b){if(!a.hasLocalMutations||b&&0===b.fields.length)return null;if(null===b)if(a.isNoDocument())return new q$(a.key,qJ.none());else return new qR(a.key,a.data,qJ.none());{let c=a.data,d=oV.empty(),e=new nF(lt.comparator);for(let a of b.fields)if(!e.has(a)){let b=c.field(a);null===b&&a.length>1&&(a=a.popLast(),b=c.field(a)),null===b?d.delete(a):d.set(a,b),e=e.add(a)}return new qU(a.key,d,new nJ(e.toArray()),qJ.none())}}function qN(a,b,c){a instanceof qR?qS(a,b,c):a instanceof qU?qV(a,b,c):q_(a,b,c)}function qO(a,b,c,d){return a instanceof qR?qT(a,b,c,d):a instanceof qU?qW(a,b,c,d):q0(a,b,c)}function qP(a,b){let c=null;for(let d of a.fieldTransforms){let a=b.data.field(d.field),e=qu(d.transform,a||null);null!=e&&(null===c&&(c=oV.empty()),c.set(d.field,e))}return c||null}function qQ(a,b){return a.type===b.type&&!!a.key.isEqual(b.key)&&!!a.precondition.isEqual(b.precondition)&&!!qH(a.fieldTransforms,b.fieldTransforms)&&(0===a.type?a.value.isEqual(b.value):1!==a.type||a.data.isEqual(b.data)&&a.fieldMask.isEqual(b.fieldMask))}class qR extends qL{constructor(a,b,c,d=[]){super(),this.key=a,this.value=b,this.precondition=c,this.fieldTransforms=d,this.type=0}getFieldMask(){return null}}function qS(a,b,c){let d=a.value.clone(),e=qY(a.fieldTransforms,b,c.transformResults);d.setAll(e),b.convertToFoundDocument(c.version,d).setHasCommittedMutations()}function qT(a,b,c,d){if(!qK(a.precondition,b))return c;let e=a.value.clone(),f=qZ(a.fieldTransforms,d,b);return e.setAll(f),b.convertToFoundDocument(b.version,e).setHasLocalMutations(),null}class qU extends qL{constructor(a,b,c,d,e=[]){super(),this.key=a,this.data=b,this.fieldMask=c,this.precondition=d,this.fieldTransforms=e,this.type=1}getFieldMask(){return this.fieldMask}}function qV(a,b,c){if(!qK(a.precondition,b))return void b.convertToUnknownDocument(c.version);let d=qY(a.fieldTransforms,b,c.transformResults),e=b.data;e.setAll(qX(a)),e.setAll(d),b.convertToFoundDocument(c.version,e).setHasCommittedMutations()}function qW(a,b,c,d){if(!qK(a.precondition,b))return c;let e=qZ(a.fieldTransforms,d,b),f=b.data;return(f.setAll(qX(a)),f.setAll(e),b.convertToFoundDocument(b.version,f).setHasLocalMutations(),null===c)?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(a=>a.field))}function qX(a){let b=new Map;return a.fieldMask.fields.forEach(c=>{if(!c.isEmpty()){let d=a.data.field(c);b.set(c,d)}}),b}function qY(a,b,c){let d=new Map;k1(a.length===c.length,32656,{serverTransformResultCount:c.length,fieldTransformCount:a.length});for(let e=0;e<c.length;e++){let f=a[e],g=f.transform,h=b.data.field(f.field);d.set(f.field,qt(g,h,c[e]))}return d}function qZ(a,b,c){let d=new Map;for(let e of a){let a=e.transform,f=c.data.field(e.field);d.set(e.field,qs(a,f,b))}return d}class q$ extends qL{constructor(a,b){super(),this.key=a,this.precondition=b,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}function q_(a,b,c){b.convertToNoDocument(c.version).setHasCommittedMutations()}function q0(a,b,c){return qK(a.precondition,b)?(b.convertToNoDocument(b.version).setHasLocalMutations(),null):c}class q1 extends qL{constructor(a,b){super(),this.key=a,this.precondition=b,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class q2{constructor(a,b,c,d){this.batchId=a,this.localWriteTime=b,this.baseMutations=c,this.mutations=d}applyToRemoteDocument(a,b){let c=b.mutationResults;for(let b=0;b<this.mutations.length;b++){let d=this.mutations[b];d.key.isEqual(a.key)&&qN(d,a,c[b])}}applyToLocalView(a,b){for(let c of this.baseMutations)c.key.isEqual(a.key)&&(b=qO(c,a,b,this.localWriteTime));for(let c of this.mutations)c.key.isEqual(a.key)&&(b=qO(c,a,b,this.localWriteTime));return b}applyToLocalDocumentSet(a,b){let c=qg();return this.mutations.forEach(d=>{let e=a.get(d.key),f=e.overlayedDocument,g=this.applyToLocalView(f,e.mutatedFields),h=qM(f,g=b.has(d.key)?null:g);null!==h&&c.set(d.key,h),f.isValidDocument()||f.convertToNoDocument(lH.min())}),c}keys(){return this.mutations.reduce((a,b)=>a.add(b.key),ql())}isEqual(a){return this.batchId===a.batchId&&ln(this.mutations,a.mutations,(a,b)=>qQ(a,b))&&ln(this.baseMutations,a.baseMutations,(a,b)=>qQ(a,b))}}class q3{constructor(a,b,c,d){this.batch=a,this.commitVersion=b,this.mutationResults=c,this.docVersions=d}static from(a,b,c){k1(a.mutations.length===c.length,58842,{mutationsSent:a.mutations.length,resultsReceived:c.length});let d=qj(),e=a.mutations;for(let a=0;a<e.length;a++)d=d.insert(e[a].key,c[a].version);return new q3(a,b,c,d)}}class q4{constructor(a,b){this.largestBatchId=a,this.mutation=b}getKey(){return this.mutation.key}isEqual(a){return null!==a&&this.mutation===a.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class q5{constructor(a,b){this.count=a,this.unchangedNames=b}}function q6(a){switch(a){case k3.OK:return k_(64938);case k3.CANCELLED:case k3.UNKNOWN:case k3.DEADLINE_EXCEEDED:case k3.RESOURCE_EXHAUSTED:case k3.INTERNAL:case k3.UNAVAILABLE:case k3.UNAUTHENTICATED:return!1;case k3.INVALID_ARGUMENT:case k3.NOT_FOUND:case k3.ALREADY_EXISTS:case k3.PERMISSION_DENIED:case k3.FAILED_PRECONDITION:case k3.ABORTED:case k3.OUT_OF_RANGE:case k3.UNIMPLEMENTED:case k3.DATA_LOSS:return!0;default:return k_(15467,{code:a})}}function q7(a){return q6(a)&&a!==k3.ABORTED}function q8(a){if(void 0===a)return kY("GRPC error has no .code"),k3.UNKNOWN;switch(a){case i.OK:return k3.OK;case i.CANCELLED:return k3.CANCELLED;case i.UNKNOWN:return k3.UNKNOWN;case i.DEADLINE_EXCEEDED:return k3.DEADLINE_EXCEEDED;case i.RESOURCE_EXHAUSTED:return k3.RESOURCE_EXHAUSTED;case i.INTERNAL:return k3.INTERNAL;case i.UNAVAILABLE:return k3.UNAVAILABLE;case i.UNAUTHENTICATED:return k3.UNAUTHENTICATED;case i.INVALID_ARGUMENT:return k3.INVALID_ARGUMENT;case i.NOT_FOUND:return k3.NOT_FOUND;case i.ALREADY_EXISTS:return k3.ALREADY_EXISTS;case i.PERMISSION_DENIED:return k3.PERMISSION_DENIED;case i.FAILED_PRECONDITION:return k3.FAILED_PRECONDITION;case i.ABORTED:return k3.ABORTED;case i.OUT_OF_RANGE:return k3.OUT_OF_RANGE;case i.UNIMPLEMENTED:return k3.UNIMPLEMENTED;case i.DATA_LOSS:return k3.DATA_LOSS;default:return k_(39323,{code:a})}}!function(a){a[a.OK=0]="OK",a[a.CANCELLED=1]="CANCELLED",a[a.UNKNOWN=2]="UNKNOWN",a[a.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",a[a.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",a[a.NOT_FOUND=5]="NOT_FOUND",a[a.ALREADY_EXISTS=6]="ALREADY_EXISTS",a[a.PERMISSION_DENIED=7]="PERMISSION_DENIED",a[a.UNAUTHENTICATED=16]="UNAUTHENTICATED",a[a.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",a[a.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",a[a.ABORTED=10]="ABORTED",a[a.OUT_OF_RANGE=11]="OUT_OF_RANGE",a[a.UNIMPLEMENTED=12]="UNIMPLEMENTED",a[a.INTERNAL=13]="INTERNAL",a[a.UNAVAILABLE=14]="UNAVAILABLE",a[a.DATA_LOSS=15]="DATA_LOSS"}(i||(i={}));class q9 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}let ra=null;function rb(a){if(ra)throw Error("a TestingHooksSpi instance is already set");ra=a}let rc=new g([0xffffffff,0xffffffff],0);function rd(a){let b=lg().encode(a),c=new h;return c.update(b),new Uint8Array(c.digest())}function re(a){let b=new DataView(a.buffer),c=b.getUint32(0,!0),d=b.getUint32(4,!0),e=b.getUint32(8,!0),f=b.getUint32(12,!0);return[new g([c,d],0),new g([e,f],0)]}class rf{constructor(a,b,c){if(this.bitmap=a,this.padding=b,this.hashCount=c,b<0||b>=8)throw new rg(`Invalid padding: ${b}`);if(c<0||a.length>0&&0===this.hashCount)throw new rg(`Invalid hash count: ${c}`);if(0===a.length&&0!==b)throw new rg(`Invalid padding when bitmap length is 0: ${b}`);this.bitCount=8*a.length-b,this.bitCountInInteger=g.fromNumber(this.bitCount)}getBitIndex(a,b,c){let d=a.add(b.multiply(g.fromNumber(c)));return 1===d.compare(rc)&&(d=new g([d.getBits(0),d.getBits(1)],0)),d.modulo(this.bitCountInInteger).toNumber()}isBitSet(a){return(this.bitmap[Math.floor(a/8)]&1<<a%8)!=0}mightContain(a){if(0===this.bitCount)return!1;let[b,c]=re(rd(a));for(let a=0;a<this.hashCount;a++){let d=this.getBitIndex(b,c,a);if(!this.isBitSet(d))return!1}return!0}static create(a,b,c){let d=a%8==0?0:8-a%8,e=new rf(new Uint8Array(Math.ceil(a/8)),d,b);return c.forEach(a=>e.insert(a)),e}insert(a){if(0===this.bitCount)return;let[b,c]=re(rd(a));for(let a=0;a<this.hashCount;a++){let d=this.getBitIndex(b,c,a);this.setBit(d)}}setBit(a){let b=Math.floor(a/8),c=a%8;this.bitmap[b]|=1<<c}}class rg extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class rh{constructor(a,b,c,d,e){this.snapshotVersion=a,this.targetChanges=b,this.targetMismatches=c,this.documentUpdates=d,this.resolvedLimboDocuments=e}static createSynthesizedRemoteEventForCurrentChange(a,b,c){let d=new Map;return d.set(a,ri.createSynthesizedTargetChangeForCurrentChange(a,b,c)),new rh(lH.min(),d,new nB(lj),qa(),ql())}}class ri{constructor(a,b,c,d,e){this.resumeToken=a,this.current=b,this.addedDocuments=c,this.modifiedDocuments=d,this.removedDocuments=e}static createSynthesizedTargetChangeForCurrentChange(a,b,c){return new ri(c,b,ql(),ql(),ql())}}class rj{constructor(a,b,c,d){this.updatedTargetIds=a,this.removedTargetIds=b,this.key=c,this.newDoc=d}}class rk{constructor(a,b){this.targetId=a,this.existenceFilter=b}}class rl{constructor(a,b,c=nM.EMPTY_BYTE_STRING,d=null){this.state=a,this.targetIds=b,this.resumeToken=c,this.cause=d}}class rm{constructor(){this.pendingResponses=0,this.documentChanges=rq(),this._resumeToken=nM.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return 0!==this.pendingResponses}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(a){a.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=a)}toTargetChange(){let a=ql(),b=ql(),c=ql();return this.documentChanges.forEach((d,e)=>{switch(e){case 0:a=a.add(d);break;case 2:b=b.add(d);break;case 1:c=c.add(d);break;default:k_(38017,{changeType:e})}}),new ri(this._resumeToken,this._current,a,b,c)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=rq()}addDocumentChange(a,b){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(a,b)}removeDocumentChange(a){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(a)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,k1(this.pendingResponses>=0,3241,{pendingResponses:this.pendingResponses})}markCurrent(){this._hasPendingChanges=!0,this._current=!0}}let rn="WatchChangeAggregator";class ro{constructor(a){this.metadataProvider=a,this.targetStates=new Map,this.pendingDocumentUpdates=qa(),this.pendingDocumentUpdatesByTarget=rp(),this.pendingDocumentTargetMapping=rp(),this.pendingTargetResets=new nB(lj)}handleDocumentChange(a){for(let b of a.updatedTargetIds)a.newDoc&&a.newDoc.isFoundDocument()?this.addDocumentToTarget(b,a.newDoc):this.removeDocumentFromTarget(b,a.key,a.newDoc);for(let b of a.removedTargetIds)this.removeDocumentFromTarget(b,a.key,a.newDoc)}handleTargetChange(a){this.forEachTarget(a,b=>{let c=this.ensureTargetState(b);switch(a.state){case 0:this.isActiveTarget(b)&&c.updateResumeToken(a.resumeToken);break;case 1:c.recordTargetResponse(),c.isPending||c.clearPendingChanges(),c.updateResumeToken(a.resumeToken);break;case 2:c.recordTargetResponse(),c.isPending||this.removeTarget(b);break;case 3:this.isActiveTarget(b)&&(c.markCurrent(),c.updateResumeToken(a.resumeToken));break;case 4:this.isActiveTarget(b)&&(this.resetTarget(b),c.updateResumeToken(a.resumeToken));break;default:k_(56790,{state:a.state})}})}forEachTarget(a,b){a.targetIds.length>0?a.targetIds.forEach(b):this.targetStates.forEach((a,c)=>{this.isActiveTarget(c)&&b(c)})}handleExistenceFilter(a){let b=a.targetId,c=a.existenceFilter.count,d=this.targetDataForActiveTarget(b);if(d){let e=d.target;if(py(e))if(0===c){let a=new lu(e.path);this.removeDocumentFromTarget(b,a,oX.newNoDocument(a,lH.min()))}else k1(1===c,20013,{expectedCount:c});else{let d=this.getCurrentDocumentCountForTarget(b);if(d!==c){let c=this.parseBloomFilter(a),e=c?this.applyBloomFilter(c,a,d):1;if(0!==e){this.resetTarget(b);let a=2===e?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(b,a)}null==ra||ra.notifyOnExistenceFilterMismatch(rr(d,a.existenceFilter,this.metadataProvider.getDatabaseId(),c,e))}}}}parseBloomFilter(a){let b,c,d=a.existenceFilter.unchangedNames;if(!d||!d.bits)return null;let{bits:{bitmap:e="",padding:f=0},hashCount:g=0}=d;try{b=nS(e).toUint8Array()}catch(a){if(a instanceof q9)return kZ("Decoding the base64 bloom filter in existence filter failed ("+a.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw a}try{c=new rf(b,f,g)}catch(a){return a instanceof rg?kZ("BloomFilter error: ",a):kZ("Applying bloom filter failed: ",a),null}return 0===c.bitCount?null:c}applyBloomFilter(a,b,c){return 2*(b.existenceFilter.count!==c-this.filterRemovedDocuments(a,b.targetId))}filterRemovedDocuments(a,b){let c=this.metadataProvider.getRemoteKeysForTarget(b),d=0;return c.forEach(c=>{let e=this.metadataProvider.getDatabaseId(),f=`projects/${e.projectId}/databases/${e.database}/documents/${c.path.canonicalString()}`;!a.mightContain(f)&&(this.removeDocumentFromTarget(b,c,null),d++)}),d}createRemoteEvent(a){let b=new Map;this.targetStates.forEach((c,d)=>{let e=this.targetDataForActiveTarget(d);if(e){if(c.current&&py(e.target)){let b=new lu(e.target.path);this.ensureDocumentUpdateByTarget(b).has(d)||this.targetContainsDocument(d,b)||this.removeDocumentFromTarget(d,b,oX.newNoDocument(b,a))}c.hasPendingChanges&&(b.set(d,c.toTargetChange()),c.clearPendingChanges())}});let c=ql();this.pendingDocumentTargetMapping.forEach((a,b)=>{let d=!0;b.forEachWhile(a=>{let b=this.targetDataForActiveTarget(a);return!b||"TargetPurposeLimboResolution"===b.purpose||(d=!1,!1)}),d&&(c=c.add(a))}),this.pendingDocumentUpdates.forEach((b,c)=>c.setReadTime(a));let d=new rh(a,b,this.pendingTargetResets,this.pendingDocumentUpdates,c);return this.pendingDocumentUpdates=qa(),this.pendingDocumentUpdatesByTarget=rp(),this.pendingDocumentTargetMapping=rp(),this.pendingTargetResets=new nB(lj),d}addDocumentToTarget(a,b){if(!this.isActiveTarget(a))return;let c=2*!!this.targetContainsDocument(a,b.key);this.ensureTargetState(a).addDocumentChange(b.key,c),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(b.key,b),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(b.key,this.ensureDocumentUpdateByTarget(b.key).add(a)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(b.key,this.ensureDocumentTargetMapping(b.key).add(a))}removeDocumentFromTarget(a,b,c){if(!this.isActiveTarget(a))return;let d=this.ensureTargetState(a);this.targetContainsDocument(a,b)?d.addDocumentChange(b,1):d.removeDocumentChange(b),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(b,this.ensureDocumentTargetMapping(b).delete(a)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(b,this.ensureDocumentTargetMapping(b).add(a)),c&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(b,c))}removeTarget(a){this.targetStates.delete(a)}getCurrentDocumentCountForTarget(a){let b=this.ensureTargetState(a).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(a).size+b.addedDocuments.size-b.removedDocuments.size}recordPendingTargetRequest(a){this.ensureTargetState(a).recordPendingTargetRequest()}ensureTargetState(a){let b=this.targetStates.get(a);return b||(b=new rm,this.targetStates.set(a,b)),b}ensureDocumentTargetMapping(a){let b=this.pendingDocumentTargetMapping.get(a);return b||(b=new nF(lj),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(a,b)),b}ensureDocumentUpdateByTarget(a){let b=this.pendingDocumentUpdatesByTarget.get(a);return b||(b=new nF(lj),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(a,b)),b}isActiveTarget(a){let b=null!==this.targetDataForActiveTarget(a);return b||kX(rn,"Detected inactive target",a),b}targetDataForActiveTarget(a){let b=this.targetStates.get(a);return b&&b.isPending?null:this.metadataProvider.getTargetDataForTarget(a)}resetTarget(a){this.targetStates.set(a,new rm),this.metadataProvider.getRemoteKeysForTarget(a).forEach(b=>{this.removeDocumentFromTarget(a,b,null)})}targetContainsDocument(a,b){return this.metadataProvider.getRemoteKeysForTarget(a).has(b)}}function rp(){return new nB(lu.comparator)}function rq(){return new nB(lu.comparator)}function rr(a,b,c,d,e){var f,g,h,i,j,k;let l={localCacheCount:a,existenceFilterCount:b.count,databaseId:c.database,projectId:c.projectId},m=b.unchangedNames;return m&&(l.bloomFilter={applied:0===e,hashCount:null!=(f=null==m?void 0:m.hashCount)?f:0,bitmapLength:null!=(i=null==(h=null==(g=null==m?void 0:m.bits)?void 0:g.bitmap)?void 0:h.length)?i:0,padding:null!=(k=null==(j=null==m?void 0:m.bits)?void 0:j.padding)?k:0,mightContain:a=>{var b;return null!=(b=null==d?void 0:d.mightContain(a))&&b}}),l}let rs=(()=>{let a={};return a.asc="ASCENDING",a.desc="DESCENDING",a})(),rt=(()=>{let a={};return a["<"]="LESS_THAN",a["<="]="LESS_THAN_OR_EQUAL",a[">"]="GREATER_THAN",a[">="]="GREATER_THAN_OR_EQUAL",a["=="]="EQUAL",a["!="]="NOT_EQUAL",a["array-contains"]="ARRAY_CONTAINS",a.in="IN",a["not-in"]="NOT_IN",a["array-contains-any"]="ARRAY_CONTAINS_ANY",a})(),ru=(()=>{let a={};return a.and="AND",a.or="OR",a})();class rv{constructor(a,b){this.databaseId=a,this.useProto3Json=b}}function rw(a){return new k4(void 0===a.code?k3.UNKNOWN:q8(a.code),a.message||"")}function rx(a,b){return a.useProto3Json||n4(b)?b:{value:b}}function ry(a){let b;return n4(b="object"==typeof a?a.value:a)?null:b}function rz(a,b){if(!a.useProto3Json)return{seconds:""+b.seconds,nanos:b.nanoseconds};{let a=new Date(1e3*b.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),c=("000000000"+b.nanoseconds).slice(-9);return`${a}.${c}Z`}}function rA(a){let b=nQ(a);return new lG(b.seconds,b.nanos)}function rB(a,b){return a.useProto3Json?b.toBase64():b.toUint8Array()}function rC(a,b){return a.useProto3Json?(k1(void 0===b||"string"==typeof b,58123),nM.fromBase64String(b||"")):(k1(void 0===b||b instanceof Buffer||b instanceof Uint8Array,16193),nM.fromUint8Array(b||new Uint8Array))}function rD(a,b){return rz(a,b.toTimestamp())}function rE(a){return k1(!!a,49232),lH.fromTimestamp(rA(a))}function rF(a,b){return rG(a,b).canonicalString()}function rG(a,b){let c=rN(a).child("documents");return void 0===b?c:c.child(b)}function rH(a){let b=lr.fromString(a);return k1(sE(b),10190,{key:b.toString()}),b}function rI(a,b){return rF(a.databaseId,b.path)}function rJ(a,b){let c=rH(b);if(c.get(1)!==a.databaseId.projectId)throw new k4(k3.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+c.get(1)+" vs "+a.databaseId.projectId);if(c.get(3)!==a.databaseId.database)throw new k4(k3.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+c.get(3)+" vs "+a.databaseId.database);return new lu(rO(c))}function rK(a,b){return rF(a.databaseId,b)}function rL(a){let b=rH(a);return 4===b.length?lr.emptyPath():rO(b)}function rM(a){return new lr(["projects",a.databaseId.projectId,"databases",a.databaseId.database]).canonicalString()}function rN(a){return new lr(["projects",a.projectId,"databases",a.database])}function rO(a){return k1(a.length>4&&"documents"===a.get(4),29091,{key:a.toString()}),a.popFirst(5)}function rP(a,b,c){return{name:rI(a,b),fields:c.value.mapValue.fields}}function rQ(a,b){return{name:rI(a,b.key),fields:b.data.value.mapValue.fields,updateTime:rz(a,b.version.toTimestamp()),createTime:rz(a,b.createTime.toTimestamp())}}function rR(a,b,c){let d=rJ(a,b.name),e=rE(b.updateTime),f=b.createTime?rE(b.createTime):lH.min(),g=new oV({mapValue:{fields:b.fields}}),h=oX.newFoundDocument(d,e,f,g);return c&&h.setHasCommittedMutations(),c?h.setHasCommittedMutations():h}function rS(a,b){k1(!!b.found,43571),b.found.name,b.found.updateTime;let c=rJ(a,b.found.name),d=rE(b.found.updateTime),e=b.found.createTime?rE(b.found.createTime):lH.min(),f=new oV({mapValue:{fields:b.found.fields}});return oX.newFoundDocument(c,d,e,f)}function rT(a,b){k1(!!b.missing,3894),k1(!!b.readTime,22933);let c=rJ(a,b.missing),d=rE(b.readTime);return oX.newNoDocument(c,d)}function rU(a,b){return"found"in b?rS(a,b):"missing"in b?rT(a,b):k_(7234,{result:b})}function rV(a,b){let c;if("targetChange"in b){b.targetChange;let d=rW(b.targetChange.targetChangeType||"NO_CHANGE"),e=b.targetChange.targetIds||[],f=rC(a,b.targetChange.resumeToken),g=b.targetChange.cause;c=new rl(d,e,f,g&&rw(g)||null)}else if("documentChange"in b){b.documentChange;let d=b.documentChange;d.document,d.document.name,d.document.updateTime;let e=rJ(a,d.document.name),f=rE(d.document.updateTime),g=d.document.createTime?rE(d.document.createTime):lH.min(),h=new oV({mapValue:{fields:d.document.fields}}),i=oX.newFoundDocument(e,f,g,h);c=new rj(d.targetIds||[],d.removedTargetIds||[],i.key,i)}else if("documentDelete"in b){b.documentDelete;let d=b.documentDelete;d.document;let e=rJ(a,d.document),f=d.readTime?rE(d.readTime):lH.min(),g=oX.newNoDocument(e,f);c=new rj([],d.removedTargetIds||[],g.key,g)}else if("documentRemove"in b){b.documentRemove;let d=b.documentRemove;d.document;let e=rJ(a,d.document);c=new rj([],d.removedTargetIds||[],e,null)}else{if(!("filter"in b))return k_(11601,{change:b});b.filter;let a=b.filter;a.targetId;let{count:d=0,unchangedNames:e}=a,f=new q5(d,e);c=new rk(a.targetId,f)}return c}function rW(a){if("NO_CHANGE"===a)return 0;if("ADD"===a)return 1;if("REMOVE"===a)return 2;if("CURRENT"===a)return 3;if("RESET"===a)return 4;else return k_(39313,{state:a})}function rX(a){if(!("targetChange"in a))return lH.min();let b=a.targetChange;return b.targetIds&&b.targetIds.length||!b.readTime?lH.min():rE(b.readTime)}function rY(a,b){let c;if(b instanceof qR)c={update:rP(a,b.key,b.value)};else if(b instanceof q$)c={delete:rI(a,b.key)};else if(b instanceof qU)c={update:rP(a,b.key,b.data),updateMask:sC(b.fieldMask)};else{if(!(b instanceof q1))return k_(16599,{mutationType:b.type});c={verify:rI(a,b.key)}}return b.fieldTransforms.length>0&&(c.updateTransforms=b.fieldTransforms.map(b=>r2(a,b))),b.precondition.isNone||(c.currentDocument=r$(a,b.precondition)),c}function rZ(a,b){let c=b.currentDocument?r_(b.currentDocument):qJ.none(),d=b.updateTransforms?b.updateTransforms.map(b=>r3(a,b)):[];if(b.update){b.update.name;let e=rJ(a,b.update.name),f=new oV({mapValue:{fields:b.update.fields}});return b.updateMask?new qU(e,f,sD(b.updateMask),c,d):new qR(e,f,c,d)}return b.delete?new q$(rJ(a,b.delete),c):b.verify?new q1(rJ(a,b.verify),c):k_(1463,{proto:b})}function r$(a,b){return void 0!==b.updateTime?{updateTime:rD(a,b.updateTime)}:void 0!==b.exists?{exists:b.exists}:k_(27497)}function r_(a){return void 0!==a.updateTime?qJ.updateTime(rE(a.updateTime)):void 0!==a.exists?qJ.exists(a.exists):qJ.none()}function r0(a,b){let c=a.updateTime?rE(a.updateTime):rE(b);return c.isEqual(lH.min())&&(c=rE(b)),new qI(c,a.transformResults||[])}function r1(a,b){return a&&a.length>0?(k1(void 0!==b,14353),a.map(a=>r0(a,b))):[]}function r2(a,b){let c=b.transform;if(c instanceof qw)return{fieldPath:b.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof qx)return{fieldPath:b.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof qz)return{fieldPath:b.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof qB)return{fieldPath:b.field.canonicalString(),increment:c.operand};throw k_(20930,{transform:b.transform})}function r3(a,b){let c=null;return"setToServerValue"in b?(k1("REQUEST_TIME"===b.setToServerValue,16630,{proto:b}),c=new qw):"appendMissingElements"in b?c=new qx(b.appendMissingElements.values||[]):"removeAllFromArray"in b?c=new qz(b.removeAllFromArray.values||[]):"increment"in b?c=new qB(a,b.increment):k_(16584,{proto:b}),new qF(lt.fromServerFormat(b.fieldPath),c)}function r4(a,b){return{documents:[rK(a,b.path)]}}function r5(a){let b=a.documents.length;return k1(1===b,1966,{count:b}),pR(pK(rL(a.documents[0])))}function r6(a,b){let c,d={structuredQuery:{}},e=b.path;null!==b.collectionGroup?(c=e,d.structuredQuery.from=[{collectionId:b.collectionGroup,allDescendants:!0}]):(c=e.popLast(),d.structuredQuery.from=[{collectionId:e.lastSegment()}]),d.parent=rK(a,c);let f=sd(b.filters);f&&(d.structuredQuery.where=f);let g=sg(b.orderBy);g&&(d.structuredQuery.orderBy=g);let h=rx(a,b.limit);return null!==h&&(d.structuredQuery.limit=h),b.startAt&&(d.structuredQuery.startAt=si(b.startAt)),b.endAt&&(d.structuredQuery.endAt=sj(b.endAt)),{queryTarget:d,parent:c}}function r7(a,b,c,d){let{queryTarget:e,parent:f}=r6(a,b),g={},h=[],i=0;return c.forEach(a=>{let b=d?a.alias:`aggregate_${i++}`;g[b]=a.alias,"count"===a.aggregateType?h.push({alias:b,count:{}}):"avg"===a.aggregateType?h.push({alias:b,avg:{field:ss(a.fieldPath)}}):"sum"===a.aggregateType&&h.push({alias:b,sum:{field:ss(a.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:h,structuredQuery:e.structuredQuery},parent:e.parent},aliasMap:g,parent:f}}function r8(a){let b=rL(a.parent),c=a.structuredQuery,d=c.from?c.from.length:0,e=null;if(d>0){k1(1===d,65062);let a=c.from[0];a.allDescendants?e=a.collectionId:b=b.child(a.collectionId)}let f=[];c.where&&(f=se(c.where));let g=[];c.orderBy&&(g=sh(c.orderBy));let h=null;c.limit&&(h=ry(c.limit));let i=null;c.startAt&&(i=sk(c.startAt));let j=null;return c.endAt&&(j=sl(c.endAt)),pJ(b,e,g,f,h,"F",i,j)}function r9(a){return pR(r8(a))}function sa(a,b){let c=sb(b.purpose);return null==c?null:{"goog-listen-tags":c}}function sb(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return k_(28987,{purpose:a})}}function sc(a,b){let c,d=b.target;if((c=py(d)?{documents:r4(a,d)}:{query:r6(a,d).queryTarget}).targetId=b.targetId,b.resumeToken.approximateByteSize()>0){c.resumeToken=rB(a,b.resumeToken);let d=rx(a,b.expectedCount);null!==d&&(c.expectedCount=d)}else if(b.snapshotVersion.compareTo(lH.min())>0){c.readTime=rz(a,b.snapshotVersion.toTimestamp());let d=rx(a,b.expectedCount);null!==d&&(c.expectedCount=d)}return c}function sd(a){if(0!==a.length)return sw(o8.create(a,"and"))}function se(a){let b=sf(a);return b instanceof o8&&pb(b)?b.getFilters():[b]}function sf(a){return void 0!==a.unaryFilter?sz(a):void 0!==a.fieldFilter?sA(a):void 0!==a.compositeFilter?sB(a):k_(30097,{filter:a})}function sg(a){if(0!==a.length)return a.map(a=>su(a))}function sh(a){return a.map(a=>sv(a))}function si(a){return{before:a.inclusive,values:a.position}}function sj(a){return{before:!a.inclusive,values:a.position}}function sk(a){let b=!!a.before;return new oZ(a.values||[],b)}function sl(a){let b=!a.before;return new oZ(a.values||[],b)}function sm(a){return rs[a]}function sn(a){switch(a){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function so(a){return rt[a]}function sp(a){return ru[a]}function sq(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return k_(58110);default:return k_(50506)}}function sr(a){switch(a){case"AND":return"and";case"OR":return"or";default:return k_(1026)}}function ss(a){return{fieldPath:a.canonicalString()}}function st(a){return lt.fromServerFormat(a.fieldPath)}function su(a){return{field:ss(a.field),direction:sm(a.dir)}}function sv(a){return new o2(st(a.field),sn(a.direction))}function sw(a){return a instanceof o7?sy(a):a instanceof o8?sx(a):k_(54877,{filter:a})}function sx(a){let b=a.getFilters().map(a=>sw(a));return 1===b.length?b[0]:{compositeFilter:{op:sp(a.op),filters:b}}}function sy(a){if("=="===a.op){if(oL(a.value))return{unaryFilter:{field:ss(a.field),op:"IS_NAN"}};else if(oK(a.value))return{unaryFilter:{field:ss(a.field),op:"IS_NULL"}}}else if("!="===a.op){if(oL(a.value))return{unaryFilter:{field:ss(a.field),op:"IS_NOT_NAN"}};else if(oK(a.value))return{unaryFilter:{field:ss(a.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ss(a.field),op:so(a.op),value:a.value}}}function sz(a){switch(a.unaryFilter.op){case"IS_NAN":let b=st(a.unaryFilter.field);return o7.create(b,"==",{doubleValue:NaN});case"IS_NULL":let c=st(a.unaryFilter.field);return o7.create(c,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let d=st(a.unaryFilter.field);return o7.create(d,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let e=st(a.unaryFilter.field);return o7.create(e,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return k_(61313);default:return k_(60726)}}function sA(a){return o7.create(st(a.fieldFilter.field),sq(a.fieldFilter.op),a.fieldFilter.value)}function sB(a){return o8.create(a.compositeFilter.filters.map(a=>sf(a)),sr(a.compositeFilter.op))}function sC(a){let b=[];return a.fields.forEach(a=>b.push(a.canonicalString())),{fieldPaths:b}}function sD(a){return new nJ((a.fieldPaths||[]).map(a=>lt.fromServerFormat(a)))}function sE(a){return a.length>=4&&"projects"===a.get(0)&&"databases"===a.get(2)}class sF{constructor(a,b,c,d,e=lH.min(),f=lH.min(),g=nM.EMPTY_BYTE_STRING,h=null){this.target=a,this.targetId=b,this.purpose=c,this.sequenceNumber=d,this.snapshotVersion=e,this.lastLimboFreeSnapshotVersion=f,this.resumeToken=g,this.expectedCount=h}withSequenceNumber(a){return new sF(this.target,this.targetId,this.purpose,a,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(a,b){return new sF(this.target,this.targetId,this.purpose,this.sequenceNumber,b,this.lastLimboFreeSnapshotVersion,a,null)}withExpectedCount(a){return new sF(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,a)}withLastLimboFreeSnapshotVersion(a){return new sF(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,a,this.resumeToken,this.expectedCount)}}class sG{constructor(a){this.remoteSerializer=a}}function sH(a,b){let c;if(b.document)c=rR(a.remoteSerializer,b.document,!!b.hasCommittedMutations);else if(b.noDocument){let a=lu.fromSegments(b.noDocument.path),d=sM(b.noDocument.readTime);c=oX.newNoDocument(a,d),b.hasCommittedMutations&&c.setHasCommittedMutations()}else{if(!b.unknownDocument)return k_(56709);let a=lu.fromSegments(b.unknownDocument.path),d=sM(b.unknownDocument.version);c=oX.newUnknownDocument(a,d)}return b.readTime&&c.setReadTime(sK(b.readTime)),c}function sI(a,b){let c=b.key,d={prefixPath:c.getCollectionPath().popLast().toArray(),collectionGroup:c.collectionGroup,documentId:c.path.lastSegment(),readTime:sJ(b.readTime),hasCommittedMutations:b.hasCommittedMutations};if(b.isFoundDocument())d.document=rQ(a.remoteSerializer,b);else if(b.isNoDocument())d.noDocument={path:c.path.toArray(),readTime:sL(b.version)};else{if(!b.isUnknownDocument())return k_(57904,{document:b});d.unknownDocument={path:c.path.toArray(),version:sL(b.version)}}return d}function sJ(a){let b=a.toTimestamp();return[b.seconds,b.nanoseconds]}function sK(a){let b=new lG(a[0],a[1]);return lH.fromTimestamp(b)}function sL(a){let b=a.toTimestamp();return{seconds:b.seconds,nanoseconds:b.nanoseconds}}function sM(a){let b=new lG(a.seconds,a.nanoseconds);return lH.fromTimestamp(b)}function sN(a,b,c){let d=c.baseMutations.map(b=>rY(a.remoteSerializer,b)),e=c.mutations.map(b=>rY(a.remoteSerializer,b));return{userId:b,batchId:c.batchId,localWriteTimeMs:c.localWriteTime.toMillis(),baseMutations:d,mutations:e}}function sO(a,b){let c=(b.baseMutations||[]).map(b=>rZ(a.remoteSerializer,b));for(let a=0;a<b.mutations.length-1;++a){let c=b.mutations[a];a+1<b.mutations.length&&void 0!==b.mutations[a+1].transform&&(c.updateTransforms=b.mutations[a+1].transform.fieldTransforms,b.mutations.splice(a+1,1),++a)}let d=b.mutations.map(b=>rZ(a.remoteSerializer,b)),e=lG.fromMillis(b.localWriteTimeMs);return new q2(b.batchId,e,c,d)}function sP(a){let b,c=sM(a.readTime),d=void 0!==a.lastLimboFreeSnapshotVersion?sM(a.lastLimboFreeSnapshotVersion):lH.min();return new sF(b=sR(a.query)?r5(a.query):r9(a.query),a.targetId,"TargetPurposeListen",a.lastListenSequenceNumber,c,d,nM.fromBase64String(a.resumeToken))}function sQ(a,b){let c,d=sL(b.snapshotVersion),e=sL(b.lastLimboFreeSnapshotVersion);c=py(b.target)?r4(a.remoteSerializer,b.target):r6(a.remoteSerializer,b.target).queryTarget;let f=b.resumeToken.toBase64();return{targetId:b.targetId,canonicalId:pv(b.target),readTime:d,resumeToken:f,lastListenSequenceNumber:b.sequenceNumber,lastLimboFreeSnapshotVersion:e,query:c}}function sR(a){return void 0!==a.documents}function sS(a){return{id:a.bundleId,createTime:sM(a.createTime),version:a.version}}function sT(a){return{bundleId:a.id,createTime:sL(rE(a.createTime)),version:a.version}}function sU(a){return{name:a.name,query:sW(a.bundledQuery),readTime:sM(a.readTime)}}function sV(a){return{name:a.name,readTime:sL(rE(a.readTime)),bundledQuery:a.bundledQuery}}function sW(a){let b=r8({parent:a.parent,structuredQuery:a.structuredQuery});return"LAST"===a.limitType?pW(b,b.limit,"L"):b}function sX(a){return{name:a.name,query:sW(a.bundledQuery),readTime:rE(a.readTime)}}function sY(a){return{id:a.id,version:a.version,createTime:rE(a.createTime)}}function sZ(a,b){return new q4(b.largestBatchId,rZ(a.remoteSerializer,b.overlayMutation))}function s$(a,b,c){let[d,e,f]=s_(b,c.mutation.key);return{userId:b,collectionPath:e,documentId:f,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:rY(a.remoteSerializer,c.mutation)}}function s_(a,b){let c=b.path.lastSegment();return[a,mm(b.path.popLast()),c]}function s0(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}function s1(a,b){let c=b?new lS(b.sequenceNumber,new lV(sM(b.readTime),new lu(mp(b.documentKey)),b.largestBatchId)):lS.empty(),d=a.fields.map(([a,b])=>new lQ(lt.fromServerFormat(a),b));return new lK(a.indexId,a.collectionGroup,d,c)}function s2(a,b,c,d){return{indexId:a,uid:b,sequenceNumber:c,readTime:sL(d.readTime),documentKey:mm(d.documentKey.path),largestBatchId:d.largestBatchId}}class s3{getBundleMetadata(a,b){return s4(a).get(b).next(a=>{if(a)return sS(a)})}saveBundleMetadata(a,b){return s4(a).put(sT(b))}getNamedQuery(a,b){return s5(a).get(b).next(a=>{if(a)return sU(a)})}saveNamedQuery(a,b){return s5(a).put(sV(b))}}function s4(a){return nw(a,m$)}function s5(a){return nw(a,m0)}class s6{constructor(a,b){this.serializer=a,this.userId=b}static forUser(a,b){return new s6(a,b.uid||"")}getOverlay(a,b){return s7(a).get(s_(this.userId,b)).next(a=>a?sZ(this.serializer,a):null)}getOverlays(a,b){let c=qf();return l$.forEach(b,b=>this.getOverlay(a,b).next(a=>{null!==a&&c.set(b,a)})).next(()=>c)}saveOverlays(a,b,c){let d=[];return c.forEach((c,e)=>{let f=new q4(b,e);d.push(this.saveOverlay(a,f))}),l$.waitFor(d)}removeOverlaysForBatchId(a,b,c){let d=new Set;b.forEach(a=>d.add(mm(a.getCollectionPath())));let e=[];return d.forEach(b=>{let d=IDBKeyRange.bound([this.userId,b,c],[this.userId,b,c+1],!1,!0);e.push(s7(a).deleteAll(ng,d))}),l$.waitFor(e)}getOverlaysForCollection(a,b,c){let d=qf(),e=mm(b),f=IDBKeyRange.bound([this.userId,e,c],[this.userId,e,1/0],!0);return s7(a).loadAll(ng,f).next(a=>{for(let b of a){let a=sZ(this.serializer,b);d.set(a.getKey(),a)}return d})}getOverlaysForCollectionGroup(a,b,c,d){let e,f=qf(),g=IDBKeyRange.bound([this.userId,b,c],[this.userId,b,1/0],!0);return s7(a).iterate({index:ni,range:g},(a,b,c)=>{let g=sZ(this.serializer,b);f.size()<d||g.largestBatchId===e?(f.set(g.getKey(),g),e=g.largestBatchId):c.done()}).next(()=>f)}saveOverlay(a,b){return s7(a).put(s$(this.serializer,this.userId,b))}}function s7(a){return nw(a,ne)}class s8{globalsStore(a){return nw(a,nk)}getSessionToken(a){return this.globalsStore(a).get("sessionToken").next(a=>{let b=null==a?void 0:a.value;return b?nM.fromUint8Array(b):nM.EMPTY_BYTE_STRING})}setSessionToken(a,b){return this.globalsStore(a).put({name:"sessionToken",value:b.toUint8Array()})}}let s9=5,ta=10,tb=13,tc=15,td=20,te=25,tf=30,tg=37,th=45,ti=50,tj=53,tk=55,tl=60,tm=2;class tn{constructor(){}writeIndexValue(a,b){this.writeIndexValueAux(a,b),b.writeInfinity()}writeIndexValueAux(a,b){if("nullValue"in a)this.writeValueTypeLabel(b,s9);else if("booleanValue"in a)this.writeValueTypeLabel(b,ta),b.writeNumber(+!!a.booleanValue);else if("integerValue"in a)this.writeValueTypeLabel(b,tc),b.writeNumber(nR(a.integerValue));else if("doubleValue"in a){let c=nR(a.doubleValue);isNaN(c)?this.writeValueTypeLabel(b,tb):(this.writeValueTypeLabel(b,tc),n5(c)?b.writeNumber(0):b.writeNumber(c))}else if("timestampValue"in a){let c=a.timestampValue;this.writeValueTypeLabel(b,td),"string"==typeof c&&(c=nQ(c)),b.writeString(`${c.seconds||""}`),b.writeNumber(c.nanos||0)}else if("stringValue"in a)this.writeIndexString(a.stringValue,b),this.writeTruncationMarker(b);else if("bytesValue"in a)this.writeValueTypeLabel(b,tf),b.writeBytes(nS(a.bytesValue)),this.writeTruncationMarker(b);else if("referenceValue"in a)this.writeIndexEntityRef(a.referenceValue,b);else if("geoPointValue"in a){let c=a.geoPointValue;this.writeValueTypeLabel(b,th),b.writeNumber(c.latitude||0),b.writeNumber(c.longitude||0)}else"mapValue"in a?oP(a)?this.writeValueTypeLabel(b,Number.MAX_SAFE_INTEGER):oN(a)?this.writeIndexVector(a.mapValue,b):(this.writeIndexMap(a.mapValue,b),this.writeTruncationMarker(b)):"arrayValue"in a?(this.writeIndexArray(a.arrayValue,b),this.writeTruncationMarker(b)):k_(19022,{indexValue:a})}writeIndexString(a,b){this.writeValueTypeLabel(b,te),this.writeUnlabeledIndexString(a,b)}writeUnlabeledIndexString(a,b){b.writeString(a)}writeIndexMap(a,b){let c=a.fields||{};for(let a of(this.writeValueTypeLabel(b,tk),Object.keys(c)))this.writeIndexString(a,b),this.writeIndexValueAux(c[a],b)}writeIndexVector(a,b){var c,d;let e=a.fields||{};this.writeValueTypeLabel(b,tj);let f=ob,g=(null==(d=null==(c=e[f].arrayValue)?void 0:c.values)?void 0:d.length)||0;this.writeValueTypeLabel(b,tc),b.writeNumber(nR(g)),this.writeIndexString(f,b),this.writeIndexValueAux(e[f],b)}writeIndexArray(a,b){let c=a.values||[];for(let a of(this.writeValueTypeLabel(b,ti),c))this.writeIndexValueAux(a,b)}writeIndexEntityRef(a,b){this.writeValueTypeLabel(b,tg),lu.fromName(a).path.forEach(a=>{this.writeValueTypeLabel(b,tl),this.writeUnlabeledIndexString(a,b)})}writeValueTypeLabel(a,b){a.writeNumber(b)}writeTruncationMarker(a){a.writeNumber(tm)}}tn.INSTANCE=new tn;let to="\uD800",tp="\uDBFF",tq=0,tr=255,ts=1,tt=255,tu=255,tv=0,tw=64,tx=8,ty=1024;function tz(a){let b=new DataView(new ArrayBuffer(8));return b.setFloat64(0,a,!1),new Uint8Array(b.buffer)}function tA(a){if(0===a)return 8;let b=0;return a>>4==0&&(b+=4,a<<=4),a>>6==0&&(b+=2,a<<=2),a>>7==0&&(b+=1),b}function tB(a){let b=0;for(let c=0;c<8;++c){let d=tA(255&a[c]);if(b+=d,8!==d)break}return b}function tC(a){return Math.ceil((tw-tB(a))/tx)}class tD{constructor(){this.buffer=new Uint8Array(ty),this.position=0}writeBytesAscending(a){let b=a[Symbol.iterator](),c=b.next();for(;!c.done;)this.writeByteAscending(c.value),c=b.next();this.writeSeparatorAscending()}writeBytesDescending(a){let b=a[Symbol.iterator](),c=b.next();for(;!c.done;)this.writeByteDescending(c.value),c=b.next();this.writeSeparatorDescending()}writeUtf8Ascending(a){for(let b of a){let a=b.charCodeAt(0);if(a<128)this.writeByteAscending(a);else if(a<2048)this.writeByteAscending(960|a>>>6),this.writeByteAscending(128|63&a);else if(b<to||tp<b)this.writeByteAscending(480|a>>>12),this.writeByteAscending(128|63&a>>>6),this.writeByteAscending(128|63&a);else{let a=b.codePointAt(0);this.writeByteAscending(240|a>>>18),this.writeByteAscending(128|63&a>>>12),this.writeByteAscending(128|63&a>>>6),this.writeByteAscending(128|63&a)}}this.writeSeparatorAscending()}writeUtf8Descending(a){for(let b of a){let a=b.charCodeAt(0);if(a<128)this.writeByteDescending(a);else if(a<2048)this.writeByteDescending(960|a>>>6),this.writeByteDescending(128|63&a);else if(b<to||tp<b)this.writeByteDescending(480|a>>>12),this.writeByteDescending(128|63&a>>>6),this.writeByteDescending(128|63&a);else{let a=b.codePointAt(0);this.writeByteDescending(240|a>>>18),this.writeByteDescending(128|63&a>>>12),this.writeByteDescending(128|63&a>>>6),this.writeByteDescending(128|63&a)}}this.writeSeparatorDescending()}writeNumberAscending(a){let b=this.toOrderedBits(a),c=tC(b);this.ensureAvailable(1+c),this.buffer[this.position++]=255&c;for(let a=b.length-c;a<b.length;++a)this.buffer[this.position++]=255&b[a]}writeNumberDescending(a){let b=this.toOrderedBits(a),c=tC(b);this.ensureAvailable(1+c),this.buffer[this.position++]=~(255&c);for(let a=b.length-c;a<b.length;++a)this.buffer[this.position++]=~(255&b[a])}writeInfinityAscending(){this.writeEscapedByteAscending(tt),this.writeEscapedByteAscending(tu)}writeInfinityDescending(){this.writeEscapedByteDescending(tt),this.writeEscapedByteDescending(tu)}reset(){this.position=0}seed(a){this.ensureAvailable(a.length),this.buffer.set(a,this.position),this.position+=a.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(a){let b=tz(a),c=(128&b[0])!=0;b[0]^=c?255:128;for(let a=1;a<b.length;++a)b[a]^=255*!!c;return b}writeByteAscending(a){let b=255&a;b===tq?(this.writeEscapedByteAscending(tq),this.writeEscapedByteAscending(tr)):b===tt?(this.writeEscapedByteAscending(tt),this.writeEscapedByteAscending(tv)):this.writeEscapedByteAscending(b)}writeByteDescending(a){let b=255&a;b===tq?(this.writeEscapedByteDescending(tq),this.writeEscapedByteDescending(tr)):b===tt?(this.writeEscapedByteDescending(tt),this.writeEscapedByteDescending(tv)):this.writeEscapedByteDescending(a)}writeSeparatorAscending(){this.writeEscapedByteAscending(tq),this.writeEscapedByteAscending(ts)}writeSeparatorDescending(){this.writeEscapedByteDescending(tq),this.writeEscapedByteDescending(ts)}writeEscapedByteAscending(a){this.ensureAvailable(1),this.buffer[this.position++]=a}writeEscapedByteDescending(a){this.ensureAvailable(1),this.buffer[this.position++]=~a}ensureAvailable(a){let b=a+this.position;if(b<=this.buffer.length)return;let c=2*this.buffer.length;c<b&&(c=b);let d=new Uint8Array(c);d.set(this.buffer),this.buffer=d}}class tE{constructor(a){this.orderedCode=a}writeBytes(a){this.orderedCode.writeBytesAscending(a)}writeString(a){this.orderedCode.writeUtf8Ascending(a)}writeNumber(a){this.orderedCode.writeNumberAscending(a)}writeInfinity(){this.orderedCode.writeInfinityAscending()}}class tF{constructor(a){this.orderedCode=a}writeBytes(a){this.orderedCode.writeBytesDescending(a)}writeString(a){this.orderedCode.writeUtf8Descending(a)}writeNumber(a){this.orderedCode.writeNumberDescending(a)}writeInfinity(){this.orderedCode.writeInfinityDescending()}}class tG{constructor(){this.orderedCode=new tD,this.ascending=new tE(this.orderedCode),this.descending=new tF(this.orderedCode)}seed(a){this.orderedCode.seed(a)}forKind(a){return 0===a?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}}class tH{constructor(a,b,c,d){this._indexId=a,this._documentKey=b,this._arrayValue=c,this._directionalValue=d}successor(){let a=this._directionalValue.length,b=0===a||255===this._directionalValue[a-1]?a+1:a,c=new Uint8Array(b);return c.set(this._directionalValue,0),b!==a?c.set([0],this._directionalValue.length):++c[c.length-1],new tH(this._indexId,this._documentKey,this._arrayValue,c)}dbIndexEntry(a,b,c){return{indexId:this._indexId,uid:a,arrayValue:tK(this._arrayValue),directionalValue:tK(this._directionalValue),orderedDocumentKey:tK(b),documentKey:c.path.toArray()}}dbIndexEntryKey(a,b,c){let d=this.dbIndexEntry(a,b,c);return[d.indexId,d.uid,d.arrayValue,d.directionalValue,d.orderedDocumentKey,d.documentKey]}}function tI(a,b){let c=a._indexId-b._indexId;return 0!==c||0!==(c=tJ(a._arrayValue,b._arrayValue))||0!==(c=tJ(a._directionalValue,b._directionalValue))?c:lu.comparator(a._documentKey,b._documentKey)}function tJ(a,b){for(let c=0;c<a.length&&c<b.length;++c){let d=a[c]-b[c];if(0!==d)return d}return a.length-b.length}function tK(a){return f8()?tM(a):a}function tL(a){return"string"!=typeof a?a:tN(a)}function tM(a){let b="";for(let c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b}function tN(a){let b=new Uint8Array(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}class tO{constructor(a){for(let b of(this.inequalityFilters=new nF((a,b)=>lt.comparator(a.field,b.field)),this.collectionId=null!=a.collectionGroup?a.collectionGroup:a.path.lastSegment(),this.orderBys=a.orderBy,this.equalityFilters=[],a.filters)){let a=b;a.isInequality()?this.inequalityFilters=this.inequalityFilters.add(a):this.equalityFilters.push(a)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(a){if(k1(a.collectionGroup===this.collectionId,49279),this.hasMultipleInequality)return!1;let b=lL(a);if(void 0!==b&&!this.hasMatchingEqualityFilter(b))return!1;let c=lM(a),d=new Set,e=0,f=0;for(;e<c.length;++e)if(this.hasMatchingEqualityFilter(c[e]))d=d.add(c[e].fieldPath.canonicalString());else break;if(e===c.length)return!0;if(this.inequalityFilters.size>0){let a=this.inequalityFilters.getIterator().getNext();if(!d.has(a.field.canonicalString())){let b=c[e];if(!this.matchesFilter(a,b)||!this.matchesOrderBy(this.orderBys[f++],b))return!1}++e}for(;e<c.length;++e){let a=c[e];if(f>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[f++],a))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let a=new nF(lt.comparator),b=[];for(let c of this.equalityFilters)if(!c.field.isKeyField())if("array-contains"===c.op||"array-contains-any"===c.op)b.push(new lQ(c.field,2));else{if(a.has(c.field))continue;a=a.add(c.field),b.push(new lQ(c.field,0))}for(let c of this.orderBys)!c.field.isKeyField()&&(a.has(c.field)||(a=a.add(c.field),b.push(new lQ(c.field,+("asc"!==c.dir)))));return new lK(lK.UNKNOWN_ID,this.collectionId,b,lS.empty())}hasMatchingEqualityFilter(a){for(let b of this.equalityFilters)if(this.matchesFilter(b,a))return!0;return!1}matchesFilter(a,b){if(void 0===a||!a.field.isEqual(b.fieldPath))return!1;let c="array-contains"===a.op||"array-contains-any"===a.op;return 2===b.kind===c}matchesOrderBy(a,b){return!!a.field.isEqual(b.fieldPath)&&(0===b.kind&&"asc"===a.dir||1===b.kind&&"desc"===a.dir)}}function tP(a){var b,c;if(k1(a instanceof o7||a instanceof o8,20012),a instanceof o7)if(!(a instanceof pq))return a;else{let d=(null==(c=null==(b=a.value.arrayValue)?void 0:b.values)?void 0:c.map(b=>o7.create(a.field,"==",b)))||[];return o8.create(d,"or")}let d=a.filters.map(a=>tP(a));return o8.create(d,a.op)}function tQ(a){if(0===a.getFilters().length)return[];let b=tV(tP(a));return(k1(tT(b),7391),tR(b)||tS(b))?[b]:b.getFilters()}function tR(a){return a instanceof o7}function tS(a){return a instanceof o8&&pb(a)}function tT(a){return tR(a)||tS(a)||tU(a)}function tU(a){if(a instanceof o8&&pa(a)){for(let b of a.getFilters())if(!tR(b)&&!tS(b))return!1;return!0}return!1}function tV(a){if(k1(a instanceof o7||a instanceof o8,34018),a instanceof o7)return a;if(1===a.filters.length)return tV(a.filters[0]);let b=a.filters.map(a=>tV(a)),c=o8.create(b,a.op);return tT(c=t$(c))?c:(k1(c instanceof o8,64498),k1(o9(c),40251),k1(c.filters.length>1,57927),c.filters.reduce((a,b)=>tW(a,b)))}function tW(a,b){let c;return k1(a instanceof o7||a instanceof o8,38388),k1(b instanceof o7||b instanceof o8,25473),t$(c=a instanceof o7?b instanceof o7?tX(a,b):tZ(a,b):b instanceof o7?tZ(b,a):tY(a,b))}function tX(a,b){return o8.create([a,b],"and")}function tY(a,b){if(k1(a.filters.length>0&&b.filters.length>0,48005),o9(a)&&o9(b))return ph(a,b.getFilters());let c=pa(a)?a:b,d=pa(a)?b:a,e=c.filters.map(a=>tW(a,d));return o8.create(e,"or")}function tZ(a,b){if(o9(b))return ph(b,a.getFilters());{let c=b.filters.map(b=>tW(a,b));return o8.create(c,"or")}}function t$(a){if(k1(a instanceof o7||a instanceof o8,11850),a instanceof o7)return a;let b=a.getFilters();if(1===b.length)return t$(b[0]);if(pc(a))return a;let c=b.map(a=>t$(a)),d=[];return(c.forEach(b=>{b instanceof o7?d.push(b):b instanceof o8&&(b.op===a.op?d.push(...b.filters):d.push(b))}),1===d.length)?d[0]:o8.create(d,a.op)}class t_{constructor(){this.collectionParentIndex=new t0}addToCollectionParentIndex(a,b){return this.collectionParentIndex.add(b),l$.resolve()}getCollectionParents(a,b){return l$.resolve(this.collectionParentIndex.getEntries(b))}addFieldIndex(a,b){return l$.resolve()}deleteFieldIndex(a,b){return l$.resolve()}deleteAllFieldIndexes(a){return l$.resolve()}createTargetIndexes(a,b){return l$.resolve()}getDocumentsMatchingTarget(a,b){return l$.resolve(null)}getIndexType(a,b){return l$.resolve(0)}getFieldIndexes(a,b){return l$.resolve([])}getNextCollectionGroupToUpdate(a){return l$.resolve(null)}getMinOffset(a,b){return l$.resolve(lV.min())}getMinOffsetFromCollectionGroup(a,b){return l$.resolve(lV.min())}updateCollectionGroup(a,b,c){return l$.resolve()}updateIndexEntries(a,b){return l$.resolve()}}class t0{constructor(){this.index={}}add(a){let b=a.lastSegment(),c=a.popLast(),d=this.index[b]||new nF(lr.comparator),e=!d.has(c);return this.index[b]=d.add(c),e}has(a){let b=a.lastSegment(),c=a.popLast(),d=this.index[b];return d&&d.has(c)}getEntries(a){return(this.index[a]||new nF(lr.comparator)).toArray()}}let t1="IndexedDbIndexManager",t2=new Uint8Array(0);class t3{constructor(a,b){this.databaseId=b,this.collectionParentsCache=new t0,this.targetToDnfSubTargets=new p8(a=>pv(a),(a,b)=>px(a,b)),this.uid=a.uid||""}addToCollectionParentIndex(a,b){if(!this.collectionParentsCache.has(b)){let c=b.lastSegment(),d=b.popLast();a.addOnCommittedListener(()=>{this.collectionParentsCache.add(b)});let e={collectionId:c,parent:mm(d)};return t4(a).put(e)}return l$.resolve()}getCollectionParents(a,b){let c=[],d=IDBKeyRange.bound([b,""],[lo(b),""],!1,!0);return t4(a).loadAll(d).next(a=>{for(let d of a){if(d.collectionId!==b)break;c.push(mp(d.parent))}return c})}addFieldIndex(a,b){let c=t6(a),d=s0(b);delete d.indexId;let e=c.add(d);if(!b.indexState)return e.next();{let c=t7(a);return e.next(a=>{c.put(s2(a,this.uid,b.indexState.sequenceNumber,b.indexState.offset))})}}deleteFieldIndex(a,b){let c=t6(a),d=t7(a),e=t5(a);return c.delete(b.indexId).next(()=>d.delete(IDBKeyRange.bound([b.indexId],[b.indexId+1],!1,!0))).next(()=>e.delete(IDBKeyRange.bound([b.indexId],[b.indexId+1],!1,!0)))}deleteAllFieldIndexes(a){let b=t6(a),c=t5(a),d=t7(a);return b.deleteAll().next(()=>c.deleteAll()).next(()=>d.deleteAll())}createTargetIndexes(a,b){return l$.forEach(this.getSubTargets(b),b=>this.getIndexType(a,b).next(c=>{if(0===c||1===c){let c=new tO(b).buildTargetIndex();if(null!=c)return this.addFieldIndex(a,c)}}))}getDocumentsMatchingTarget(a,b){let c=t5(a),d=!0,e=new Map;return l$.forEach(this.getSubTargets(b),b=>this.getFieldIndex(a,b).next(a=>{d&&(d=!!a),e.set(b,a)})).next(()=>{if(!d)return l$.resolve(null);{let a=ql(),d=[];return l$.forEach(e,(e,f)=>{kX(t1,`Using index ${lP(e)} to execute ${pv(b)}`);let g=pA(f,e),h=pB(f,e),i=pC(f,e),j=pD(f,e),k=this.encodeBound(e,f,i),l=this.encodeBound(e,f,j),m=this.encodeValues(e,f,h),n=this.generateIndexRanges(e.indexId,g,k,i.inclusive,l,j.inclusive,m);return l$.forEach(n,e=>c.loadFirst(e,b.limit).next(b=>{b.forEach(b=>{let c=lu.fromSegments(b.documentKey);a.has(c)||(a=a.add(c),d.push(c))})}))}).next(()=>d)}})}getSubTargets(a){let b=this.targetToDnfSubTargets.get(a);return b||(b=0===a.filters.length?[a]:tQ(o8.create(a.filters,"and")).map(b=>pu(a.path,a.collectionGroup,a.orderBy,b.getFilters(),a.limit,a.startAt,a.endAt)),this.targetToDnfSubTargets.set(a,b)),b}generateIndexRanges(a,b,c,d,e,f,g){let h=(null!=b?b.length:1)*Math.max(c.length,e.length),i=h/(null!=b?b.length:1),j=[];for(let k=0;k<h;++k){let h=b?this.encodeSingleElement(b[k/i]):t2,l=this.generateLowerBound(a,h,c[k%i],d),m=this.generateUpperBound(a,h,e[k%i],f),n=g.map(b=>this.generateLowerBound(a,h,b,!0));j.push(...this.createRange(l,m,n))}return j}generateLowerBound(a,b,c,d){let e=new tH(a,lu.empty(),b,c);return d?e:e.successor()}generateUpperBound(a,b,c,d){let e=new tH(a,lu.empty(),b,c);return d?e.successor():e}getFieldIndex(a,b){let c=new tO(b),d=null!=b.collectionGroup?b.collectionGroup:b.path.lastSegment();return this.getFieldIndexes(a,d).next(a=>{let b=null;for(let d of a)c.servedByIndex(d)&&(!b||d.fields.length>b.fields.length)&&(b=d);return b})}getIndexType(a,b){let c=2,d=this.getSubTargets(b);return l$.forEach(d,b=>this.getFieldIndex(a,b).next(a=>{a?0!==c&&a.fields.length<pG(b)&&(c=1):c=0})).next(()=>pH(b)&&d.length>1&&2===c?1:c)}encodeDirectionalElements(a,b){let c=new tG;for(let d of lM(a)){let a=b.data.field(d.fieldPath);if(null==a)return null;let e=c.forKind(d.kind);tn.INSTANCE.writeIndexValue(a,e)}return c.encodedBytes()}encodeSingleElement(a){let b=new tG;return tn.INSTANCE.writeIndexValue(a,b.forKind(0)),b.encodedBytes()}encodeDirectionalKey(a,b){let c=new tG;return tn.INSTANCE.writeIndexValue(oF(this.databaseId,b),c.forKind(lN(a))),c.encodedBytes()}encodeValues(a,b,c){if(null===c)return[];let d=[];d.push(new tG);let e=0;for(let f of lM(a)){let a=c[e++];for(let c of d)if(this.isInFilter(b,f.fieldPath)&&oJ(a))d=this.expandIndexValues(d,f,a);else{let b=c.forKind(f.kind);tn.INSTANCE.writeIndexValue(a,b)}}return this.getEncodedBytes(d)}encodeBound(a,b,c){return this.encodeValues(a,b,c.position)}getEncodedBytes(a){let b=[];for(let c=0;c<a.length;++c)b[c]=a[c].encodedBytes();return b}expandIndexValues(a,b,c){let d=[...a],e=[];for(let a of c.arrayValue.values||[])for(let c of d){let d=new tG;d.seed(c.encodedBytes()),tn.INSTANCE.writeIndexValue(a,d.forKind(b.kind)),e.push(d)}return e}isInFilter(a,b){return!!a.filters.find(a=>a instanceof o7&&a.field.isEqual(b)&&("in"===a.op||"not-in"===a.op))}getFieldIndexes(a,b){let c=t6(a),d=t7(a);return(b?c.loadAll(m4,IDBKeyRange.bound(b,b)):c.loadAll()).next(a=>{let b=[];return l$.forEach(a,a=>d.get([a.indexId,this.uid]).next(c=>{b.push(s1(a,c))})).next(()=>b)})}getNextCollectionGroupToUpdate(a){return this.getFieldIndexes(a).next(a=>0===a.length?null:(a.sort((a,b)=>{let c=a.indexState.sequenceNumber-b.indexState.sequenceNumber;return 0!==c?c:lj(a.collectionGroup,b.collectionGroup)}),a[0].collectionGroup))}updateCollectionGroup(a,b,c){let d=t6(a),e=t7(a);return this.getNextSequenceNumber(a).next(a=>d.loadAll(m4,IDBKeyRange.bound(b,b)).next(b=>l$.forEach(b,b=>e.put(s2(b.indexId,this.uid,a,c)))))}updateIndexEntries(a,b){let c=new Map;return l$.forEach(b,(b,d)=>{let e=c.get(b.collectionGroup);return(e?l$.resolve(e):this.getFieldIndexes(a,b.collectionGroup)).next(e=>(c.set(b.collectionGroup,e),l$.forEach(e,c=>this.getExistingIndexEntries(a,b,c).next(b=>{let e=this.computeIndexEntries(d,c);return b.isEqual(e)?l$.resolve():this.updateEntries(a,d,c,b,e)}))))})}addIndexEntry(a,b,c,d){return t5(a).put(d.dbIndexEntry(this.uid,this.encodeDirectionalKey(c,b.key),b.key))}deleteIndexEntry(a,b,c,d){return t5(a).delete(d.dbIndexEntryKey(this.uid,this.encodeDirectionalKey(c,b.key),b.key))}getExistingIndexEntries(a,b,c){let d=t5(a),e=new nF(tI);return d.iterate({index:nc,range:IDBKeyRange.only([c.indexId,this.uid,tK(this.encodeDirectionalKey(c,b))])},(a,d)=>{e=e.add(new tH(c.indexId,b,tL(d.arrayValue),tL(d.directionalValue)))}).next(()=>e)}computeIndexEntries(a,b){let c=new nF(tI),d=this.encodeDirectionalElements(b,a);if(null==d)return c;let e=lL(b);if(null!=e){let f=a.data.field(e.fieldPath);if(oJ(f))for(let e of f.arrayValue.values||[])c=c.add(new tH(b.indexId,a.key,this.encodeSingleElement(e),d))}else c=c.add(new tH(b.indexId,a.key,t2,d));return c}updateEntries(a,b,c,d,e){kX(t1,"Updating index entries for document '%s'",b.key);let f=[];return nH(d,e,tI,d=>{f.push(this.addIndexEntry(a,b,c,d))},d=>{f.push(this.deleteIndexEntry(a,b,c,d))}),l$.waitFor(f)}getNextSequenceNumber(a){let b=1;return t7(a).iterate({index:m8,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(a,c,d)=>{d.done(),b=c.sequenceNumber+1}).next(()=>b)}createRange(a,b,c){c=c.sort((a,b)=>tI(a,b)).filter((a,b,c)=>!b||0!==tI(a,c[b-1]));let d=[];for(let e of(d.push(a),c)){let c=tI(e,a),f=tI(e,b);if(0===c)d[0]=a.successor();else if(c>0&&f<0)d.push(e),d.push(e.successor());else if(f>0)break}d.push(b);let e=[];for(let a=0;a<d.length;a+=2){if(this.isRangeMatchable(d[a],d[a+1]))return[];let b=d[a].dbIndexEntryKey(this.uid,t2,lu.empty()),c=d[a+1].dbIndexEntryKey(this.uid,t2,lu.empty());e.push(IDBKeyRange.bound(b,c))}return e}isRangeMatchable(a,b){return tI(a,b)>0}getMinOffsetFromCollectionGroup(a,b){return this.getFieldIndexes(a,b).next(t8)}getMinOffset(a,b){return l$.mapArray(this.getSubTargets(b),b=>this.getFieldIndex(a,b).next(a=>a||k_(44426))).next(t8)}}function t4(a){return nw(a,mW)}function t5(a){return nw(a,na)}function t6(a){return nw(a,m2)}function t7(a){return nw(a,m6)}function t8(a){k1(0!==a.length,28825);let b=a[0].indexState.offset,c=b.largestBatchId;for(let d=1;d<a.length;d++){let e=a[d].indexState.offset;0>lW(e,b)&&(b=e),c<e.largestBatchId&&(c=e.largestBatchId)}return new lV(b.readTime,b.documentKey,c)}function t9(a,b,c){let d=a.store(mv),e=a.store(mD),f=[],g=IDBKeyRange.only(c.batchId),h=0,i=d.iterate({range:g},(a,b,c)=>(h++,c.delete()));f.push(i.next(()=>{k1(1===h,47070,{batchId:c.batchId})}));let j=[];for(let a of c.mutations){let d=mB(b,a.key.path,c.batchId);f.push(e.delete(d)),j.push(a.key)}return l$.waitFor(f).next(()=>j)}function ua(a){let b;if(!a)return 0;if(a.document)b=a.document;else if(a.unknownDocument)b=a.unknownDocument;else if(a.noDocument)b=a.noDocument;else throw k_(14731);return JSON.stringify(b).length}class ub{constructor(a,b,c,d){this.userId=a,this.serializer=b,this.indexManager=c,this.referenceDelegate=d,this.documentKeysByBatchId={}}static forUser(a,b,c,d){return k1(""!==a.uid,64387),new ub(a.isAuthenticated()?a.uid:"",b,c,d)}checkEmpty(a){let b=!0,c=IDBKeyRange.bound([this.userId,-1/0],[this.userId,1/0]);return ue(a).iterate({index:mx,range:c},(a,c,d)=>{b=!1,d.done()}).next(()=>b)}addMutationBatch(a,b,c,d){let e=uf(a),f=ue(a);return f.add({}).next(g=>{k1("number"==typeof g,49019);let h=new q2(g,b,c,d),i=sN(this.serializer,this.userId,h),j=[],k=new nF((a,b)=>lj(a.canonicalString(),b.canonicalString()));for(let a of d){let b=mB(this.userId,a.key.path,g);k=k.add(a.key.path.popLast()),j.push(f.put(i)),j.push(e.put(b,mC))}return k.forEach(b=>{j.push(this.indexManager.addToCollectionParentIndex(a,b))}),a.addOnCommittedListener(()=>{this.documentKeysByBatchId[g]=h.keys()}),l$.waitFor(j).next(()=>h)})}lookupMutationBatch(a,b){return ue(a).get(b).next(a=>a?(k1(a.userId===this.userId,48,"Unexpected user for mutation batch",{userId:a.userId,batchId:b}),sO(this.serializer,a)):null)}lookupMutationKeys(a,b){return this.documentKeysByBatchId[b]?l$.resolve(this.documentKeysByBatchId[b]):this.lookupMutationBatch(a,b).next(a=>{if(!a)return null;{let c=a.keys();return this.documentKeysByBatchId[b]=c,c}})}getNextMutationBatchAfterBatchId(a,b){let c=b+1,d=IDBKeyRange.lowerBound([this.userId,c]),e=null;return ue(a).iterate({index:mx,range:d},(a,b,d)=>{b.userId===this.userId&&(k1(b.batchId>=c,47524,{nextBatchId:c}),e=sO(this.serializer,b)),d.done()}).next(()=>e)}getHighestUnacknowledgedBatchId(a){let b=IDBKeyRange.upperBound([this.userId,1/0]),c=n3;return ue(a).iterate({index:mx,range:b,reverse:!0},(a,b,d)=>{c=b.batchId,d.done()}).next(()=>c)}getAllMutationBatches(a){let b=IDBKeyRange.bound([this.userId,n3],[this.userId,1/0]);return ue(a).loadAll(mx,b).next(a=>a.map(a=>sO(this.serializer,a)))}getAllMutationBatchesAffectingDocumentKey(a,b){let c=mA(this.userId,b.path),d=IDBKeyRange.lowerBound(c),e=[];return uf(a).iterate({range:d},(c,d,f)=>{let[g,h,i]=c,j=mp(h);return g===this.userId&&b.path.isEqual(j)?ue(a).get(i).next(a=>{if(!a)throw k_(61480,{indexKey:c,batchId:i});k1(a.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:a.userId,batchId:i}),e.push(sO(this.serializer,a))}):void f.done()}).next(()=>e)}getAllMutationBatchesAffectingDocumentKeys(a,b){let c=new nF(lj),d=[];return b.forEach(b=>{let e=mA(this.userId,b.path),f=IDBKeyRange.lowerBound(e),g=uf(a).iterate({range:f},(a,d,e)=>{let[f,g,h]=a,i=mp(g);if(f!==this.userId||!b.path.isEqual(i))return void e.done();c=c.add(h)});d.push(g)}),l$.waitFor(d).next(()=>this.lookupMutationBatches(a,c))}getAllMutationBatchesAffectingQuery(a,b){let c=b.path,d=c.length+1,e=mA(this.userId,c),f=IDBKeyRange.lowerBound(e),g=new nF(lj);return uf(a).iterate({range:f},(a,b,e)=>{let[f,h,i]=a,j=mp(h);if(f!==this.userId||!c.isPrefixOf(j))return void e.done();j.length===d&&(g=g.add(i))}).next(()=>this.lookupMutationBatches(a,g))}lookupMutationBatches(a,b){let c=[],d=[];return b.forEach(b=>{d.push(ue(a).get(b).next(a=>{if(null===a)throw k_(35274,{batchId:b});k1(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:b}),c.push(sO(this.serializer,a))}))}),l$.waitFor(d).next(()=>c)}removeMutationBatch(a,b){return t9(a.simpleDbTransaction,this.userId,b).next(c=>(a.addOnCommittedListener(()=>{this.removeCachedMutationKeys(b.batchId)}),l$.forEach(c,b=>this.referenceDelegate.markPotentiallyOrphaned(a,b))))}removeCachedMutationKeys(a){delete this.documentKeysByBatchId[a]}performConsistencyCheck(a){return this.checkEmpty(a).next(b=>{if(!b)return l$.resolve();let c=IDBKeyRange.lowerBound(mz(this.userId)),d=[];return uf(a).iterate({range:c},(a,b,c)=>{if(a[0]!==this.userId)return void c.done();{let b=mp(a[1]);d.push(b)}}).next(()=>{k1(0===d.length,56720,{danglingKeys:d.map(a=>a.canonicalString())})})})}containsKey(a,b){return uc(a,this.userId,b)}getMutationQueueMetadata(a){return ug(a).get(this.userId).next(a=>a||{userId:this.userId,lastAcknowledgedBatchId:n3,lastStreamToken:""})}}function uc(a,b,c){let d=mA(b,c.path),e=d[1],f=IDBKeyRange.lowerBound(d),g=!1;return uf(a).iterate({range:f,keysOnly:!0},(a,c,d)=>{let[f,h,i]=a;f===b&&h===e&&(g=!0),d.done()}).next(()=>g)}function ud(a,b){let c=!1;return ug(a).iterateSerial(d=>uc(a,d,b).next(a=>(a&&(c=!0),l$.resolve(!a)))).next(()=>c)}function ue(a){return nw(a,mv)}function uf(a){return nw(a,mD)}function ug(a){return nw(a,mt)}let uh=2;class ui{constructor(a){this.lastId=a}next(){return this.lastId+=uh,this.lastId}static forTargetCache(){return new ui(2-uh)}static forSyncEngine(){return new ui(1-uh)}}class uj{constructor(a,b){this.referenceDelegate=a,this.serializer=b}allocateTargetId(a){return this.retrieveMetadata(a).next(b=>{let c=new ui(b.highestTargetId);return b.highestTargetId=c.next(),this.saveMetadata(a,b).next(()=>b.highestTargetId)})}getLastRemoteSnapshotVersion(a){return this.retrieveMetadata(a).next(a=>lH.fromTimestamp(new lG(a.lastRemoteSnapshotVersion.seconds,a.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(a){return this.retrieveMetadata(a).next(a=>a.highestListenSequenceNumber)}setTargetsMetadata(a,b,c){return this.retrieveMetadata(a).next(d=>(d.highestListenSequenceNumber=b,c&&(d.lastRemoteSnapshotVersion=c.toTimestamp()),b>d.highestListenSequenceNumber&&(d.highestListenSequenceNumber=b),this.saveMetadata(a,d)))}addTargetData(a,b){return this.saveTargetData(a,b).next(()=>this.retrieveMetadata(a).next(c=>(c.targetCount+=1,this.updateMetadataFromTargetData(b,c),this.saveMetadata(a,c))))}updateTargetData(a,b){return this.saveTargetData(a,b)}removeTargetData(a,b){return this.removeMatchingKeysForTargetId(a,b.targetId).next(()=>uk(a).delete(b.targetId)).next(()=>this.retrieveMetadata(a)).next(b=>(k1(b.targetCount>0,8065),b.targetCount-=1,this.saveMetadata(a,b)))}removeTargets(a,b,c){let d=0,e=[];return uk(a).iterate((f,g)=>{let h=sP(g);h.sequenceNumber<=b&&null===c.get(h.targetId)&&(d++,e.push(this.removeTargetData(a,h)))}).next(()=>l$.waitFor(e)).next(()=>d)}forEachTarget(a,b){return uk(a).iterate((a,c)=>{b(sP(c))})}retrieveMetadata(a){return ul(a).get(mU).next(a=>(k1(null!==a,2888),a))}saveMetadata(a,b){return ul(a).put(mU,b)}saveTargetData(a,b){return uk(a).put(sQ(this.serializer,b))}updateMetadataFromTargetData(a,b){let c=!1;return a.targetId>b.highestTargetId&&(b.highestTargetId=a.targetId,c=!0),a.sequenceNumber>b.highestListenSequenceNumber&&(b.highestListenSequenceNumber=a.sequenceNumber,c=!0),c}getTargetCount(a){return this.retrieveMetadata(a).next(a=>a.targetCount)}getTargetData(a,b){let c=pv(b),d=IDBKeyRange.bound([c,-1/0],[c,1/0]),e=null;return uk(a).iterate({range:d,index:mO},(a,c,d)=>{let f=sP(c);px(b,f.target)&&(e=f,d.done())}).next(()=>e)}addMatchingKeys(a,b,c){let d=[],e=um(a);return b.forEach(b=>{let f=mm(b.path);d.push(e.put({targetId:c,path:f})),d.push(this.referenceDelegate.addReference(a,c,b))}),l$.waitFor(d)}removeMatchingKeys(a,b,c){let d=um(a);return l$.forEach(b,b=>{let e=mm(b.path);return l$.waitFor([d.delete([c,e]),this.referenceDelegate.removeReference(a,c,b)])})}removeMatchingKeysForTargetId(a,b){let c=um(a),d=IDBKeyRange.bound([b],[b+1],!1,!0);return c.delete(d)}getMatchingKeysForTargetId(a,b){let c=IDBKeyRange.bound([b],[b+1],!1,!0),d=um(a),e=ql();return d.iterate({range:c,keysOnly:!0},(a,b,c)=>{let d=new lu(mp(a[1]));e=e.add(d)}).next(()=>e)}containsKey(a,b){let c=mm(b.path),d=IDBKeyRange.bound([c],[lo(c)],!1,!0),e=0;return um(a).iterate({index:mS,keysOnly:!0,range:d},([a,b],c,d)=>{0!==a&&(e++,d.done())}).next(()=>e>0)}getTargetDataForTarget(a,b){return uk(a).get(b).next(a=>a?sP(a):null)}}function uk(a){return nw(a,mM)}function ul(a){return nw(a,mV)}function um(a){return nw(a,mQ)}let un={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},uo=-1,up=0x2800000;class uq{static withCacheSize(a){return new uq(a,uq.DEFAULT_COLLECTION_PERCENTILE,uq.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(a,b,c){this.cacheSizeCollectionThreshold=a,this.percentileToCollect=b,this.maximumSequenceNumbersToCollect=c}}uq.DEFAULT_COLLECTION_PERCENTILE=10,uq.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,uq.DEFAULT=new uq(up,uq.DEFAULT_COLLECTION_PERCENTILE,uq.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),uq.DISABLED=new uq(uo,0,0);let ur="LruGarbageCollector",us=1048576,ut=6e4,uu=3e5;function uv([a,b],[c,d]){let e=lj(a,c);return 0===e?lj(b,d):e}class uw{constructor(a){this.maxElements=a,this.buffer=new nF(uv),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(a){let b=[a,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(b);else{let a=this.buffer.last();0>uv(b,a)&&(this.buffer=this.buffer.delete(a).add(b))}}get maxValue(){return this.buffer.last()[0]}}class ux{constructor(a,b,c){this.garbageCollector=a,this.asyncQueue=b,this.localStore=c,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==uo&&this.scheduleGC(ut)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return null!==this.gcTask}scheduleGC(a){kX(ur,`Garbage collection scheduled in ${a}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",a,async()=>{this.gcTask=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(a){l6(a)?kX(ur,"Ignoring IndexedDB error during garbage collection: ",a):await lZ(a)}await this.scheduleGC(uu)})}}class uy{constructor(a,b){this.delegate=a,this.params=b}calculateTargetCount(a,b){return this.delegate.getSequenceNumberCount(a).next(a=>Math.floor(b/100*a))}nthSequenceNumber(a,b){if(0===b)return l$.resolve(mh.INVALID);let c=new uw(b);return this.delegate.forEachTarget(a,a=>c.addElement(a.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(a,a=>c.addElement(a))).next(()=>c.maxValue)}removeTargets(a,b,c){return this.delegate.removeTargets(a,b,c)}removeOrphanedDocuments(a,b){return this.delegate.removeOrphanedDocuments(a,b)}collect(a,b){return this.params.cacheSizeCollectionThreshold===uo?(kX("LruGarbageCollector","Garbage collection skipped; disabled"),l$.resolve(un)):this.getCacheSize(a).next(c=>c<this.params.cacheSizeCollectionThreshold?(kX("LruGarbageCollector",`Garbage collection skipped; Cache size ${c} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),un):this.runGarbageCollection(a,b))}getCacheSize(a){return this.delegate.getCacheSize(a)}runGarbageCollection(a,b){let c,d,e,g,h,i,j,k=Date.now();return this.calculateTargetCount(a,this.params.percentileToCollect).next(b=>(b>this.params.maximumSequenceNumbersToCollect?(kX("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),d=this.params.maximumSequenceNumbersToCollect):d=b,g=Date.now(),this.nthSequenceNumber(a,d))).next(d=>(c=d,h=Date.now(),this.removeTargets(a,c,b))).next(b=>(e=b,i=Date.now(),this.removeOrphanedDocuments(a,c))).next(a=>(j=Date.now(),kW()<=f.DEBUG&&kX("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${g-k}ms
	Determined least recently used ${d} in ${h-g}ms
	Removed ${e} targets in ${i-h}ms
	Removed ${a} documents in ${j-i}ms
Total Duration: ${j-k}ms`),l$.resolve({didRun:!0,sequenceNumbersCollected:d,targetsRemoved:e,documentsRemoved:a})))}}function uz(a,b){return new uy(a,b)}class uA{constructor(a,b){this.db=a,this.garbageCollector=uz(this,b)}getSequenceNumberCount(a){let b=this.orphanedDocumentCount(a);return this.db.getTargetCache().getTargetCount(a).next(a=>b.next(b=>a+b))}orphanedDocumentCount(a){let b=0;return this.forEachOrphanedDocumentSequenceNumber(a,a=>{b++}).next(()=>b)}forEachTarget(a,b){return this.db.getTargetCache().forEachTarget(a,b)}forEachOrphanedDocumentSequenceNumber(a,b){return this.forEachOrphanedDocument(a,(a,c)=>b(c))}addReference(a,b,c){return uD(a,c)}removeReference(a,b,c){return uD(a,c)}removeTargets(a,b,c){return this.db.getTargetCache().removeTargets(a,b,c)}markPotentiallyOrphaned(a,b){return uD(a,b)}isPinned(a,b){return ud(a,b)}removeOrphanedDocuments(a,b){let c=this.db.getRemoteDocumentCache().newChangeBuffer(),d=[],e=0;return this.forEachOrphanedDocument(a,(f,g)=>{if(g<=b){let b=this.isPinned(a,f).next(b=>{if(!b)return e++,c.getEntry(a,f).next(()=>(c.removeEntry(f,lH.min()),um(a).delete(uB(f))))});d.push(b)}}).next(()=>l$.waitFor(d)).next(()=>c.apply(a)).next(()=>e)}removeTarget(a,b){let c=b.withSequenceNumber(a.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(a,c)}updateLimboDocument(a,b){return uD(a,b)}forEachOrphanedDocument(a,b){let c,d=um(a),e=mh.INVALID;return d.iterate({index:mS},([a,d],{path:f,sequenceNumber:g})=>{0===a?(e!==mh.INVALID&&b(new lu(mp(c)),e),e=g,c=f):e=mh.INVALID}).next(()=>{e!==mh.INVALID&&b(new lu(mp(c)),e)})}getCacheSize(a){return this.db.getRemoteDocumentCache().getSize(a)}}function uB(a){return[0,mm(a.path)]}function uC(a,b){return{targetId:0,path:mm(a.path),sequenceNumber:b}}function uD(a,b){return um(a).put(uC(b,a.currentSequenceNumber))}class uE{constructor(){this.changes=new p8(a=>a.toString(),(a,b)=>a.isEqual(b)),this.changesApplied=!1}addEntry(a){this.assertNotApplied(),this.changes.set(a.key,a)}removeEntry(a,b){this.assertNotApplied(),this.changes.set(a,oX.newInvalidDocument(a).setReadTime(b))}getEntry(a,b){this.assertNotApplied();let c=this.changes.get(b);return void 0!==c?l$.resolve(c):this.getFromCache(a,b)}getEntries(a,b){return this.getAllFromCache(a,b)}apply(a){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(a)}assertNotApplied(){}}class uF{constructor(a){this.serializer=a}setIndexManager(a){this.indexManager=a}addEntry(a,b,c){return uJ(a).put(c)}removeEntry(a,b,c){return uJ(a).delete(uL(b,c))}updateMetadata(a,b){return this.getMetadata(a).next(c=>(c.byteSize+=b,this.setMetadata(a,c)))}getEntry(a,b){let c=oX.newInvalidDocument(b);return uJ(a).iterate({index:mG,range:IDBKeyRange.only(uK(b))},(a,d)=>{c=this.maybeDecodeDocument(b,d)}).next(()=>c)}getSizedEntry(a,b){let c={size:0,document:oX.newInvalidDocument(b)};return uJ(a).iterate({index:mG,range:IDBKeyRange.only(uK(b))},(a,d)=>{c={document:this.maybeDecodeDocument(b,d),size:ua(d)}}).next(()=>c)}getEntries(a,b){let c=qa();return this.forEachDbEntry(a,b,(a,b)=>{let d=this.maybeDecodeDocument(a,b);c=c.insert(a,d)}).next(()=>c)}getSizedEntries(a,b){let c=qa(),d=new nB(lu.comparator);return this.forEachDbEntry(a,b,(a,b)=>{let e=this.maybeDecodeDocument(a,b);c=c.insert(a,e),d=d.insert(a,ua(b))}).next(()=>({documents:c,sizeMap:d}))}forEachDbEntry(a,b,c){if(b.isEmpty())return l$.resolve();let d=new nF(uN);b.forEach(a=>d=d.add(a));let e=IDBKeyRange.bound(uK(d.first()),uK(d.last())),f=d.getIterator(),g=f.getNext();return uJ(a).iterate({index:mG,range:e},(a,b,d)=>{let e=lu.fromSegments([...b.prefixPath,b.collectionGroup,b.documentId]);for(;g&&0>uN(g,e);)c(g,null),g=f.getNext();g&&g.isEqual(e)&&(c(g,b),g=f.hasNext()?f.getNext():null),g?d.skip(uK(g)):d.done()}).next(()=>{for(;g;)c(g,null),g=f.hasNext()?f.getNext():null})}getDocumentsMatchingQuery(a,b,c,d,e){let f=b.path,g=[f.popLast().toArray(),f.lastSegment(),sJ(c.readTime),c.documentKey.path.isEmpty()?"":c.documentKey.path.lastSegment()],h=[f.popLast().toArray(),f.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return uJ(a).loadAll(IDBKeyRange.bound(g,h,!0)).next(a=>{null==e||e.incrementDocumentReadCount(a.length);let c=qa();for(let e of a){let a=this.maybeDecodeDocument(lu.fromSegments(e.prefixPath.concat(e.collectionGroup,e.documentId)),e);a.isFoundDocument()&&(p0(b,a)||d.has(a.key))&&(c=c.insert(a.key,a))}return c})}getAllFromCollectionGroup(a,b,c,d){let e=qa(),f=uM(b,c),g=uM(b,lV.max());return uJ(a).iterate({index:mI,range:IDBKeyRange.bound(f,g,!0)},(a,b,c)=>{let f=this.maybeDecodeDocument(lu.fromSegments(b.prefixPath.concat(b.collectionGroup,b.documentId)),b);(e=e.insert(f.key,f)).size===d&&c.done()}).next(()=>e)}newChangeBuffer(a){return new uH(this,!!a&&a.trackRemovals)}getSize(a){return this.getMetadata(a).next(a=>a.byteSize)}getMetadata(a){return uI(a).get(mL).next(a=>(k1(!!a,20021),a))}setMetadata(a,b){return uI(a).put(mL,b)}maybeDecodeDocument(a,b){if(b){let a=sH(this.serializer,b);if(!(a.isNoDocument()&&a.version.isEqual(lH.min())))return a}return oX.newInvalidDocument(a)}}function uG(a){return new uF(a)}class uH extends uE{constructor(a,b){super(),this.documentCache=a,this.trackRemovals=b,this.documentStates=new p8(a=>a.toString(),(a,b)=>a.isEqual(b))}applyChanges(a){let b=[],c=0,d=new nF((a,b)=>lj(a.canonicalString(),b.canonicalString()));return this.changes.forEach((e,f)=>{let g=this.documentStates.get(e);if(b.push(this.documentCache.removeEntry(a,e,g.readTime)),f.isValidDocument()){let h=sI(this.documentCache.serializer,f);d=d.add(e.path.popLast());let i=ua(h);c+=i-g.size,b.push(this.documentCache.addEntry(a,e,h))}else if(c-=g.size,this.trackRemovals){let c=sI(this.documentCache.serializer,f.convertToNoDocument(lH.min()));b.push(this.documentCache.addEntry(a,e,c))}}),d.forEach(c=>{b.push(this.documentCache.indexManager.addToCollectionParentIndex(a,c))}),b.push(this.documentCache.updateMetadata(a,c)),l$.waitFor(b)}getFromCache(a,b){return this.documentCache.getSizedEntry(a,b).next(a=>(this.documentStates.set(b,{size:a.size,readTime:a.document.readTime}),a.document))}getAllFromCache(a,b){return this.documentCache.getSizedEntries(a,b).next(({documents:a,sizeMap:b})=>(b.forEach((b,c)=>{this.documentStates.set(b,{size:c,readTime:a.get(b).readTime})}),a))}}function uI(a){return nw(a,mK)}function uJ(a){return nw(a,mE)}function uK(a){let b=a.path.toArray();return[b.slice(0,b.length-2),b[b.length-2],b[b.length-1]]}function uL(a,b){let c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],sJ(b),c[c.length-1]]}function uM(a,b){let c=b.documentKey.path.toArray();return[a,sJ(b.readTime),c.slice(0,c.length-2),c.length>0?c[c.length-1]:""]}function uN(a,b){let c=a.path.toArray(),d=b.path.toArray(),e=0;for(let a=0;a<c.length-2&&a<d.length-2;++a)if(e=lj(c[a],d[a]))return e;return(e=lj(c.length,d.length))||(e=lj(c[c.length-2],d[d.length-2]))?e:lj(c[c.length-1],d[d.length-1])}let uO=18;class uP{constructor(a,b){this.overlayedDocument=a,this.mutatedFields=b}}class uQ{constructor(a,b,c,d){this.remoteDocumentCache=a,this.mutationQueue=b,this.documentOverlayCache=c,this.indexManager=d}getDocument(a,b){let c=null;return this.documentOverlayCache.getOverlay(a,b).next(d=>(c=d,this.remoteDocumentCache.getEntry(a,b))).next(a=>(null!==c&&qO(c.mutation,a,nJ.empty(),lG.now()),a))}getDocuments(a,b){return this.remoteDocumentCache.getEntries(a,b).next(b=>this.getLocalViewOfDocuments(a,b,ql()).next(()=>b))}getLocalViewOfDocuments(a,b,c=ql()){let d=qf();return this.populateOverlays(a,d,b).next(()=>this.computeViews(a,b,d,c).next(a=>{let b=qc();return a.forEach((a,c)=>{b=b.insert(a,c.overlayedDocument)}),b}))}getOverlayedDocuments(a,b){let c=qf();return this.populateOverlays(a,c,b).next(()=>this.computeViews(a,b,c,ql()))}populateOverlays(a,b,c){let d=[];return c.forEach(a=>{b.has(a)||d.push(a)}),this.documentOverlayCache.getOverlays(a,d).next(a=>{a.forEach((a,c)=>{b.set(a,c)})})}computeViews(a,b,c,d){let e=qa(),f=qh(),g=qd();return b.forEach((a,b)=>{let g=c.get(b.key);d.has(b.key)&&(void 0===g||g.mutation instanceof qU)?e=e.insert(b.key,b):void 0!==g?(f.set(b.key,g.mutation.getFieldMask()),qO(g.mutation,b,g.mutation.getFieldMask(),lG.now())):f.set(b.key,nJ.empty())}),this.recalculateAndSaveOverlays(a,e).next(a=>(a.forEach((a,b)=>f.set(a,b)),b.forEach((a,b)=>{var c;return g.set(a,new uP(b,null!=(c=f.get(a))?c:null))}),g))}recalculateAndSaveOverlays(a,b){let c=qh(),d=new nB((a,b)=>a-b),e=ql();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(a,b).next(a=>{for(let e of a)e.keys().forEach(a=>{let f=b.get(a);if(null===f)return;let g=c.get(a)||nJ.empty();g=e.applyToLocalView(f,g),c.set(a,g);let h=(d.get(e.batchId)||ql()).add(a);d=d.insert(e.batchId,h)})}).next(()=>{let f=[],g=d.getReverseIterator();for(;g.hasNext();){let d=g.getNext(),h=d.key,i=d.value,j=qg();i.forEach(a=>{if(!e.has(a)){let d=qM(b.get(a),c.get(a));null!==d&&j.set(a,d),e=e.add(a)}}),f.push(this.documentOverlayCache.saveOverlays(a,h,j))}return l$.waitFor(f)}).next(()=>c)}recalculateAndSaveOverlaysForDocumentKeys(a,b){return this.remoteDocumentCache.getEntries(a,b).next(b=>this.recalculateAndSaveOverlays(a,b))}getDocumentsMatchingQuery(a,b,c,d){return pO(b)?this.getDocumentsMatchingDocumentQuery(a,b.path):pP(b)?this.getDocumentsMatchingCollectionGroupQuery(a,b,c,d):this.getDocumentsMatchingCollectionQuery(a,b,c,d)}getNextDocuments(a,b,c,d){return this.remoteDocumentCache.getAllFromCollectionGroup(a,b,c,d).next(e=>{let f=d-e.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(a,b,c.largestBatchId,d-e.size):l$.resolve(qf()),g=lI,h=e;return f.next(b=>l$.forEach(b,(b,c)=>(g<c.largestBatchId&&(g=c.largestBatchId),e.get(b))?l$.resolve():this.remoteDocumentCache.getEntry(a,b).next(a=>{h=h.insert(b,a)})).next(()=>this.populateOverlays(a,b,e)).next(()=>this.computeViews(a,h,b,ql())).next(a=>({batchId:g,changes:qe(a)})))})}getDocumentsMatchingDocumentQuery(a,b){return this.getDocument(a,new lu(b)).next(a=>{let b=qc();return a.isFoundDocument()&&(b=b.insert(a.key,a)),b})}getDocumentsMatchingCollectionGroupQuery(a,b,c,d){let e=b.collectionGroup,f=qc();return this.indexManager.getCollectionParents(a,e).next(g=>l$.forEach(g,g=>{let h=pL(b,g.child(e));return this.getDocumentsMatchingCollectionQuery(a,h,c,d).next(a=>{a.forEach((a,b)=>{f=f.insert(a,b)})})}).next(()=>f))}getDocumentsMatchingCollectionQuery(a,b,c,d){let e;return this.documentOverlayCache.getOverlaysForCollection(a,b.path,c.largestBatchId).next(f=>(e=f,this.remoteDocumentCache.getDocumentsMatchingQuery(a,b,c,e,d))).next(a=>{e.forEach((b,c)=>{let d=c.getKey();null===a.get(d)&&(a=a.insert(d,oX.newInvalidDocument(d)))});let c=qc();return a.forEach((a,d)=>{let f=e.get(a);void 0!==f&&qO(f.mutation,d,nJ.empty(),lG.now()),p0(b,d)&&(c=c.insert(a,d))}),c})}}class uR{constructor(a){this.serializer=a,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(a,b){return l$.resolve(this.bundles.get(b))}saveBundleMetadata(a,b){return this.bundles.set(b.id,sY(b)),l$.resolve()}getNamedQuery(a,b){return l$.resolve(this.namedQueries.get(b))}saveNamedQuery(a,b){return this.namedQueries.set(b.name,sX(b)),l$.resolve()}}class uS{constructor(){this.overlays=new nB(lu.comparator),this.overlayByBatchId=new Map}getOverlay(a,b){return l$.resolve(this.overlays.get(b))}getOverlays(a,b){let c=qf();return l$.forEach(b,b=>this.getOverlay(a,b).next(a=>{null!==a&&c.set(b,a)})).next(()=>c)}saveOverlays(a,b,c){return c.forEach((c,d)=>{this.saveOverlay(a,b,d)}),l$.resolve()}removeOverlaysForBatchId(a,b,c){let d=this.overlayByBatchId.get(c);return void 0!==d&&(d.forEach(a=>this.overlays=this.overlays.remove(a)),this.overlayByBatchId.delete(c)),l$.resolve()}getOverlaysForCollection(a,b,c){let d=qf(),e=b.length+1,f=new lu(b.child("")),g=this.overlays.getIteratorFrom(f);for(;g.hasNext();){let a=g.getNext().value,f=a.getKey();if(!b.isPrefixOf(f.path))break;f.path.length===e&&a.largestBatchId>c&&d.set(a.getKey(),a)}return l$.resolve(d)}getOverlaysForCollectionGroup(a,b,c,d){let e=new nB((a,b)=>a-b),f=this.overlays.getIterator();for(;f.hasNext();){let a=f.getNext().value;if(a.getKey().getCollectionGroup()===b&&a.largestBatchId>c){let b=e.get(a.largestBatchId);null===b&&(b=qf(),e=e.insert(a.largestBatchId,b)),b.set(a.getKey(),a)}}let g=qf(),h=e.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((a,b)=>g.set(a,b)),!(g.size()>=d)););return l$.resolve(g)}saveOverlay(a,b,c){let d=this.overlays.get(c.key);if(null!==d){let a=this.overlayByBatchId.get(d.largestBatchId).delete(c.key);this.overlayByBatchId.set(d.largestBatchId,a)}this.overlays=this.overlays.insert(c.key,new q4(b,c));let e=this.overlayByBatchId.get(b);void 0===e&&(e=ql(),this.overlayByBatchId.set(b,e)),this.overlayByBatchId.set(b,e.add(c.key))}}class uT{constructor(){this.sessionToken=nM.EMPTY_BYTE_STRING}getSessionToken(a){return l$.resolve(this.sessionToken)}setSessionToken(a,b){return this.sessionToken=b,l$.resolve()}}class uU{constructor(){this.refsByKey=new nF(uV.compareByKey),this.refsByTarget=new nF(uV.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(a,b){let c=new uV(a,b);this.refsByKey=this.refsByKey.add(c),this.refsByTarget=this.refsByTarget.add(c)}addReferences(a,b){a.forEach(a=>this.addReference(a,b))}removeReference(a,b){this.removeRef(new uV(a,b))}removeReferences(a,b){a.forEach(a=>this.removeReference(a,b))}removeReferencesForId(a){let b=new lu(new lr([])),c=new uV(b,a),d=new uV(b,a+1),e=[];return this.refsByTarget.forEachInRange([c,d],a=>{this.removeRef(a),e.push(a.key)}),e}removeAllReferences(){this.refsByKey.forEach(a=>this.removeRef(a))}removeRef(a){this.refsByKey=this.refsByKey.delete(a),this.refsByTarget=this.refsByTarget.delete(a)}referencesForId(a){let b=new lu(new lr([])),c=new uV(b,a),d=new uV(b,a+1),e=ql();return this.refsByTarget.forEachInRange([c,d],a=>{e=e.add(a.key)}),e}containsKey(a){let b=new uV(a,0),c=this.refsByKey.firstAfterOrEqual(b);return null!==c&&a.isEqual(c.key)}}class uV{constructor(a,b){this.key=a,this.targetOrBatchId=b}static compareByKey(a,b){return lu.comparator(a.key,b.key)||lj(a.targetOrBatchId,b.targetOrBatchId)}static compareByTargetId(a,b){return lj(a.targetOrBatchId,b.targetOrBatchId)||lu.comparator(a.key,b.key)}}class uW{constructor(a,b){this.indexManager=a,this.referenceDelegate=b,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new nF(uV.compareByKey)}checkEmpty(a){return l$.resolve(0===this.mutationQueue.length)}addMutationBatch(a,b,c,d){let e=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let f=new q2(e,b,c,d);for(let b of(this.mutationQueue.push(f),d))this.batchesByDocumentKey=this.batchesByDocumentKey.add(new uV(b.key,e)),this.indexManager.addToCollectionParentIndex(a,b.key.path.popLast());return l$.resolve(f)}lookupMutationBatch(a,b){return l$.resolve(this.findMutationBatch(b))}getNextMutationBatchAfterBatchId(a,b){let c=b+1,d=this.indexOfBatchId(c),e=d<0?0:d;return l$.resolve(this.mutationQueue.length>e?this.mutationQueue[e]:null)}getHighestUnacknowledgedBatchId(){return l$.resolve(0===this.mutationQueue.length?n3:this.nextBatchId-1)}getAllMutationBatches(a){return l$.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(a,b){let c=new uV(b,0),d=new uV(b,1/0),e=[];return this.batchesByDocumentKey.forEachInRange([c,d],a=>{let b=this.findMutationBatch(a.targetOrBatchId);e.push(b)}),l$.resolve(e)}getAllMutationBatchesAffectingDocumentKeys(a,b){let c=new nF(lj);return b.forEach(a=>{let b=new uV(a,0),d=new uV(a,1/0);this.batchesByDocumentKey.forEachInRange([b,d],a=>{c=c.add(a.targetOrBatchId)})}),l$.resolve(this.findMutationBatches(c))}getAllMutationBatchesAffectingQuery(a,b){let c=b.path,d=c.length+1,e=c;lu.isDocumentKey(e)||(e=e.child(""));let f=new uV(new lu(e),0),g=new nF(lj);return this.batchesByDocumentKey.forEachWhile(a=>{let b=a.key.path;return!!c.isPrefixOf(b)&&(b.length===d&&(g=g.add(a.targetOrBatchId)),!0)},f),l$.resolve(this.findMutationBatches(g))}findMutationBatches(a){let b=[];return a.forEach(a=>{let c=this.findMutationBatch(a);null!==c&&b.push(c)}),b}removeMutationBatch(a,b){k1(0===this.indexOfExistingBatchId(b.batchId,"removed"),55003),this.mutationQueue.shift();let c=this.batchesByDocumentKey;return l$.forEach(b.mutations,d=>{let e=new uV(d.key,b.batchId);return c=c.delete(e),this.referenceDelegate.markPotentiallyOrphaned(a,d.key)}).next(()=>{this.batchesByDocumentKey=c})}removeCachedMutationKeys(a){}containsKey(a,b){let c=new uV(b,0),d=this.batchesByDocumentKey.firstAfterOrEqual(c);return l$.resolve(b.isEqual(d&&d.key))}performConsistencyCheck(a){return this.mutationQueue.length,l$.resolve()}indexOfExistingBatchId(a,b){return this.indexOfBatchId(a)}indexOfBatchId(a){return 0===this.mutationQueue.length?0:a-this.mutationQueue[0].batchId}findMutationBatch(a){let b=this.indexOfBatchId(a);return b<0||b>=this.mutationQueue.length?null:this.mutationQueue[b]}}let uX="-9223372036854775808";function uY(){return new nB(lu.comparator)}class uZ{constructor(a){this.sizer=a,this.docs=uY(),this.size=0}setIndexManager(a){this.indexManager=a}addEntry(a,b){let c=b.key,d=this.docs.get(c),e=d?d.size:0,f=this.sizer(b);return this.docs=this.docs.insert(c,{document:b.mutableCopy(),size:f}),this.size+=f-e,this.indexManager.addToCollectionParentIndex(a,c.path.popLast())}removeEntry(a){let b=this.docs.get(a);b&&(this.docs=this.docs.remove(a),this.size-=b.size)}getEntry(a,b){let c=this.docs.get(b);return l$.resolve(c?c.document.mutableCopy():oX.newInvalidDocument(b))}getEntries(a,b){let c=qa();return b.forEach(a=>{let b=this.docs.get(a);c=c.insert(a,b?b.document.mutableCopy():oX.newInvalidDocument(a))}),l$.resolve(c)}getDocumentsMatchingQuery(a,b,c,d){let e=qa(),f=b.path,g=new lu(f.child("__id"+uX+"__")),h=this.docs.getIteratorFrom(g);for(;h.hasNext();){let{key:a,value:{document:g}}=h.getNext();if(!f.isPrefixOf(a.path))break;!(a.path.length>f.length+1||0>=lW(lU(g),c))&&(d.has(g.key)||p0(b,g))&&(e=e.insert(g.key,g.mutableCopy()))}return l$.resolve(e)}getAllFromCollectionGroup(a,b,c,d){k_(9500)}forEachDocumentKey(a,b){return l$.forEach(this.docs,a=>b(a))}newChangeBuffer(a){return new u_(this)}getSize(a){return l$.resolve(this.size)}}function u$(a){return new uZ(a)}class u_ extends uE{constructor(a){super(),this.documentCache=a}applyChanges(a){let b=[];return this.changes.forEach((c,d)=>{d.isValidDocument()?b.push(this.documentCache.addEntry(a,d)):this.documentCache.removeEntry(c)}),l$.waitFor(b)}getFromCache(a,b){return this.documentCache.getEntry(a,b)}getAllFromCache(a,b){return this.documentCache.getEntries(a,b)}}class u0{constructor(a){this.persistence=a,this.targets=new p8(a=>pv(a),px),this.lastRemoteSnapshotVersion=lH.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new uU,this.targetCount=0,this.targetIdGenerator=ui.forTargetCache()}forEachTarget(a,b){return this.targets.forEach((a,c)=>b(c)),l$.resolve()}getLastRemoteSnapshotVersion(a){return l$.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(a){return l$.resolve(this.highestSequenceNumber)}allocateTargetId(a){return this.highestTargetId=this.targetIdGenerator.next(),l$.resolve(this.highestTargetId)}setTargetsMetadata(a,b,c){return c&&(this.lastRemoteSnapshotVersion=c),b>this.highestSequenceNumber&&(this.highestSequenceNumber=b),l$.resolve()}saveTargetData(a){this.targets.set(a.target,a);let b=a.targetId;b>this.highestTargetId&&(this.targetIdGenerator=new ui(b),this.highestTargetId=b),a.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=a.sequenceNumber)}addTargetData(a,b){return this.saveTargetData(b),this.targetCount+=1,l$.resolve()}updateTargetData(a,b){return this.saveTargetData(b),l$.resolve()}removeTargetData(a,b){return this.targets.delete(b.target),this.references.removeReferencesForId(b.targetId),this.targetCount-=1,l$.resolve()}removeTargets(a,b,c){let d=0,e=[];return this.targets.forEach((f,g)=>{g.sequenceNumber<=b&&null===c.get(g.targetId)&&(this.targets.delete(f),e.push(this.removeMatchingKeysForTargetId(a,g.targetId)),d++)}),l$.waitFor(e).next(()=>d)}getTargetCount(a){return l$.resolve(this.targetCount)}getTargetData(a,b){let c=this.targets.get(b)||null;return l$.resolve(c)}addMatchingKeys(a,b,c){return this.references.addReferences(b,c),l$.resolve()}removeMatchingKeys(a,b,c){this.references.removeReferences(b,c);let d=this.persistence.referenceDelegate,e=[];return d&&b.forEach(b=>{e.push(d.markPotentiallyOrphaned(a,b))}),l$.waitFor(e)}removeMatchingKeysForTargetId(a,b){return this.references.removeReferencesForId(b),l$.resolve()}getMatchingKeysForTargetId(a,b){let c=this.references.referencesForId(b);return l$.resolve(c)}containsKey(a,b){return l$.resolve(this.references.containsKey(b))}}let u1="MemoryPersistence";class u2{constructor(a,b){this.mutationQueues={},this.overlays={},this.listenSequence=new mh(0),this._started=!1,this._started=!0,this.globalsCache=new uT,this.referenceDelegate=a(this),this.targetCache=new u0(this);let c=a=>this.referenceDelegate.documentSize(a);this.indexManager=new t_,this.remoteDocumentCache=u$(c),this.serializer=new sG(b),this.bundleCache=new uR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(a){return this.indexManager}getDocumentOverlayCache(a){let b=this.overlays[a.toKey()];return b||(b=new uS,this.overlays[a.toKey()]=b),b}getMutationQueue(a,b){let c=this.mutationQueues[a.toKey()];return c||(c=new uW(b,this.referenceDelegate),this.mutationQueues[a.toKey()]=c),c}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(a,b,c){kX(u1,"Starting transaction:",a);let d=new u3(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),c(d).next(a=>this.referenceDelegate.onTransactionCommitted(d).next(()=>a)).toPromise().then(a=>(d.raiseOnCommittedEvent(),a))}mutationQueuesContainKey(a,b){return l$.or(Object.values(this.mutationQueues).map(c=>()=>c.containsKey(a,b)))}}class u3 extends lY{constructor(a){super(),this.currentSequenceNumber=a}}class u4{constructor(a){this.persistence=a,this.localViewReferences=new uU,this._orphanedDocuments=null}static factory(a){return new u4(a)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw k_(60996)}addReference(a,b,c){return this.localViewReferences.addReference(c,b),this.orphanedDocuments.delete(c.toString()),l$.resolve()}removeReference(a,b,c){return this.localViewReferences.removeReference(c,b),this.orphanedDocuments.add(c.toString()),l$.resolve()}markPotentiallyOrphaned(a,b){return this.orphanedDocuments.add(b.toString()),l$.resolve()}removeTarget(a,b){this.localViewReferences.removeReferencesForId(b.targetId).forEach(a=>this.orphanedDocuments.add(a.toString()));let c=this.persistence.getTargetCache();return c.getMatchingKeysForTargetId(a,b.targetId).next(a=>{a.forEach(a=>this.orphanedDocuments.add(a.toString()))}).next(()=>c.removeTargetData(a,b))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(a){let b=this.persistence.getRemoteDocumentCache().newChangeBuffer();return l$.forEach(this.orphanedDocuments,c=>{let d=lu.fromPath(c);return this.isReferenced(a,d).next(a=>{a||b.removeEntry(d,lH.min())})}).next(()=>(this._orphanedDocuments=null,b.apply(a)))}updateLimboDocument(a,b){return this.isReferenced(a,b).next(a=>{a?this.orphanedDocuments.delete(b.toString()):this.orphanedDocuments.add(b.toString())})}documentSize(a){return 0}isReferenced(a,b){return l$.or([()=>l$.resolve(this.localViewReferences.containsKey(b)),()=>this.persistence.getTargetCache().containsKey(a,b),()=>this.persistence.mutationQueuesContainKey(a,b)])}}class u5{constructor(a,b){this.persistence=a,this.orphanedSequenceNumbers=new p8(a=>mm(a.path),(a,b)=>a.isEqual(b)),this.garbageCollector=uz(this,b)}static factory(a,b){return new u5(a,b)}onTransactionStarted(){}onTransactionCommitted(a){return l$.resolve()}forEachTarget(a,b){return this.persistence.getTargetCache().forEachTarget(a,b)}getSequenceNumberCount(a){let b=this.orphanedDocumentCount(a);return this.persistence.getTargetCache().getTargetCount(a).next(a=>b.next(b=>a+b))}orphanedDocumentCount(a){let b=0;return this.forEachOrphanedDocumentSequenceNumber(a,a=>{b++}).next(()=>b)}forEachOrphanedDocumentSequenceNumber(a,b){return l$.forEach(this.orphanedSequenceNumbers,(c,d)=>this.isPinned(a,c,d).next(a=>a?l$.resolve():b(d)))}removeTargets(a,b,c){return this.persistence.getTargetCache().removeTargets(a,b,c)}removeOrphanedDocuments(a,b){let c=0,d=this.persistence.getRemoteDocumentCache(),e=d.newChangeBuffer();return d.forEachDocumentKey(a,d=>this.isPinned(a,d,b).next(a=>{a||(c++,e.removeEntry(d,lH.min()))})).next(()=>e.apply(a)).next(()=>c)}markPotentiallyOrphaned(a,b){return this.orphanedSequenceNumbers.set(b,a.currentSequenceNumber),l$.resolve()}removeTarget(a,b){let c=b.withSequenceNumber(a.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(a,c)}addReference(a,b,c){return this.orphanedSequenceNumbers.set(c,a.currentSequenceNumber),l$.resolve()}removeReference(a,b,c){return this.orphanedSequenceNumbers.set(c,a.currentSequenceNumber),l$.resolve()}updateLimboDocument(a,b){return this.orphanedSequenceNumbers.set(b,a.currentSequenceNumber),l$.resolve()}documentSize(a){let b=a.key.toString().length;return a.isFoundDocument()&&(b+=oC(a.data.value)),b}isPinned(a,b,c){return l$.or([()=>this.persistence.mutationQueuesContainKey(a,b),()=>this.persistence.getTargetCache().containsKey(a,b),()=>{let a=this.orphanedSequenceNumbers.get(b);return l$.resolve(void 0!==a&&a>c)}])}getCacheSize(a){return this.persistence.getRemoteDocumentCache().getSize(a)}}class u6{constructor(a){this.serializer=a}createOrUpgrade(a,b,c,d){let e=new l1("createOrUpgrade",b);c<1&&d>=1&&(u8(a),u9(a),ve(a),vb(a));let f=l$.resolve();return c<3&&d>=3&&(0!==c&&(vf(a),ve(a)),f=f.next(()=>vh(e))),c<4&&d>=4&&(0!==c&&(f=f.next(()=>va(a,e))),f=f.next(()=>{vi(a)})),c<5&&d>=5&&(f=f.next(()=>this.removeAcknowledgedMutations(e))),c<6&&d>=6&&(f=f.next(()=>(vd(a),this.addDocumentGlobal(e)))),c<7&&d>=7&&(f=f.next(()=>this.ensureSequenceNumbers(e))),c<8&&d>=8&&(f=f.next(()=>this.createCollectionParentIndex(a,e))),c<9&&d>=9&&(f=f.next(()=>{vg(a)})),c<10&&d>=10&&(f=f.next(()=>this.rewriteCanonicalIds(e))),c<11&&d>=11&&(f=f.next(()=>{vj(a),vk(a)})),c<12&&d>=12&&(f=f.next(()=>{vm(a)})),c<13&&d>=13&&(f=f.next(()=>vc(a)).next(()=>this.rewriteRemoteDocumentCache(a,e)).next(()=>a.deleteObjectStore(mq))),c<14&&d>=14&&(f=f.next(()=>this.runOverlayMigration(a,e))),c<15&&d>=15&&(f=f.next(()=>vl(a))),c<16&&d>=16&&(f=f.next(()=>{b.objectStore(m6).clear()}).next(()=>{b.objectStore(na).clear()})),c<17&&d>=17&&(f=f.next(()=>{vn(a)})),c<18&&d>=18&&f8()&&(f=f.next(()=>{b.objectStore(m6).clear()}).next(()=>{b.objectStore(na).clear()})),f}addDocumentGlobal(a){let b=0;return a.store(mq).iterate((a,c)=>{b+=ua(c)}).next(()=>{let c={byteSize:b};return a.store(mK).put(mL,c)})}removeAcknowledgedMutations(a){let b=a.store(mt),c=a.store(mv);return b.loadAll().next(b=>l$.forEach(b,b=>{let d=IDBKeyRange.bound([b.userId,n3],[b.userId,b.lastAcknowledgedBatchId]);return c.loadAll(mx,d).next(c=>l$.forEach(c,c=>{k1(c.userId===b.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});let d=sO(this.serializer,c);return t9(a,b.userId,d).next(()=>{})}))}))}ensureSequenceNumbers(a){let b=a.store(mQ),c=a.store(mq);return a.store(mV).get(mU).next(a=>{let d=c=>b.put({targetId:0,path:mm(c),sequenceNumber:a.highestListenSequenceNumber}),e=[];return c.iterate((a,c)=>{let f=new lr(a),g=u7(f);e.push(b.get(g).next(a=>a?l$.resolve():d(f)))}).next(()=>l$.waitFor(e))})}createCollectionParentIndex(a,b){a.createObjectStore(mW,{keyPath:mX});let c=b.store(mW),d=new t0,e=a=>{if(d.add(a)){let b=a.lastSegment(),d=a.popLast();return c.put({collectionId:b,parent:mm(d)})}};return b.store(mq).iterate({keysOnly:!0},(a,b)=>e(new lr(a).popLast())).next(()=>b.store(mD).iterate({keysOnly:!0},([a,b,c],d)=>e(mp(b).popLast())))}rewriteCanonicalIds(a){let b=a.store(mM);return b.iterate((a,c)=>{let d=sP(c),e=sQ(this.serializer,d);return b.put(e)})}rewriteRemoteDocumentCache(a,b){let c=b.store(mq),d=[];return c.iterate((a,c)=>{let e=b.store(mE),f=vo(c).path.toArray(),g={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};d.push(e.put(g))}).next(()=>l$.waitFor(d))}runOverlayMigration(a,b){let c=b.store(mv),d=uG(this.serializer),e=new u2(u4.factory,this.serializer.remoteSerializer);return c.loadAll().next(a=>{let c=new Map;return a.forEach(a=>{var b;let d=null!=(b=c.get(a.userId))?b:ql();sO(this.serializer,a).keys().forEach(a=>d=d.add(a)),c.set(a.userId,d)}),l$.forEach(c,(a,c)=>{let f=new kR(c),g=s6.forUser(this.serializer,f),h=e.getIndexManager(f);return new uQ(d,ub.forUser(f,this.serializer,h,e.referenceDelegate),g,h).recalculateAndSaveOverlaysForDocumentKeys(new nv(b,mh.INVALID),a).next()})})}}function u7(a){return[0,mm(a)]}function u8(a){a.createObjectStore(mr)}function u9(a){a.createObjectStore(mt,{keyPath:mu}),a.createObjectStore(mv,{keyPath:mw,autoIncrement:!0}).createIndex(mx,my,{unique:!0}),a.createObjectStore(mD)}function va(a,b){return b.store(mv).loadAll().next(c=>{a.deleteObjectStore(mv),a.createObjectStore(mv,{keyPath:mw,autoIncrement:!0}).createIndex(mx,my,{unique:!0});let d=b.store(mv),e=c.map(a=>d.put(a));return l$.waitFor(e)})}function vb(a){a.createObjectStore(mq)}function vc(a){let b=a.createObjectStore(mE,{keyPath:mF});b.createIndex(mG,mH),b.createIndex(mI,mJ)}function vd(a){a.createObjectStore(mK)}function ve(a){a.createObjectStore(mQ,{keyPath:mR}).createIndex(mS,mT,{unique:!0}),a.createObjectStore(mM,{keyPath:mN}).createIndex(mO,mP,{unique:!0}),a.createObjectStore(mV)}function vf(a){a.deleteObjectStore(mQ),a.deleteObjectStore(mM),a.deleteObjectStore(mV)}function vg(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")}function vh(a){let b=a.store(mV),c={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:lH.min().toTimestamp(),targetCount:0};return b.put(mU,c)}function vi(a){a.createObjectStore(mY,{keyPath:mZ})}function vj(a){a.createObjectStore(m$,{keyPath:m_})}function vk(a){a.createObjectStore(m0,{keyPath:m1})}function vl(a){a.createObjectStore(m2,{keyPath:m3,autoIncrement:!0}).createIndex(m4,m5,{unique:!1}),a.createObjectStore(m6,{keyPath:m7}).createIndex(m8,m9,{unique:!1}),a.createObjectStore(na,{keyPath:nb}).createIndex(nc,nd,{unique:!1})}function vm(a){let b=a.createObjectStore(ne,{keyPath:nf});b.createIndex(ng,nh,{unique:!1}),b.createIndex(ni,nj,{unique:!1})}function vn(a){a.createObjectStore(nk,{keyPath:nl})}function vo(a){return a.document?new lu(lr.fromString(a.document.name).popFirst(5)):a.noDocument?lu.fromSegments(a.noDocument.path):a.unknownDocument?lu.fromSegments(a.unknownDocument.path):k_(36783)}let vp="IndexedDbPersistence",vq=18e5,vr=5e3,vs=4e3,vt="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",vu="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",vv="firestore_zombie",vw="main";class vx{constructor(a,b,c,d,e,f,g,h,i,j,k=uO){if(this.allowTabSynchronization=a,this.persistenceKey=b,this.clientId=c,this.queue=e,this.window=f,this.document=g,this.sequenceNumberSyncer=i,this.forceOwningTab=j,this.schemaVersion=k,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=-1/0,this.primaryStateListener=a=>Promise.resolve(),!vx.isAvailable())throw new k4(k3.UNIMPLEMENTED,vu);this.referenceDelegate=new uA(this,d),this.dbName=b+vw,this.serializer=new sG(h),this.simpleDb=new l2(this.dbName,this.schemaVersion,new u6(this.serializer)),this.globalsCache=new s8,this.targetCache=new uj(this.referenceDelegate,this.serializer),this.remoteDocumentCache=uG(this.serializer),this.bundleCache=new s3,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,!1===j&&kY(vp,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k4(k3.FAILED_PRECONDITION,vt);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",a=>this.targetCache.getHighestSequenceNumber(a))}).then(a=>{this.listenSequence=new mh(a,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(a=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(a)))}setPrimaryStateListener(a){return this.primaryStateListener=async b=>{if(this.started)return a(b)},a(this.isPrimary)}setDatabaseDeletedListener(a){this.simpleDb.setDatabaseDeletedListener(a)}setNetworkEnabled(a){this.networkEnabled!==a&&(this.networkEnabled=a,this.queue.enqueueAndForget(async()=>{this.started&&await this.updateClientMetadataAndTryBecomePrimary()}))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",a=>vz(a).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(a).next(a=>{a||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(a)).next(b=>this.isPrimary&&!b?this.releasePrimaryLeaseIfHeld(a).next(()=>!1):!!b&&this.acquireOrExtendPrimaryLease(a).next(()=>!0))).catch(a=>{if(l6(a))return kX(vp,"Failed to extend owner lease: ",a),this.isPrimary;if(!this.allowTabSynchronization)throw a;return kX(vp,"Releasing owner lease after error during lease refresh",a),!1}).then(a=>{this.isPrimary!==a&&this.queue.enqueueRetryable(()=>this.primaryStateListener(a)),this.isPrimary=a})}verifyPrimaryLease(a){return vy(a).get(ms).next(a=>l$.resolve(this.isLocalClient(a)))}removeClientMetadata(a){return vz(a).delete(this.clientId)}async maybeGarbageCollectMultiClientState(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,vq)){this.lastGarbageCollectionTime=Date.now();let a=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",a=>{let b=nw(a,mY);return b.loadAll().next(a=>{let c=this.filterActiveClients(a,vq),d=a.filter(a=>-1===c.indexOf(a));return l$.forEach(d,a=>b.delete(a.clientId)).next(()=>d)})}).catch(()=>[]);if(this.webStorage)for(let b of a)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(b.clientId))}}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",vs,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(a){return!!a&&a.ownerId===this.clientId}canActAsPrimary(a){return this.forceOwningTab?l$.resolve(!0):vy(a).get(ms).next(b=>{if(null!==b&&this.isWithinAge(b.leaseTimestampMs,vr)&&!this.isClientZombied(b.ownerId)){if(this.isLocalClient(b)&&this.networkEnabled)return!0;if(!this.isLocalClient(b)){if(!b.allowTabSynchronization)throw new k4(k3.FAILED_PRECONDITION,vt);return!1}}return!!this.networkEnabled&&!!this.inForeground||vz(a).loadAll().next(a=>void 0===this.filterActiveClients(a,vr).find(a=>{if(this.clientId!==a.clientId){let b=!this.networkEnabled&&a.networkEnabled,c=!this.inForeground&&a.inForeground,d=this.networkEnabled===a.networkEnabled;if(b||c&&d)return!0}return!1}))}).next(a=>(this.isPrimary!==a&&kX(vp,`Client ${a?"is":"is not"} eligible for a primary lease.`),a))}async shutdown(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),await this.simpleDb.runTransaction("shutdown","readwrite",[mr,mY],a=>{let b=new nv(a,mh.INVALID);return this.releasePrimaryLeaseIfHeld(b).next(()=>this.removeClientMetadata(b))}),this.simpleDb.close(),this.removeClientZombiedEntry()}filterActiveClients(a,b){return a.filter(a=>this.isWithinAge(a.updateTimeMs,b)&&!this.isClientZombied(a.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",a=>vz(a).loadAll().next(a=>this.filterActiveClients(a,vq).map(a=>a.clientId)))}get started(){return this._started}getGlobalsCache(){return this.globalsCache}getMutationQueue(a,b){return ub.forUser(a,this.serializer,b,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(a){return new t3(a,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(a){return s6.forUser(this.serializer,a)}getBundleCache(){return this.bundleCache}runTransaction(a,b,c){let d;kX(vp,"Starting transaction:",a);let e="readonly"===b?"readonly":"readwrite",f=nu(this.schemaVersion);return this.simpleDb.runTransaction(a,e,f,e=>(d=new nv(e,this.listenSequence?this.listenSequence.next():mh.INVALID),"readwrite-primary"===b)?this.verifyPrimaryLease(d).next(a=>!!a||this.canActAsPrimary(d)).next(b=>{if(!b)throw kY(`Failed to obtain primary lease for action '${a}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new k4(k3.FAILED_PRECONDITION,lX);return c(d)}).next(a=>this.acquireOrExtendPrimaryLease(d).next(()=>a)):this.verifyAllowTabSynchronization(d).next(()=>c(d))).then(a=>(d.raiseOnCommittedEvent(),a))}verifyAllowTabSynchronization(a){return vy(a).get(ms).next(a=>{if(null!==a&&this.isWithinAge(a.leaseTimestampMs,vr)&&!this.isClientZombied(a.ownerId)&&!this.isLocalClient(a)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!a.allowTabSynchronization))throw new k4(k3.FAILED_PRECONDITION,vt)})}acquireOrExtendPrimaryLease(a){let b={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return vy(a).put(ms,b)}static isAvailable(){return l2.isAvailable()}releasePrimaryLeaseIfHeld(a){let b=vy(a);return b.get(ms).next(a=>this.isLocalClient(a)?(kX(vp,"Releasing primary lease."),b.delete(ms)):l$.resolve())}isWithinAge(a,b){let c=Date.now(),d=c-b,e=c;return!(a<d)&&(!(a>e)||(kY(`Detected an update time that is in the future: ${a} > ${e}`),!1))}attachVisibilityHandler(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){var a;"function"==typeof(null==(a=this.window)?void 0:a.addEventListener)&&(this.windowUnloadHandler=()=>{this.markClientZombied();let a=/(?:Version|Mobile)\/1[456]/;f7()&&(navigator.appVersion.match(a)||navigator.userAgent.match(a))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(a){var b;try{let c=(null==(b=this.webStorage)?void 0:b.getItem(this.zombiedClientLocalStorageKey(a)))!==null;return kX(vp,`Client '${a}' ${c?"is":"is not"} zombied in LocalStorage`),c}catch(a){return kY(vp,"Failed to get zombied client id.",a),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(a){kY("Failed to set zombie client id.",a)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(a){}}zombiedClientLocalStorageKey(a){return`${vv}_${this.persistenceKey}_${a}`}}function vy(a){return nw(a,mr)}function vz(a){return nw(a,mY)}function vA(a,b){let c=a.projectId;return a.isDefaultDatabase||(c+="."+a.database),"firestore/"+b+"/"+c+"/"}function vB(a,b,c,d,e){b=[...b],(a=[...a]).sort(c),b.sort(c);let f=a.length,g=b.length,h=0,i=0;for(;h<g&&i<f;){let f=c(a[i],b[h]);f<0?e(a[i++]):f>0?d(b[h++]):(h++,i++)}for(;h<g;)d(b[h++]);for(;i<f;)e(a[i++])}function vC(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;++c)if(a[c]!==b[c])return!1;return!0}let vD="LocalStore",vE=3e8;class vF{constructor(a,b,c,d){this.persistence=a,this.queryEngine=b,this.serializer=d,this.targetDataByTarget=new nB(lj),this.targetIdByTarget=new p8(a=>pv(a),px),this.collectionGroupReadTime=new Map,this.remoteDocuments=a.getRemoteDocumentCache(),this.targetCache=a.getTargetCache(),this.bundleCache=a.getBundleCache(),this.initializeUserComponents(c)}initializeUserComponents(a){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(a),this.indexManager=this.persistence.getIndexManager(a),this.mutationQueue=this.persistence.getMutationQueue(a,this.indexManager),this.localDocuments=new uQ(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(a){return this.persistence.runTransaction("Collect garbage","readwrite-primary",b=>a.collect(b,this.targetDataByTarget))}}function vG(a,b,c,d){return new vF(a,b,c,d)}async function vH(a,b){let c=k2(a);return await c.persistence.runTransaction("Handle user change","readonly",a=>{let d;return c.mutationQueue.getAllMutationBatches(a).next(e=>(d=e,c.initializeUserComponents(b),c.mutationQueue.getAllMutationBatches(a))).next(b=>{let e=[],f=[],g=ql();for(let a of d)for(let b of(e.push(a.batchId),a.mutations))g=g.add(b.key);for(let a of b)for(let b of(f.push(a.batchId),a.mutations))g=g.add(b.key);return c.localDocuments.getDocuments(a,g).next(a=>({affectedDocuments:a,removedBatchIds:e,addedBatchIds:f}))})})}function vI(a,b){let c,d,e=k2(a),f=lG.now(),g=b.reduce((a,b)=>a.add(b.key),ql());return e.persistence.runTransaction("Locally write mutations","readwrite",a=>{let h=qa(),i=ql();return e.remoteDocuments.getEntries(a,g).next(a=>{(h=a).forEach((a,b)=>{b.isValidDocument()||(i=i.add(a))})}).next(()=>e.localDocuments.getOverlayedDocuments(a,h)).next(d=>{c=d;let g=[];for(let a of b){let b=qP(a,c.get(a.key).overlayedDocument);null!=b&&g.push(new qU(a.key,b,oW(b.value.mapValue),qJ.exists(!0)))}return e.mutationQueue.addMutationBatch(a,f,g,b)}).next(b=>{d=b;let f=b.applyToLocalDocumentSet(c,i);return e.documentOverlayCache.saveOverlays(a,b.batchId,f)})}).then(()=>({batchId:d.batchId,changes:qe(c)}))}function vJ(a,b){let c=k2(a);return c.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{let d=b.batch.keys(),e=c.remoteDocuments.newChangeBuffer({trackRemovals:!0});return vY(c,a,b,e).next(()=>e.apply(a)).next(()=>c.mutationQueue.performConsistencyCheck(a)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(a,d,b.batch.batchId)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,vK(b))).next(()=>c.localDocuments.getDocuments(a,d))})}function vK(a){let b=ql();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(b=b.add(a.batch.mutations[c].key));return b}function vL(a,b){let c=k2(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",a=>{let d;return c.mutationQueue.lookupMutationBatch(a,b).next(b=>(k1(null!==b,37113),d=b.keys(),c.mutationQueue.removeMutationBatch(a,b))).next(()=>c.mutationQueue.performConsistencyCheck(a)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(a,d,b)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,d)).next(()=>c.localDocuments.getDocuments(a,d))})}function vM(a){let b=k2(a);return b.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>b.mutationQueue.getHighestUnacknowledgedBatchId(a))}function vN(a){let b=k2(a);return b.persistence.runTransaction("Get last remote snapshot version","readonly",a=>b.targetCache.getLastRemoteSnapshotVersion(a))}function vO(a,b){let c=k2(a),d=b.snapshotVersion,e=c.targetDataByTarget;return c.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{let f=c.remoteDocuments.newChangeBuffer({trackRemovals:!0});e=c.targetDataByTarget;let g=[];b.targetChanges.forEach((f,h)=>{let i=e.get(h);if(!i)return;g.push(c.targetCache.removeMatchingKeys(a,f.removedDocuments,h).next(()=>c.targetCache.addMatchingKeys(a,f.addedDocuments,h)));let j=i.withSequenceNumber(a.currentSequenceNumber);null!==b.targetMismatches.get(h)?j=j.withResumeToken(nM.EMPTY_BYTE_STRING,lH.min()).withLastLimboFreeSnapshotVersion(lH.min()):f.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(f.resumeToken,d)),e=e.insert(h,j),vQ(i,j,f)&&g.push(c.targetCache.updateTargetData(a,j))});let h=qa(),i=ql();if(b.documentUpdates.forEach(d=>{b.resolvedLimboDocuments.has(d)&&g.push(c.persistence.referenceDelegate.updateLimboDocument(a,d))}),g.push(vP(a,f,b.documentUpdates).next(a=>{h=a.changedDocuments,i=a.existenceChangedKeys})),!d.isEqual(lH.min())){let b=c.targetCache.getLastRemoteSnapshotVersion(a).next(b=>c.targetCache.setTargetsMetadata(a,a.currentSequenceNumber,d));g.push(b)}return l$.waitFor(g).next(()=>f.apply(a)).next(()=>c.localDocuments.getLocalViewOfDocuments(a,h,i)).next(()=>h)}).then(a=>(c.targetDataByTarget=e,a))}function vP(a,b,c){let d=ql(),e=ql();return c.forEach(a=>d=d.add(a)),b.getEntries(a,d).next(a=>{let d=qa();return c.forEach((c,f)=>{let g=a.get(c);f.isFoundDocument()!==g.isFoundDocument()&&(e=e.add(c)),f.isNoDocument()&&f.version.isEqual(lH.min())?(b.removeEntry(c,f.readTime),d=d.insert(c,f)):!g.isValidDocument()||f.version.compareTo(g.version)>0||0===f.version.compareTo(g.version)&&g.hasPendingWrites?(b.addEntry(f),d=d.insert(c,f)):kX(vD,"Ignoring outdated watch update for ",c,". Current version:",g.version," Watch version:",f.version)}),{changedDocuments:d,existenceChangedKeys:e}})}function vQ(a,b,c){return!!(0===a.resumeToken.approximateByteSize()||b.snapshotVersion.toMicroseconds()-a.snapshotVersion.toMicroseconds()>=vE)||c.addedDocuments.size+c.modifiedDocuments.size+c.removedDocuments.size>0}async function vR(a,b){let c=k2(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",a=>l$.forEach(b,b=>l$.forEach(b.addedKeys,d=>c.persistence.referenceDelegate.addReference(a,b.targetId,d)).next(()=>l$.forEach(b.removedKeys,d=>c.persistence.referenceDelegate.removeReference(a,b.targetId,d)))))}catch(a){if(l6(a))kX(vD,"Failed to update sequence numbers: "+a);else throw a}for(let a of b){let b=a.targetId;if(!a.fromCache){let a=c.targetDataByTarget.get(b),d=a.snapshotVersion,e=a.withLastLimboFreeSnapshotVersion(d);c.targetDataByTarget=c.targetDataByTarget.insert(b,e)}}}function vS(a,b){let c=k2(a);return c.persistence.runTransaction("Get next mutation batch","readonly",a=>(void 0===b&&(b=n3),c.mutationQueue.getNextMutationBatchAfterBatchId(a,b)))}function vT(a,b){let c=k2(a);return c.persistence.runTransaction("read document","readonly",a=>c.localDocuments.getDocument(a,b))}function vU(a,b){let c=k2(a);return c.persistence.runTransaction("Allocate target","readwrite",a=>{let d;return c.targetCache.getTargetData(a,b).next(e=>e?(d=e,l$.resolve(d)):c.targetCache.allocateTargetId(a).next(e=>(d=new sF(b,e,"TargetPurposeListen",a.currentSequenceNumber),c.targetCache.addTargetData(a,d).next(()=>d))))}).then(a=>{let d=c.targetDataByTarget.get(a.targetId);return(null===d||a.snapshotVersion.compareTo(d.snapshotVersion)>0)&&(c.targetDataByTarget=c.targetDataByTarget.insert(a.targetId,a),c.targetIdByTarget.set(b,a.targetId)),a})}function vV(a,b,c){let d=k2(a),e=d.targetIdByTarget.get(c);return void 0!==e?l$.resolve(d.targetDataByTarget.get(e)):d.targetCache.getTargetData(b,c)}async function vW(a,b,c){let d=k2(a),e=d.targetDataByTarget.get(b),f=c?"readwrite":"readwrite-primary";try{c||await d.persistence.runTransaction("Release target",f,a=>d.persistence.referenceDelegate.removeTarget(a,e))}catch(a){if(l6(a))kX(vD,`Failed to update sequence numbers for target ${b}: ${a}`);else throw a}d.targetDataByTarget=d.targetDataByTarget.remove(b),d.targetIdByTarget.delete(e.target)}function vX(a,b,c){let d=k2(a),e=lH.min(),f=ql();return d.persistence.runTransaction("Execute query","readwrite",a=>vV(d,a,pR(b)).next(b=>{if(b)return e=b.lastLimboFreeSnapshotVersion,d.targetCache.getMatchingKeysForTargetId(a,b.targetId).next(a=>{f=a})}).next(()=>d.queryEngine.getDocumentsMatchingQuery(a,b,c?e:lH.min(),c?f:ql())).next(a=>(v2(d,p5(b),a),{documents:a,remoteKeys:f})))}function vY(a,b,c,d){let e=c.batch,f=e.keys(),g=l$.resolve();return f.forEach(a=>{g=g.next(()=>d.getEntry(b,a)).next(b=>{let f=c.docVersions.get(a);k1(null!==f,48541),0>b.version.compareTo(f)&&(e.applyToRemoteDocument(b,c),b.isValidDocument()&&(b.setReadTime(c.commitVersion),d.addEntry(b)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(b,e))}function vZ(a,b){let c=k2(a),d=k2(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",a=>d.lookupMutationKeys(a,b).next(b=>b?c.localDocuments.getDocuments(a,b):l$.resolve(null)))}function v$(a,b){k2(k2(a,vF).mutationQueue).removeCachedMutationKeys(b)}function v_(a){return k2(k2(a,vF).persistence).getActiveClients()}function v0(a,b){let c=k2(a),d=k2(c.targetCache),e=c.targetDataByTarget.get(b);return e?Promise.resolve(e.target):c.persistence.runTransaction("Get target data","readonly",a=>d.getTargetDataForTarget(a,b).next(a=>a?a.target:null))}function v1(a,b){let c=k2(a),d=c.collectionGroupReadTime.get(b)||lH.min();return c.persistence.runTransaction("Get new document changes","readonly",a=>c.remoteDocuments.getAllFromCollectionGroup(a,b,lT(d,lI),Number.MAX_SAFE_INTEGER)).then(a=>(v2(c,b,a),a))}function v2(a,b,c){let d=a.collectionGroupReadTime.get(b)||lH.min();c.forEach((a,b)=>{b.readTime.compareTo(d)>0&&(d=b.readTime)}),a.collectionGroupReadTime.set(b,d)}function v3(a){return pR(pK(lr.fromString(`__bundle__/docs/${a}`)))}async function v4(a,b,c,d){let e=k2(a),f=ql(),g=qa();for(let a of c){let c=b.toDocumentKey(a.metadata.name);a.document&&(f=f.add(c));let d=b.toMutableDocument(a);d.setReadTime(b.toSnapshotVersion(a.metadata.readTime)),g=g.insert(c,d)}let h=e.remoteDocuments.newChangeBuffer({trackRemovals:!0}),i=await vU(e,v3(d));return e.persistence.runTransaction("Apply bundle documents","readwrite",a=>vP(a,h,g).next(b=>(h.apply(a),b)).next(b=>e.targetCache.removeMatchingKeysForTargetId(a,i.targetId).next(()=>e.targetCache.addMatchingKeys(a,f,i.targetId)).next(()=>e.localDocuments.getLocalViewOfDocuments(a,b.changedDocuments,b.existenceChangedKeys)).next(()=>b.changedDocuments)))}function v5(a,b){let c=k2(a),d=rE(b.createTime);return c.persistence.runTransaction("hasNewerBundle","readonly",a=>c.bundleCache.getBundleMetadata(a,b.id)).then(a=>!!a&&a.createTime.compareTo(d)>=0)}function v6(a,b){let c=k2(a);return c.persistence.runTransaction("Save bundle","readwrite",a=>c.bundleCache.saveBundleMetadata(a,b))}function v7(a,b){let c=k2(a);return c.persistence.runTransaction("Get named query","readonly",a=>c.bundleCache.getNamedQuery(a,b))}async function v8(a,b,c=ql()){let d=await vU(a,pR(sW(b.bundledQuery))),e=k2(a);return e.persistence.runTransaction("Save named query","readwrite",a=>{let f=rE(b.readTime);if(d.snapshotVersion.compareTo(f)>=0)return e.bundleCache.saveNamedQuery(a,b);let g=d.withResumeToken(nM.EMPTY_BYTE_STRING,f);return e.targetDataByTarget=e.targetDataByTarget.insert(g.targetId,g),e.targetCache.updateTargetData(a,g).next(()=>e.targetCache.removeMatchingKeysForTargetId(a,d.targetId)).next(()=>e.targetCache.addMatchingKeys(a,c,d.targetId)).next(()=>e.bundleCache.saveNamedQuery(a,b))})}async function v9(a,b){let c=k2(a),d=c.indexManager,e=[];return c.persistence.runTransaction("Configure indexes","readwrite",a=>d.getFieldIndexes(a).next(c=>vB(c,b,lO,b=>{e.push(d.addFieldIndex(a,b))},b=>{e.push(d.deleteFieldIndex(a,b))})).next(()=>l$.waitFor(e)))}function wa(a,b){k2(a).queryEngine.indexAutoCreationEnabled=b}function wb(a){let b=k2(a),c=b.indexManager;return b.persistence.runTransaction("Delete All Indexes","readwrite",a=>c.deleteAllFieldIndexes(a))}class wc{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(a){this._documentReadCount+=a}}let wd=100;function we(){return f7()?8:l3(f1())>0?6:4}class wf{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=wd,this.relativeIndexReadCostPerDocument=we()}initialize(a,b){this.localDocumentsView=a,this.indexManager=b,this.initialized=!0}getDocumentsMatchingQuery(a,b,c,d){let e={result:null};return this.performQueryUsingIndex(a,b).next(a=>{e.result=a}).next(()=>{if(!e.result)return this.performQueryUsingRemoteKeys(a,b,d,c).next(a=>{e.result=a})}).next(()=>{if(e.result)return;let c=new wc;return this.executeFullCollectionScan(a,b,c).next(d=>{if(e.result=d,this.indexAutoCreationEnabled)return this.createCacheIndexes(a,b,c,d.size)})}).next(()=>e.result)}createCacheIndexes(a,b,c,d){return c.documentReadCount<this.indexAutoCreationMinCollectionSize?(kW()<=f.DEBUG&&kX("QueryEngine","SDK will not create cache indexes for query:",p_(b),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),l$.resolve()):(kW()<=f.DEBUG&&kX("QueryEngine","Query:",p_(b),"scans",c.documentReadCount,"local documents and returns",d,"documents as results."),c.documentReadCount>this.relativeIndexReadCostPerDocument*d)?(kW()<=f.DEBUG&&kX("QueryEngine","The SDK decides to create cache indexes for query:",p_(b),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(a,pR(b))):l$.resolve()}performQueryUsingIndex(a,b){if(pM(b))return l$.resolve(null);let c=pR(b);return this.indexManager.getIndexType(a,c).next(d=>0===d?null:(null!==b.limit&&1===d&&(c=pR(b=pW(b,null,"F"))),this.indexManager.getDocumentsMatchingTarget(a,c).next(d=>{let e=ql(...d);return this.localDocumentsView.getDocuments(a,e).next(d=>this.indexManager.getMinOffset(a,c).next(c=>{let f=this.applyQuery(b,d);return this.needsRefill(b,f,e,c.readTime)?this.performQueryUsingIndex(a,pW(b,null,"F")):this.appendRemainingResults(a,f,b,c)}))})))}performQueryUsingRemoteKeys(a,b,c,d){return pM(b)||d.isEqual(lH.min())?l$.resolve(null):this.localDocumentsView.getDocuments(a,c).next(e=>{let g=this.applyQuery(b,e);return this.needsRefill(b,g,c,d)?l$.resolve(null):(kW()<=f.DEBUG&&kX("QueryEngine","Re-using previous result from %s to execute query: %s",d.toString(),p_(b)),this.appendRemainingResults(a,g,b,lT(d,lI)).next(a=>a))})}applyQuery(a,b){let c=new nF(p6(a));return b.forEach((b,d)=>{p0(a,d)&&(c=c.add(d))}),c}needsRefill(a,b,c,d){if(null===a.limit)return!1;if(c.size!==b.size)return!0;let e="F"===a.limitType?b.last():b.first();return!!e&&(e.hasPendingWrites||e.version.compareTo(d)>0)}executeFullCollectionScan(a,b,c){return kW()<=f.DEBUG&&kX("QueryEngine","Using full collection scan to execute query:",p_(b)),this.localDocumentsView.getDocumentsMatchingQuery(a,b,lV.min(),c)}appendRemainingResults(a,b,c,d){return this.localDocumentsView.getDocumentsMatchingQuery(a,c,d).next(a=>(b.forEach(b=>{a=a.insert(b.key,b)}),a))}}let wg="firestore_clients";function wh(a,b){return`${wg}_${a}_${b}`}let wi="firestore_mutations";function wj(a,b,c){let d=`${wi}_${a}_${c}`;return b.isAuthenticated()&&(d+=`_${b.uid}`),d}let wk="firestore_targets";function wl(a,b){return`${wk}_${a}_${b}`}let wm="firestore_online_state";function wn(a){return`${wm}_${a}`}let wo="firestore_bundle_loaded_v2";function wp(a){return`${wo}_${a}`}let wq="firestore_sequence_number";function wr(a){return`${wq}_${a}`}let ws="SharedClientState";class wt{constructor(a,b,c,d){this.user=a,this.batchId=b,this.state=c,this.error=d}static fromWebStorageEntry(a,b,c){let d,e=JSON.parse(c),f="object"==typeof e&&-1!==["pending","acknowledged","rejected"].indexOf(e.state)&&(void 0===e.error||"object"==typeof e.error);return(f&&e.error&&(f="string"==typeof e.error.message&&"string"==typeof e.error.code)&&(d=new k4(e.error.code,e.error.message)),f)?new wt(a,b,e.state,d):(kY(ws,`Failed to parse mutation state for ID '${b}': ${c}`),null)}toWebStorageJSON(){let a={state:this.state,updateTimeMs:Date.now()};return this.error&&(a.error={code:this.error.code,message:this.error.message}),JSON.stringify(a)}}class wu{constructor(a,b,c){this.targetId=a,this.state=b,this.error=c}static fromWebStorageEntry(a,b){let c,d=JSON.parse(b),e="object"==typeof d&&-1!==["not-current","current","rejected"].indexOf(d.state)&&(void 0===d.error||"object"==typeof d.error);return(e&&d.error&&(e="string"==typeof d.error.message&&"string"==typeof d.error.code)&&(c=new k4(d.error.code,d.error.message)),e)?new wu(a,d.state,c):(kY(ws,`Failed to parse target state for ID '${a}': ${b}`),null)}toWebStorageJSON(){let a={state:this.state,updateTimeMs:Date.now()};return this.error&&(a.error={code:this.error.code,message:this.error.message}),JSON.stringify(a)}}class wv{constructor(a,b){this.clientId=a,this.activeTargetIds=b}static fromWebStorageEntry(a,b){let c=JSON.parse(b),d="object"==typeof c&&c.activeTargetIds instanceof Array,e=qn();for(let a=0;d&&a<c.activeTargetIds.length;++a)d=n6(c.activeTargetIds[a]),e=e.add(c.activeTargetIds[a]);return d?new wv(a,e):(kY(ws,`Failed to parse client data for instance '${a}': ${b}`),null)}}class ww{constructor(a,b){this.clientId=a,this.onlineState=b}static fromWebStorageEntry(a){let b=JSON.parse(a);return"object"==typeof b&&-1!==["Unknown","Online","Offline"].indexOf(b.onlineState)&&"string"==typeof b.clientId?new ww(b.clientId,b.onlineState):(kY(ws,`Failed to parse online state: ${a}`),null)}}class wx{constructor(){this.activeTargetIds=qn()}addQueryTarget(a){this.activeTargetIds=this.activeTargetIds.add(a)}removeQueryTarget(a){this.activeTargetIds=this.activeTargetIds.delete(a)}toWebStorageJSON(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class wy{constructor(a,b,c,d,e){this.window=a,this.queue=b,this.persistenceKey=c,this.localClientId=d,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new nB(lj),this.started=!1,this.earlyEvents=[];let f=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=e,this.localClientStorageKey=wh(this.persistenceKey,this.localClientId),this.sequenceNumberKey=wr(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new wx),this.clientStateKeyRe=RegExp(`^${wg}_${f}_([^_]*)$`),this.mutationBatchKeyRe=RegExp(`^${wi}_${f}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=RegExp(`^${wk}_${f}_(\\d+)$`),this.onlineStateKey=wn(this.persistenceKey),this.bundleLoadedKey=wp(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(a){return!!(a&&a.localStorage)}async start(){for(let a of(await this.syncEngine.getActiveClients())){if(a===this.localClientId)continue;let b=this.getItem(wh(this.persistenceKey,a));if(b){let c=wv.fromWebStorageEntry(a,b);c&&(this.activeClients=this.activeClients.insert(c.clientId,c))}}this.persistClientState();let a=this.storage.getItem(this.onlineStateKey);if(a){let b=this.fromWebStorageOnlineState(a);b&&this.handleOnlineStateEvent(b)}for(let a of this.earlyEvents)this.handleWebStorageEvent(a);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(a){this.setItem(this.sequenceNumberKey,JSON.stringify(a))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(a){let b=!1;return this.activeClients.forEach((c,d)=>{d.activeTargetIds.has(a)&&(b=!0)}),b}addPendingMutation(a){this.persistMutationState(a,"pending")}updateMutationState(a,b,c){this.persistMutationState(a,b,c),this.removeMutationState(a)}addLocalQueryTarget(a,b=!0){let c="not-current";if(this.isActiveQueryTarget(a)){let b=this.storage.getItem(wl(this.persistenceKey,a));if(b){let d=wu.fromWebStorageEntry(a,b);d&&(c=d.state)}}return b&&this.localClientState.addQueryTarget(a),this.persistClientState(),c}removeLocalQueryTarget(a){this.localClientState.removeQueryTarget(a),this.persistClientState()}isLocalQueryTarget(a){return this.localClientState.activeTargetIds.has(a)}clearQueryState(a){this.removeItem(wl(this.persistenceKey,a))}updateQueryState(a,b,c){this.persistQueryTargetState(a,b,c)}handleUserChange(a,b,c){b.forEach(a=>{this.removeMutationState(a)}),this.currentUser=a,c.forEach(a=>{this.addPendingMutation(a)})}setOnlineState(a){this.persistOnlineState(a)}notifyBundleLoaded(a){this.persistBundleLoadedState(a)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(a){let b=this.storage.getItem(a);return kX(ws,"READ",a,b),b}setItem(a,b){kX(ws,"SET",a,b),this.storage.setItem(a,b)}removeItem(a){kX(ws,"REMOVE",a),this.storage.removeItem(a)}handleWebStorageEvent(a){let b=a;if(b.storageArea===this.storage){if(kX(ws,"EVENT",b.key,b.newValue),b.key===this.localClientStorageKey)return void kY("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueRetryable(async()=>{if(!this.started)return void this.earlyEvents.push(b);if(null!==b.key){if(this.clientStateKeyRe.test(b.key))if(null!=b.newValue){let a=this.fromWebStorageClientState(b.key,b.newValue);if(a)return this.handleClientStateEvent(a.clientId,a)}else{let a=this.fromWebStorageClientStateKey(b.key);return this.handleClientStateEvent(a,null)}else if(this.mutationBatchKeyRe.test(b.key)){if(null!==b.newValue){let a=this.fromWebStorageMutationMetadata(b.key,b.newValue);if(a)return this.handleMutationBatchEvent(a)}}else if(this.queryTargetKeyRe.test(b.key)){if(null!==b.newValue){let a=this.fromWebStorageQueryTargetMetadata(b.key,b.newValue);if(a)return this.handleQueryTargetEvent(a)}}else if(b.key===this.onlineStateKey){if(null!==b.newValue){let a=this.fromWebStorageOnlineState(b.newValue);if(a)return this.handleOnlineStateEvent(a)}}else if(b.key===this.sequenceNumberKey){let a=wz(b.newValue);a!==mh.INVALID&&this.sequenceNumberHandler(a)}else if(b.key===this.bundleLoadedKey){let a=this.fromWebStoreBundleLoadedState(b.newValue);await Promise.all(a.map(a=>this.syncEngine.synchronizeWithChangedDocuments(a)))}}})}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(a,b,c){let d=new wt(this.currentUser,a,b,c),e=wj(this.persistenceKey,this.currentUser,a);this.setItem(e,d.toWebStorageJSON())}removeMutationState(a){let b=wj(this.persistenceKey,this.currentUser,a);this.removeItem(b)}persistOnlineState(a){let b={clientId:this.localClientId,onlineState:a};this.storage.setItem(this.onlineStateKey,JSON.stringify(b))}persistQueryTargetState(a,b,c){let d=wl(this.persistenceKey,a),e=new wu(a,b,c);this.setItem(d,e.toWebStorageJSON())}persistBundleLoadedState(a){let b=JSON.stringify(Array.from(a));this.setItem(this.bundleLoadedKey,b)}fromWebStorageClientStateKey(a){let b=this.clientStateKeyRe.exec(a);return b?b[1]:null}fromWebStorageClientState(a,b){let c=this.fromWebStorageClientStateKey(a);return wv.fromWebStorageEntry(c,b)}fromWebStorageMutationMetadata(a,b){let c=this.mutationBatchKeyRe.exec(a),d=Number(c[1]),e=void 0!==c[2]?c[2]:null;return wt.fromWebStorageEntry(new kR(e),d,b)}fromWebStorageQueryTargetMetadata(a,b){let c=Number(this.queryTargetKeyRe.exec(a)[1]);return wu.fromWebStorageEntry(c,b)}fromWebStorageOnlineState(a){return ww.fromWebStorageEntry(a)}fromWebStoreBundleLoadedState(a){return JSON.parse(a)}async handleMutationBatchEvent(a){return a.user.uid!==this.currentUser.uid?void kX(ws,`Ignoring mutation for non-active user ${a.user.uid}`):this.syncEngine.applyBatchState(a.batchId,a.state,a.error)}handleQueryTargetEvent(a){return this.syncEngine.applyTargetState(a.targetId,a.state,a.error)}handleClientStateEvent(a,b){let c=b?this.activeClients.insert(a,b):this.activeClients.remove(a),d=this.extractActiveQueryTargets(this.activeClients),e=this.extractActiveQueryTargets(c),f=[],g=[];return e.forEach(a=>{d.has(a)||f.push(a)}),d.forEach(a=>{e.has(a)||g.push(a)}),this.syncEngine.applyActiveTargetsChange(f,g).then(()=>{this.activeClients=c})}handleOnlineStateEvent(a){this.activeClients.get(a.clientId)&&this.onlineStateHandler(a.onlineState)}extractActiveQueryTargets(a){let b=qn();return a.forEach((a,c)=>{b=b.unionWith(c.activeTargetIds)}),b}}function wz(a){let b=mh.INVALID;if(null!=a)try{let c=JSON.parse(a);k1("number"==typeof c,30636,{seqString:a}),b=c}catch(a){kY(ws,"Failed to read sequence number from WebStorage",a)}return b}class wA{constructor(){this.localState=new wx,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(a){}updateMutationState(a,b,c){}addLocalQueryTarget(a,b=!0){return b&&this.localState.addQueryTarget(a),this.queryState[a]||"not-current"}updateQueryState(a,b,c){this.queryState[a]=b}removeLocalQueryTarget(a){this.localState.removeQueryTarget(a)}isLocalQueryTarget(a){return this.localState.activeTargetIds.has(a)}clearQueryState(a){delete this.queryState[a]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(a){return this.localState.activeTargetIds.has(a)}start(){return this.localState=new wx,Promise.resolve()}handleUserChange(a,b,c){}setOnlineState(a){}shutdown(){}writeSequenceNumber(a){}notifyBundleLoaded(a){}}class wB{addCallback(a){}shutdown(){}}class wC{constructor(a){this.sendFn=a.sendFn,this.closeFn=a.closeFn}onConnected(a){this.wrappedOnConnected=a}onOpen(a){this.wrappedOnOpen=a}onClose(a){this.wrappedOnClose=a}onMessage(a){this.wrappedOnMessage=a}close(){this.closeFn()}send(a){this.sendFn(a)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(a){this.wrappedOnClose(a)}callOnMessage(a){this.wrappedOnMessage(a)}}let wD=null;function wE(){return 0x10000000+Math.round(0x80000000*Math.random())}function wF(){return null===wD?wD=wE():wD++,"0x"+wD.toString(16)}function wG(a){return new Promise((b,c)=>{a((a,d)=>{a?c(a):b(d)})})}let wH="1.9.15",wI="GrpcConnection",wJ=`gl-node/${process.versions.node} fire/${kS} grpc/${wH}`;function wK(a,b,c,d){k1(null===b||"OAuth"===b.type,36936);let e=new kN.OS;return b&&b.headers.forEach((a,b)=>e.set(b,a)),c&&c.headers.forEach((a,b)=>e.set(b,a)),d&&e.set("X-Firebase-GMPID",d),e.set("X-Goog-Api-Client",wJ),e.set("Google-Cloud-Resource-Prefix",a),e.set("x-goog-request-params",a),e}class wL{get shouldResourcePathBeIncludedInRequest(){return!0}constructor(a,b){this.databaseInfo=b,this.cachedStub=null,this.firestore=a.google.firestore.v1,this.databasePath=`projects/${b.databaseId.projectId}/databases/${b.databaseId.database}`}ensureActiveStub(){if(!this.cachedStub){kX(wI,"Creating Firestore stub.");let a=this.databaseInfo.ssl?kN.z3.createSsl():kN.z3.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,a)}return this.cachedStub}invokeRPC(a,b,c,d,e){let f=wF(),g=this.ensureActiveStub(),h=wK(this.databasePath,d,e,this.databaseInfo.appId),i=Object.assign({database:this.databasePath},c);return wG(b=>(kX(wI,`RPC '${a}' ${f} invoked with request:`,c),g[a](i,h,(c,d)=>{c?(kX(wI,`RPC '${a}' ${f} failed with error:`,c),b(new k4(q8(c.code),c.message))):(kX(wI,`RPC '${a}' ${f} completed with response:`,d),b(void 0,d))})))}invokeStreamingRPC(a,b,c,d,e,f){let g=wF(),h=[],i=new k5;kX(wI,`RPC '${a}' ${g} invoked (streaming) with request:`,c);let j=this.ensureActiveStub(),k=wK(this.databasePath,d,e,this.databaseInfo.appId),l=Object.assign(Object.assign({},c),{database:this.databasePath}),m=j[a](l,k),n=!1;return m.on("data",b=>{kX(wI,`RPC ${a} ${g} received result:`,b),h.push(b),void 0!==f&&h.length===f&&(n=!0,i.resolve(h))}),m.on("end",()=>{kX(wI,`RPC '${a}' ${g} completed.`),n||(n=!0,i.resolve(h))}),m.on("error",b=>{kX(wI,`RPC '${a}' ${g} failed with error:`,b);let c=q8(b.code);i.reject(new k4(c,b.message))}),i.promise}openStream(a,b,c){let d=wF(),e=this.ensureActiveStub(),f=wK(this.databasePath,b,c,this.databaseInfo.appId),g=e[a](f),h=!1,i=a=>{h||(h=!0,j.callOnClose(a),g.end())},j=new wC({sendFn:b=>{if(h)kX(wI,`RPC '${a}' stream ${d} not sending because gRPC stream is closed:`,b);else{kX(wI,`RPC '${a}' stream ${d} sending:`,b);try{g.write(b)}catch(a){throw kY("Failure sending:",b),kY("Error:",a),a}}},closeFn:()=>{kX(wI,`RPC '${a}' stream ${d} closed locally via close().`),i()}}),k=!1;return g.on("data",b=>{h||(kX(wI,`RPC '${a}' stream ${d} received:`,b),k||(j.callOnConnected(),k=!0),j.callOnMessage(b))}),g.on("end",()=>{kX(wI,`RPC '${a}' stream ${d} ended.`),i()}),g.on("error",b=>{h||(kZ(wI,`RPC '${a}' stream ${d} error. Code:`,b.code,"Message:",b.message),i(new k4(q8(b.code),b.message)))}),kX(wI,`Opening RPC '${a}' stream ${d} to ${this.databaseInfo.host}`),setTimeout(()=>{j.callOnOpen()},0),j}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}}let wM={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:0x44f2530,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}};var wN={nested:wM},wO=Object.freeze({__proto__:null,nested:wM,default:wN});let wP={longs:String,enums:String,defaults:!0,oneofs:!1};function wQ(){let a=kO.rS(wO,wP);return kN.ex(a)}function wR(a){return new wL(wQ(),a)}function wS(){return new wB}function wT(){return"YES"===process.env.USE_MOCK_PERSISTENCE?window:null}function wU(){return null}function wV(a){return new rv(a,!1)}let wW="ExponentialBackoff",wX=1e3,wY=1.5,wZ=6e4;class w${constructor(a,b,c=wX,d=wY,e=wZ){this.queue=a,this.timerId=b,this.initialDelayMs=c,this.backoffFactor=d,this.maxDelayMs=e,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(a){this.cancel();let b=Math.floor(this.currentBaseMs+this.jitterDelayMs()),c=Math.max(0,Date.now()-this.lastAttemptTime),d=Math.max(0,b-c);d>0&&kX(wW,`Backing off for ${d} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${b} ms, last attempt: ${c} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,d,()=>(this.lastAttemptTime=Date.now(),a())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}}let w_="PersistentStream",w0=6e4,w1=1e4;class w2{constructor(a,b,c,d,e,f,g,h){this.queue=a,this.idleTimerId=c,this.healthTimerId=d,this.connection=e,this.authCredentialsProvider=f,this.appCheckCredentialsProvider=g,this.listener=h,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new w$(a,b)}isStarted(){return 1===this.state||5===this.state||this.isOpen()}isOpen(){return 2===this.state||3===this.state}start(){if(this.responseCount=0,4===this.state)return void this.performBackoff();this.auth()}async stop(){this.isStarted()&&await this.close(0)}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,w0,()=>this.handleIdleCloseTimer()))}sendRequest(a){this.cancelIdleCheck(),this.stream.send(a)}async handleIdleCloseTimer(){if(this.isOpen())return this.close(0)}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}async close(a,b){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,4!==a?this.backoff.reset():b&&b.code===k3.RESOURCE_EXHAUSTED?(kY(b.toString()),kY("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):b&&b.code===k3.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=a,await this.listener.onClose(b)}tearDown(){}auth(){this.state=1;let a=this.getCloseGuardedDispatcher(this.closeCount),b=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,c])=>{this.closeCount===b&&this.startStream(a,c)},b=>{a(()=>{let a=new k4(k3.UNKNOWN,"Fetching auth token failed: "+b.message);return this.handleStreamClose(a)})})}startStream(a,b){let c=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(a,b),this.stream.onConnected(()=>{c(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{c(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,w1,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(a=>{c(()=>this.handleStreamClose(a))}),this.stream.onMessage(a=>{c(()=>1==++this.responseCount?this.onFirst(a):this.onNext(a))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(async()=>{this.state=0,this.start()})}handleStreamClose(a){return kX(w_,`close with error: ${a}`),this.stream=null,this.close(4,a)}getCloseGuardedDispatcher(a){return b=>{this.queue.enqueueAndForget(()=>this.closeCount===a?b():(kX(w_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class w3 extends w2{constructor(a,b,c,d,e,f){super(a,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",b,c,d,f),this.serializer=e}startRpc(a,b){return this.connection.openStream("Listen",a,b)}onFirst(a){return this.onNext(a)}onNext(a){this.backoff.reset();let b=rV(this.serializer,a),c=rX(a);return this.listener.onWatchChange(b,c)}watch(a){let b={};b.database=rM(this.serializer),b.addTarget=sc(this.serializer,a);let c=sa(this.serializer,a);c&&(b.labels=c),this.sendRequest(b)}unwatch(a){let b={};b.database=rM(this.serializer),b.removeTarget=a,this.sendRequest(b)}}class w4 extends w2{constructor(a,b,c,d,e,f){super(a,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",b,c,d,f),this.serializer=e}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(a,b){return this.connection.openStream("Write",a,b)}onFirst(a){return k1(!!a.streamToken,31322),this.lastStreamToken=a.streamToken,k1(!a.writeResults||0===a.writeResults.length,55816),this.listener.onHandshakeComplete()}onNext(a){k1(!!a.streamToken,12678),this.lastStreamToken=a.streamToken,this.backoff.reset();let b=r1(a.writeResults,a.commitTime),c=rE(a.commitTime);return this.listener.onMutationResult(c,b)}writeHandshake(){let a={};a.database=rM(this.serializer),this.sendRequest(a)}writeMutations(a){let b={streamToken:this.lastStreamToken,writes:a.map(a=>rY(this.serializer,a))};this.sendRequest(b)}}class w5{}class w6 extends w5{constructor(a,b,c,d){super(),this.authCredentials=a,this.appCheckCredentials=b,this.connection=c,this.serializer=d,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new k4(k3.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(a,b,c,d){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([e,f])=>this.connection.invokeRPC(a,rG(b,c),d,e,f)).catch(a=>{if("FirebaseError"===a.name)throw a.code===k3.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a;throw new k4(k3.UNKNOWN,a.toString())})}invokeStreamingRPC(a,b,c,d,e){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([f,g])=>this.connection.invokeStreamingRPC(a,rG(b,c),d,f,g,e)).catch(a=>{if("FirebaseError"===a.name)throw a.code===k3.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a;throw new k4(k3.UNKNOWN,a.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}}function w7(a,b,c,d){return new w6(a,b,c,d)}async function w8(a,b){let c=k2(a),d={writes:b.map(a=>rY(c.serializer,a))};await c.invokeRPC("Commit",c.serializer.databaseId,lr.emptyPath(),d)}async function w9(a,b){let c=k2(a),d={documents:b.map(a=>rI(c.serializer,a))},e=await c.invokeStreamingRPC("BatchGetDocuments",c.serializer.databaseId,lr.emptyPath(),d,b.length),f=new Map;e.forEach(a=>{let b=rU(c.serializer,a);f.set(b.key.toString(),b)});let g=[];return b.forEach(a=>{let b=f.get(a.toString());k1(!!b,55234,{key:a}),g.push(b)}),g}async function xa(a,b,c){var d;let e=k2(a),{request:f,aliasMap:g,parent:h}=r7(e.serializer,pS(b),c);e.connection.shouldResourcePathBeIncludedInRequest||delete f.parent;let i=(await e.invokeStreamingRPC("RunAggregationQuery",e.serializer.databaseId,h,f,1)).filter(a=>!!a.result);k1(1===i.length,64727);let j=null==(d=i[0].result)?void 0:d.aggregateFields;return Object.keys(j).reduce((a,b)=>(a[g[b]]=j[b],a),{})}function xb(a,b,c){let d=k2(a);return d.verifyInitialized(),new w4(b,d.connection,d.authCredentials,d.appCheckCredentials,d.serializer,c)}function xc(a,b,c){let d=k2(a);return d.verifyInitialized(),new w3(b,d.connection,d.authCredentials,d.appCheckCredentials,d.serializer,c)}let xd="OnlineStateTracker",xe=1,xf=1e4;class xg{constructor(a,b){this.asyncQueue=a,this.onlineStateHandler=b,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){0===this.watchStreamFailures&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",xf,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${xf/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(a){"Online"===this.state?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=xe&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${xe} times. Most recent error: ${a.toString()}`),this.setAndBroadcast("Offline")))}set(a){this.clearOnlineStateTimer(),this.watchStreamFailures=0,"Online"===a&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(a)}setAndBroadcast(a){a!==this.state&&(this.state=a,this.onlineStateHandler(a))}logClientOfflineWarningIfNecessary(a){let b=`Could not reach Cloud Firestore backend. ${a}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(kY(b),this.shouldWarnClientIsOffline=!1):kX(xd,b)}clearOnlineStateTimer(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}}let xh="RemoteStore",xi=10;class xj{constructor(a,b,c,d,e){this.localStore=a,this.datastore=b,this.asyncQueue=c,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=e,this.connectivityMonitor.addCallback(a=>{c.enqueueAndForget(async()=>{xw(this)&&(kX(xh,"Restarting streams for network reachability change."),await xQ(this))})}),this.onlineStateTracker=new xg(c,d)}}function xk(a,b,c,d,e){return new xj(a,b,c,d,e)}function xl(a){let b=k2(a);return b.offlineCauses.delete(0),xm(b)}async function xm(a){if(xw(a))for(let b of a.onNetworkStatusChange)await b(!0)}async function xn(a){let b=k2(a);b.offlineCauses.add(0),await xo(b),b.onlineStateTracker.set("Offline")}async function xo(a){for(let b of a.onNetworkStatusChange)await b(!1)}async function xp(a){let b=k2(a);kX(xh,"RemoteStore shutting down."),b.offlineCauses.add(5),await xo(b),b.connectivityMonitor.shutdown(),b.onlineStateTracker.set("Unknown")}function xq(a,b){let c=k2(a);!c.listenTargets.has(b.targetId)&&(c.listenTargets.set(b.targetId,b),xv(c)?xu(c):xT(c).isOpen()&&xs(c,b))}function xr(a,b){let c=k2(a),d=xT(c);c.listenTargets.delete(b),d.isOpen()&&xt(c,b),0===c.listenTargets.size&&(d.isOpen()?d.markIdle():xw(c)&&c.onlineStateTracker.set("Unknown"))}function xs(a,b){if(a.watchChangeAggregator.recordPendingTargetRequest(b.targetId),b.resumeToken.approximateByteSize()>0||b.snapshotVersion.compareTo(lH.min())>0){let c=a.remoteSyncer.getRemoteKeysForTarget(b.targetId).size;b=b.withExpectedCount(c)}xT(a).watch(b)}function xt(a,b){a.watchChangeAggregator.recordPendingTargetRequest(b),xT(a).unwatch(b)}function xu(a){a.watchChangeAggregator=new ro({getRemoteKeysForTarget:b=>a.remoteSyncer.getRemoteKeysForTarget(b),getTargetDataForTarget:b=>a.listenTargets.get(b)||null,getDatabaseId:()=>a.datastore.serializer.databaseId}),xT(a).start(),a.onlineStateTracker.handleWatchStreamStart()}function xv(a){return xw(a)&&!xT(a).isStarted()&&a.listenTargets.size>0}function xw(a){return 0===k2(a).offlineCauses.size}function xx(a){a.watchChangeAggregator=void 0}async function xy(a){a.onlineStateTracker.set("Online")}async function xz(a){a.listenTargets.forEach((b,c)=>{xs(a,b)})}async function xA(a,b){xx(a),xv(a)?(a.onlineStateTracker.handleWatchStreamFailure(b),xu(a)):a.onlineStateTracker.set("Unknown")}async function xB(a,b,c){if(a.onlineStateTracker.set("Online"),b instanceof rl&&2===b.state&&b.cause){try{await xF(a,b)}catch(c){kX(xh,"Failed to remove targets %s: %s ",b.targetIds.join(","),c),await xC(a,c)}return}if(b instanceof rj?a.watchChangeAggregator.handleDocumentChange(b):b instanceof rk?a.watchChangeAggregator.handleExistenceFilter(b):a.watchChangeAggregator.handleTargetChange(b),!c.isEqual(lH.min()))try{let b=await vN(a.localStore);c.compareTo(b)>=0&&await xE(a,c)}catch(b){kX(xh,"Failed to raise snapshot:",b),await xC(a,b)}}async function xC(a,b,c){if(l6(b))a.offlineCauses.add(1),await xo(a),a.onlineStateTracker.set("Offline"),c||(c=()=>vN(a.localStore)),a.asyncQueue.enqueueRetryable(async()=>{kX(xh,"Retrying IndexedDB access"),await c(),a.offlineCauses.delete(1),await xm(a)});else throw b}function xD(a,b){return b().catch(c=>xC(a,c,b))}function xE(a,b){let c=a.watchChangeAggregator.createRemoteEvent(b);return c.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){let e=a.listenTargets.get(d);e&&a.listenTargets.set(d,e.withResumeToken(c.resumeToken,b))}}),c.targetMismatches.forEach((b,c)=>{let d=a.listenTargets.get(b);d&&(a.listenTargets.set(b,d.withResumeToken(nM.EMPTY_BYTE_STRING,d.snapshotVersion)),xt(a,b),xs(a,new sF(d.target,b,c,d.sequenceNumber)))}),a.remoteSyncer.applyRemoteEvent(c)}async function xF(a,b){let c=b.cause;for(let d of b.targetIds)a.listenTargets.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.listenTargets.delete(d),a.watchChangeAggregator.removeTarget(d))}async function xG(a){let b=k2(a),c=xU(b),d=b.writePipeline.length>0?b.writePipeline[b.writePipeline.length-1].batchId:n3;for(;xH(b);)try{let a=await vS(b.localStore,d);if(null===a){0===b.writePipeline.length&&c.markIdle();break}d=a.batchId,xI(b,a)}catch(a){await xC(b,a)}xJ(b)&&xK(b)}function xH(a){return xw(a)&&a.writePipeline.length<xi}function xI(a,b){a.writePipeline.push(b);let c=xU(a);c.isOpen()&&c.handshakeComplete&&c.writeMutations(b.mutations)}function xJ(a){return xw(a)&&!xU(a).isStarted()&&a.writePipeline.length>0}function xK(a){xU(a).start()}async function xL(a){xU(a).writeHandshake()}async function xM(a){let b=xU(a);for(let c of a.writePipeline)b.writeMutations(c.mutations)}async function xN(a,b,c){let d=a.writePipeline.shift(),e=q3.from(d,b,c);await xD(a,()=>a.remoteSyncer.applySuccessfulWrite(e)),await xG(a)}async function xO(a,b){b&&xU(a).handshakeComplete&&await xP(a,b),xJ(a)&&xK(a)}async function xP(a,b){if(q7(b.code)){let c=a.writePipeline.shift();xU(a).inhibitBackoff(),await xD(a,()=>a.remoteSyncer.rejectFailedWrite(c.batchId,b)),await xG(a)}}async function xQ(a){let b=k2(a);b.offlineCauses.add(4),await xo(b),b.onlineStateTracker.set("Unknown"),b.offlineCauses.delete(4),await xm(b)}async function xR(a,b){let c=k2(a);c.asyncQueue.verifyOperationInProgress(),kX(xh,"RemoteStore received new credentials");let d=xw(c);c.offlineCauses.add(3),await xo(c),d&&c.onlineStateTracker.set("Unknown"),await c.remoteSyncer.handleCredentialChange(b),c.offlineCauses.delete(3),await xm(c)}async function xS(a,b){let c=k2(a);b?(c.offlineCauses.delete(2),await xm(c)):b||(c.offlineCauses.add(2),await xo(c),c.onlineStateTracker.set("Unknown"))}function xT(a){return a.watchStream||(a.watchStream=xc(a.datastore,a.asyncQueue,{onConnected:xy.bind(null,a),onOpen:xz.bind(null,a),onClose:xA.bind(null,a),onWatchChange:xB.bind(null,a)}),a.onNetworkStatusChange.push(async b=>{b?(a.watchStream.inhibitBackoff(),xv(a)?xu(a):a.onlineStateTracker.set("Unknown")):(await a.watchStream.stop(),xx(a))})),a.watchStream}function xU(a){return a.writeStream||(a.writeStream=xb(a.datastore,a.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:xL.bind(null,a),onClose:xO.bind(null,a),onHandshakeComplete:xM.bind(null,a),onMutationResult:xN.bind(null,a)}),a.onNetworkStatusChange.push(async b=>{b?(a.writeStream.inhibitBackoff(),await xG(a)):(await a.writeStream.stop(),a.writePipeline.length>0&&(kX(xh,`Stopping write stream with ${a.writePipeline.length} pending writes`),a.writePipeline=[]))})),a.writeStream}let xV="AsyncQueue";class xW{constructor(a,b,c,d,e){this.asyncQueue=a,this.timerId=b,this.targetTimeMs=c,this.op=d,this.removalCallback=e,this.deferred=new k5,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(a,b,c,d,e){let f=new xW(a,b,Date.now()+c,d,e);return f.start(c),f}start(a){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),a)}skipDelay(){return this.handleDelayElapsed()}cancel(a){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new k4(k3.CANCELLED,"Operation cancelled"+(a?": "+a:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(a=>this.deferred.resolve(a))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xX(a,b){if(kY(xV,`${b}: ${a}`),l6(a))return new k4(k3.UNAVAILABLE,`${b}: ${a}`);throw a}class xY{static emptySet(a){return new xY(a.comparator)}constructor(a){a?this.comparator=(b,c)=>a(b,c)||lu.comparator(b.key,c.key):this.comparator=(a,b)=>lu.comparator(a.key,b.key),this.keyedMap=qc(),this.sortedSet=new nB(this.comparator)}has(a){return null!=this.keyedMap.get(a)}get(a){return this.keyedMap.get(a)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(a){let b=this.keyedMap.get(a);return b?this.sortedSet.indexOf(b):-1}get size(){return this.sortedSet.size}forEach(a){this.sortedSet.inorderTraversal((b,c)=>(a(b),!1))}add(a){let b=this.delete(a.key);return b.copy(b.keyedMap.insert(a.key,a),b.sortedSet.insert(a,null))}delete(a){let b=this.get(a);return b?this.copy(this.keyedMap.remove(a),this.sortedSet.remove(b)):this}isEqual(a){if(!(a instanceof xY)||this.size!==a.size)return!1;let b=this.sortedSet.getIterator(),c=a.sortedSet.getIterator();for(;b.hasNext();){let a=b.getNext().key,d=c.getNext().key;if(!a.isEqual(d))return!1}return!0}toString(){let a=[];return(this.forEach(b=>{a.push(b.toString())}),0===a.length)?"DocumentSet ()":"DocumentSet (\n  "+a.join("  \n")+"\n)"}copy(a,b){let c=new xY;return c.comparator=this.comparator,c.keyedMap=a,c.sortedSet=b,c}}class xZ{constructor(){this.changeMap=new nB(lu.comparator)}track(a){let b=a.doc.key,c=this.changeMap.get(b);if(!c){this.changeMap=this.changeMap.insert(b,a);return}0!==a.type&&3===c.type?this.changeMap=this.changeMap.insert(b,a):3===a.type&&1!==c.type?this.changeMap=this.changeMap.insert(b,{type:c.type,doc:a.doc}):2===a.type&&2===c.type?this.changeMap=this.changeMap.insert(b,{type:2,doc:a.doc}):2===a.type&&0===c.type?this.changeMap=this.changeMap.insert(b,{type:0,doc:a.doc}):1===a.type&&0===c.type?this.changeMap=this.changeMap.remove(b):1===a.type&&2===c.type?this.changeMap=this.changeMap.insert(b,{type:1,doc:c.doc}):0===a.type&&1===c.type?this.changeMap=this.changeMap.insert(b,{type:2,doc:a.doc}):k_(63341,{change:a,oldChange:c})}getChanges(){let a=[];return this.changeMap.inorderTraversal((b,c)=>{a.push(c)}),a}}class x${constructor(a,b,c,d,e,f,g,h,i){this.query=a,this.docs=b,this.oldDocs=c,this.docChanges=d,this.mutatedKeys=e,this.fromCache=f,this.syncStateChanged=g,this.excludesMetadataChanges=h,this.hasCachedResults=i}static fromInitialDocuments(a,b,c,d,e){let f=[];return b.forEach(a=>{f.push({type:0,doc:a})}),new x$(a,b,xY.emptySet(b),f,c,d,!0,!1,e)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(a){if(this.fromCache!==a.fromCache||this.hasCachedResults!==a.hasCachedResults||this.syncStateChanged!==a.syncStateChanged||!this.mutatedKeys.isEqual(a.mutatedKeys)||!pZ(this.query,a.query)||!this.docs.isEqual(a.docs)||!this.oldDocs.isEqual(a.oldDocs))return!1;let b=this.docChanges,c=a.docChanges;if(b.length!==c.length)return!1;for(let a=0;a<b.length;a++)if(b[a].type!==c[a].type||!b[a].doc.isEqual(c[a].doc))return!1;return!0}}class x_{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(a=>a.listensToRemoteStore())}}function x0(){return new x1}class x1{constructor(){this.queries=x2(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){ya(this,new k4(k3.ABORTED,"Firestore shutting down"))}}function x2(){return new p8(a=>p$(a),pZ)}async function x3(a,b){let c=k2(a),d=3,e=b.query,f=c.queries.get(e);f?!f.hasRemoteListeners()&&b.listensToRemoteStore()&&(d=2):(f=new x_,d=+!b.listensToRemoteStore());try{switch(d){case 0:f.viewSnap=await c.onListen(e,!0);break;case 1:f.viewSnap=await c.onListen(e,!1);break;case 2:await c.onFirstRemoteStoreListen(e)}}catch(c){let a=xX(c,`Initialization of query '${p_(b.query)}' failed`);b.onError(a);return}c.queries.set(e,f),f.listeners.push(b),b.applyOnlineStateChange(c.onlineState),f.viewSnap&&b.onViewSnapshot(f.viewSnap)&&yb(c)}async function x4(a,b){let c=k2(a),d=b.query,e=3,f=c.queries.get(d);if(f){let a=f.listeners.indexOf(b);a>=0&&(f.listeners.splice(a,1),0===f.listeners.length?e=+!b.listensToRemoteStore():!f.hasRemoteListeners()&&b.listensToRemoteStore()&&(e=2))}switch(e){case 0:return c.queries.delete(d),c.onUnlisten(d,!0);case 1:return c.queries.delete(d),c.onUnlisten(d,!1);case 2:return c.onLastRemoteStoreUnlisten(d);default:return}}function x5(a,b){let c=k2(a),d=!1;for(let a of b){let b=a.query,e=c.queries.get(b);if(e){for(let b of e.listeners)b.onViewSnapshot(a)&&(d=!0);e.viewSnap=a}}d&&yb(c)}function x6(a,b,c){let d=k2(a),e=d.queries.get(b);if(e)for(let a of e.listeners)a.onError(c);d.queries.delete(b)}function x7(a,b){let c=k2(a);c.onlineState=b;let d=!1;c.queries.forEach((a,c)=>{for(let a of c.listeners)a.applyOnlineStateChange(b)&&(d=!0)}),d&&yb(c)}function x8(a,b){k2(a).snapshotsInSyncListeners.add(b),b.next()}function x9(a,b){k2(a).snapshotsInSyncListeners.delete(b)}function ya(a,b){let c=k2(a),d=c.queries;c.queries=x2(),d.forEach((a,c)=>{for(let a of c.listeners)a.onError(b)})}function yb(a){a.snapshotsInSyncListeners.forEach(a=>{a.next()})}!function(a){a.Default="default",a.Cache="cache"}(j||(j={}));class yc{constructor(a,b,c){this.query=a,this.queryObserver=b,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=c||{}}onViewSnapshot(a){if(!this.options.includeMetadataChanges){let b=[];for(let c of a.docChanges)3!==c.type&&b.push(c);a=new x$(a.query,a.docs,a.oldDocs,b,a.mutatedKeys,a.fromCache,a.syncStateChanged,!0,a.hasCachedResults)}let b=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(a)&&(this.queryObserver.next(a),b=!0):this.shouldRaiseInitialEvent(a,this.onlineState)&&(this.raiseInitialEvent(a),b=!0),this.snap=a,b}onError(a){this.queryObserver.error(a)}applyOnlineStateChange(a){this.onlineState=a;let b=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,a)&&(this.raiseInitialEvent(this.snap),b=!0),b}shouldRaiseInitialEvent(a,b){if(!a.fromCache||!this.listensToRemoteStore())return!0;let c="Offline"!==b;return(!this.options.waitForSyncWhenOnline||!c)&&(!a.docs.isEmpty()||a.hasCachedResults||"Offline"===b)}shouldRaiseEvent(a){if(a.docChanges.length>0)return!0;let b=this.snap&&this.snap.hasPendingWrites!==a.hasPendingWrites;return(!!a.syncStateChanged||!!b)&&!0===this.options.includeMetadataChanges}raiseInitialEvent(a){a=x$.fromInitialDocuments(a.query,a.docs,a.mutatedKeys,a.fromCache,a.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(a)}listensToRemoteStore(){return this.options.source!==j.Cache}}class yd{constructor(a,b,c,d){this.targetId=a,this.fromCache=b,this.addedKeys=c,this.removedKeys=d}static fromSnapshot(a,b){let c=ql(),d=ql();for(let a of b.docChanges)switch(a.type){case 0:c=c.add(a.doc.key);break;case 1:d=d.add(a.doc.key)}return new yd(a,b.fromCache,c,d)}}class ye{constructor(a){this.serializer=a}toDocumentKey(a){return rJ(this.serializer,a)}toMutableDocument(a){return a.metadata.exists?rR(this.serializer,a.document,!1):oX.newNoDocument(this.toDocumentKey(a.metadata.name),this.toSnapshotVersion(a.metadata.readTime))}toSnapshotVersion(a){return rE(a)}}class yf{constructor(a,b){this.bundleMetadata=a,this.serializer=b,this._queries=[],this._documents=[],this.collectionGroups=new Set,this.progress=yg(a)}get queries(){return this._queries}get documents(){return this._documents}addSizedElement(a){this.progress.bytesLoaded+=a.byteLength;let b=this.progress.documentsLoaded;if(a.payload.namedQuery)this._queries.push(a.payload.namedQuery);else if(a.payload.documentMetadata){this._documents.push({metadata:a.payload.documentMetadata}),!a.payload.documentMetadata.exists&&++b;let c=lr.fromString(a.payload.documentMetadata.name);this.collectionGroups.add(c.get(c.length-2))}else a.payload.document&&(this._documents[this._documents.length-1].document=a.payload.document,++b);return b!==this.progress.documentsLoaded?(this.progress.documentsLoaded=b,Object.assign({},this.progress)):null}getQueryDocumentMapping(a){let b=new Map,c=new ye(this.serializer);for(let d of a)if(d.metadata.queries){let a=c.toDocumentKey(d.metadata.name);for(let c of d.metadata.queries){let d=(b.get(c)||ql()).add(a);b.set(c,d)}}return b}async completeAndStoreAsync(a){let b=await v4(a,new ye(this.serializer),this._documents,this.bundleMetadata.id),c=this.getQueryDocumentMapping(this.documents);for(let b of this._queries)await v8(a,b,c.get(b.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:b}}}function yg(a){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}}function yh(a){return{taskState:"Success",documentsLoaded:a.totalDocuments,bytesLoaded:a.totalBytes,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}}class yi{constructor(a){this.key=a}}class yj{constructor(a){this.key=a}}class yk{constructor(a,b){this.query=a,this._syncedDocuments=b,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=ql(),this.mutatedKeys=ql(),this.docComparator=p6(a),this.documentSet=new xY(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(a,b){let c=b?b.changeSet:new xZ,d=b?b.documentSet:this.documentSet,e=b?b.mutatedKeys:this.mutatedKeys,f=d,g=!1,h="F"===this.query.limitType&&d.size===this.query.limit?d.last():null,i="L"===this.query.limitType&&d.size===this.query.limit?d.first():null;if(a.inorderTraversal((a,b)=>{let j=d.get(a),k=p0(this.query,b)?b:null,l=!!j&&this.mutatedKeys.has(j.key),m=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations),n=!1;j&&k?j.data.isEqual(k.data)?l!==m&&(c.track({type:3,doc:k}),n=!0):!this.shouldWaitForSyncedDocument(j,k)&&(c.track({type:2,doc:k}),n=!0,(h&&this.docComparator(k,h)>0||i&&0>this.docComparator(k,i))&&(g=!0)):!j&&k?(c.track({type:0,doc:k}),n=!0):j&&!k&&(c.track({type:1,doc:j}),n=!0,(h||i)&&(g=!0)),n&&(k?(f=f.add(k),e=m?e.add(a):e.delete(a)):(f=f.delete(a),e=e.delete(a)))}),null!==this.query.limit)for(;f.size>this.query.limit;){let a="F"===this.query.limitType?f.last():f.first();f=f.delete(a.key),e=e.delete(a.key),c.track({type:1,doc:a})}return{documentSet:f,changeSet:c,needsRefill:g,mutatedKeys:e}}shouldWaitForSyncedDocument(a,b){return a.hasLocalMutations&&b.hasCommittedMutations&&!b.hasLocalMutations}applyChanges(a,b,c,d){let e=this.documentSet;this.documentSet=a.documentSet,this.mutatedKeys=a.mutatedKeys;let f=a.changeSet.getChanges();f.sort((a,b)=>yl(a.type,b.type)||this.docComparator(a.doc,b.doc)),this.applyTargetChange(c),d=null!=d&&d;let g=b&&!d?this.updateLimboDocuments():[],h=+!!(0===this.limboDocuments.size&&this.current&&!d),i=h!==this.syncState;return(this.syncState=h,0!==f.length||i)?{snapshot:new x$(this.query,a.documentSet,e,f,a.mutatedKeys,0===h,i,!1,!!c&&c.resumeToken.approximateByteSize()>0),limboChanges:g}:{limboChanges:g}}applyOnlineStateChange(a){return this.current&&"Offline"===a?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new xZ,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(a){return!this._syncedDocuments.has(a)&&!!this.documentSet.has(a)&&!this.documentSet.get(a).hasLocalMutations}applyTargetChange(a){a&&(a.addedDocuments.forEach(a=>this._syncedDocuments=this._syncedDocuments.add(a)),a.modifiedDocuments.forEach(a=>{}),a.removedDocuments.forEach(a=>this._syncedDocuments=this._syncedDocuments.delete(a)),this.current=a.current)}updateLimboDocuments(){if(!this.current)return[];let a=this.limboDocuments;this.limboDocuments=ql(),this.documentSet.forEach(a=>{this.shouldBeInLimbo(a.key)&&(this.limboDocuments=this.limboDocuments.add(a.key))});let b=[];return a.forEach(a=>{this.limboDocuments.has(a)||b.push(new yj(a))}),this.limboDocuments.forEach(c=>{a.has(c)||b.push(new yi(c))}),b}synchronizeWithPersistedState(a){this._syncedDocuments=a.remoteKeys,this.limboDocuments=ql();let b=this.computeDocChanges(a.documents);return this.applyChanges(b,!0)}computeInitialSnapshot(){return x$.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,0===this.syncState,this.hasCachedResults)}}function yl(a,b){let c=a=>{switch(a){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return k_(20277,{change:a})}};return c(a)-c(b)}let ym="SyncEngine";class yn{constructor(a,b,c){this.query=a,this.targetId=b,this.view=c}}class yo{constructor(a){this.key=a,this.receivedDocument=!1}}class yp{constructor(a,b,c,d,e,f){this.localStore=a,this.remoteStore=b,this.eventManager=c,this.sharedClientState=d,this.currentUser=e,this.maxConcurrentLimboResolutions=f,this.syncEngineListener={},this.queryViewsByQuery=new p8(a=>p$(a),pZ),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new nB(lu.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new uU,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=ui.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return!0===this._isPrimaryClient}}function yq(a,b,c,d,e,f,g){let h=new yp(a,b,c,d,e,f);return g&&(h._isPrimaryClient=!0),h}async function yr(a,b,c=!0){let d,e=y_(a),f=e.queryViewsByQuery.get(b);return f?(e.sharedClientState.addLocalQueryTarget(f.targetId),d=f.view.computeInitialSnapshot()):d=await yt(e,b,c,!0),d}async function ys(a,b){let c=y_(a);await yt(c,b,!0,!1)}async function yt(a,b,c,d){let e,f=await vU(a.localStore,pR(b)),g=f.targetId,h=a.sharedClientState.addLocalQueryTarget(g,c);return d&&(e=await yu(a,b,g,"current"===h,f.resumeToken)),a.isPrimaryClient&&c&&xq(a.remoteStore,f),e}async function yu(a,b,c,d,e){a.applyDocChanges=(b,c,d)=>yO(a,b,c,d);let f=await vX(a.localStore,b,!0),g=new yk(b,f.remoteKeys),h=g.computeDocChanges(f.documents),i=ri.createSynthesizedTargetChangeForCurrentChange(c,d&&"Offline"!==a.onlineState,e),j=g.applyChanges(h,a.isPrimaryClient,i);yK(a,c,j.limboChanges);let k=new yn(b,c,g);return a.queryViewsByQuery.set(b,k),a.queriesByTarget.has(c)?a.queriesByTarget.get(c).push(b):a.queriesByTarget.set(c,[b]),j.snapshot}async function yv(a,b,c){let d=k2(a),e=d.queryViewsByQuery.get(b),f=d.queriesByTarget.get(e.targetId);if(f.length>1){d.queriesByTarget.set(e.targetId,f.filter(a=>!pZ(a,b))),d.queryViewsByQuery.delete(b);return}d.isPrimaryClient?(d.sharedClientState.removeLocalQueryTarget(e.targetId),d.sharedClientState.isActiveQueryTarget(e.targetId)||await vW(d.localStore,e.targetId,!1).then(()=>{d.sharedClientState.clearQueryState(e.targetId),c&&xr(d.remoteStore,e.targetId),yI(d,e.targetId)}).catch(lZ)):(yI(d,e.targetId),await vW(d.localStore,e.targetId,!0))}async function yw(a,b){let c=k2(a),d=c.queryViewsByQuery.get(b),e=c.queriesByTarget.get(d.targetId);c.isPrimaryClient&&1===e.length&&(c.sharedClientState.removeLocalQueryTarget(d.targetId),xr(c.remoteStore,d.targetId))}async function yx(a,b,c){let d=y0(a);try{let a=await vI(d.localStore,b);d.sharedClientState.addPendingMutation(a.batchId),yG(d,a.batchId,c),await yN(d,a.changes),await xG(d.remoteStore)}catch(b){let a=xX(b,"Failed to persist write");c.reject(a)}}async function yy(a,b){let c=k2(a);try{let a=await vO(c.localStore,b);b.targetChanges.forEach((a,b)=>{let d=c.activeLimboResolutionsByTarget.get(b);d&&(k1(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.receivedDocument=!0:a.modifiedDocuments.size>0?k1(d.receivedDocument,14607):a.removedDocuments.size>0&&(k1(d.receivedDocument,42227),d.receivedDocument=!1))}),await yN(c,a,b)}catch(a){await lZ(a)}}function yz(a,b,c){let d=k2(a);if(d.isPrimaryClient&&0===c||!d.isPrimaryClient&&1===c){let a=[];d.queryViewsByQuery.forEach((c,d)=>{let e=d.view.applyOnlineStateChange(b);e.snapshot&&a.push(e.snapshot)}),x7(d.eventManager,b),a.length&&d.syncEngineListener.onWatchChange(a),d.onlineState=b,d.isPrimaryClient&&d.sharedClientState.setOnlineState(b)}}async function yA(a,b,c){let d=k2(a);d.sharedClientState.updateQueryState(b,"rejected",c);let e=d.activeLimboResolutionsByTarget.get(b),f=e&&e.key;if(f){let a=new nB(lu.comparator);a=a.insert(f,oX.newNoDocument(f,lH.min()));let c=ql().add(f),e=new rh(lH.min(),new Map,new nB(lj),a,c);await yy(d,e),d.activeLimboTargetsByKey=d.activeLimboTargetsByKey.remove(f),d.activeLimboResolutionsByTarget.delete(b),yM(d)}else await vW(d.localStore,b,!1).then(()=>yI(d,b,c)).catch(lZ)}async function yB(a,b){let c=k2(a),d=b.batch.batchId;try{let a=await vJ(c.localStore,b);yH(c,d,null),yE(c,d),c.sharedClientState.updateMutationState(d,"acknowledged"),await yN(c,a)}catch(a){await lZ(a)}}async function yC(a,b,c){let d=k2(a);try{let a=await vL(d.localStore,b);yH(d,b,c),yE(d,b),d.sharedClientState.updateMutationState(b,"rejected",c),await yN(d,a)}catch(a){await lZ(a)}}async function yD(a,b){let c=k2(a);xw(c.remoteStore)||kX(ym,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let a=await vM(c.localStore);if(a===n3)return void b.resolve();let d=c.pendingWritesCallbacks.get(a)||[];d.push(b),c.pendingWritesCallbacks.set(a,d)}catch(c){let a=xX(c,"Initialization of waitForPendingWrites() operation failed");b.reject(a)}}function yE(a,b){(a.pendingWritesCallbacks.get(b)||[]).forEach(a=>{a.resolve()}),a.pendingWritesCallbacks.delete(b)}function yF(a,b){a.pendingWritesCallbacks.forEach(a=>{a.forEach(a=>{a.reject(new k4(k3.CANCELLED,b))})}),a.pendingWritesCallbacks.clear()}function yG(a,b,c){let d=a.mutationUserCallbacks[a.currentUser.toKey()];d||(d=new nB(lj)),d=d.insert(b,c),a.mutationUserCallbacks[a.currentUser.toKey()]=d}function yH(a,b,c){let d=k2(a),e=d.mutationUserCallbacks[d.currentUser.toKey()];if(e){let a=e.get(b);a&&(c?a.reject(c):a.resolve(),e=e.remove(b)),d.mutationUserCallbacks[d.currentUser.toKey()]=e}}function yI(a,b,c=null){for(let d of(a.sharedClientState.removeLocalQueryTarget(b),a.queriesByTarget.get(b)))a.queryViewsByQuery.delete(d),c&&a.syncEngineListener.onWatchError(d,c);a.queriesByTarget.delete(b),a.isPrimaryClient&&a.limboDocumentRefs.removeReferencesForId(b).forEach(b=>{a.limboDocumentRefs.containsKey(b)||yJ(a,b)})}function yJ(a,b){a.enqueuedLimboResolutions.delete(b.path.canonicalString());let c=a.activeLimboTargetsByKey.get(b);null!==c&&(xr(a.remoteStore,c),a.activeLimboTargetsByKey=a.activeLimboTargetsByKey.remove(b),a.activeLimboResolutionsByTarget.delete(c),yM(a))}function yK(a,b,c){for(let d of c)d instanceof yi?(a.limboDocumentRefs.addReference(d.key,b),yL(a,d)):d instanceof yj?(kX(ym,"Document no longer in limbo: "+d.key),a.limboDocumentRefs.removeReference(d.key,b),a.limboDocumentRefs.containsKey(d.key)||yJ(a,d.key)):k_(19791,{limboChange:d})}function yL(a,b){let c=b.key,d=c.path.canonicalString();a.activeLimboTargetsByKey.get(c)||a.enqueuedLimboResolutions.has(d)||(kX(ym,"New document in limbo: "+c),a.enqueuedLimboResolutions.add(d),yM(a))}function yM(a){for(;a.enqueuedLimboResolutions.size>0&&a.activeLimboTargetsByKey.size<a.maxConcurrentLimboResolutions;){let b=a.enqueuedLimboResolutions.values().next().value;a.enqueuedLimboResolutions.delete(b);let c=new lu(lr.fromString(b)),d=a.limboTargetIdGenerator.next();a.activeLimboResolutionsByTarget.set(d,new yo(c)),a.activeLimboTargetsByKey=a.activeLimboTargetsByKey.insert(c,d),xq(a.remoteStore,new sF(pR(pK(c.path)),d,"TargetPurposeLimboResolution",mh.INVALID))}}async function yN(a,b,c){let d=k2(a),e=[],f=[],g=[];d.queryViewsByQuery.isEmpty()||(d.queryViewsByQuery.forEach((a,h)=>{g.push(d.applyDocChanges(h,b,c).then(a=>{var b;if((a||c)&&d.isPrimaryClient){let e=a?!a.fromCache:null==(b=null==c?void 0:c.targetChanges.get(h.targetId))?void 0:b.current;d.sharedClientState.updateQueryState(h.targetId,e?"current":"not-current")}if(a){e.push(a);let b=yd.fromSnapshot(h.targetId,a);f.push(b)}}))}),await Promise.all(g),d.syncEngineListener.onWatchChange(e),await vR(d.localStore,f))}async function yO(a,b,c,d){let e=b.view.computeDocChanges(c);e.needsRefill&&(e=await vX(a.localStore,b.query,!1).then(({documents:a})=>b.view.computeDocChanges(a,e)));let f=d&&d.targetChanges.get(b.targetId),g=d&&null!=d.targetMismatches.get(b.targetId),h=b.view.applyChanges(e,a.isPrimaryClient,f,g);return yK(a,b.targetId,h.limboChanges),h.snapshot}async function yP(a,b){let c=k2(a);if(!c.currentUser.isEqual(b)){kX(ym,"User change. New user:",b.toKey());let a=await vH(c.localStore,b);c.currentUser=b,yF(c,"'waitForPendingWrites' promise is rejected due to a user change."),c.sharedClientState.handleUserChange(b,a.removedBatchIds,a.addedBatchIds),await yN(c,a.affectedDocuments)}}function yQ(a,b){let c=k2(a),d=c.activeLimboResolutionsByTarget.get(b);if(d&&d.receivedDocument)return ql().add(d.key);{let a=ql(),d=c.queriesByTarget.get(b);if(!d)return a;for(let b of d){let d=c.queryViewsByQuery.get(b);a=a.unionWith(d.view.syncedDocuments)}return a}}async function yR(a,b){let c=k2(a),d=await vX(c.localStore,b.query,!0),e=b.view.synchronizeWithPersistedState(d);return c.isPrimaryClient&&yK(c,b.targetId,e.limboChanges),e}async function yS(a,b){let c=k2(a);return v1(c.localStore,b).then(a=>yN(c,a))}async function yT(a,b,c,d){let e=k2(a),f=await vZ(e.localStore,b);if(null===f)return void kX(ym,"Cannot apply mutation batch with id: "+b);"pending"===c?await xG(e.remoteStore):"acknowledged"===c||"rejected"===c?(yH(e,b,d||null),yE(e,b),v$(e.localStore,b)):k_(6720,"Unknown batchState",{batchState:c}),await yN(e,f)}async function yU(a,b){let c=k2(a);if(y_(c),y0(c),!0===b&&!0!==c._isPrimaryClient){let a=c.sharedClientState.getAllActiveQueryTargets(),b=await yW(c,a.toArray());for(let a of(c._isPrimaryClient=!0,await xS(c.remoteStore,!0),b))xq(c.remoteStore,a)}else if(!1===b&&!1!==c._isPrimaryClient){let a=[],b=Promise.resolve();c.queriesByTarget.forEach((d,e)=>{c.sharedClientState.isLocalQueryTarget(e)?a.push(e):b=b.then(()=>(yI(c,e),vW(c.localStore,e,!0))),xr(c.remoteStore,e)}),await b,await yW(c,a),yV(c),c._isPrimaryClient=!1,await xS(c.remoteStore,!1)}}function yV(a){let b=k2(a);b.activeLimboResolutionsByTarget.forEach((a,c)=>{xr(b.remoteStore,c)}),b.limboDocumentRefs.removeAllReferences(),b.activeLimboResolutionsByTarget=new Map,b.activeLimboTargetsByKey=new nB(lu.comparator)}async function yW(a,b,c){let d=k2(a),e=[],f=[];for(let a of b){let b,c=d.queriesByTarget.get(a);if(c&&0!==c.length)for(let a of(b=await vU(d.localStore,pR(c[0])),c)){let b=d.queryViewsByQuery.get(a),c=await yR(d,b);c.snapshot&&f.push(c.snapshot)}else{let c=await v0(d.localStore,a);b=await vU(d.localStore,c),await yu(d,yX(c),a,!1,b.resumeToken)}e.push(b)}return d.syncEngineListener.onWatchChange(f),e}function yX(a){return pJ(a.path,a.collectionGroup,a.orderBy,a.filters,a.limit,"F",a.startAt,a.endAt)}function yY(a){return v_(k2(a).localStore)}async function yZ(a,b,c,d){let e=k2(a);if(e._isPrimaryClient)return void kX(ym,"Ignoring unexpected query state notification.");let f=e.queriesByTarget.get(b);if(f&&f.length>0)switch(c){case"current":case"not-current":{let a=await v1(e.localStore,p5(f[0])),d=rh.createSynthesizedRemoteEventForCurrentChange(b,"current"===c,nM.EMPTY_BYTE_STRING);await yN(e,a,d);break}case"rejected":await vW(e.localStore,b,!0),yI(e,b,d);break;default:k_(64155,c)}}async function y$(a,b,c){let d=y_(a);if(d._isPrimaryClient){for(let a of b){if(d.queriesByTarget.has(a)&&d.sharedClientState.isActiveQueryTarget(a)){kX(ym,"Adding an already active target "+a);continue}let b=await v0(d.localStore,a),c=await vU(d.localStore,b);await yu(d,yX(b),c.targetId,!1,c.resumeToken),xq(d.remoteStore,c)}for(let a of c)d.queriesByTarget.has(a)&&await vW(d.localStore,a,!1).then(()=>{xr(d.remoteStore,a),yI(d,a)}).catch(lZ)}}function y_(a){let b=k2(a);return b.remoteStore.remoteSyncer.applyRemoteEvent=yy.bind(null,b),b.remoteStore.remoteSyncer.getRemoteKeysForTarget=yQ.bind(null,b),b.remoteStore.remoteSyncer.rejectListen=yA.bind(null,b),b.syncEngineListener.onWatchChange=x5.bind(null,b.eventManager),b.syncEngineListener.onWatchError=x6.bind(null,b.eventManager),b}function y0(a){let b=k2(a);return b.remoteStore.remoteSyncer.applySuccessfulWrite=yB.bind(null,b),b.remoteStore.remoteSyncer.rejectFailedWrite=yC.bind(null,b),b}function y1(a,b,c){let d=k2(a);y2(d,b,c).then(a=>{d.sharedClientState.notifyBundleLoaded(a)})}async function y2(a,b,c){try{let d=await b.getMetadata();if(await v5(a.localStore,d))return await b.close(),c._completeWith(yh(d)),Promise.resolve(new Set);c._updateProgress(yg(d));let e=new yf(d,b.serializer),f=await b.nextElement();for(;f;){let a=await e.addSizedElement(f);a&&c._updateProgress(a),f=await b.nextElement()}let g=await e.completeAndStoreAsync(a.localStore);return await yN(a,g.changedDocs,void 0),await v6(a.localStore,d),c._completeWith(g.progress),Promise.resolve(g.changedCollectionGroups)}catch(a){return kZ(ym,`Loading bundle failed with ${a}`),c._failWith(a),Promise.resolve(new Set)}}class y3{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(a){this.serializer=wV(a.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(a),this.persistence=this.createPersistence(a),await this.persistence.start(),this.localStore=this.createLocalStore(a),this.gcScheduler=this.createGarbageCollectionScheduler(a,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(a,this.localStore)}createGarbageCollectionScheduler(a,b){return null}createIndexBackfillerScheduler(a,b){return null}createLocalStore(a){return vG(this.persistence,new wf,a.initialUser,this.serializer)}createPersistence(a){return new u2(u4.factory,this.serializer)}createSharedClientState(a){return new wA}async terminate(){var a,b;null==(a=this.gcScheduler)||a.stop(),null==(b=this.indexBackfillerScheduler)||b.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}y3.provider={build:()=>new y3};class y4 extends y3{constructor(a){super(),this.cacheSizeBytes=a}createGarbageCollectionScheduler(a,b){return k1(this.persistence.referenceDelegate instanceof u5,46915),new ux(this.persistence.referenceDelegate.garbageCollector,a.asyncQueue,b)}createPersistence(a){let b=void 0!==this.cacheSizeBytes?uq.withCacheSize(this.cacheSizeBytes):uq.DEFAULT;return new u2(a=>u5.factory(a,b),this.serializer)}}class y5 extends y3{constructor(a,b,c){super(),this.onlineComponentProvider=a,this.cacheSizeBytes=b,this.forceOwnership=c,this.kind="persistent",this.synchronizeTabs=!1}async initialize(a){await super.initialize(a),await this.onlineComponentProvider.initialize(this,a),await y0(this.onlineComponentProvider.syncEngine),await xG(this.onlineComponentProvider.remoteStore),await this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(a){return vG(this.persistence,new wf,a.initialUser,this.serializer)}createGarbageCollectionScheduler(a,b){return new ux(this.persistence.referenceDelegate.garbageCollector,a.asyncQueue,b)}createIndexBackfillerScheduler(a,b){let c=new mg(b,this.persistence);return new mf(a.asyncQueue,c)}createPersistence(a){let b=vA(a.databaseInfo.databaseId,a.databaseInfo.persistenceKey),c=void 0!==this.cacheSizeBytes?uq.withCacheSize(this.cacheSizeBytes):uq.DEFAULT;return new vx(this.synchronizeTabs,b,a.clientId,c,a.asyncQueue,wT(),wU(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(a){return new wA}}class y6 extends y5{constructor(a,b){super(a,b,!1),this.onlineComponentProvider=a,this.cacheSizeBytes=b,this.synchronizeTabs=!0}async initialize(a){await super.initialize(a);let b=this.onlineComponentProvider.syncEngine;this.sharedClientState instanceof wy&&(this.sharedClientState.syncEngine={applyBatchState:yT.bind(null,b),applyTargetState:yZ.bind(null,b),applyActiveTargetsChange:y$.bind(null,b),getActiveClients:yY.bind(null,b),synchronizeWithChangedDocuments:yS.bind(null,b)},await this.sharedClientState.start()),await this.persistence.setPrimaryStateListener(async a=>{await yU(this.onlineComponentProvider.syncEngine,a),this.gcScheduler&&(a&&!this.gcScheduler.started?this.gcScheduler.start():a||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(a&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():a||this.indexBackfillerScheduler.stop())})}createSharedClientState(a){let b=wT();if(!wy.isAvailable(b))throw new k4(k3.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let c=vA(a.databaseInfo.databaseId,a.databaseInfo.persistenceKey);return new wy(b,a.asyncQueue,c,a.clientId,a.initialUser)}}class y7{async initialize(a,b){this.localStore||(this.localStore=a.localStore,this.sharedClientState=a.sharedClientState,this.datastore=this.createDatastore(b),this.remoteStore=this.createRemoteStore(b),this.eventManager=this.createEventManager(b),this.syncEngine=this.createSyncEngine(b,!a.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>yz(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=yP.bind(null,this.syncEngine),await xS(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(a){return x0()}createDatastore(a){let b=wV(a.databaseInfo.databaseId),c=wR(a.databaseInfo);return w7(a.authCredentials,a.appCheckCredentials,c,b)}createRemoteStore(a){return xk(this.localStore,this.datastore,a.asyncQueue,a=>yz(this.syncEngine,a,0),wS())}createSyncEngine(a,b){return yq(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,a.initialUser,a.maxConcurrentLimboResolutions,b)}async terminate(){var a,b;await xp(this.remoteStore),null==(a=this.datastore)||a.terminate(),null==(b=this.eventManager)||b.terminate()}}y7.provider={build:()=>new y7};let y8=10240;function y9(a,b=y8){let c=0;return{async read(){if(c<a.byteLength){let d={value:a.slice(c,c+b),done:!1};return c+=b,d}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}function za(a,b){if(!(a instanceof Uint8Array))throw new k4(k3.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${lz(a)}`);return y9(a,b)}class zb{constructor(a){this.observer=a,this.muted=!1}next(a){!this.muted&&this.observer.next&&this.scheduleEvent(this.observer.next,a)}error(a){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,a):kY("Uncaught Error in snapshot listener:",a.toString()))}mute(){this.muted=!0}scheduleEvent(a,b){setTimeout(()=>{this.muted||a(b)},0)}}class zc{constructor(a,b){this.payload=a,this.byteLength=b}isBundleMetadata(){return"metadata"in this.payload}}class zd{constructor(a,b){this.reader=a,this.serializer=b,this.metadata=new k5,this.buffer=new Uint8Array,this.textDecoder=lh(),this.nextElementImpl().then(a=>{a&&a.isBundleMetadata()?this.metadata.resolve(a.payload.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(null==a?void 0:a.payload)}`))},a=>this.metadata.reject(a))}close(){return this.reader.cancel()}async getMetadata(){return this.metadata.promise}async nextElement(){return await this.getMetadata(),this.nextElementImpl()}async nextElementImpl(){let a=await this.readLength();if(null===a)return null;let b=this.textDecoder.decode(a),c=Number(b);return isNaN(c)&&this.raiseError(`length string (${b}) is not valid number`),new zc(JSON.parse(await this.readJsonString(c)),a.length+c)}indexOfOpenBracket(){return this.buffer.findIndex(a=>123===a)}async readLength(){for(;0>this.indexOfOpenBracket()&&!await this.pullMoreDataToBuffer(););if(0===this.buffer.length)return null;let a=this.indexOfOpenBracket();a<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let b=this.buffer.slice(0,a);return this.buffer=this.buffer.slice(a),b}async readJsonString(a){for(;this.buffer.length<a;)await this.pullMoreDataToBuffer()&&this.raiseError("Reached the end of bundle when more is expected.");let b=this.textDecoder.decode(this.buffer.slice(0,a));return this.buffer=this.buffer.slice(a),b}raiseError(a){throw this.reader.cancel(),Error(`Invalid bundle format: ${a}`)}async pullMoreDataToBuffer(){let a=await this.reader.read();if(!a.done){let b=new Uint8Array(this.buffer.length+a.value.length);b.set(this.buffer),b.set(a.value,this.buffer.length),this.buffer=b}return a.done}}function ze(a,b){return new zd(a,b)}class zf{constructor(a,b){this.bundleData=a,this.serializer=b,this.cursor=0,this.elements=[];let c=this.nextElement();if(c&&c.isBundleMetadata())this.metadata=c;else throw Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(null==c?void 0:c.payload)}`);do null!==(c=this.nextElement())&&this.elements.push(c);while(null!==c)}getMetadata(){return this.metadata}getElements(){return this.elements}nextElement(){if(this.cursor===this.bundleData.length)return null;let a=this.readLength();return new zc(JSON.parse(this.readJsonString(a)),a)}readJsonString(a){if(this.cursor+a>this.bundleData.length)throw new k4(k3.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=a)}readLength(){let a=this.cursor,b=this.cursor;for(;b<this.bundleData.length;){if("{"===this.bundleData[b]){if(b===a)throw Error("First character is a bracket and not a number");return this.cursor=b,Number(this.bundleData.slice(a,b))}b++}throw Error("Reached the end of bundle when more is expected.")}}function zg(a,b){return new zf(a,b)}class zh{constructor(a){this.datastore=a,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(a){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new k4(k3.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let b=await w9(this.datastore,a);return b.forEach(a=>this.recordVersion(a)),b}set(a,b){this.write(b.toMutation(a,this.precondition(a))),this.writtenDocs.add(a.toString())}update(a,b){try{this.write(b.toMutation(a,this.preconditionForUpdate(a)))}catch(a){this.lastTransactionError=a}this.writtenDocs.add(a.toString())}delete(a){this.write(new q$(a,this.precondition(a))),this.writtenDocs.add(a.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let a=this.readVersions;this.mutations.forEach(b=>{a.delete(b.key.toString())}),a.forEach((a,b)=>{let c=lu.fromPath(b);this.mutations.push(new q1(c,this.precondition(c)))}),await w8(this.datastore,this.mutations),this.committed=!0}recordVersion(a){let b;if(a.isFoundDocument())b=a.version;else if(a.isNoDocument())b=lH.min();else throw k_(50498,{documentName:a.constructor.name});let c=this.readVersions.get(a.key.toString());if(c){if(!b.isEqual(c))throw new k4(k3.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(a.key.toString(),b)}precondition(a){let b=this.readVersions.get(a.toString());return this.writtenDocs.has(a.toString())||!b?qJ.none():b.isEqual(lH.min())?qJ.exists(!1):qJ.updateTime(b)}preconditionForUpdate(a){let b=this.readVersions.get(a.toString());if(this.writtenDocs.has(a.toString())||!b)return qJ.exists(!0);if(b.isEqual(lH.min()))throw new k4(k3.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return qJ.updateTime(b)}write(a){this.ensureCommitNotCalled(),this.mutations.push(a)}ensureCommitNotCalled(){}}class zi{constructor(a,b,c,d,e){this.asyncQueue=a,this.datastore=b,this.options=c,this.updateFunction=d,this.deferred=e,this.attemptsRemaining=c.maxAttempts,this.backoff=new w$(this.asyncQueue,"transaction_retry")}run(){this.attemptsRemaining-=1,this.runWithBackOff()}runWithBackOff(){this.backoff.backoffAndRun(async()=>{let a=new zh(this.datastore),b=this.tryRunUpdateFunction(a);b&&b.then(b=>{this.asyncQueue.enqueueAndForget(()=>a.commit().then(()=>{this.deferred.resolve(b)}).catch(a=>{this.handleTransactionError(a)}))}).catch(a=>{this.handleTransactionError(a)})})}tryRunUpdateFunction(a){try{let b=this.updateFunction(a);if(n4(b)||!b.catch||!b.then)return this.deferred.reject(Error("Transaction callback must return a Promise")),null;return b}catch(a){return this.deferred.reject(a),null}}handleTransactionError(a){this.attemptsRemaining>0&&this.isRetryableTransactionError(a)?(this.attemptsRemaining-=1,this.asyncQueue.enqueueAndForget(()=>(this.runWithBackOff(),Promise.resolve()))):this.deferred.reject(a)}isRetryableTransactionError(a){if("FirebaseError"===a.name){let b=a.code;return"aborted"===b||"failed-precondition"===b||"already-exists"===b||!q6(b)}return!1}}let zj="FirestoreClient",zk=100,zl=11,zm=20,zn=22;class zo{constructor(a,b,c,d,e){this.authCredentials=a,this.appCheckCredentials=b,this.asyncQueue=c,this.databaseInfo=d,this.user=kR.UNAUTHENTICATED,this.clientId=li.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=e,this.authCredentials.start(c,async a=>{kX(zj,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(c,a=>(kX(zj,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:zk}}setCredentialChangeListener(a){this.authCredentialListener=a}setAppCheckTokenChangeListener(a){this.appCheckCredentialListener=a}terminate(){this.asyncQueue.enterRestrictedMode();let a=new k5;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),a.resolve()}catch(c){let b=xX(c,"Failed to shutdown persistence");a.reject(b)}}),a.promise}}async function zp(a,b){a.asyncQueue.verifyOperationInProgress(),kX(zj,"Initializing OfflineComponentProvider");let c=a.configuration;await b.initialize(c);let d=c.initialUser;a.setCredentialChangeListener(async a=>{d.isEqual(a)||(await vH(b.localStore,a),d=a)}),b.persistence.setDatabaseDeletedListener(()=>{kZ("Terminating Firestore due to IndexedDb database deletion"),a.terminate().then(()=>{kX("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(a=>{kZ("Terminating Firestore due to IndexedDb database deletion failed",a)})}),a._offlineComponents=b}async function zq(a,b){a.asyncQueue.verifyOperationInProgress();let c=await zs(a);kX(zj,"Initializing OnlineComponentProvider"),await b.initialize(c,a.configuration),a.setCredentialChangeListener(a=>xR(b.remoteStore,a)),a.setAppCheckTokenChangeListener((a,c)=>xR(b.remoteStore,c)),a._onlineComponents=b}function zr(a){return"FirebaseError"===a.name?a.code===k3.FAILED_PRECONDITION||a.code===k3.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&a instanceof DOMException)||a.code===zn||a.code===zm||a.code===zl}async function zs(a){if(!a._offlineComponents)if(a._uninitializedComponentsProvider){kX(zj,"Using user provided OfflineComponentProvider");try{await zp(a,a._uninitializedComponentsProvider._offline)}catch(c){let b=c;if(!zr(b))throw b;kZ("Error using user provided cache. Falling back to memory cache: "+b),await zp(a,new y3)}}else kX(zj,"Using default OfflineComponentProvider"),await zp(a,new y4(void 0));return a._offlineComponents}async function zt(a){return a._onlineComponents||(a._uninitializedComponentsProvider?(kX(zj,"Using user provided OnlineComponentProvider"),await zq(a,a._uninitializedComponentsProvider._online)):(kX(zj,"Using default OnlineComponentProvider"),await zq(a,new y7))),a._onlineComponents}function zu(a){return zs(a).then(a=>a.persistence)}function zv(a){return zs(a).then(a=>a.localStore)}function zw(a){return zt(a).then(a=>a.remoteStore)}function zx(a){return zt(a).then(a=>a.syncEngine)}function zy(a){return zt(a).then(a=>a.datastore)}async function zz(a){let b=await zt(a),c=b.eventManager;return c.onListen=yr.bind(null,b.syncEngine),c.onUnlisten=yv.bind(null,b.syncEngine),c.onFirstRemoteStoreListen=ys.bind(null,b.syncEngine),c.onLastRemoteStoreUnlisten=yw.bind(null,b.syncEngine),c}function zA(a,b,c,d){let e=new zb(d),f=new yc(b,e,c);return a.asyncQueue.enqueueAndForget(async()=>x3(await zz(a),f)),()=>{e.mute(),a.asyncQueue.enqueueAndForget(async()=>x4(await zz(a),f))}}function zB(a,b,c){let d=new k5;return a.asyncQueue.enqueueAndForget(async()=>{try{let e=await zy(a);d.resolve(xa(e,b,c))}catch(a){d.reject(a)}}),d.promise}function zC(a,b){let c=new k5;return a.asyncQueue.enqueueAndForget(async()=>yx(await zx(a),b,c)),c.promise}async function zD(a,b,c){try{let d=await vT(a,b);d.isFoundDocument()?c.resolve(d):d.isNoDocument()?c.resolve(null):c.reject(new k4(k3.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){let a=xX(d,`Failed to get document '${b} from cache`);c.reject(a)}}function zE(a,b,c,d,e){let f=new zb({next:h=>{f.mute(),b.enqueueAndForget(()=>x4(a,g));let i=h.docs.has(c);!i&&h.fromCache?e.reject(new k4(k3.UNAVAILABLE,"Failed to get document because the client is offline.")):i&&h.fromCache&&d&&"server"===d.source?e.reject(new k4(k3.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e.resolve(h)},error:a=>e.reject(a)}),g=new yc(pK(c.path),f,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return x3(a,g)}async function zF(a,b,c){try{let d=await vX(a,b,!0),e=new yk(b,d.remoteKeys),f=e.computeDocChanges(d.documents),g=e.applyChanges(f,!1);c.resolve(g.snapshot)}catch(d){let a=xX(d,`Failed to execute query '${b} against cache`);c.reject(a)}}function zG(a,b,c,d,e){let f=new zb({next:c=>{f.mute(),b.enqueueAndForget(()=>x4(a,g)),c.fromCache&&"server"===d.source?e.reject(new k4(k3.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e.resolve(c)},error:a=>e.reject(a)}),g=new yc(c,f,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return x3(a,g)}function zH(a,b,c,d){let e=zJ(c,wV(b));a.asyncQueue.enqueueAndForget(async()=>{y1(await zx(a),e,d)})}function zI(a,b){return a.asyncQueue.enqueue(async()=>v7(await zv(a),b))}function zJ(a,b){let c;return ze(za(c="string"==typeof a?lg().encode(a):a),b)}function zK(a,b){return a.asyncQueue.enqueue(async()=>wa(await zv(a),b))}function zL(a,b){return a.timeoutSeconds===b.timeoutSeconds}function zM(a){let b={};return void 0!==a.timeoutSeconds&&(b.timeoutSeconds=a.timeoutSeconds),b}let zN="ComponentProvider",zO=new Map;function zP(a){let b=zO.get(a);b&&(kX(zN,"Removing Datastore"),zO.delete(a),b.terminate())}function zQ(a,b,c,d){return new n_(a,b,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,zM(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}let zR="firestore.googleapis.com",zS=!0,zT=5,zU=30,zV=!0;class zW{constructor(a){var b,c;if(void 0===a.host){if(void 0!==a.ssl)throw new k4(k3.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=zR,this.ssl=zS}else this.host=a.host,this.ssl=null!=(b=a.ssl)?b:zS;if(this.isUsingEmulator=void 0!==a.emulatorOptions,this.credentials=a.credentials,this.ignoreUndefinedProperties=!!a.ignoreUndefinedProperties,this.localCache=a.localCache,void 0===a.cacheSizeBytes)this.cacheSizeBytes=up;else if(a.cacheSizeBytes!==uo&&a.cacheSizeBytes<us)throw new k4(k3.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${us}`);else this.cacheSizeBytes=a.cacheSizeBytes;lw("experimentalForceLongPolling",a.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",a.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!a.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===a.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=zV:this.experimentalAutoDetectLongPolling=!!a.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zM(null!=(c=a.experimentalLongPollingOptions)?c:{}),zX(this.experimentalLongPollingOptions),this.useFetchStreams=!!a.useFetchStreams}isEqual(a){return this.host===a.host&&this.ssl===a.ssl&&this.credentials===a.credentials&&this.cacheSizeBytes===a.cacheSizeBytes&&this.experimentalForceLongPolling===a.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===a.experimentalAutoDetectLongPolling&&zL(this.experimentalLongPollingOptions,a.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===a.ignoreUndefinedProperties&&this.useFetchStreams===a.useFetchStreams}}function zX(a){if(void 0!==a.timeoutSeconds){if(isNaN(a.timeoutSeconds))throw new k4(k3.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<zT)throw new k4(k3.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is ${zT})`);if(a.timeoutSeconds>zU)throw new k4(k3.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is ${zU})`)}}class zY{constructor(a,b,c,d){this._authCredentials=a,this._appCheckCredentials=b,this._databaseId=c,this._app=d,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zW({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new k4(k3.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(a){if(this._settingsFrozen)throw new k4(k3.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zW(a),this._emulatorOptions=a.emulatorOptions||{},void 0!==a.credentials&&(this._authCredentials=le(a.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return zP(this),Promise.resolve()}}function zZ(a,b,c,d={}){var e;a=lB(a,zY);let f=fV(b),g=a._getSettings(),h=Object.assign(Object.assign({},g),{emulatorOptions:a._getEmulatorOptions()}),i=`${b}:${c}`;f&&(fW(`https://${i}`),f0("Firestore",!0)),g.host!==zR&&g.host!==i&&kZ("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let j=Object.assign(Object.assign({},g),{host:i,ssl:f,emulatorOptions:d});if(!gh(j,h)&&(a._setSettings(j),d.mockUserToken)){let b,c;if("string"==typeof d.mockUserToken)b=d.mockUserToken,c=kR.MOCK_USER;else{b=fX(d.mockUserToken,null==(e=a._app)?void 0:e.options.projectId);let f=d.mockUserToken.sub||d.mockUserToken.user_id;if(!f)throw new k4(k3.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new kR(f)}a._authCredentials=new k8(new k6(b,c))}}class z${constructor(a,b,c){this.converter=b,this._query=c,this.type="query",this.firestore=a}withConverter(a){return new z$(this.firestore,a,this._query)}}class z_{constructor(a,b,c){this.converter=b,this._key=c,this.type="document",this.firestore=a}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new z0(this.firestore,this.converter,this._key.path.popLast())}withConverter(a){return new z_(this.firestore,a,this._key)}toJSON(){return{type:z_._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(a,b,c){if(lD(b,z_._jsonSchema))return new z_(a,c||null,new lu(lr.fromString(b.referencePath)))}}z_._jsonSchemaVersion="firestore/documentReference/1.0",z_._jsonSchema={type:lC("string",z_._jsonSchemaVersion),referencePath:lC("string")};class z0 extends z${constructor(a,b,c){super(a,b,pK(c)),this._path=c,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let a=this._path.popLast();return a.isEmpty()?null:new z_(this.firestore,null,new lu(a))}withConverter(a){return new z0(this.firestore,a,this._path)}}let z1="AsyncQueue";class z2{constructor(a=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new w$(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=a}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(a){this.enqueue(a)}enqueueAndForgetEvenWhileRestricted(a){this.verifyNotFailed(),this.enqueueInternal(a)}enterRestrictedMode(a){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=a||!1)}enqueue(a){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let b=new k5;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(a().then(b.resolve,b.reject),b.promise)).then(()=>b.promise)}enqueueRetryable(a){this.enqueueAndForget(()=>(this.retryableOps.push(a),this.retryNextOp()))}async retryNextOp(){if(0!==this.retryableOps.length){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(a){if(l6(a))kX(z1,"Operation failed with retryable error: "+a);else throw a}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(a){let b=this.tail.then(()=>(this.operationInProgress=!0,a().catch(a=>{throw this.failure=a,this.operationInProgress=!1,kY("INTERNAL UNHANDLED ERROR: ",z3(a)),a}).then(a=>(this.operationInProgress=!1,a))));return this.tail=b,b}enqueueAfterDelay(a,b,c){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(a)>-1&&(b=0);let d=xW.createAndSchedule(this,a,b,c,a=>this.removeDelayedOperation(a));return this.delayedOperations.push(d),d}verifyNotFailed(){this.failure&&k_(47125,{messageOrStack:z3(this.failure)})}verifyOperationInProgress(){}async drain(){let a;do a=this.tail,await a;while(a!==this.tail)}containsDelayedOperation(a){for(let b of this.delayedOperations)if(b.timerId===a)return!0;return!1}runAllDelayedOperationsUntil(a){return this.drain().then(()=>{for(let b of(this.delayedOperations.sort((a,b)=>a.targetTimeMs-b.targetTimeMs),this.delayedOperations))if(b.skipDelay(),"all"!==a&&b.timerId===a)break;return this.drain()})}skipDelaysForTimerId(a){this.timerIdsToSkip.push(a)}removeDelayedOperation(a){let b=this.delayedOperations.indexOf(a);this.delayedOperations.splice(b,1)}}function z3(a){let b=a.message||"";return a.stack&&(b=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),b}class z4{constructor(){this._progressObserver={},this._taskCompletionResolver=new k5,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(a,b,c){this._progressObserver={next:a,error:b,complete:c}}catch(a){return this._taskCompletionResolver.promise.catch(a)}then(a,b){return this._taskCompletionResolver.promise.then(a,b)}_completeWith(a){this._updateProgress(a),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(a)}_failWith(a){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(a),this._taskCompletionResolver.reject(a)}_updateProgress(a){this._lastProgress=a,this._progressObserver.next&&this._progressObserver.next(a)}}class z5 extends zY{constructor(a,b,c,d){super(a,b,c,d),this.type="firestore",this._queue=new z2,this._persistenceKey=(null==d?void 0:d.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let a=this._firestoreClient.terminate();this._queue=new z2(a),this._firestoreClient=void 0,await a}}}function z6(a,b){let c="object"==typeof a?a:hg(),d="string"==typeof a?a:b||n0,e=g9(c,"firestore").getImmediate({identifier:d});if(!e._initialized){let a=fS("firestore");a&&zZ(e,...a)}return e}function z7(a){if(a._terminated)throw new k4(k3.FAILED_PRECONDITION,"The client has already been terminated.");return a._firestoreClient||z8(a),a._firestoreClient}function z8(a){var b,c,d;let e=a._freezeSettings(),f=zQ(a._databaseId,(null==(b=a._app)?void 0:b.options.appId)||"",a._persistenceKey,e);!a._componentsProvider&&(null==(c=e.localCache)?void 0:c._offlineComponentProvider)&&(null==(d=e.localCache)?void 0:d._onlineComponentProvider)&&(a._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),a._firestoreClient=new zo(a._authCredentials,a._appCheckCredentials,a._queue,f,a._componentsProvider&&z9(a._componentsProvider))}function z9(a){let b=null==a?void 0:a._online.build();return{_offline:null==a?void 0:a._offline.build(b),_online:b}}function Aa(a,b){let c=z7(a=lB(a,z5)),d=new z4;return zH(c,a._databaseId,b,d),d}function Ab(a,b){return zI(z7(a=lB(a,z5)),b).then(b=>b?new z$(a,null,b.query):null)}function Ac(a,b=!0){kT(he),g8(new gr("firestore",(a,{instanceIdentifier:c,options:d})=>{let e=a.getProvider("app").getImmediate(),f=new z5(new k9(a.getProvider("auth-internal")),new ld(e,a.getProvider("app-check-internal")),n2(e,c),e);return d=Object.assign({useFetchStreams:b},d),f._setSettings(d),f},"PUBLIC").setMultipleInstances(!0)),hj(kP,kQ,a),hj(kP,kQ,"esm2017")}class Ad{constructor(a,b,c){this.alias=a,this.aggregateType=b,this.fieldPath=c}}class Ae{constructor(a="count",b){this._internalFieldPath=b,this.type="AggregateField",this.aggregateType=a}}class Af{constructor(a,b,c){this._userDataWriter=b,this._data=c,this.type="AggregateQuerySnapshot",this.query=a}data(){return this._userDataWriter.convertObjectMap(this._data)}}class Ag{constructor(a){this._byteString=a}static fromBase64String(a){try{return new Ag(nM.fromBase64String(a))}catch(a){throw new k4(k3.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+a)}}static fromUint8Array(a){return new Ag(nM.fromUint8Array(a))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(a){return this._byteString.isEqual(a._byteString)}toJSON(){return{type:Ag._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(a){if(lD(a,Ag._jsonSchema))return Ag.fromBase64String(a.bytes)}}Ag._jsonSchemaVersion="firestore/bytes/1.0",Ag._jsonSchema={type:lC("string",Ag._jsonSchemaVersion),bytes:lC("string")};class Ah{constructor(...a){for(let b=0;b<a.length;++b)if(0===a[b].length)throw new k4(k3.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lt(a)}isEqual(a){return this._internalPath.isEqual(a._internalPath)}}class Ai{constructor(a){this._methodName=a}}class Aj{constructor(a,b){if(!isFinite(a)||a<-90||a>90)throw new k4(k3.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+a);if(!isFinite(b)||b<-180||b>180)throw new k4(k3.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+b);this._lat=a,this._long=b}get latitude(){return this._lat}get longitude(){return this._long}isEqual(a){return this._lat===a._lat&&this._long===a._long}_compareTo(a){return lj(this._lat,a._lat)||lj(this._long,a._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Aj._jsonSchemaVersion}}static fromJSON(a){if(lD(a,Aj._jsonSchema))return new Aj(a.latitude,a.longitude)}}Aj._jsonSchemaVersion="firestore/geoPoint/1.0",Aj._jsonSchema={type:lC("string",Aj._jsonSchemaVersion),latitude:lC("number"),longitude:lC("number")};class Ak{constructor(a){this._values=(a||[]).map(a=>a)}toArray(){return this._values.map(a=>a)}isEqual(a){return vC(this._values,a._values)}toJSON(){return{type:Ak._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(a){if(lD(a,Ak._jsonSchema)){if(Array.isArray(a.vectorValues)&&a.vectorValues.every(a=>"number"==typeof a))return new Ak(a.vectorValues);throw new k4(k3.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ak._jsonSchemaVersion="firestore/vectorValue/1.0",Ak._jsonSchema={type:lC("string",Ak._jsonSchemaVersion),vectorValues:lC("object")};let Al=/^__.*__$/;class Am{constructor(a,b,c){this.data=a,this.fieldMask=b,this.fieldTransforms=c}toMutation(a,b){return null!==this.fieldMask?new qU(a,this.data,this.fieldMask,b,this.fieldTransforms):new qR(a,this.data,b,this.fieldTransforms)}}class An{constructor(a,b,c){this.data=a,this.fieldMask=b,this.fieldTransforms=c}toMutation(a,b){return new qU(a,this.data,this.fieldMask,b,this.fieldTransforms)}}function Ao(a){switch(a){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw k_(40011,{dataSource:a})}}class Ap{constructor(a,b,c,d,e,f){this.settings=a,this.databaseId=b,this.serializer=c,this.ignoreUndefinedProperties=d,void 0===e&&this.validatePath(),this.fieldTransforms=e||[],this.fieldMask=f||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(a){return new Ap(Object.assign(Object.assign({},this.settings),a),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(a){var b;let c=null==(b=this.path)?void 0:b.child(a),d=this.contextWith({path:c,arrayElement:!1});return d.validatePathSegment(a),d}childContextForFieldPath(a){var b;let c=null==(b=this.path)?void 0:b.child(a),d=this.contextWith({path:c,arrayElement:!1});return d.validatePath(),d}childContextForArray(a){return this.contextWith({path:void 0,arrayElement:!0})}createError(a){return AN(a,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(a){return void 0!==this.fieldMask.find(b=>a.isPrefixOf(b))||void 0!==this.fieldTransforms.find(b=>a.isPrefixOf(b.field))}validatePath(){if(this.path)for(let a=0;a<this.path.length;a++)this.validatePathSegment(this.path.get(a))}validatePathSegment(a){if(0===a.length)throw this.createError("Document fields must not be empty");if(Ao(this.dataSource)&&Al.test(a))throw this.createError('Document fields cannot begin and end with "__"')}}class Aq{constructor(a,b,c){this.databaseId=a,this.ignoreUndefinedProperties=b,this.serializer=c||wV(a)}createContext(a,b,c,d=!1){return new Ap({dataSource:a,methodName:b,targetDoc:c,path:lt.emptyPath(),arrayElement:!1,hasConverter:d},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ar(a){let b=a._freezeSettings(),c=wV(a._databaseId);return new Aq(a._databaseId,!!b.ignoreUndefinedProperties,c)}function As(a,b,c,d,e,f={}){let g,h,i=a.createContext(f.merge||f.mergeFields?2:0,b,c,e);AJ("Data must be an object, but it was:",i,d);let j=AD(d,i);if(f.merge)g=new nJ(i.fieldMask),h=i.fieldTransforms;else if(f.mergeFields){let a=[];for(let d of f.mergeFields){let e=AK(b,d,c);if(!i.contains(e))throw new k4(k3.INVALID_ARGUMENT,`Field '${e}' is specified in your field mask but missing from your input data.`);AO(a,e)||a.push(e)}g=new nJ(a),h=i.fieldTransforms.filter(a=>g.covers(a.field))}else g=null,h=i.fieldTransforms;return new Am(new oV(j),g,h)}class At extends Ai{_toFieldTransform(a){if(2===a.dataSource)a.fieldMask.push(a.path);else if(1===a.dataSource)throw a.createError(`${this._methodName}() can only appear at the top level of your update data`);else throw a.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(a){return a instanceof At}}function Au(a,b,c){return new Ap({dataSource:3,targetDoc:b.settings.targetDoc,methodName:a._methodName,arrayElement:c},b.databaseId,b.serializer,b.ignoreUndefinedProperties)}class Av extends null{_toFieldTransform(a){return new qF(a.path,new qw)}isEqual(a){return a instanceof Av}}class Aw extends Ai{constructor(a,b){super(a),this._elements=b}_toFieldTransform(a){let b=Au(this,a,!0),c=new qx(this._elements.map(a=>AC(a,b)));return new qF(a.path,c)}isEqual(a){return a instanceof Aw&&gh(this._elements,a._elements)}}class Ax extends Ai{constructor(a,b){super(a),this._elements=b}_toFieldTransform(a){let b=Au(this,a,!0),c=new qz(this._elements.map(a=>AC(a,b)));return new qF(a.path,c)}isEqual(a){return a instanceof Ax&&gh(this._elements,a._elements)}}class Ay extends Ai{constructor(a,b){super(a),this._operand=b}_toFieldTransform(a){let b=new qB(a.serializer,qq(a.serializer,this._operand));return new qF(a.path,b)}isEqual(a){return a instanceof Ay&&this._operand===a._operand}}function Az(a,b,c,d){let e=a.createContext(1,b,c);AJ("Data must be an object, but it was:",e,d);let f=[],g=oV.empty();return ny(d,(a,d)=>{let h=AM(b,a,c);d=gq(d);let i=e.childContextForFieldPath(h);if(d instanceof At)f.push(h);else{let a=AC(d,i);null!=a&&(f.push(h),g.set(h,a))}}),new An(g,new nJ(f),e.fieldTransforms)}function AA(a,b,c,d,e,f){let g=a.createContext(1,b,c),h=[AK(b,d,c)],i=[e];if(f.length%2!=0)throw new k4(k3.INVALID_ARGUMENT,`Function ${b}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let a=0;a<f.length;a+=2)h.push(AK(b,f[a])),i.push(f[a+1]);let j=[],k=oV.empty();for(let a=h.length-1;a>=0;--a)if(!AO(j,h[a])){let b=h[a],c=i[a];c=gq(c);let d=g.childContextForFieldPath(b);if(c instanceof At)j.push(b);else{let a=AC(c,d);null!=a&&(j.push(b),k.set(b,a))}}return new An(k,new nJ(j),g.fieldTransforms)}function AB(a,b,c,d=!1){return AC(c,a.createContext(d?4:3,b))}function AC(a,b){if(AI(a=gq(a)))return AJ("Unsupported field value:",b,a),AD(a,b);if(a instanceof Ai)return AF(a,b),null;if(void 0===a&&b.ignoreUndefinedProperties)return null;if(b.path&&b.fieldMask.push(b.path),!(a instanceof Array))return AG(a,b);if(b.settings.arrayElement&&4!==b.dataSource)throw b.createError("Nested arrays are not supported");return AE(a,b)}function AD(a,b){let c={};return nA(a)?b.path&&b.path.length>0&&b.fieldMask.push(b.path):ny(a,(a,d)=>{let e=AC(d,b.childContextForField(a));null!=e&&(c[a]=e)}),{mapValue:{fields:c}}}function AE(a,b){let c=[],d=0;for(let e of a){let a=AC(e,b.childContextForArray(d));null==a&&(a={nullValue:"NULL_VALUE"}),c.push(a),d++}return{arrayValue:{values:c}}}function AF(a,b){if(!Ao(b.dataSource))throw b.createError(`${a._methodName}() can only be used with update() and set()`);if(!b.path)throw b.createError(`${a._methodName}() is not currently supported inside arrays`);let c=a._toFieldTransform(b);c&&b.fieldTransforms.push(c)}function AG(a,b){if(null===(a=gq(a)))return{nullValue:"NULL_VALUE"};if("number"==typeof a)return qq(b.serializer,a);if("boolean"==typeof a)return{booleanValue:a};if("string"==typeof a)return{stringValue:a};if(a instanceof Date){let c=lG.fromDate(a);return{timestampValue:rz(b.serializer,c)}}else if(a instanceof lG){let c=new lG(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:rz(b.serializer,c)}}else if(a instanceof Aj)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};else if(a instanceof Ag)return{bytesValue:rB(b.serializer,a._byteString)};else if(a instanceof z_){let c=b.databaseId,d=a.firestore._databaseId;if(!d.isEqual(c))throw b.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:rF(a.firestore._databaseId||b.databaseId,a._key.path)}}else if(a instanceof Ak)return AH(a,b);else throw b.createError(`Unsupported field value: ${lz(a)}`)}function AH(a,b){return{mapValue:{fields:{[n7]:{stringValue:oa},[ob]:{arrayValue:{values:a.toArray().map(a=>{if("number"!=typeof a)throw b.createError("VectorValues must only contain numeric values.");return qo(b.serializer,a)})}}}}}}function AI(a){return"object"==typeof a&&null!==a&&!(a instanceof Array)&&!(a instanceof Date)&&!(a instanceof lG)&&!(a instanceof Aj)&&!(a instanceof Ag)&&!(a instanceof z_)&&!(a instanceof Ai)&&!(a instanceof Ak)}function AJ(a,b,c){if(!AI(c)||!ly(c)){let d=lz(c);if("an object"===d)throw b.createError(a+" a custom object");throw b.createError(a+" "+d)}}function AK(a,b,c){if((b=gq(b))instanceof Ah)return b._internalPath;if("string"==typeof b)return AM(a,b);throw AN("Field path arguments must be of type string or ",a,!1,void 0,c)}let AL=RegExp("[~\\*/\\[\\]]");function AM(a,b,c){if(b.search(AL)>=0)throw AN(`Invalid field path (${b}). Paths must not contain '~', '*', '/', '[', or ']'`,a,!1,void 0,c);try{return new Ah(...b.split("."))._internalPath}catch(d){throw AN(`Invalid field path (${b}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,a,!1,void 0,c)}}function AN(a,b,c,d,e){let f=d&&!d.isEmpty(),g=void 0!==e,h=`Function ${b}() called with invalid data`;c&&(h+=" (via `toFirestore()`)"),h+=". ";let i="";return(f||g)&&(i+=" (found",f&&(i+=` in field ${d}`),g&&(i+=` in document ${e}`),i+=")"),new k4(k3.INVALID_ARGUMENT,h+a+i)}function AO(a,b){return a.some(a=>a.isEqual(b))}class AP{constructor(a,b,c,d,e){this._firestore=a,this._userDataWriter=b,this._key=c,this._document=d,this._converter=e}get id(){return this._key.path.lastSegment()}get ref(){return new z_(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value);{let a=new AQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(a)}}}get(a){if(this._document){let b=this._document.data.field(AR("DocumentSnapshot.get",a));if(null!==b)return this._userDataWriter.convertValue(b)}}}class AQ extends AP{data(){return super.data()}}function AR(a,b){return"string"==typeof b?AM(a,b):b instanceof Ah?b._internalPath:b._delegate._internalPath}function AS(a){if("L"===a.limitType&&0===a.explicitOrderBy.length)throw new k4(k3.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AT{}class AU extends AT{}class AV extends AU{constructor(a,b,c){super(),this._field=a,this._op=b,this._value=c,this.type="where"}static _create(a,b,c){return new AV(a,b,c)}_apply(a){let b=this._parse(a);return A7(a._query,b),new z$(a.firestore,a.converter,pU(a._query,b))}_parse(a){let b=Ar(a.firestore);return A0(a._query,"where",b,a.firestore._databaseId,this._field,this._op,this._value)}}class AW extends AT{constructor(a,b){super(),this.type=a,this._queryConstraints=b}static _create(a,b){return new AW(a,b)}_parse(a){let b=this._queryConstraints.map(b=>b._parse(a)).filter(a=>a.getFilters().length>0);return 1===b.length?b[0]:o8.create(b,this._getOperator())}_apply(a){let b=this._parse(a);return 0===b.getFilters().length?a:(A8(a._query,b),new z$(a.firestore,a.converter,pU(a._query,b)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class AX extends AU{constructor(a,b){super(),this._field=a,this._direction=b,this.type="orderBy"}static _create(a,b){return new AX(a,b)}_apply(a){let b=A1(a._query,this._field,this._direction);return new z$(a.firestore,a.converter,pV(a._query,b))}}class AY extends AU{constructor(a,b,c){super(),this.type=a,this._limit=b,this._limitType=c}static _create(a,b,c){return new AY(a,b,c)}_apply(a){return new z$(a.firestore,a.converter,pW(a._query,this._limit,this._limitType))}}class AZ extends AU{constructor(a,b,c){super(),this.type=a,this._docOrFields=b,this._inclusive=c}static _create(a,b,c){return new AZ(a,b,c)}_apply(a){let b=A_(a,this.type,this._docOrFields,this._inclusive);return new z$(a.firestore,a.converter,pX(a._query,b))}}class A$ extends AU{constructor(a,b,c){super(),this.type=a,this._docOrFields=b,this._inclusive=c}static _create(a,b,c){return new A$(a,b,c)}_apply(a){let b=A_(a,this.type,this._docOrFields,this._inclusive);return new z$(a.firestore,a.converter,pY(a._query,b))}}function A_(a,b,c,d){if(c[0]=gq(c[0]),c[0]instanceof AP)return A2(a._query,a.firestore._databaseId,b,c[0]._document,d);{let e=Ar(a.firestore);return A3(a._query,a.firestore._databaseId,e,b,c,d)}}function A0(a,b,c,d,e,f,g){let h;if(e.isKeyField())if("array-contains"===f||"array-contains-any"===f)throw new k4(k3.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);else if("in"===f||"not-in"===f){A5(g,f);let b=[];for(let c of g)b.push(A4(d,a,c));h={arrayValue:{values:b}}}else h=A4(d,a,g);else("in"===f||"not-in"===f||"array-contains-any"===f)&&A5(g,f),h=AB(c,b,g,"in"===f||"not-in"===f);return o7.create(e,f,h)}function A1(a,b,c){if(null!==a.startAt)throw new k4(k3.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==a.endAt)throw new k4(k3.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new o2(b,c)}function A2(a,b,c,d,e){if(!d)throw new k4(k3.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);let f=[];for(let c of pQ(a))if(c.field.isKeyField())f.push(oF(b,d.key));else{let a=d.data.field(c.field);if(nX(a))throw new k4(k3.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+c.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null!==a)f.push(a);else{let a=c.field.canonicalString();throw new k4(k3.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${a}' (used as the orderBy) does not exist.`)}}return new oZ(f,e)}function A3(a,b,c,d,e,f){let g=a.explicitOrderBy;if(e.length>g.length)throw new k4(k3.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let h=[];for(let f=0;f<e.length;f++){let i=e[f];if(g[f].field.isKeyField()){if("string"!=typeof i)throw new k4(k3.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof i}`);if(!pP(a)&&-1!==i.indexOf("/"))throw new k4(k3.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${i}' contains a slash.`);let c=a.path.child(lr.fromString(i));if(!lu.isDocumentKey(c))throw new k4(k3.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${c}' is not because it contains an odd number of segments.`);let e=new lu(c);h.push(oF(b,e))}else{let a=AB(c,d,i);h.push(a)}}return new oZ(h,f)}function A4(a,b,c){if("string"==typeof(c=gq(c))){if(""===c)throw new k4(k3.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pP(b)&&-1!==c.indexOf("/"))throw new k4(k3.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${c}' contains a '/' character.`);let d=b.path.child(lr.fromString(c));if(!lu.isDocumentKey(d))throw new k4(k3.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${d}' is not because it has an odd number of segments (${d.length}).`);return oF(a,new lu(d))}if(c instanceof z_)return oF(a,c._key);throw new k4(k3.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${lz(c)}.`)}function A5(a,b){if(!Array.isArray(a)||0===a.length)throw new k4(k3.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${b.toString()}' filters.`)}function A6(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function A7(a,b){let c=A9(a.filters,A6(b.op));if(null!==c)if(c===b.op)throw new k4(k3.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${b.op.toString()}' filter.`);else throw new k4(k3.INVALID_ARGUMENT,`Invalid query. You cannot use '${b.op.toString()}' filters with '${c.toString()}' filters.`)}function A8(a,b){let c=a;for(let a of b.getFlattenedFilters())A7(c,a),c=pU(c,a)}function A9(a,b){for(let c of a)for(let a of c.getFlattenedFilters())if(b.indexOf(a.op)>=0)return a.op;return null}class Ba{convertValue(a,b="none"){switch(od(a)){case 0:return null;case 1:return a.booleanValue;case 2:return nR(a.integerValue||a.doubleValue);case 3:return this.convertTimestamp(a.timestampValue);case 4:return this.convertServerTimestamp(a,b);case 5:return a.stringValue;case 6:return this.convertBytes(nS(a.bytesValue));case 7:return this.convertReference(a.referenceValue);case 8:return this.convertGeoPoint(a.geoPointValue);case 9:return this.convertArray(a.arrayValue,b);case 11:return this.convertObject(a.mapValue,b);case 10:return this.convertVectorValue(a.mapValue);default:throw k_(62114,{value:a})}}convertObject(a,b){return this.convertObjectMap(a.fields,b)}convertObjectMap(a,b="none"){let c={};return ny(a,(a,d)=>{c[a]=this.convertValue(d,b)}),c}convertVectorValue(a){var b,c,d;return new Ak(null==(d=null==(c=null==(b=a.fields)?void 0:b[ob].arrayValue)?void 0:c.values)?void 0:d.map(a=>nR(a.doubleValue)))}convertGeoPoint(a){return new Aj(nR(a.latitude),nR(a.longitude))}convertArray(a,b){return(a.values||[]).map(a=>this.convertValue(a,b))}convertServerTimestamp(a,b){switch(b){case"previous":let c=nZ(a);if(null==c)return null;return this.convertValue(c,b);case"estimate":return this.convertTimestamp(n$(a));default:return null}}convertTimestamp(a){let b=nQ(a);return new lG(b.seconds,b.nanos)}convertDocumentKey(a,b){let c=lr.fromString(a);k1(sE(c),9688,{name:a});let d=new n1(c.get(1),c.get(3)),e=new lu(c.popFirst(5));return d.isEqual(b)||kY(`Document ${e} contains a document reference within a different database (${d.projectId}/${d.database}) which is not supported. It will be treated as a reference in the current database (${b.projectId}/${b.database}) instead.`),e}}function Bb(a,b,c){let d;return a?c&&(c.merge||c.mergeFields)?a.toFirestore(b,c):a.toFirestore(b):b}class Bc extends Ba{constructor(a){super(),this.firestore=a}convertBytes(a){return new Ag(a)}convertReference(a){let b=this.convertDocumentKey(a,this.firestore._databaseId);return new z_(this.firestore,null,b)}}function Bd(a){return Be(a,["next","error","complete"])}function Be(a,b){if("object"!=typeof a||null===a)return!1;let c=a;for(let a of b)if(a in c&&"function"==typeof c[a])return!0;return!1}let Bf=lg();function Bg(a){let b=JSON.stringify(a),c=Bf.encode(b).byteLength;return`${c}${b}`}Bg({metadata:{id:"test-bundle",createTime:{seconds:0x5e0be105,nanos:6},version:1,totalDocuments:1,totalBytes:416}}),Bg({documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",readTime:{seconds:5,nanos:6},exists:!0}}),Bg({document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value"},bar:{integerValue:-42}}}}),Bg({documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",readTime:{seconds:5,nanos:6},exists:!0}}),Bg({document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value1"},bar:{integerValue:42},emptyArray:{arrayValue:{}},emptyMap:{mapValue:{}}}}}),Bg({documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/nodoc",readTime:{seconds:5,nanos:6},exists:!1}}),Bg({namedQuery:{name:"limitQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"DESCENDING"}],limit:{value:1}},limitType:"FIRST"},readTime:{seconds:0x5ec5a5f3,nanos:191164e3}}}),Bg({namedQuery:{name:"limitToLastQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"ASCENDING"}],limit:{value:1}},limitType:"LAST"},readTime:{seconds:0x5ec5a5f3,nanos:543063e3}}});let Bh=1;class Bi{constructor(a,b){this.firestore=a,this.bundleId=b,this.documents=new Map,this.namedQueries=new Map,this.latestReadTime=new lG(0,0),this.databaseId=a._databaseId,this.serializer=new rv(this.databaseId,!0),this.userDataReader=new Aq(this.databaseId,!0,this.serializer)}addBundleDocument(a,b){let c=this.documents.get(a.documentPath),d=null==c?void 0:c.metadata.queries,e=a.readTime,f=(null==c?void 0:c.metadata.readTime)?rA(c.metadata.readTime):null,g=!e&&null==f,h=void 0!==e&&(null==f||f<e);if((g||h)&&this.documents.set(a.documentPath,{document:this.toBundleDocument(a),metadata:{name:rI(this.serializer,a.documentKey),readTime:e?rz(this.serializer,e):void 0,exists:a.documentExists}}),e&&e>this.latestReadTime&&(this.latestReadTime=e),b){let c=this.documents.get(a.documentPath);c.metadata.queries=d||[],c.metadata.queries.push(b)}}addBundleQuery(a){if(this.namedQueries.has(a.name))throw Error(`Query name conflict: ${name} has already been added.`);let b=new lG(0,0);for(let c of a.docBundleDataArray)this.addBundleDocument(c,a.name),c.readTime&&c.readTime>b&&(b=c.readTime);let c=r6(this.serializer,pR(a.query)),d={parent:a.parent,structuredQuery:c.queryTarget.structuredQuery};this.namedQueries.set(a.name,{name:a.name,bundledQuery:d,readTime:rz(this.serializer,b)})}toBundleDocument(a){let b=this.userDataReader.createContext(4,"internal toBundledDocument"),c=AD(a.documentData,b);return{name:rI(this.serializer,a.documentKey),fields:c.mapValue.fields,updateTime:rz(this.serializer,a.versionTime),createTime:rz(this.serializer,a.createdTime)}}lengthPrefixedString(a){let b=JSON.stringify(a),c=Bf.encode(b).byteLength;return`${c}${b}`}build(){let a="";for(let b of this.namedQueries.values())a+=this.lengthPrefixedString({namedQuery:b});for(let b of this.documents.values()){let c=b.metadata;a+=this.lengthPrefixedString({documentMetadata:c});let d=b.document;d&&(a+=this.lengthPrefixedString({document:d}))}let b={id:this.bundleId,createTime:rz(this.serializer,this.latestReadTime),version:Bh,totalDocuments:this.documents.size,totalBytes:Bf.encode(a).length};return this.lengthPrefixedString({metadata:b})+a}}function Bj(a,b,c,d){let e=new Bi(a,li.newId());return e.addBundleDocument(Bl(d,c,b)),e.build()}function Bk(a,b,c,d,e,f,g){let h=[];for(let a=0;a<f.length;a++)h.push(Bl(e[a],g[a],f[a]));let i={name:c,query:b,parent:d,docBundleDataArray:h},j=new Bi(a,c);return j.addBundleQuery(i),j.build()}function Bl(a,b,c){return{documentData:b,documentKey:c.mutableCopy().key,documentPath:a,documentExists:!0,createdTime:c.createTime.toTimestamp(),readTime:c.readTime.toTimestamp(),versionTime:c.version.toTimestamp()}}class Bm{constructor(a,b){this.hasPendingWrites=a,this.fromCache=b}isEqual(a){return this.hasPendingWrites===a.hasPendingWrites&&this.fromCache===a.fromCache}}class Bn extends AP{constructor(a,b,c,d,e,f){super(a,b,c,d,f),this._firestore=a,this._firestoreImpl=a,this.metadata=e}exists(){return super.exists()}data(a={}){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value,a.serverTimestamps);{let b=new Bo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(b,a)}}}get(a,b={}){if(this._document){let c=this._document.data.field(AR("DocumentSnapshot.get",a));if(null!==c)return this._userDataWriter.convertValue(c,b.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new k4(k3.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let a=this._document,b={};if(b.type=Bn._jsonSchemaVersion,b.bundle="",b.bundleSource="DocumentSnapshot",b.bundleName=this._key.toString(),!a||!a.isValidDocument()||!a.isFoundDocument())return b;let c=this._userDataWriter.convertObjectMap(a.data.value.mapValue.fields,"previous");return b.bundle=Bj(this._firestore,a,c,this.ref.path),b}}Bn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Bn._jsonSchema={type:lC("string",Bn._jsonSchemaVersion),bundleSource:lC("string","DocumentSnapshot"),bundleName:lC("string"),bundle:lC("string")};class Bo extends Bn{data(a={}){return super.data(a)}}class Bp{constructor(a,b,c,d){this._firestore=a,this._userDataWriter=b,this._snapshot=d,this.metadata=new Bm(d.hasPendingWrites,d.fromCache),this.query=c}get docs(){let a=[];return this.forEach(b=>a.push(b)),a}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(a,b){this._snapshot.docs.forEach(c=>{a.call(b,new Bo(this._firestore,this._userDataWriter,c.key,c,new Bm(this._snapshot.mutatedKeys.has(c.key),this._snapshot.fromCache),this.query.converter))})}docChanges(a={}){let b=!!a.includeMetadataChanges;if(b&&this._snapshot.excludesMetadataChanges)throw new k4(k3.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===b||(this._cachedChanges=Bq(this,b),this._cachedChangesIncludeMetadataChanges=b),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new k4(k3.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let a={};a.type=Bp._jsonSchemaVersion,a.bundleSource="QuerySnapshot",a.bundleName=li.newId();let b=this._firestore._databaseId.database,c=this._firestore._databaseId.projectId,d=`projects/${c}/databases/${b}/documents`,e=[],f=[],g=[];return this.docs.forEach(a=>{null!==a._document&&(e.push(a._document),f.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),g.push(a.ref.path))}),a.bundle=Bk(this._firestore,this.query._query,a.bundleName,d,g,e,f),a}}function Bq(a,b){if(a._snapshot.oldDocs.isEmpty()){let b=0;return a._snapshot.docChanges.map(c=>{let d=new Bo(a._firestore,a._userDataWriter,c.doc.key,c.doc,new Bm(a._snapshot.mutatedKeys.has(c.doc.key),a._snapshot.fromCache),a.query.converter);return c.doc,{type:"added",doc:d,oldIndex:-1,newIndex:b++}})}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(a=>b||3!==a.type).map(b=>{let d=new Bo(a._firestore,a._userDataWriter,b.doc.key,b.doc,new Bm(a._snapshot.mutatedKeys.has(b.doc.key),a._snapshot.fromCache),a.query.converter),e=-1,f=-1;return 0!==b.type&&(e=c.indexOf(b.doc.key),c=c.delete(b.doc.key)),1!==b.type&&(f=(c=c.add(b.doc)).indexOf(b.doc.key)),{type:Br(b.type),doc:d,oldIndex:e,newIndex:f}})}}function Br(a){switch(a){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return k_(61501,{type:a})}}Bp._jsonSchemaVersion="firestore/querySnapshot/1.0",Bp._jsonSchema={type:lC("string",Bp._jsonSchemaVersion),bundleSource:lC("string","QuerySnapshot"),bundleName:lC("string"),bundle:lC("string")};class Bs extends Ba{constructor(a){super(),this.firestore=a}convertBytes(a){return new Ag(a)}convertReference(a){let b=this.convertDocumentKey(a,this.firestore._databaseId);return new z_(this.firestore,null,b)}}function Bt(a,...b){var c,d,e;let f,g,h;a=getModularInstance(a);let i={includeMetadataChanges:!1,source:"default"},j=0;"object"!=typeof b[0]||Bd(b[j])||(i=b[j++]);let k={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Bd(b[j])){let a=b[j];b[j]=null==(c=a.next)?void 0:c.bind(a),b[j+1]=null==(d=a.error)?void 0:d.bind(a),b[j+2]=null==(e=a.complete)?void 0:e.bind(a)}if(a instanceof z_)g=lB(a.firestore,z5),h=pK(a._key.path),f={next:c=>{b[j]&&b[j](Bu(g,a,c))},error:b[j+1],complete:b[j+2]};else{let c=lB(a,z$);g=lB(c.firestore,z5),h=c._query;let d=new Bs(g);f={next:a=>{b[j]&&b[j](new Bp(g,d,c,a))},error:b[j+1],complete:b[j+2]},AS(a._query)}return zA(z7(g),h,k,f)}function Bu(a,b,c){let d=c.docs.get(b._key),e=new Bs(a);return new Bn(a,e,b._key,d,new Bm(c.hasPendingWrites,c.fromCache),b.converter)}function Bv(a,b,c){return new Af(b,new Bs(a),c)}class Bw{constructor(a){this.forceOwnership=a,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(a){this._onlineComponentProvider=y7.provider,this._offlineComponentProvider={build:b=>new y5(b,null==a?void 0:a.cacheSizeBytes,this.forceOwnership)}}}function Bx(a){return new Bw(null==a?void 0:a.forceOwnership)}function By(a,b){if((a=gq(a)).firestore===b)return a;throw new k4(k3.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.")}class Bz{constructor(a,b){this._firestore=a,this._transaction=b,this._dataReader=Ar(a)}get(a){let b=By(a,this._firestore),c=new Bc(this._firestore);return this._transaction.lookup([b._key]).then(a=>{if(!a||1!==a.length)return k_(24041);let d=a[0];if(d.isFoundDocument())return new AP(this._firestore,c,d.key,d,b.converter);if(d.isNoDocument())return new AP(this._firestore,c,b._key,null,b.converter);throw k_(18433,{doc:d})})}set(a,b,c){let d=By(a,this._firestore),e=Bb(d.converter,b,c),f=As(this._dataReader,"Transaction.set",d._key,e,null!==d.converter,c);return this._transaction.set(d._key,f),this}update(a,b,c,...d){let e,f=By(a,this._firestore);return e="string"==typeof(b=gq(b))||b instanceof Ah?AA(this._dataReader,"Transaction.update",f._key,b,c,d):Az(this._dataReader,"Transaction.update",f._key,b),this._transaction.update(f._key,e),this}delete(a){let b=By(a,this._firestore);return this._transaction.delete(b._key),this}}function BA(a){try{return JSON.parse(a)}catch(a){throw new k4(k3.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==a?void 0:a.message))}}function BB(a,b){if("string"!=typeof a[b])throw new k4(k3.INVALID_ARGUMENT,"Missing string value for: "+b);return a[b]}new WeakMap;class BC{constructor(){this.existenceFilterMismatchCallbacksById=new Map}static get instance(){return BD||rb(BD=new BC),BD}notifyOnExistenceFilterMismatch(a){this.existenceFilterMismatchCallbacksById.forEach(b=>b(a))}onExistenceFilterMismatch(a){let b=Symbol(),c=this.existenceFilterMismatchCallbacksById;return c.set(b,a),()=>c.delete(b)}}let BD=null;Ac("node");let BE={projectId:"studio-296644579-18969",appId:"1:814805864825:web:f8488613ee3fdc818d5fa8",storageBucket:"studio-296644579-18969.appspot.com",apiKey:"AIzaSyBSVdKZiro4GcjbHlw0XcoaK-j6BD3DEUs",authDomain:"studio-296644579-18969.firebaseapp.com",messagingSenderId:"814805864825"},BF=hh().length?hg():hf(BE);kD(BF),z6(BF);let BG=process.env.STRIPE_SECRET_KEY;async function BH(a){let b;if(!BG)return new Response("Stripe desativado no ambiente de build",{status:200});let c=new fA(BG,{apiVersion:"2024-04-10"}),d=process.env.STRIPE_WEBHOOK_SECRET||"",e=(await (0,D.b)()).get("stripe-signature"),f=await a.arrayBuffer();try{if(!e)throw Error("Stripe signature is missing");if(!d)throw Error("Stripe webhook secret is not configured.");b=c.webhooks.constructEvent(Buffer.from(f),e,d)}catch(a){return console.error(` Webhook signature verification failed: ${a.message}`),new Response(`Webhook Error: ${a.message}`,{status:400})}if("checkout.session.completed"===b.type){let a=b.data.object,c=a.client_reference_id,d=a.line_items?.data[0].price?.id,e="string"==typeof a.customer?a.customer:a.customer?.id;if(!c||!d||!e){let a=[!c&&"userId",!d&&"priceId",!e&&"stripeCustomerId"].filter(Boolean).join(", ");return console.error(` Missing essential metadata in checkout session: ${a}`),new Response("Webhook Error: Missing essential metadata",{status:400})}try{hh().length||hf(BE);let a=h1(void 0,"southamerica-east1"),b=h3(a,"updateUserPlanOnPayment");await b({userId:c,priceId:d,stripeCustomerId:e}),console.log(` Successfully triggered Cloud Function to update plan for UserID: ${c}`)}catch(a){return console.error(" Error triggering updateUserPlan Cloud Function:",a),new Response("Webhook Error: Failed to trigger backend processing.",{status:500})}}else console.log(` Received unhandled event type: ${b.type}`);return new Response(JSON.stringify({received:!0}),{status:200})}BG||console.warn(" STRIPE_SECRET_KEY n\xe3o configurada, rota ignorada.");let BI="",BJ=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/stripe/webhook/route",pathname:"/api/stripe/webhook",filename:"route",bundlePath:"app/api/stripe/webhook/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/home/user/VitalLink-VF/src/app/api/stripe/webhook/route.ts",nextConfigOutput:BI,userland:m}),{workAsyncStorage:BK,workUnitAsyncStorage:BL,serverHooks:BM}=BJ;function BN(){return(0,p.patchFetch)({workAsyncStorage:BK,workUnitAsyncStorage:BL})}async function BO(a,b,c){var d;let e="/api/stripe/webhook/route";"/index"===e&&(e="/");let f=!1,g=await BJ.prepare(a,b,{srcPage:e,multiZoneDraftMode:f});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:h,params:i,nextConfig:j,isDraftMode:k,prerenderManifest:l,routerServerContext:m,isOnDemandRevalidate:n,revalidateOnlyGenerated:p,resolvedPathname:D}=g,E=(0,s.normalizeAppPath)(e),F=!!(l.dynamicRoutes[E]||l.routes[D]);if(F&&!k){let a=!!l.routes[D],b=l.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new B.NoFallbackError}let G=null;!F||BJ.isDev||k||(G="/index"===(G=D)?"/":G);let H=!0===BJ.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,r.getTracer)(),L=K.getActiveScopeSpan(),M={params:i,prerenderManifest:l,renderOpts:{experimental:{cacheComponents:!!j.experimental.cacheComponents,authInterrupts:!!j.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,q.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=j.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>BJ.onRequestError(a,b,d,m)},sharedContext:{buildId:h}},N=new t.NodeNextRequest(a),O=new t.NodeNextResponse(b),P=u.NextRequestAdapter.fromNodeNextRequest(N,(0,u.signalFromNodeResponse)(b));try{let d=async c=>BJ.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==v.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),f=async f=>{var g,h;let i=async({previousCacheEntry:g})=>{try{if(!(0,q.getRequestMeta)(a,"minimalMode")&&n&&p&&!g)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(f);a.fetchMetrics=M.renderOpts.fetchMetrics;let h=M.renderOpts.pendingWaitUntil;h&&c.waitUntil&&(c.waitUntil(h),h=void 0);let i=M.renderOpts.collectedTags;if(!F)return await (0,x.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,y.toNodeOutgoingHttpHeaders)(e.headers);i&&(b[A.NEXT_CACHE_TAGS_HEADER]=i),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=A.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=A.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:C.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==g?void 0:g.isStale)&&await BJ.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,w.c)({isRevalidate:I,isOnDemandRevalidate:n})},m),b}},r=await BJ.handleResponse({req:a,nextConfig:j,cacheKey:G,routeKind:o.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:l,isRoutePPREnabled:!1,isOnDemandRevalidate:n,revalidateOnlyGenerated:p,responseGenerator:i,waitUntil:c.waitUntil});if(!F)return null;if((null==r||null==(g=r.value)?void 0:g.kind)!==C.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==r||null==(h=r.value)?void 0:h.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,q.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",n?"REVALIDATED":r.isMiss?"MISS":r.isStale?"STALE":"HIT"),k&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let s=(0,y.fromNodeOutgoingHttpHeaders)(r.value.headers);return(0,q.getRequestMeta)(a,"minimalMode")&&F||s.delete(A.NEXT_CACHE_TAGS_HEADER),!r.cacheControl||b.getHeader("Cache-Control")||s.get("Cache-Control")||s.set("Cache-Control",(0,z.getCacheControlHeader)(r.cacheControl)),await (0,x.I)(N,O,new Response(r.value.body,{headers:s,status:r.value.status||200})),null};L?await f(L):await K.withPropagatedContext(a.headers,()=>K.trace(v.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:r.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},f))}catch(b){if(b instanceof B.NoFallbackError||await BJ.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,w.c)({isRevalidate:I,isOnDemandRevalidate:n})}),F)throw b;return await (0,x.I)(N,O,new Response(null,{status:500})),null}}},36544:(a,b,c)=>{"use strict";var d,e,f=a.exports=c(13884),g=c(38872);f.codegen=c(24775),f.fetch=c(93690),f.path=c(4781),f.fs=f.inquire("fs"),f.toArray=function(a){if(a){for(var b=Object.keys(a),c=Array(b.length),d=0;d<b.length;)c[d]=a[b[d++]];return c}return[]},f.toObject=function(a){for(var b={},c=0;c<a.length;){var d=a[c++],e=a[c++];void 0!==e&&(b[d]=e)}return b};var h=/\\/g,i=/"/g;f.isReserved=function(a){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(a)},f.safeProp=function(a){return!/^[$\w_]+$/.test(a)||f.isReserved(a)?'["'+a.replace(h,"\\\\").replace(i,'\\"')+'"]':"."+a},f.ucFirst=function(a){return a.charAt(0).toUpperCase()+a.substring(1)};var j=/_([a-z])/g;f.camelCase=function(a){return a.substring(0,1)+a.substring(1).replace(j,function(a,b){return b.toUpperCase()})},f.compareFieldsById=function(a,b){return a.id-b.id},f.decorateType=function(a,b){if(a.$type)return b&&a.$type.name!==b&&(f.decorateRoot.remove(a.$type),a.$type.name=b,f.decorateRoot.add(a.$type)),a.$type;d||(d=c(36660));var e=new d(b||a.name);return f.decorateRoot.add(e),e.ctor=a,Object.defineProperty(a,"$type",{value:e,enumerable:!1}),Object.defineProperty(a.prototype,"$type",{value:e,enumerable:!1}),e};var k=0;f.decorateEnum=function(a){if(a.$type)return a.$type;e||(e=c(60081));var b=new e("Enum"+k++,a);return f.decorateRoot.add(b),Object.defineProperty(a,"$type",{value:b,enumerable:!1}),b},f.setProperty=function(a,b,c,d){function e(a,b,c){var f=b.shift();if("__proto__"===f||"prototype"===f)return a;if(b.length>0)a[f]=e(a[f]||{},b,c);else{var g=a[f];if(g&&d)return a;g&&(c=[].concat(g).concat(c)),a[f]=c}return a}if("object"!=typeof a)throw TypeError("dst must be an object");if(!b)throw TypeError("path must be specified");return e(a,b=b.split("."),c)},Object.defineProperty(f,"decorateRoot",{get:function(){return g.decorated||(g.decorated=new(c(92072)))}})},36660:(a,b,c)=>{"use strict";a.exports=s;var d=c(18677);((s.prototype=Object.create(d.prototype)).constructor=s).className="Type";var e=c(60081),f=c(10059),g=c(9758),h=c(80366),i=c(75965),j=c(4673),k=c(86723),l=c(78915),m=c(36544),n=c(35546),o=c(65526),p=c(43866),q=c(97594),r=c(38972);function s(a,b){d.call(this,a,b),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function t(a){return a._fieldsById=a._fieldsArray=a._oneofsArray=null,delete a.encode,delete a.decode,delete a.verify,a}Object.defineProperties(s.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var a=Object.keys(this.fields),b=0;b<a.length;++b){var c=this.fields[a[b]],d=c.id;if(this._fieldsById[d])throw Error("duplicate id "+d+" in "+this);this._fieldsById[d]=c}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=m.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=m.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=s.generateConstructor(this)())},set:function(a){var b=a.prototype;b instanceof j||((a.prototype=new j).constructor=a,m.merge(a.prototype,b)),a.$type=a.prototype.$type=this,m.merge(a,j,!0),this._ctor=a;for(var c=0;c<this.fieldsArray.length;++c)this._fieldsArray[c].resolve();var d={};for(c=0;c<this.oneofsArray.length;++c)d[this._oneofsArray[c].resolve().name]={get:m.oneOfGetter(this._oneofsArray[c].oneof),set:m.oneOfSetter(this._oneofsArray[c].oneof)};c&&Object.defineProperties(a.prototype,d)}}}),s.generateConstructor=function(a){for(var b,c=m.codegen(["p"],a.name),d=0;d<a.fieldsArray.length;++d)(b=a._fieldsArray[d]).map?c("this%s={}",m.safeProp(b.name)):b.repeated&&c("this%s=[]",m.safeProp(b.name));return c("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},s.fromJSON=function(a,b){var c=new s(a,b.options);c.extensions=b.extensions,c.reserved=b.reserved;for(var j=Object.keys(b.fields),k=0;k<j.length;++k)c.add((void 0!==b.fields[j[k]].keyType?h.fromJSON:g.fromJSON)(j[k],b.fields[j[k]]));if(b.oneofs)for(j=Object.keys(b.oneofs),k=0;k<j.length;++k)c.add(f.fromJSON(j[k],b.oneofs[j[k]]));if(b.nested)for(j=Object.keys(b.nested),k=0;k<j.length;++k){var l=b.nested[j[k]];c.add((void 0!==l.id?g.fromJSON:void 0!==l.fields?s.fromJSON:void 0!==l.values?e.fromJSON:void 0!==l.methods?i.fromJSON:d.fromJSON)(j[k],l))}return b.extensions&&b.extensions.length&&(c.extensions=b.extensions),b.reserved&&b.reserved.length&&(c.reserved=b.reserved),b.group&&(c.group=!0),b.comment&&(c.comment=b.comment),b.edition&&(c._edition=b.edition),c._defaultEdition="proto3",c},s.prototype.toJSON=function(a){var b=d.prototype.toJSON.call(this,a),c=!!a&&!!a.keepComments;return m.toObject(["edition",this._editionToJSON(),"options",b&&b.options||void 0,"oneofs",d.arrayToJSON(this.oneofsArray,a),"fields",d.arrayToJSON(this.fieldsArray.filter(function(a){return!a.declaringField}),a)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",b&&b.nested||void 0,"comment",c?this.comment:void 0])},s.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;d.prototype.resolveAll.call(this);var a=this.oneofsArray;for(c=0;c<a.length;)a[c++].resolve();for(var b=this.fieldsArray,c=0;c<b.length;)b[c++].resolve();return this},s.prototype._resolveFeaturesRecursive=function(a){return this._needsRecursiveFeatureResolution&&(a=this._edition||a,d.prototype._resolveFeaturesRecursive.call(this,a),this.oneofsArray.forEach(b=>{b._resolveFeatures(a)}),this.fieldsArray.forEach(b=>{b._resolveFeatures(a)})),this},s.prototype.get=function(a){return this.fields[a]||this.oneofs&&this.oneofs[a]||this.nested&&this.nested[a]||null},s.prototype.add=function(a){if(this.get(a.name))throw Error("duplicate name '"+a.name+"' in "+this);if(a instanceof g&&void 0===a.extend){if(this._fieldsById?this._fieldsById[a.id]:this.fieldsById[a.id])throw Error("duplicate id "+a.id+" in "+this);if(this.isReservedId(a.id))throw Error("id "+a.id+" is reserved in "+this);if(this.isReservedName(a.name))throw Error("name '"+a.name+"' is reserved in "+this);return a.parent&&a.parent.remove(a),this.fields[a.name]=a,a.message=this,a.onAdd(this),t(this)}return a instanceof f?(this.oneofs||(this.oneofs={}),this.oneofs[a.name]=a,a.onAdd(this),t(this)):d.prototype.add.call(this,a)},s.prototype.remove=function(a){if(a instanceof g&&void 0===a.extend){if(!this.fields||this.fields[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.fields[a.name],a.parent=null,a.onRemove(this),t(this)}if(a instanceof f){if(!this.oneofs||this.oneofs[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.oneofs[a.name],a.parent=null,a.onRemove(this),t(this)}return d.prototype.remove.call(this,a)},s.prototype.isReservedId=function(a){return d.isReservedId(this.reserved,a)},s.prototype.isReservedName=function(a){return d.isReservedName(this.reserved,a)},s.prototype.create=function(a){return new this.ctor(a)},s.prototype.setup=function(){for(var a=this.fullName,b=[],c=0;c<this.fieldsArray.length;++c)b.push(this._fieldsArray[c].resolve().resolvedType);this.encode=n(this)({Writer:l,types:b,util:m}),this.decode=o(this)({Reader:k,types:b,util:m}),this.verify=p(this)({types:b,util:m}),this.fromObject=q.fromObject(this)({types:b,util:m}),this.toObject=q.toObject(this)({types:b,util:m});var d=r[a];if(d){var e=Object.create(this);e.fromObject=this.fromObject,this.fromObject=d.fromObject.bind(e),e.toObject=this.toObject,this.toObject=d.toObject.bind(e)}return this},s.prototype.encode=function(a,b){return this.setup().encode(a,b)},s.prototype.encodeDelimited=function(a,b){return this.encode(a,b&&b.len?b.fork():b).ldelim()},s.prototype.decode=function(a,b){return this.setup().decode(a,b)},s.prototype.decodeDelimited=function(a){return a instanceof k||(a=k.create(a)),this.decode(a,a.uint32())},s.prototype.verify=function(a){return this.setup().verify(a)},s.prototype.fromObject=function(a){return this.setup().fromObject(a)},s.prototype.toObject=function(a,b){return this.setup().toObject(a,b)},s.d=function(a){return function(b){m.decorateType(b,a)}}},37458:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.isDuration=b.durationToMs=b.msToDuration=void 0,b.msToDuration=function(a){return{seconds:a/1e3|0,nanos:a%1e3*1e6|0}},b.durationToMs=function(a){return 1e3*a.seconds+a.nanos/1e6|0},b.isDuration=function(a){return"number"==typeof a.seconds&&"number"==typeof a.nanos}},38575:(a,b,c)=>{"use strict";a.exports=j,j.className="ReflectionObject";let d=c(10059);var e,f=c(36544),g={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},h={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},i={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function j(a,b){if(!f.isString(a))throw TypeError("name must be a string");if(b&&!f.isObject(b))throw TypeError("options must be an object");this.options=b,this.parsedOptions=null,this.name=a,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(j.prototype,{root:{get:function(){for(var a=this;null!==a.parent;)a=a.parent;return a}},fullName:{get:function(){for(var a=[this.name],b=this.parent;b;)a.unshift(b.name),b=b.parent;return a.join(".")}}}),j.prototype.toJSON=function(){throw Error()},j.prototype.onAdd=function(a){this.parent&&this.parent!==a&&this.parent.remove(this),this.parent=a,this.resolved=!1;var b=a.root;b instanceof e&&b._handleAdd(this)},j.prototype.onRemove=function(a){var b=a.root;b instanceof e&&b._handleRemove(this),this.parent=null,this.resolved=!1},j.prototype.resolve=function(){return this.resolved||this.root instanceof e&&(this.resolved=!0),this},j.prototype._resolveFeaturesRecursive=function(a){return this._resolveFeatures(this._edition||a)},j.prototype._resolveFeatures=function(a){if(!this._featuresResolved){var b={};if(!a)throw Error("Unknown edition for "+this.fullName);var c=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(a));if(this._edition){if("proto2"===a)b=Object.assign({},h);else if("proto3"===a)b=Object.assign({},i);else if("2023"===a)b=Object.assign({},g);else throw Error("Unknown edition: "+a);this._features=Object.assign(b,c||{}),this._featuresResolved=!0;return}if(this.partOf instanceof d){var e=Object.assign({},this.partOf._features);this._features=Object.assign(e,c||{})}else if(this.declaringField);else if(this.parent){var f=Object.assign({},this.parent._features);this._features=Object.assign(f,c||{})}else throw Error("Unable to find a parent for "+this.fullName);this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}},j.prototype._inferLegacyProtoFeatures=function(){return{}},j.prototype.getOption=function(a){if(this.options)return this.options[a]},j.prototype.setOption=function(a,b,c){return this.options||(this.options={}),/^features\./.test(a)?f.setProperty(this.options,a,b,c):c&&void 0!==this.options[a]||(this.getOption(a)!==b&&(this.resolved=!1),this.options[a]=b),this},j.prototype.setParsedOption=function(a,b,c){this.parsedOptions||(this.parsedOptions=[]);var d=this.parsedOptions;if(c){var e=d.find(function(b){return Object.prototype.hasOwnProperty.call(b,a)});if(e){var g=e[a];f.setProperty(g,c,b)}else(e={})[a]=f.setProperty({},c,b),d.push(e)}else{var h={};h[a]=b,d.push(h)}return this},j.prototype.setOptions=function(a,b){if(a)for(var c=Object.keys(a),d=0;d<c.length;++d)this.setOption(c[d],a[c[d]],b);return this},j.prototype.toString=function(){var a=this.constructor.className,b=this.fullName;return b.length?a+" "+b:a},j.prototype._editionToJSON=function(){if(this._edition&&"proto3"!==this._edition)return this._edition},j._configure=function(a){e=a}},38872:a=>{"use strict";a.exports={}},38972:(a,b,c)=>{"use strict";var d=b,e=c(4673);d[".google.protobuf.Any"]={fromObject:function(a){if(a&&a["@type"]){var b=a["@type"].substring(a["@type"].lastIndexOf("/")+1),c=this.lookup(b);if(c){var d="."===a["@type"].charAt(0)?a["@type"].slice(1):a["@type"];return -1===d.indexOf("/")&&(d="/"+d),this.create({type_url:d,value:c.encode(c.fromObject(a)).finish()})}}return this.fromObject(a)},toObject:function(a,b){var c="type.googleapis.com/",d="",f="";if(b&&b.json&&a.type_url&&a.value){f=a.type_url.substring(a.type_url.lastIndexOf("/")+1),d=a.type_url.substring(0,a.type_url.lastIndexOf("/")+1);var g=this.lookup(f);g&&(a=g.decode(a.value))}if(!(a instanceof this.ctor)&&a instanceof e){var h=a.$type.toObject(a,b),i="."===a.$type.fullName[0]?a.$type.fullName.slice(1):a.$type.fullName;return""===d&&(d=c),f=d+i,h["@type"]=f,h}return this.toObject(a,b)}}},39101:(a,b,c)=>{"use strict";a.exports=e;var d=c(13884);function e(a,b,c){if("function"!=typeof a)throw TypeError("rpcImpl must be a function");d.EventEmitter.call(this),this.rpcImpl=a,this.requestDelimited=!!b,this.responseDelimited=!!c}(e.prototype=Object.create(d.EventEmitter.prototype)).constructor=e,e.prototype.rpcCall=function a(b,c,e,f,g){if(!f)throw TypeError("request must be specified");var h=this;if(!g)return d.asPromise(a,h,b,c,e,f);if(!h.rpcImpl)return void setTimeout(function(){g(Error("already ended"))},0);try{return h.rpcImpl(b,c[h.requestDelimited?"encodeDelimited":"encode"](f).finish(),function(a,c){if(a)return h.emit("error",a,b),g(a);if(null===c)return void h.end(!0);if(!(c instanceof e))try{c=e[h.responseDelimited?"decodeDelimited":"decode"](c)}catch(a){return h.emit("error",a,b),g(a)}return h.emit("data",c,b),g(null,c)})}catch(a){h.emit("error",a,b),setTimeout(function(){g(a)},0);return}},e.prototype.end=function(a){return this.rpcImpl&&(a||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},39244:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OutlierDetectionLoadBalancingConfig=b.BaseSubchannelWrapper=b.registerAdminService=b.FilterStackFactory=b.BaseFilter=b.PickResultType=b.QueuePicker=b.UnavailablePicker=b.ChildLoadBalancerHandler=b.subchannelAddressToString=b.validateLoadBalancingConfig=b.getFirstUsableConfig=b.registerLoadBalancerType=b.createChildChannelControlHelper=b.BackoffTimeout=b.durationToMs=b.uriToString=b.createResolver=b.registerResolver=b.log=b.trace=void 0;var d=c(35433);Object.defineProperty(b,"trace",{enumerable:!0,get:function(){return d.trace}}),Object.defineProperty(b,"log",{enumerable:!0,get:function(){return d.log}});var e=c(66528);Object.defineProperty(b,"registerResolver",{enumerable:!0,get:function(){return e.registerResolver}}),Object.defineProperty(b,"createResolver",{enumerable:!0,get:function(){return e.createResolver}});var f=c(23220);Object.defineProperty(b,"uriToString",{enumerable:!0,get:function(){return f.uriToString}});var g=c(37458);Object.defineProperty(b,"durationToMs",{enumerable:!0,get:function(){return g.durationToMs}});var h=c(30422);Object.defineProperty(b,"BackoffTimeout",{enumerable:!0,get:function(){return h.BackoffTimeout}});var i=c(4825);Object.defineProperty(b,"createChildChannelControlHelper",{enumerable:!0,get:function(){return i.createChildChannelControlHelper}}),Object.defineProperty(b,"registerLoadBalancerType",{enumerable:!0,get:function(){return i.registerLoadBalancerType}}),Object.defineProperty(b,"getFirstUsableConfig",{enumerable:!0,get:function(){return i.getFirstUsableConfig}}),Object.defineProperty(b,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return i.validateLoadBalancingConfig}});var j=c(74590);Object.defineProperty(b,"subchannelAddressToString",{enumerable:!0,get:function(){return j.subchannelAddressToString}});var k=c(33371);Object.defineProperty(b,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return k.ChildLoadBalancerHandler}});var l=c(14908);Object.defineProperty(b,"UnavailablePicker",{enumerable:!0,get:function(){return l.UnavailablePicker}}),Object.defineProperty(b,"QueuePicker",{enumerable:!0,get:function(){return l.QueuePicker}}),Object.defineProperty(b,"PickResultType",{enumerable:!0,get:function(){return l.PickResultType}});var m=c(77148);Object.defineProperty(b,"BaseFilter",{enumerable:!0,get:function(){return m.BaseFilter}});var n=c(91713);Object.defineProperty(b,"FilterStackFactory",{enumerable:!0,get:function(){return n.FilterStackFactory}});var o=c(58279);Object.defineProperty(b,"registerAdminService",{enumerable:!0,get:function(){return o.registerAdminService}});var p=c(87973);Object.defineProperty(b,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return p.BaseSubchannelWrapper}});var q=c(43890);Object.defineProperty(b,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return q.OutlierDetectionLoadBalancingConfig}})},39833:(a,b)=>{"use strict";var c=b;c.length=function(a){var b=a.length;if(!b)return 0;for(var c=0;--b%4>1&&"="===a.charAt(b);)++c;return Math.ceil(3*a.length)/4-c};for(var d=Array(64),e=Array(123),f=0;f<64;)e[d[f]=f<26?f+65:f<52?f+71:f<62?f-4:f-59|43]=f++;c.encode=function(a,b,c){for(var e,f=null,g=[],h=0,i=0;b<c;){var j=a[b++];switch(i){case 0:g[h++]=d[j>>2],e=(3&j)<<4,i=1;break;case 1:g[h++]=d[e|j>>4],e=(15&j)<<2,i=2;break;case 2:g[h++]=d[e|j>>6],g[h++]=d[63&j],i=0}h>8191&&((f||(f=[])).push(String.fromCharCode.apply(String,g)),h=0)}return(i&&(g[h++]=d[e],g[h++]=61,1===i&&(g[h++]=61)),f)?(h&&f.push(String.fromCharCode.apply(String,g.slice(0,h))),f.join("")):String.fromCharCode.apply(String,g.slice(0,h))};var g="invalid encoding";c.decode=function(a,b,c){for(var d,f=c,h=0,i=0;i<a.length;){var j=a.charCodeAt(i++);if(61===j&&h>1)break;if(void 0===(j=e[j]))throw Error(g);switch(h){case 0:d=j,h=1;break;case 1:b[c++]=d<<2|(48&j)>>4,d=j,h=2;break;case 2:b[c++]=(15&d)<<4|(60&j)>>2,d=j,h=3;break;case 3:b[c++]=(3&d)<<6|j,h=0}}if(1===h)throw Error(g);return c-f},c.test=function(a){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(a)}},40249:(a,b)=>{"use strict";var c;Object.defineProperty(b,"__esModule",{value:!0}),b.ConnectivityState=void 0,function(a){a[a.IDLE=0]="IDLE",a[a.CONNECTING=1]="CONNECTING",a[a.READY=2]="READY",a[a.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",a[a.SHUTDOWN=4]="SHUTDOWN"}(c||(b.ConnectivityState=c={}))},42226:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.loadPackageDefinition=b.makeClientConstructor=void 0;let d=c(92385),e={unary:d.Client.prototype.makeUnaryRequest,server_stream:d.Client.prototype.makeServerStreamRequest,client_stream:d.Client.prototype.makeClientStreamRequest,bidi:d.Client.prototype.makeBidiStreamRequest};function f(a){return["__proto__","prototype","constructor"].includes(a)}function g(a,b,c){c||(c={});class g extends d.Client{}return Object.keys(a).forEach(b=>{let c;if(f(b))return;let d=a[b];if("string"==typeof b&&"$"===b.charAt(0))throw Error("Method names cannot start with $");c=d.requestStream?d.responseStream?"bidi":"client_stream":d.responseStream?"server_stream":"unary";let i=d.requestSerialize,j=d.responseDeserialize,k=h(e[c],d.path,i,j);g.prototype[b]=k,Object.assign(g.prototype[b],d),d.originalName&&!f(d.originalName)&&(g.prototype[d.originalName]=g.prototype[b])}),g.service=a,g.serviceName=b,g}function h(a,b,c,d){return function(...e){return a.call(this,b,c,d,...e)}}function i(a){return"format"in a}b.makeClientConstructor=g,b.loadPackageDefinition=function(a){let b={};for(let c in a)if(Object.prototype.hasOwnProperty.call(a,c)){let d=a[c],e=c.split(".");if(e.some(a=>f(a)))continue;let h=e[e.length-1],j=b;for(let a of e.slice(0,-1))j[a]||(j[a]={}),j=j[a];i(d)?j[h]=d:j[h]=g(d,h,{})}return b}},42398:a=>{"use strict";a.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Api":{"fields":{"name":{"type":"string","id":1},"methods":{"rule":"repeated","type":"Method","id":2},"options":{"rule":"repeated","type":"Option","id":3},"version":{"type":"string","id":4},"sourceContext":{"type":"SourceContext","id":5},"mixins":{"rule":"repeated","type":"Mixin","id":6},"syntax":{"type":"Syntax","id":7}}},"Method":{"fields":{"name":{"type":"string","id":1},"requestTypeUrl":{"type":"string","id":2},"requestStreaming":{"type":"bool","id":3},"responseTypeUrl":{"type":"string","id":4},"responseStreaming":{"type":"bool","id":5},"options":{"rule":"repeated","type":"Option","id":6},"syntax":{"type":"Syntax","id":7}}},"Mixin":{"fields":{"name":{"type":"string","id":1},"root":{"type":"string","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}}}}}}}}')},43545:a=>{"use strict";a.exports=l;var b=/[\s{}=;:[\],'"()<>]/g,c=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,d=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,e=/^ *[*/]+ */,f=/^\s*\*?\/*/,g=/\n/g,h=/\s/,i=/\\(.?)/g,j={0:"\0",r:"\r",n:"\n",t:"	"};function k(a){return a.replace(i,function(a,b){switch(b){case"\\":case"":return b;default:return j[b]||""}})}function l(a,i){a=a.toString();var j=0,l=a.length,m=1,n=0,o={},p=[],q=null;function r(a){return Error("illegal "+a+" (line "+m+")")}function s(){var b="'"===q?d:c;b.lastIndex=j-1;var e=b.exec(a);if(!e)throw r("string");return j=b.lastIndex,y(q),q=null,k(e[1])}function t(b){return a.charAt(b)}function u(b,c,d){var h,j={type:a.charAt(b++),lineEmpty:!1,leading:d},k=b-(i?2:3);do if(--k<0||"\n"===(h=a.charAt(k))){j.lineEmpty=!0;break}while(" "===h||"	"===h);for(var l=a.substring(b,c).split(g),p=0;p<l.length;++p)l[p]=l[p].replace(i?f:e,"").trim();j.text=l.join("\n").trim(),o[m]=j,n=m}function v(b){var c=w(b),d=a.substring(b,c);return/^\s*\/\//.test(d)}function w(a){for(var b=a;b<l&&"\n"!==t(b);)b++;return b}function x(){if(p.length>0)return p.shift();if(q)return s();var c,d,e,f,g,k=0===j;do{if(j===l)return null;for(c=!1;h.test(e=t(j));)if("\n"===e&&(k=!0,++m),++j===l)return null;if("/"===t(j)){if(++j===l)throw r("comment");if("/"===t(j))if(i){if(f=j,g=!1,v(j-1)){g=!0;do if((j=w(j))===l||(j++,!k))break;while(v(j))}else j=Math.min(l,w(j)+1);g&&(u(f,j,k),k=!0),m++,c=!0}else{for(g="/"===t(f=j+1);"\n"!==t(++j);)if(j===l)return null;++j,g&&(u(f,j-1,k),k=!0),++m,c=!0}else{if("*"!==(e=t(j)))return"/";f=j+1,g=i||"*"===t(f);do{if("\n"===e&&++m,++j===l)throw r("comment");d=e,e=t(j)}while("*"!==d||"/"!==e);++j,g&&(u(f,j-2,k),k=!0),c=!0}}}while(c);var n=j;if(b.lastIndex=0,!b.test(t(n++)))for(;n<l&&!b.test(t(n));)++n;var o=a.substring(j,j=n);return('"'===o||"'"===o)&&(q=o),o}function y(a){p.push(a)}function z(){if(!p.length){var a=x();if(null===a)return null;y(a)}return p[0]}function A(a,b){var c=z();if(c===a)return x(),!0;if(!b)throw r("token '"+c+"', '"+a+"' expected");return!1}function B(a){var b,c=null;return void 0===a?(b=o[m-1],delete o[m-1],b&&(i||"*"===b.type||b.lineEmpty)&&(c=b.leading?b.text:null)):(n<a&&z(),b=o[a],delete o[a],b&&!b.lineEmpty&&(i||"/"===b.type)&&(c=b.leading?null:b.text)),c}return Object.defineProperty({next:x,peek:z,push:y,skip:A,cmnt:B},"line",{get:function(){return m}})}l.unescape=k},43558:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ServerCredentials=void 0;let d=c(84549);class e{static createInsecure(){return new f}static createSsl(a,b,c=!1){if(null!==a&&!Buffer.isBuffer(a))throw TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(b))throw TypeError("keyCertPairs must be an array");if("boolean"!=typeof c)throw TypeError("checkClientCertificate must be a boolean");let e=[],f=[];for(let a=0;a<b.length;a++){let c=b[a];if(null===c||"object"!=typeof c)throw TypeError(`keyCertPair[${a}] must be an object`);if(!Buffer.isBuffer(c.private_key))throw TypeError(`keyCertPair[${a}].private_key must be a Buffer`);if(!Buffer.isBuffer(c.cert_chain))throw TypeError(`keyCertPair[${a}].cert_chain must be a Buffer`);e.push(c.cert_chain),f.push(c.private_key)}return new g({ca:a||(0,d.getDefaultRootsData)()||void 0,cert:e,key:f,requestCert:c,ciphers:d.CIPHER_SUITES})}}b.ServerCredentials=e;class f extends e{_isSecure(){return!1}_getSettings(){return null}}class g extends e{constructor(a){super(),this.options=a}_isSecure(){return!0}_getSettings(){return this.options}}},43866:(a,b,c)=>{"use strict";a.exports=i;var d=c(60081),e=c(36544);function f(a,b){return a.name+": "+b+(a.repeated&&"array"!==b?"[]":a.map&&"object"!==b?"{k:"+a.keyType+"}":"")+" expected"}function g(a,b,c,e){if(b.resolvedType)if(b.resolvedType instanceof d){a("switch(%s){",e)("default:")("return%j",f(b,"enum value"));for(var g=Object.keys(b.resolvedType.values),h=0;h<g.length;++h)a("case %i:",b.resolvedType.values[g[h]]);a("break")("}")}else a("{")("var e=types[%i].verify(%s);",c,e)("if(e)")("return%j+e",b.name+".")("}");else switch(b.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":a("if(!util.isInteger(%s))",e)("return%j",f(b,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":a("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",e,e,e,e)("return%j",f(b,"integer|Long"));break;case"float":case"double":a('if(typeof %s!=="number")',e)("return%j",f(b,"number"));break;case"bool":a('if(typeof %s!=="boolean")',e)("return%j",f(b,"boolean"));break;case"string":a("if(!util.isString(%s))",e)("return%j",f(b,"string"));break;case"bytes":a('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',e,e,e)("return%j",f(b,"buffer"))}return a}function h(a,b,c){switch(b.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":a("if(!util.key32Re.test(%s))",c)("return%j",f(b,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":a("if(!util.key64Re.test(%s))",c)("return%j",f(b,"integer|Long key"));break;case"bool":a("if(!util.key2Re.test(%s))",c)("return%j",f(b,"boolean key"))}return a}function i(a){var b=e.codegen(["m"],a.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),c=a.oneofsArray,d={};c.length&&b("var p={}");for(var i=0;i<a.fieldsArray.length;++i){var j=a._fieldsArray[i].resolve(),k="m"+e.safeProp(j.name);if(j.optional&&b("if(%s!=null&&m.hasOwnProperty(%j)){",k,j.name),j.map)b("if(!util.isObject(%s))",k)("return%j",f(j,"object"))("var k=Object.keys(%s)",k)("for(var i=0;i<k.length;++i){"),h(b,j,"k[i]"),g(b,j,i,k+"[k[i]]")("}");else if(j.repeated)b("if(!Array.isArray(%s))",k)("return%j",f(j,"array"))("for(var i=0;i<%s.length;++i){",k),g(b,j,i,k+"[i]")("}");else{if(j.partOf){var l=e.safeProp(j.partOf.name);1===d[j.partOf.name]&&b("if(p%s===1)",l)("return%j",j.partOf.name+": multiple values"),d[j.partOf.name]=1,b("p%s=1",l)}g(b,j,i,k)}j.optional&&b("}")}return b("return null")}},43890:(a,b,c)=>{"use strict";var d;Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.OutlierDetectionLoadBalancer=b.OutlierDetectionLoadBalancingConfig=void 0;let e=c(40249),f=c(77797),g=c(37458),h=c(39244),i=c(4825),j=c(33371),k=c(14908),l=c(74590),m=c(87973),n=c(35433),o="outlier_detection";function p(a){n.trace(f.LogVerbosity.DEBUG,o,a)}let q="outlier_detection",r=(null!=(d=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)?d:"true")==="true",s={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},t={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function u(a,b,c,d){if(b in a&&typeof a[b]!==c){let e=d?`${d}.${b}`:b;throw Error(`outlier detection config ${e} parse error: expected ${c}, got ${typeof a[b]}`)}}function v(a,b,c){let d=c?`${c}.${b}`:b;if(b in a){if(!(0,g.isDuration)(a[b]))throw Error(`outlier detection config ${d} parse error: expected Duration, got ${typeof a[b]}`);if(!(a[b].seconds>=0&&a[b].seconds<=315576e6&&a[b].nanos>=0&&a[b].nanos<=0x3b9ac9ff))throw Error(`outlier detection config ${d} parse error: values out of range for non-negative Duaration`)}}function w(a,b,c){let d=c?`${c}.${b}`:b;if(u(a,b,"number",c),b in a&&!(a[b]>=0&&a[b]<=100))throw Error(`outlier detection config ${d} parse error: value out of range for percentage (0-100)`)}class x{constructor(a,b,c,d,e,f,g){if(this.childPolicy=g,g.length>0&&"pick_first"===g[0].getLoadBalancerName())throw Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=null!=a?a:1e4,this.baseEjectionTimeMs=null!=b?b:3e4,this.maxEjectionTimeMs=null!=c?c:3e5,this.maxEjectionPercent=null!=d?d:10,this.successRateEjection=e?Object.assign(Object.assign({},s),e):null,this.failurePercentageEjection=f?Object.assign(Object.assign({},t),f):null}getLoadBalancerName(){return q}toJsonObject(){return{interval:(0,g.msToDuration)(this.intervalMs),base_ejection_time:(0,g.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,g.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(a=>a.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(a){return new x(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,a)}static createFromJson(a){var b;if(v(a,"interval"),v(a,"base_ejection_time"),v(a,"max_ejection_time"),w(a,"max_ejection_percent"),"success_rate_ejection"in a){if("object"!=typeof a.success_rate_ejection)throw Error("outlier detection config success_rate_ejection must be an object");u(a.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),w(a.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),u(a.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),u(a.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in a){if("object"!=typeof a.failure_percentage_ejection)throw Error("outlier detection config failure_percentage_ejection must be an object");w(a.failure_percentage_ejection,"threshold","failure_percentage_ejection"),w(a.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),u(a.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),u(a.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new x(a.interval?(0,g.durationToMs)(a.interval):null,a.base_ejection_time?(0,g.durationToMs)(a.base_ejection_time):null,a.max_ejection_time?(0,g.durationToMs)(a.max_ejection_time):null,null!=(b=a.max_ejection_percent)?b:null,a.success_rate_ejection,a.failure_percentage_ejection,a.child_policy.map(i.validateLoadBalancingConfig))}}b.OutlierDetectionLoadBalancingConfig=x;class y extends m.BaseSubchannelWrapper{constructor(a,b){super(a),this.mapEntry=b,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=a.getConnectivityState(),a.addConnectivityStateListener((a,b,c,d)=>{if(this.childSubchannelState=c,!this.ejected)for(let a of this.stateListeners)a(this,b,c,d)})}getConnectivityState(){return this.ejected?e.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(a){this.stateListeners.push(a)}removeConnectivityStateListener(a){let b=this.stateListeners.indexOf(a);b>-1&&this.stateListeners.splice(b,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let a=this.mapEntry.subchannelWrappers.indexOf(this);a>=0&&this.mapEntry.subchannelWrappers.splice(a,1)}}eject(){for(let a of(this.ejected=!0,this.stateListeners))a(this,this.childSubchannelState,e.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){for(let a of(this.ejected=!1,this.stateListeners))a(this,e.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}function z(){return{success:0,failure:0}}class A{constructor(){this.activeBucket=z(),this.inactiveBucket=z()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=z()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class B{constructor(a,b){this.wrappedPicker=a,this.countCalls=b}pick(a){let b=this.wrappedPicker.pick(a);if(b.pickResultType!==k.PickResultType.COMPLETE)return b;{let a=b.subchannel,c=a.getMapEntry();if(!c)return Object.assign(Object.assign({},b),{subchannel:a.getWrappedSubchannel()});{let d=b.onCallEnded;return this.countCalls&&(d=a=>{var d;a===f.Status.OK?c.counter.addSuccess():c.counter.addFailure(),null==(d=b.onCallEnded)||d.call(b,a)}),Object.assign(Object.assign({},b),{subchannel:a.getWrappedSubchannel(),onCallEnded:d})}}}}class C{constructor(a){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new j.ChildLoadBalancerHandler((0,h.createChildChannelControlHelper)(a,{createSubchannel:(b,c)=>{let d=a.createSubchannel(b,c),e=this.addressMap.get((0,l.subchannelAddressToString)(b)),f=new y(d,e);return(null==e?void 0:e.currentEjectionTimestamp)!==null&&f.eject(),null==e||e.subchannelWrappers.push(f),f},updateState:(b,c)=>{b===e.ConnectivityState.READY?a.updateState(b,new B(c,this.isCountingEnabled())):a.updateState(b,c)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return null!==this.latestConfig&&(null!==this.latestConfig.getSuccessRateEjectionConfig()||null!==this.latestConfig.getFailurePercentageEjectionConfig())}getCurrentEjectionPercent(){let a=0;for(let b of this.addressMap.values())null!==b.currentEjectionTimestamp&&(a+=1);return 100*a/this.addressMap.size}runSuccessRateCheck(a){if(!this.latestConfig)return;let b=this.latestConfig.getSuccessRateEjectionConfig();if(!b)return;p("Running success rate check");let c=b.request_volume,d=0,e=[];for(let[a,b]of this.addressMap){let f=b.counter.getLastSuccesses(),g=b.counter.getLastFailures();p("Stats for "+a+": successes="+f+" failures="+g+" targetRequestVolume="+c),f+g>=c&&(d+=1,e.push(f/(f+g)))}if(p("Found "+d+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+e+"]"),d<b.minimum_hosts)return;let f=e.reduce((a,b)=>a+b)/e.length,g=0;for(let a of e){let b=a-f;g+=b*b}let h=Math.sqrt(g/e.length),i=f-h*(b.stdev_factor/1e3);for(let[d,e]of(p("stdev="+h+" ejectionThreshold="+i),this.addressMap.entries())){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let f=e.counter.getLastSuccesses(),g=e.counter.getLastFailures();if(f+g<c)continue;let h=f/(f+g);if(p("Checking candidate "+d+" successRate="+h),h<i){let c=100*Math.random();p("Candidate "+d+" randomNumber="+c+" enforcement_percentage="+b.enforcement_percentage),c<b.enforcement_percentage&&(p("Ejecting candidate "+d),this.eject(e,a))}}}runFailurePercentageCheck(a){if(!this.latestConfig)return;let b=this.latestConfig.getFailurePercentageEjectionConfig();if(!b)return;p("Running failure percentage check. threshold="+b.threshold+" request volume threshold="+b.request_volume);let c=0;for(let a of this.addressMap.values())a.counter.getLastSuccesses()+a.counter.getLastFailures()>=b.request_volume&&(c+=1);if(!(c<b.minimum_hosts))for(let[c,d]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let e=d.counter.getLastSuccesses(),f=d.counter.getLastFailures();if((p("Candidate successes="+e+" failures="+f),!(e+f<b.request_volume))&&100*f/(f+e)>b.threshold){let e=100*Math.random();p("Candidate "+c+" randomNumber="+e+" enforcement_percentage="+b.enforcement_percentage),e<b.enforcement_percentage&&(p("Ejecting candidate "+c),this.eject(d,a))}}}eject(a,b){for(let b of(a.currentEjectionTimestamp=new Date,a.ejectionTimeMultiplier+=1,a.subchannelWrappers))b.eject()}uneject(a){for(let b of(a.currentEjectionTimestamp=null,a.subchannelWrappers))b.uneject()}switchAllBuckets(){for(let a of this.addressMap.values())a.counter.switchBuckets()}startTimer(a){var b,c;this.ejectionTimer=setTimeout(()=>this.runChecks(),a),null==(c=(b=this.ejectionTimer).unref)||c.call(b)}runChecks(){let a=new Date;if(p("Ejection timer running"),this.switchAllBuckets(),this.latestConfig)for(let[b,c]of(this.timerStartTime=a,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(a),this.runFailurePercentageCheck(a),this.addressMap.entries()))if(null===c.currentEjectionTimestamp)c.ejectionTimeMultiplier>0&&(c.ejectionTimeMultiplier-=1);else{let a=this.latestConfig.getBaseEjectionTimeMs(),d=this.latestConfig.getMaxEjectionTimeMs(),e=new Date(c.currentEjectionTimestamp.getTime());e.setMilliseconds(e.getMilliseconds()+Math.min(a*c.ejectionTimeMultiplier,Math.max(a,d))),e<new Date&&(p("Unejecting "+b),this.uneject(c))}}updateAddressList(a,b,c){if(!(b instanceof x))return;let d=new Set;for(let b of a)d.add((0,l.subchannelAddressToString)(b));for(let a of d)this.addressMap.has(a)||(p("Adding map entry for "+a),this.addressMap.set(a,{counter:new A,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let a of this.addressMap.keys())d.has(a)||(p("Removing map entry for "+a),this.addressMap.delete(a));let e=(0,i.getFirstUsableConfig)(b.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(a,e,c),b.getSuccessRateEjectionConfig()||b.getFailurePercentageEjectionConfig())if(this.timerStartTime){p("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let a=b.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(a)}else p("Starting new timer"),this.timerStartTime=new Date,this.startTimer(b.getIntervalMs()),this.switchAllBuckets();else for(let a of(p("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer),this.addressMap.values()))this.uneject(a),a.ejectionTimeMultiplier=0;this.latestConfig=b}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return q}}b.OutlierDetectionLoadBalancer=C,b.setup=function(){r&&(0,h.registerLoadBalancerType)(q,C,x)}},44150:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getInterceptingCall=b.InterceptingCall=b.RequesterBuilder=b.ListenerBuilder=b.InterceptorConfigurationError=void 0;let d=c(12667),e=c(18404),f=c(77797),g=c(98313);class h extends Error{constructor(a){super(a),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,h)}}b.InterceptorConfigurationError=h;class i{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(a){return this.metadata=a,this}withOnReceiveMessage(a){return this.message=a,this}withOnReceiveStatus(a){return this.status=a,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}}b.ListenerBuilder=i;class j{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(a){return this.start=a,this}withSendMessage(a){return this.message=a,this}withHalfClose(a){return this.halfClose=a,this}withCancel(a){return this.cancel=a,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}}b.RequesterBuilder=j;let k={onReceiveMetadata:(a,b)=>{b(a)},onReceiveMessage:(a,b)=>{b(a)},onReceiveStatus:(a,b)=>{b(a)}},l={start:(a,b,c)=>{c(a,b)},sendMessage:(a,b)=>{b(a)},halfClose:a=>{a()},cancel:a=>{a()}};class m{constructor(a,b){var c,d,e,f;this.nextCall=a,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,b?this.requester={start:null!=(c=b.start)?c:l.start,sendMessage:null!=(d=b.sendMessage)?d:l.sendMessage,halfClose:null!=(e=b.halfClose)?e:l.halfClose,cancel:null!=(f=b.cancel)?f:l.cancel}:this.requester=l}cancelWithStatus(a,b){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(a,b)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(a,b){var c,d,f,g,h,i;let j={onReceiveMetadata:null!=(d=null==(c=null==b?void 0:b.onReceiveMetadata)?void 0:c.bind(b))?d:a=>{},onReceiveMessage:null!=(g=null==(f=null==b?void 0:b.onReceiveMessage)?void 0:f.bind(b))?g:a=>{},onReceiveStatus:null!=(i=null==(h=null==b?void 0:b.onReceiveStatus)?void 0:h.bind(b))?i:a=>{}};this.processingMetadata=!0,this.requester.start(a,j,(a,b)=>{var c,d,f;let g;if(this.processingMetadata=!1,(0,e.isInterceptingListener)(b))g=b;else{let a={onReceiveMetadata:null!=(c=b.onReceiveMetadata)?c:k.onReceiveMetadata,onReceiveMessage:null!=(d=b.onReceiveMessage)?d:k.onReceiveMessage,onReceiveStatus:null!=(f=b.onReceiveStatus)?f:k.onReceiveStatus};g=new e.InterceptingListenerImpl(a,j)}this.nextCall.start(a,g),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(a,b){this.processingMessage=!0,this.requester.sendMessage(b,c=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=a,this.pendingMessage=b):(this.nextCall.sendMessageWithContext(a,c),this.processPendingHalfClose())})}sendMessage(a){this.sendMessageWithContext({},a)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}}function n(a,b,c){var d,e;let f=null!=(d=c.deadline)?d:1/0,g=c.host,h=null!=(e=c.parent)?e:null,i=c.propagate_flags,j=c.credentials,k=a.createCall(b,f,g,h,i);return j&&k.setCredentials(j),k}b.InterceptingCall=m;class o{constructor(a,b){this.call=a,this.methodDefinition=b}cancelWithStatus(a,b){this.call.cancelWithStatus(a,b)}getPeer(){return this.call.getPeer()}sendMessageWithContext(a,b){let c;try{c=this.methodDefinition.requestSerialize(b)}catch(a){this.call.cancelWithStatus(f.Status.INTERNAL,`Request message serialization failure: ${(0,g.getErrorMessage)(a)}`);return}this.call.sendMessageWithContext(a,c)}sendMessage(a){this.sendMessageWithContext({},a)}start(a,b){let c=null;this.call.start(a,{onReceiveMetadata:a=>{var c;null==(c=null==b?void 0:b.onReceiveMetadata)||c.call(b,a)},onReceiveMessage:a=>{var e;let h;try{h=this.methodDefinition.responseDeserialize(a)}catch(a){c={code:f.Status.INTERNAL,details:`Response message parsing error: ${(0,g.getErrorMessage)(a)}`,metadata:new d.Metadata},this.call.cancelWithStatus(c.code,c.details);return}null==(e=null==b?void 0:b.onReceiveMessage)||e.call(b,h)},onReceiveStatus:a=>{var d,e;c?null==(d=null==b?void 0:b.onReceiveStatus)||d.call(b,c):null==(e=null==b?void 0:b.onReceiveStatus)||e.call(b,a)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class p extends o{constructor(a,b){super(a,b)}start(a,b){var c,d;let e=!1,f={onReceiveMetadata:null!=(d=null==(c=null==b?void 0:b.onReceiveMetadata)?void 0:c.bind(b))?d:a=>{},onReceiveMessage:a=>{var c;e=!0,null==(c=null==b?void 0:b.onReceiveMessage)||c.call(b,a)},onReceiveStatus:a=>{var c,d;e||null==(c=null==b?void 0:b.onReceiveMessage)||c.call(b,null),null==(d=null==b?void 0:b.onReceiveStatus)||d.call(b,a)}};super.start(a,f),this.call.startRead()}}class q extends o{}function r(a,b,c){let d=n(a,c.path,b);return c.responseStream?new q(d,c):new p(d,c)}b.getInterceptingCall=function(a,b,c,d){if(a.clientInterceptors.length>0&&a.clientInterceptorProviders.length>0)throw new h("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(a.callInterceptors.length>0&&a.callInterceptorProviders.length>0)throw new h("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let e=[];e=a.callInterceptors.length>0||a.callInterceptorProviders.length>0?[].concat(a.callInterceptors,a.callInterceptorProviders.map(a=>a(b))).filter(a=>a):[].concat(a.clientInterceptors,a.clientInterceptorProviders.map(a=>a(b))).filter(a=>a);let f=Object.assign({},c,{method_definition:b});return e.reduceRight((a,b)=>c=>b(c,a),a=>r(d,a,b))(f)}},44636:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.PickFirstLoadBalancer=b.shuffled=b.PickFirstLoadBalancingConfig=void 0;let d=c(4825),e=c(40249),f=c(14908),g=c(35433),h=c(77797),i="pick_first";function j(a){g.trace(h.LogVerbosity.DEBUG,i,a)}let k="pick_first",l=250;class m{constructor(a){this.shuffleAddressList=a}getLoadBalancerName(){return k}toJsonObject(){return{[k]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(a){if("shuffleAddressList"in a&&"boolean"!=typeof a.shuffleAddressList)throw Error("pick_first config field shuffleAddressList must be a boolean if provided");return new m(!0===a.shuffleAddressList)}}b.PickFirstLoadBalancingConfig=m;class n{constructor(a){this.subchannel=a}pick(a){return{pickResultType:f.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}}function o(a){let b=a.slice();for(let a=b.length-1;a>1;a--){let c=Math.floor(Math.random()*(a+1)),d=b[a];b[a]=b[c],b[c]=d}return b}b.shuffled=o;class p{constructor(a){this.channelControlHelper=a,this.children=[],this.currentState=e.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(a,b,c,d,e)=>{this.onSubchannelStateUpdate(a,b,c,e)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(a=>a.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(e.ConnectivityState.READY,new n(this.currentPick)):0===this.children.length?this.updateState(e.ConnectivityState.IDLE,new f.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(e.ConnectivityState.TRANSIENT_FAILURE,new f.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(e.ConnectivityState.CONNECTING,new f.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){for(let{subchannel:a}of(this.stickyTransientFailureMode=!0,this.children))a.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(null!==this.currentPick){let a=this.currentPick;this.currentPick=null,a.unref(),a.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(a.getChannelzRef())}}onSubchannelStateUpdate(a,b,c,d){var f;if(null==(f=this.currentPick)?void 0:f.realSubchannelEquals(a)){c!==e.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[b,f]of this.children.entries())if(a.realSubchannelEquals(f.subchannel)){c===e.ConnectivityState.READY&&this.pickSubchannel(f.subchannel),c===e.ConnectivityState.TRANSIENT_FAILURE&&(f.hasReportedTransientFailure=!0,d&&(this.lastError=d),this.maybeEnterStickyTransientFailureMode(),b===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(b+1)),f.subchannel.startConnecting();return}}startNextSubchannelConnecting(a){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[b,c]of this.children.entries())if(b>=a){let a=c.subchannel.getConnectivityState();if(a===e.ConnectivityState.IDLE||a===e.ConnectivityState.CONNECTING)return void this.startConnecting(b)}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(a){var b,c;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=a,this.children[a].subchannel.getConnectivityState()===e.ConnectivityState.IDLE&&(j("Start connecting to subchannel with address "+this.children[a].subchannel.getAddress()),process.nextTick(()=>{var b;null==(b=this.children[a])||b.subchannel.startConnecting()})),this.connectionDelayTimeout=null==(c=(b=setTimeout(()=>{this.startNextSubchannelConnecting(a+1)},l)).unref)?void 0:c.call(b)}pickSubchannel(a){this.currentPick&&a.realSubchannelEquals(this.currentPick)||(j("Pick subchannel with address "+a.getAddress()),this.stickyTransientFailureMode=!1,null!==this.currentPick&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=a,a.ref(),this.channelControlHelper.addChannelzChild(a.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(a,b){j(e.ConnectivityState[this.currentState]+" -> "+e.ConnectivityState[a]),this.currentState=a,this.channelControlHelper.updateState(a,b)}resetSubchannelList(){for(let a of this.children)this.currentPick&&a.subchannel.realSubchannelEquals(this.currentPick)||a.subchannel.removeConnectivityStateListener(this.subchannelStateListener),a.subchannel.unref(),this.channelControlHelper.removeChannelzChild(a.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(a){let b=a.map(a=>({subchannel:this.channelControlHelper.createSubchannel(a,{}),hasReportedTransientFailure:!1}));for(let{subchannel:a}of b)a.ref(),this.channelControlHelper.addChannelzChild(a.getChannelzRef());for(let{subchannel:a}of(this.resetSubchannelList(),this.children=b,this.children))if(a.addConnectivityStateListener(this.subchannelStateListener),a.getConnectivityState()===e.ConnectivityState.READY)return void this.pickSubchannel(a);for(let a of this.children)a.subchannel.getConnectivityState()===e.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(a,b){b instanceof m&&(b.getShuffleAddressList()&&(a=o(a)),this.latestAddressList=a,this.connectToAddressList(a))}exitIdle(){this.currentState===e.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return k}}b.PickFirstLoadBalancer=p,b.setup=function(){(0,d.registerLoadBalancerType)(k,p,m),(0,d.registerDefaultLoadBalancerType)(k)}},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},45069:(a,b)=>{"use strict";var c;Object.defineProperty(b,"__esModule",{value:!0}),b.CompressionAlgorithms=void 0,function(a){a[a.identity=0]="identity",a[a.deflate=1]="deflate",a[a.gzip=2]="gzip"}(c||(b.CompressionAlgorithms=c={}))},45366:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ClientDuplexStreamImpl=b.ClientWritableStreamImpl=b.ClientReadableStreamImpl=b.ClientUnaryCallImpl=b.callErrorFromStatus=void 0;let d=c(94735),e=c(27910),f=c(77797);b.callErrorFromStatus=function(a,b){let c=`${a.code} ${f.Status[a.code]}: ${a.details}`,d=Error(c),e=`${d.stack}
for call at
${b}`;return Object.assign(Error(c),a,{stack:e})};class g extends d.EventEmitter{constructor(){super()}cancel(){var a;null==(a=this.call)||a.cancelWithStatus(f.Status.CANCELLED,"Cancelled on client")}getPeer(){var a,b;return null!=(b=null==(a=this.call)?void 0:a.getPeer())?b:"unknown"}}b.ClientUnaryCallImpl=g;class h extends e.Readable{constructor(a){super({objectMode:!0}),this.deserialize=a}cancel(){var a;null==(a=this.call)||a.cancelWithStatus(f.Status.CANCELLED,"Cancelled on client")}getPeer(){var a,b;return null!=(b=null==(a=this.call)?void 0:a.getPeer())?b:"unknown"}_read(a){var b;null==(b=this.call)||b.startRead()}}b.ClientReadableStreamImpl=h;class i extends e.Writable{constructor(a){super({objectMode:!0}),this.serialize=a}cancel(){var a;null==(a=this.call)||a.cancelWithStatus(f.Status.CANCELLED,"Cancelled on client")}getPeer(){var a,b;return null!=(b=null==(a=this.call)?void 0:a.getPeer())?b:"unknown"}_write(a,b,c){var d;let e={callback:c},f=Number(b);Number.isNaN(f)||(e.flags=f),null==(d=this.call)||d.sendMessageWithContext(e,a)}_final(a){var b;null==(b=this.call)||b.halfClose(),a()}}b.ClientWritableStreamImpl=i;class j extends e.Duplex{constructor(a,b){super({objectMode:!0}),this.serialize=a,this.deserialize=b}cancel(){var a;null==(a=this.call)||a.cancelWithStatus(f.Status.CANCELLED,"Cancelled on client")}getPeer(){var a,b;return null!=(b=null==(a=this.call)?void 0:a.getPeer())?b:"unknown"}_read(a){var b;null==(b=this.call)||b.startRead()}_write(a,b,c){var d;let e={callback:c},f=Number(b);Number.isNaN(f)||(e.flags=f),null==(d=this.call)||d.sendMessageWithContext(e,a)}_final(a){var b;null==(b=this.call)||b.halfClose(),a()}}b.ClientDuplexStreamImpl=j},45992:(a,b,c)=>{"use strict";a.exports=f;var d=c(86723);(f.prototype=Object.create(d.prototype)).constructor=f;var e=c(13884);function f(a){d.call(this,a)}f._configure=function(){e.Buffer&&(f.prototype._slice=e.Buffer.prototype.slice)},f.prototype.string=function(){var a=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+a,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+a,this.len))},f._configure()},49752:(a,b,c)=>{"use strict";var d=b;function e(){d.util._configure(),d.Writer._configure(d.BufferWriter),d.Reader._configure(d.BufferReader)}d.build="minimal",d.Writer=c(78915),d.BufferWriter=c(68968),d.Reader=c(86723),d.BufferReader=c(45992),d.util=c(13884),d.rpc=c(78757),d.roots=c(38872),d.configure=e,e()},51543:a=>{"use strict";a.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},52109:(a,b,c)=>{"use strict";a.exports=y,y.filename=null,y.defaults={keepCase:!1};var d=c(43545),e=c(92072),f=c(36660),g=c(9758),h=c(80366),i=c(10059),j=c(60081),k=c(75965),l=c(24953),m=c(38575),n=c(56207),o=c(36544),p=/^[1-9][0-9]*$/,q=/^-?[1-9][0-9]*$/,r=/^0[x][0-9a-fA-F]+$/,s=/^-?0[x][0-9a-fA-F]+$/,t=/^0[0-7]+$/,u=/^-?0[0-7]+$/,v=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,w=/^[a-zA-Z_][a-zA-Z_0-9]*$/,x=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function y(a,b,c){b instanceof e||(c=b,b=new e),c||(c=y.defaults);var z,A,B,C,D=c.preferTrailingComment||!1,E=d(a,c.alternateCommentMode||!1),F=E.next,G=E.push,H=E.peek,I=E.skip,J=E.cmnt,K=!0,L="proto2",M=b,N=[],O={},P=c.keepCase?function(a){return a}:o.camelCase;function Q(){N.forEach(a=>{a._edition=L,Object.keys(O).forEach(b=>{void 0===a.getOption(b)&&a.setOption(b,O[b],!0)})})}function R(a,b,c){var d=y.filename;return c||(y.filename=null),Error("illegal "+(b||"token")+" '"+a+"' ("+(d?d+", ":"")+"line "+E.line+")")}function S(){var a,b=[];do{if('"'!==(a=F())&&"'"!==a)throw R(a);b.push(F()),I(a),a=H()}while('"'===a||"'"===a);return b.join("")}function T(a){var b=F();switch(b){case"'":case'"':return G(b),S();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return V(b,!0)}catch(c){if(a&&x.test(b))return b;throw R(b,"value")}}function U(a,b){do if(b&&('"'===(c=H())||"'"===c)){var c,d,e=S();if(a.push(e),L>=2023)throw R(e,"id")}else try{a.push([d=W(F()),I("to",!0)?W(F()):d])}catch(d){if(b&&x.test(c)&&L>=2023)a.push(c);else throw d}while(I(",",!0));var f={options:void 0};f.setOption=function(a,b){void 0===this.options&&(this.options={}),this.options[a]=b},aa(f,function(a){if("option"===a)ai(f,a),I(";");else throw R(a)},function(){am(f)})}function V(a,b){var c=1;switch("-"===a.charAt(0)&&(c=-1,a=a.substring(1)),a){case"inf":case"INF":case"Inf":return 1/0*c;case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(a))return c*parseInt(a,10);if(r.test(a))return c*parseInt(a,16);if(t.test(a))return c*parseInt(a,8);if(v.test(a))return c*parseFloat(a);throw R(a,"number",b)}function W(a,b){switch(a){case"max":case"MAX":case"Max":return 0x1fffffff;case"0":return 0}if(!b&&"-"===a.charAt(0))throw R(a,"id");if(q.test(a))return parseInt(a,10);if(s.test(a))return parseInt(a,16);if(u.test(a))return parseInt(a,8);throw R(a,"id")}function X(){if(void 0!==A)throw R("package");if(A=F(),!x.test(A))throw R(A,"name");M=M.define(A),I(";")}function Y(){var a,b=H();switch(b){case"weak":a=C||(C=[]),F();break;case"public":F();default:a=B||(B=[])}b=S(),I(";"),a.push(b)}function Z(){if(I("="),(L=S())<2023)throw R(L,"syntax");I(";")}function $(){if(I("="),!["2023"].includes(L=S()))throw R(L,"edition");I(";")}function _(a,b){switch(b){case"option":return ai(a,b),I(";"),!0;case"message":return ab(a,b),!0;case"enum":return ag(a,b),!0;case"service":return an(a,b),!0;case"extend":return ap(a,b),!0}return!1}function aa(a,b,c){var d,e=E.line;if(a&&("string"!=typeof a.comment&&(a.comment=J()),a.filename=y.filename),I("{",!0)){for(;"}"!==(d=F());)b(d);I(";",!0)}else c&&c(),I(";"),a&&("string"!=typeof a.comment||D)&&(a.comment=J(e)||a.comment)}function ab(a,b){if(!w.test(b=F()))throw R(b,"type name");var c=new f(b);aa(c,function(a){if(!_(c,a))switch(a){case"map":ae(c,a);break;case"required":if("proto2"!==L)throw R(a);case"repeated":ac(c,a);break;case"optional":if("proto3"===L)ac(c,"proto3_optional");else if("proto2"!==L)throw R(a);else ac(c,"optional");break;case"oneof":af(c,a);break;case"extensions":U(c.extensions||(c.extensions=[]));break;case"reserved":U(c.reserved||(c.reserved=[]),!0);break;default:if("proto2"===L||!x.test(a))throw R(a);G(a),ac(c,"optional")}}),a.add(c),a===M&&N.push(c)}function ac(a,b,c){var d=F();if("group"===d)return void ad(a,b);for(;d.endsWith(".")||H().startsWith(".");)d+=F();if(!x.test(d))throw R(d,"type");var e=F();if(!w.test(e))throw R(e,"name");e=P(e),I("=");var f=new g(e,W(F()),d,b,c);if(aa(f,function(a){if("option"===a)ai(f,a),I(";");else throw R(a)},function(){am(f)}),"proto3_optional"===b){var h=new i("_"+e);f.setOption("proto3_optional",!0),h.add(f),a.add(h)}else a.add(f);a===M&&N.push(f)}function ad(a,b){if(L>=2023)throw R("group");var c=F();if(!w.test(c))throw R(c,"name");var d=o.lcFirst(c);c===d&&(c=o.ucFirst(c)),I("=");var e=W(F()),h=new f(c);h.group=!0;var i=new g(d,e,c,b);i.filename=y.filename,aa(h,function(a){switch(a){case"option":ai(h,a),I(";");break;case"required":case"repeated":ac(h,a);break;case"optional":"proto3"===L?ac(h,"proto3_optional"):ac(h,"optional");break;case"message":ab(h,a);break;case"enum":ag(h,a);break;case"reserved":U(h.reserved||(h.reserved=[]),!0);break;default:throw R(a)}}),a.add(h).add(i)}function ae(a){I("<");var b=F();if(void 0===n.mapKey[b])throw R(b,"type");I(",");var c=F();if(!x.test(c))throw R(c,"type");I(">");var d=F();if(!w.test(d))throw R(d,"name");I("=");var e=new h(P(d),W(F()),b,c);aa(e,function(a){if("option"===a)ai(e,a),I(";");else throw R(a)},function(){am(e)}),a.add(e)}function af(a,b){if(!w.test(b=F()))throw R(b,"name");var c=new i(P(b));aa(c,function(a){"option"===a?(ai(c,a),I(";")):(G(a),ac(c,"optional"))}),a.add(c)}function ag(a,b){if(!w.test(b=F()))throw R(b,"name");var c=new j(b);aa(c,function(a){switch(a){case"option":ai(c,a),I(";");break;case"reserved":U(c.reserved||(c.reserved=[]),!0),void 0===c.reserved&&(c.reserved=[]);break;default:ah(c,a)}}),a.add(c),a===M&&N.push(c)}function ah(a,b){if(!w.test(b))throw R(b,"name");I("=");var c=W(F(),!0),d={options:void 0};d.getOption=function(a){return this.options[a]},d.setOption=function(a,b){m.prototype.setOption.call(d,a,b)},d.setParsedOption=function(){},aa(d,function(a){if("option"===a)ai(d,a),I(";");else throw R(a)},function(){am(d)}),a.add(b,c,d.comment,d.parsedOptions||d.options)}function ai(a,b){var c,d,e=!0;for("option"===b&&(b=F());"="!==b;){if("("===b){var f=F();I(")"),b="("+f+")"}if(e){if(e=!1,b.includes(".")&&!b.includes("(")){var g=b.split(".");c=g[0]+".",b=g[1];continue}c=b}else d=d?d+=b:b;b=F()}var h=aj(a,d?c.concat(d):c);d=d&&"."===d[0]?d.slice(1):d,al(a,c=c&&"."===c[c.length-1]?c.slice(0,-1):c,h,d)}function aj(a,b){if(I("{",!0)){for(var c={};!I("}",!0);){if(!w.test(z=F()))throw R(z,"name");if(null===z)throw R(z,"end of input");var d,e,f=z;if(I(":",!0),"{"===H())d=aj(a,b+"."+z);else if("["===H()){if(d=[],I("[",!0)){do e=T(!0),d.push(e);while(I(",",!0));I("]"),void 0!==e&&ak(a,b+"."+z,e)}}else d=T(!0),ak(a,b+"."+z,d);var g=c[f];g&&(d=[].concat(g).concat(d)),c[f]=d,I(",",!0),I(";",!0)}return c}var h=T(!0);return ak(a,b,h),h}function ak(a,b,c){if(M===a&&/^features\./.test(b)){O[b]=c;return}a.setOption&&a.setOption(b,c)}function al(a,b,c,d){a.setParsedOption&&a.setParsedOption(b,c,d)}function am(a){if(I("[",!0)){do ai(a,"option");while(I(",",!0));I("]")}return a}function an(a,b){if(!w.test(b=F()))throw R(b,"service name");var c=new k(b);aa(c,function(a){if(!_(c,a))if("rpc"===a)ao(c,a);else throw R(a)}),a.add(c),a===M&&N.push(c)}function ao(a,b){var c=J(),d=b;if(!w.test(b=F()))throw R(b,"name");var e,f,g,h,i=b;if(I("("),I("stream",!0)&&(f=!0),!x.test(b=F())||(e=b,I(")"),I("returns"),I("("),I("stream",!0)&&(h=!0),!x.test(b=F())))throw R(b);g=b,I(")");var j=new l(i,d,e,g,f,h);j.comment=c,aa(j,function(a){if("option"===a)ai(j,a),I(";");else throw R(a)}),a.add(j)}function ap(a,b){if(!x.test(b=F()))throw R(b,"reference");var c=b;aa(null,function(b){switch(b){case"required":case"repeated":ac(a,b,c);break;case"optional":"proto3"===L?ac(a,"proto3_optional",c):ac(a,"optional",c);break;default:if("proto2"===L||!x.test(b))throw R(b);G(b),ac(a,"optional",c)}})}for(;null!==(z=F());)switch(z){case"package":if(!K)throw R(z);X();break;case"import":if(!K)throw R(z);Y();break;case"syntax":if(!K)throw R(z);Z();break;case"edition":if(!K)throw R(z);$();break;case"option":ai(M,z),I(";",!0);break;default:if(_(M,z)){K=!1;continue}throw R(z)}return Q(),y.filename=null,{package:A,imports:B,weakImports:C,root:b}}},52519:(a,b,c)=>{"use strict";var d=a.exports=c(49752);function e(a,b,c){return"function"==typeof b?(c=b,b=new d.Root):b||(b=new d.Root),b.load(a,c)}function f(a,b){return b||(b=new d.Root),b.loadSync(a)}d.build="light",d.load=e,d.loadSync=f,d.encoder=c(35546),d.decoder=c(65526),d.verifier=c(43866),d.converter=c(97594),d.ReflectionObject=c(38575),d.Namespace=c(18677),d.Root=c(92072),d.Enum=c(60081),d.Type=c(36660),d.Field=c(9758),d.OneOf=c(10059),d.MapField=c(80366),d.Service=c(75965),d.Method=c(24953),d.Message=c(4673),d.wrappers=c(38972),d.types=c(56207),d.util=c(36544),d.ReflectionObject._configure(d.Root),d.Namespace._configure(d.Type,d.Service,d.Enum),d.Root._configure(d.Type),d.Field._configure(d.Type)},53605:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.CallCredentials=void 0;let d=c(12667);function e(a){return"getRequestHeaders"in a&&"function"==typeof a.getRequestHeaders}class f{static createFromMetadataGenerator(a){return new h(a)}static createFromGoogleCredential(a){return f.createFromMetadataGenerator((b,c)=>{let f;(f=e(a)?a.getRequestHeaders(b.service_url):new Promise((c,d)=>{a.getRequestMetadata(b.service_url,(a,b)=>a?void d(a):b?void c(b):void d(Error("Headers not set by metadata plugin")))})).then(a=>{let b=new d.Metadata;for(let c of Object.keys(a))b.add(c,a[c]);c(null,b)},a=>{c(a)})})}static createEmpty(){return new i}}b.CallCredentials=f;class g extends f{constructor(a){super(),this.creds=a}async generateMetadata(a){let b=new d.Metadata;for(let c of(await Promise.all(this.creds.map(b=>b.generateMetadata(a)))))b.merge(c);return b}compose(a){return new g(this.creds.concat([a]))}_equals(a){return this===a||a instanceof g&&this.creds.every((b,c)=>b._equals(a.creds[c]))}}class h extends f{constructor(a){super(),this.metadataGenerator=a}generateMetadata(a){return new Promise((b,c)=>{this.metadataGenerator(a,(a,d)=>{void 0!==d?b(d):c(a)})})}compose(a){return new g([this,a])}_equals(a){return this===a||a instanceof h&&this.metadataGenerator===a.metadataGenerator}}class i extends f{generateMetadata(a){return Promise.resolve(new d.Metadata)}compose(a){return a}_equals(a){return a instanceof i}}},53818:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.DEFAULT_PORT=void 0;let d=c(66528),e=c(14985),f=c(28354),g=c(75478),h=c(77797),i=c(12667),j=c(35433),k=c(77797),l=c(23220),m=c(91645),n=c(30422),o="dns_resolver";function p(a){j.trace(k.LogVerbosity.DEBUG,o,a)}b.DEFAULT_PORT=443;let q=3e4,r=f.promisify(e.resolveTxt),s=f.promisify(e.lookup);function t(...a){let b=[];for(let c=0;c<Math.max.apply(null,a.map(a=>a.length));c++)for(let d of a)c<d.length&&b.push(d[c]);return b}class u{constructor(a,c,d){var e,f,g;this.target=a,this.listener=c,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,p("Resolver constructed for target "+(0,l.uriToString)(a));let j=(0,l.splitHostPort)(a.path);null===j?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,m.isIPv4)(j.host)||(0,m.isIPv6)(j.host)?(this.ipResult=[{host:j.host,port:null!=(e=j.port)?e:b.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=j.host,this.port=null!=(f=j.port)?f:b.DEFAULT_PORT),this.percentage=100*Math.random(),1===d["grpc.service_config_disable_resolution"]&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:h.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,l.uriToString)(this.target)}`,metadata:new i.Metadata};let k={initialDelay:d["grpc.initial_reconnect_backoff_ms"],maxDelay:d["grpc.max_reconnect_backoff_ms"]};this.backoff=new n.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},k),this.backoff.unref(),this.minTimeBetweenResolutionsMs=null!=(g=d["grpc.dns_min_time_between_resolutions_ms"])?g:q,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(null!==this.ipResult){this.returnedIpResult||(p("Returning IP address for target "+(0,l.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(null===this.dnsHostname)p("Failed to parse DNS address "+(0,l.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:h.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,l.uriToString)(this.target)}`,metadata:new i.Metadata})}),this.stopNextResolutionTimer();else{if(null!==this.pendingLookupPromise)return;p("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let a=this.dnsHostname;this.pendingLookupPromise=s(a,{all:!0}),this.pendingLookupPromise.then(a=>{if(null===this.pendingLookupPromise)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let b=a.filter(a=>4===a.family),c=a.filter(a=>6===a.family);this.latestLookupResult=t(c,b).map(a=>({host:a.address,port:+this.port}));let d="["+this.latestLookupResult.map(a=>a.host+":"+a.port).join(",")+"]";if(p("Resolved addresses for target "+(0,l.uriToString)(this.target)+": "+d),0===this.latestLookupResult.length)return void this.listener.onError(this.defaultResolutionError);this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},a=>{null!==this.pendingLookupPromise&&(p("Resolution error for target "+(0,l.uriToString)(this.target)+": "+a.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&null===this.pendingTxtPromise&&(this.pendingTxtPromise=r(a),this.pendingTxtPromise.then(a=>{if(null!==this.pendingTxtPromise){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,g.extractAndSelectServiceConfig)(a,this.percentage)}catch(a){this.latestServiceConfigError={code:h.Status.UNAVAILABLE,details:`Parsing service config failed with error ${a.message}`,metadata:new i.Metadata}}null!==this.latestLookupResult&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},a=>{}))}}startNextResolutionTimer(){var a,b;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=null==(b=(a=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)?void 0:b.call(a),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){null===this.pendingLookupPromise&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){null===this.pendingLookupPromise&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?p('resolution update delayed by "min time between resolutions" rate limit'):p("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(a){return a.path}}b.setup=function(){(0,d.registerResolver)("dns",u),(0,d.registerDefaultScheme)("dns")}},55176:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ResolvingCall=void 0;let d=c(77797),e=c(9874),f=c(12667),g=c(35433),h=c(90145),i="resolving_call";class j{constructor(a,b,c,f,g,h){this.channel=a,this.method=b,this.filterStackFactory=f,this.credentials=g,this.callNumber=h,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=c.deadline,this.host=c.host,c.parentCall&&(c.flags&d.Propagate.CANCELLATION&&c.parentCall.on("cancelled",()=>{this.cancelWithStatus(d.Status.CANCELLED,"Cancelled by parent call")}),c.flags&d.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+c.parentCall.getDeadline()),this.deadline=(0,e.minDeadline)(this.deadline,c.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(a){g.trace(d.LogVerbosity.DEBUG,i,"["+this.callNumber+"] "+a)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,e.deadlineToString)(this.deadline));let a=(0,e.getRelativeTimeout)(this.deadline);if(a!==1/0){this.trace("Deadline will be reached in "+a+"ms");let b=()=>{this.cancelWithStatus(d.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};a<=0?process.nextTick(b):this.deadlineTimer=setTimeout(b,a)}}outputStatus(a){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let b=this.filterStack.receiveTrailers(a);this.trace("ended with status: code="+b.code+' details="'+b.details+'"'),this.statusWatchers.forEach(a=>a(b)),process.nextTick(()=>{var a;null==(a=this.listener)||a.onReceiveStatus(b)})}}sendMessageOnChild(a,b){if(!this.child)throw Error("sendMessageonChild called with child not populated");let c=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:b,flags:a.flags})).then(b=>{this.writeFilterPending=!1,c.sendMessageWithContext(a,b.message),this.pendingHalfClose&&c.halfClose()},a=>{this.cancelWithStatus(a.code,a.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw Error("getConfig called before start");let a=this.channel.getConfig(this.method,this.metadata);if("NONE"===a.type)return void this.channel.queueCallForConfig(this);if("ERROR"===a.type)return void(this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(a.error));let b=a.config;if(b.status!==d.Status.OK){let{code:a,details:c}=(0,h.restrictControlPlaneStatusCode)(b.status,"Failed to route call to method "+this.method);this.outputStatus({code:a,details:c,metadata:new f.Metadata});return}if(b.methodConfig.timeout){let a=new Date;a.setSeconds(a.getSeconds()+b.methodConfig.timeout.seconds),a.setMilliseconds(a.getMilliseconds()+b.methodConfig.timeout.nanos/1e6),this.deadline=(0,e.minDeadline)(this.deadline,a),this.runDeadlineTimer()}this.filterStackFactory.push(b.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(a=>{this.child=this.channel.createInnerCall(b,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(a,{onReceiveMetadata:a=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(a))},onReceiveMessage:a=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(a).then(a=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(a),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},a=>{this.cancelWithStatus(a.code,a.details)})},onReceiveStatus:a=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=a:this.outputStatus(a)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},a=>{this.outputStatus(a)})}reportResolverError(a){var b;(null==(b=this.metadata)?void 0:b.getOptions().waitForReady)?this.channel.queueCallForConfig(this):this.outputStatus(a)}cancelWithStatus(a,b){var c;this.trace("cancelWithStatus code: "+a+' details: "'+b+'"'),null==(c=this.child)||c.cancelWithStatus(a,b),this.outputStatus({code:a,details:b,metadata:new f.Metadata})}getPeer(){var a,b;return null!=(b=null==(a=this.child)?void 0:a.getPeer())?b:this.channel.getTarget()}start(a,b){this.trace("start called"),this.metadata=a.clone(),this.listener=b,this.getConfig()}sendMessageWithContext(a,b){this.trace("write() called with message of length "+b.length),this.child?this.sendMessageOnChild(a,b):this.pendingMessage={context:a,message:b}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(a){this.credentials=this.credentials.compose(a)}addStatusWatcher(a){this.statusWatchers.push(a)}getCallNumber(){return this.callNumber}}b.ResolvingCall=j},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},56207:(a,b,c)=>{"use strict";var d=b,e=c(36544),f=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function g(a,b){var c=0,d={};for(b|=0;c<a.length;)d[f[c+b]]=a[c++];return d}d.basic=g([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),d.defaults=g([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",e.emptyArray,null]),d.long=g([0,0,0,1,1],7),d.mapKey=g([0,0,0,5,5,0,0,0,1,1,0,2],2),d.packed=g([1,5,0,0,0,5,5,0,0,0,1,1,0])},58187:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Http2SubchannelCall=void 0;let d=c(73496),e=c(21820),f=c(77797),g=c(12667),h=c(59651),i=c(35433),j=c(77797),k="subchannel_call";function l(a){for(let[b,c]of Object.entries(e.constants.errno))if(c===a)return b;return"Unknown system error "+a}class m{constructor(a,b,c,e,i){var j;this.http2Stream=a,this.callEventTracker=b,this.listener=c,this.transport=e,this.callId=i,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=f.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let k=null!=(j=e.getOptions()["grpc.max_receive_message_length"])?j:f.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new h.StreamDecoder(k),a.on("response",(a,b)=>{let c="";for(let b of Object.keys(a))c+="		"+b+": "+a[b]+"\n";switch(this.trace("Received server headers:\n"+c),a[":status"]){case 400:this.mappedStatusCode=f.Status.INTERNAL;break;case 401:this.mappedStatusCode=f.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=f.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=f.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=f.Status.UNAVAILABLE;break;default:this.mappedStatusCode=f.Status.UNKNOWN}if(b&d.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(a);else{let b;try{b=g.Metadata.fromHttp2Headers(a)}catch(a){this.endCall({code:f.Status.UNKNOWN,details:a.message,metadata:new g.Metadata});return}this.listener.onReceiveMetadata(b)}}),a.on("trailers",a=>{this.handleTrailers(a)}),a.on("data",a=>{let b;if(!this.statusOutput){this.trace("receive HTTP/2 data frame of length "+a.length);try{b=this.decoder.write(a)}catch(a){this.cancelWithStatus(f.Status.RESOURCE_EXHAUSTED,a.message);return}for(let a of b)this.trace("parsed message of length "+a.length),this.callEventTracker.addMessageReceived(),this.tryPush(a)}}),a.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),a.on("close",()=>{process.nextTick(()=>{var b;let c;if(this.trace("HTTP/2 stream closed with code "+a.rstCode),(null==(b=this.finalStatus)?void 0:b.code)===f.Status.OK)return;let e="";switch(a.rstCode){case d.constants.NGHTTP2_NO_ERROR:if(null!==this.finalStatus)return;c=f.Status.INTERNAL,e=`Received RST_STREAM with code ${a.rstCode}`;break;case d.constants.NGHTTP2_REFUSED_STREAM:c=f.Status.UNAVAILABLE,e="Stream refused by server";break;case d.constants.NGHTTP2_CANCEL:c=f.Status.CANCELLED,e="Call cancelled";break;case d.constants.NGHTTP2_ENHANCE_YOUR_CALM:c=f.Status.RESOURCE_EXHAUSTED,e="Bandwidth exhausted or memory limit exceeded";break;case d.constants.NGHTTP2_INADEQUATE_SECURITY:c=f.Status.PERMISSION_DENIED,e="Protocol not secure enough";break;case d.constants.NGHTTP2_INTERNAL_ERROR:c=f.Status.INTERNAL,null===this.internalError?e=`Received RST_STREAM with code ${a.rstCode} (Internal server error)`:"ECONNRESET"===this.internalError.code||"ETIMEDOUT"===this.internalError.code?(c=f.Status.UNAVAILABLE,e=this.internalError.message):e=`Received RST_STREAM with code ${a.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:c=f.Status.INTERNAL,e=`Received RST_STREAM with code ${a.rstCode}`}this.endCall({code:c,details:e,metadata:new g.Metadata,rstCode:a.rstCode})})}),a.on("error",a=>{"ERR_HTTP2_STREAM_ERROR"!==a.code&&(this.trace("Node error event: message="+a.message+" code="+a.code+" errno="+l(a.errno)+" syscall="+a.syscall),this.internalError=a),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:f.Status.UNAVAILABLE,details:"Connection dropped",metadata:new g.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(a){i.trace(j.LogVerbosity.DEBUG,k,"["+this.callId+"] "+a)}endCall(a){(null===this.finalStatus||this.finalStatus.code===f.Status.OK)&&(this.finalStatus=a,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){null===this.finalStatus||this.finalStatus.code===f.Status.OK&&(!this.readsClosed||0!==this.unpushedReadMessages.length||this.isReadFilterPending||this.isPushPending)||this.outputStatus()}push(a){this.trace("pushing to reader message of length "+(a instanceof Buffer?a.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,this.statusOutput||(this.listener.onReceiveMessage(a),this.maybeOutputStatus())})}tryPush(a){this.canPush?(this.http2Stream.pause(),this.push(a)):(this.trace("unpushedReadMessages.push message of length "+a.length),this.unpushedReadMessages.push(a))}handleTrailers(a){let b;this.callEventTracker.onStreamEnd(!0);let c="";for(let b of Object.keys(a))c+="		"+b+": "+a[b]+"\n";this.trace("Received server trailers:\n"+c);try{b=g.Metadata.fromHttp2Headers(a)}catch(a){b=new g.Metadata}let d=b.getMap(),e=this.mappedStatusCode;if(e===f.Status.UNKNOWN&&"string"==typeof d["grpc-status"]){let a=Number(d["grpc-status"]);a in f.Status&&(e=a,this.trace("received status code "+a+" from server")),b.remove("grpc-status")}let h="";if("string"==typeof d["grpc-message"]){try{h=decodeURI(d["grpc-message"])}catch(a){h=d["grpc-message"]}b.remove("grpc-message"),this.trace('received status details string "'+h+'" from server')}let i={code:e,details:h,metadata:b};this.endCall(i)}destroyHttp2Stream(){var a;if(!this.http2Stream.destroyed){let b;b=(null==(a=this.finalStatus)?void 0:a.code)===f.Status.OK?d.constants.NGHTTP2_NO_ERROR:d.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+b),this.http2Stream.close(b)}}cancelWithStatus(a,b){this.trace("cancelWithStatus code: "+a+' details: "'+b+'"'),this.endCall({code:a,details:b,metadata:new g.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(null!==this.finalStatus&&this.finalStatus.code!==f.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let a=this.unpushedReadMessages.shift();this.push(a);return}this.http2Stream.resume()}sendMessageWithContext(a,b){this.trace("write() called with message of length "+b.length);let c=b=>{process.nextTick(()=>{var c;let d=f.Status.UNAVAILABLE;(null==b?void 0:b.code)==="ERR_STREAM_WRITE_AFTER_END"&&(d=f.Status.INTERNAL),b&&this.cancelWithStatus(d,`Write error: ${b.message}`),null==(c=a.callback)||c.call(a)})};this.trace("sending data chunk of length "+b.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(b,c)}catch(a){this.endCall({code:f.Status.UNAVAILABLE,details:`Write failed with error ${a.message}`,metadata:new g.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}}b.Http2SubchannelCall=m},58279:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.addAdminServicesToServer=b.registerAdminService=void 0;let c=[];b.registerAdminService=function(a,b){c.push({getServiceDefinition:a,getHandlers:b})},b.addAdminServicesToServer=function(a){for(let{getServiceDefinition:b,getHandlers:d}of c)a.addService(b(),d())}},59651:(a,b)=>{"use strict";var c;Object.defineProperty(b,"__esModule",{value:!0}),b.StreamDecoder=void 0,function(a){a[a.NO_DATA=0]="NO_DATA",a[a.READING_SIZE=1]="READING_SIZE",a[a.READING_MESSAGE=2]="READING_MESSAGE"}(c||(c={}));class d{constructor(a){this.maxReadMessageLength=a,this.readState=c.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(a){let b,d=0,e=[];for(;d<a.length;)switch(this.readState){case c.NO_DATA:this.readCompressFlag=a.slice(d,d+1),d+=1,this.readState=c.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case c.READING_SIZE:if(b=Math.min(a.length-d,this.readSizeRemaining),a.copy(this.readPartialSize,4-this.readSizeRemaining,d,d+b),this.readSizeRemaining-=b,d+=b,0===this.readSizeRemaining){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),-1!==this.maxReadMessageLength&&this.readMessageSize>this.maxReadMessageLength)throw Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=c.READING_MESSAGE;else{let a=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=c.NO_DATA,e.push(a)}}break;case c.READING_MESSAGE:if(b=Math.min(a.length-d,this.readMessageRemaining),this.readPartialMessage.push(a.slice(d,d+b)),this.readMessageRemaining-=b,d+=b,0===this.readMessageRemaining){let a=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),b=Buffer.concat(a,this.readMessageSize+5);this.readState=c.NO_DATA,e.push(b)}break;default:throw Error("Unexpected read state")}return e}}b.StreamDecoder=d},59652:a=>{"use strict";a.exports=function a(a,b,c){var d=c||8192,e=d>>>1,f=null,g=d;return function(c){if(c<1||c>e)return a(c);g+c>d&&(f=a(d),g=0);var h=b.call(f,g,g+=c);return 7&g&&(g=(7|g)+1),h}}},60081:(a,b,c)=>{"use strict";a.exports=g;var d=c(38575);((g.prototype=Object.create(d.prototype)).constructor=g).className="Enum";var e=c(18677),f=c(36544);function g(a,b,c,e,f,g){if(d.call(this,a,c),b&&"object"!=typeof b)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=e,this.comments=f||{},this.valuesOptions=g,this._valuesFeatures={},this.reserved=void 0,b)for(var h=Object.keys(b),i=0;i<h.length;++i)"number"==typeof b[h[i]]&&(this.valuesById[this.values[h[i]]=b[h[i]]]=h[i])}g.prototype._resolveFeatures=function(a){return a=this._edition||a,d.prototype._resolveFeatures.call(this,a),Object.keys(this.values).forEach(a=>{var b=Object.assign({},this._features);this._valuesFeatures[a]=Object.assign(b,this.valuesOptions&&this.valuesOptions[a]&&this.valuesOptions[a].features)}),this},g.fromJSON=function(a,b){var c=new g(a,b.values,b.options,b.comment,b.comments);return c.reserved=b.reserved,b.edition&&(c._edition=b.edition),c._defaultEdition="proto3",c},g.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return f.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",b?this.comment:void 0,"comments",b?this.comments:void 0])},g.prototype.add=function(a,b,c,d){if(!f.isString(a))throw TypeError("name must be a string");if(!f.isInteger(b))throw TypeError("id must be an integer");if(void 0!==this.values[a])throw Error("duplicate name '"+a+"' in "+this);if(this.isReservedId(b))throw Error("id "+b+" is reserved in "+this);if(this.isReservedName(a))throw Error("name '"+a+"' is reserved in "+this);if(void 0!==this.valuesById[b]){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+b+" in "+this);this.values[a]=b}else this.valuesById[this.values[a]=b]=a;return d&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[a]=d||null),this.comments[a]=c||null,this},g.prototype.remove=function(a){if(!f.isString(a))throw TypeError("name must be a string");var b=this.values[a];if(null==b)throw Error("name '"+a+"' does not exist in "+this);return delete this.valuesById[b],delete this.values[a],delete this.comments[a],this.valuesOptions&&delete this.valuesOptions[a],this},g.prototype.isReservedId=function(a){return e.isReservedId(this.reserved,a)},g.prototype.isReservedName=function(a){return e.isReservedName(this.reserved,a)}},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63766:a=>{var b=1/0,c="[object Symbol]",d=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,e=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,f="\ud800-\udfff",g="\\u0300-\\u036f\\ufe20-\\ufe23",h="\\u20d0-\\u20f0",i="\\u2700-\\u27bf",j="a-z\\xdf-\\xf6\\xf8-\\xff",k="A-Z\\xc0-\\xd6\\xd8-\\xde",l="\\ufe0e\\ufe0f",m="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",n="[']",o="["+f+"]",p="["+m+"]",q="["+g+h+"]",r="\\d+",s="["+i+"]",t="["+j+"]",u="[^"+f+m+r+i+j+k+"]",v="\ud83c[\udffb-\udfff]",w="[^"+f+"]",x="(?:\ud83c[\udde6-\uddff]){2}",y="[\ud800-\udbff][\udc00-\udfff]",z="["+k+"]",A="\\u200d",B="(?:"+t+"|"+u+")",C="(?:"+z+"|"+u+")",D="(?:"+n+"(?:d|ll|m|re|s|t|ve))?",E="(?:"+n+"(?:D|LL|M|RE|S|T|VE))?",F="(?:"+q+"|"+v+")?",G="["+l+"]?",H="(?:"+A+"(?:"+[w,x,y].join("|")+")"+G+F+")*",I=G+F+H,J="(?:"+[s,x,y].join("|")+")"+I,K="(?:"+[w+q+"?",q,x,y,o].join("|")+")",L=RegExp(n,"g"),M=RegExp(q,"g"),N=RegExp(v+"(?="+v+")|"+K+I,"g"),O=RegExp([z+"?"+t+"+"+D+"(?="+[p,z,"$"].join("|")+")",C+"+"+E+"(?="+[p,z+B,"$"].join("|")+")",z+"?"+B+"+"+D,z+"+"+E,r,J].join("|"),"g"),P=RegExp("["+A+f+g+h+l+"]"),Q=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,R={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"ss"},S="object"==typeof global&&global&&global.Object===Object&&global,T="object"==typeof self&&self&&self.Object===Object&&self,U=S||T||Function("return this")();function V(a,b,c,d){var e=-1,f=a?a.length:0;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function W(a){return a.split("")}function X(a){return a.match(d)||[]}var Y=function(a){return function(b){return null==a?void 0:a[b]}}(R);function Z(a){return P.test(a)}function $(a){return Q.test(a)}function _(a){return Z(a)?aa(a):W(a)}function aa(a){return a.match(N)||[]}function ab(a){return a.match(O)||[]}var ac=Object.prototype.toString,ad=U.Symbol,ae=ad?ad.prototype:void 0,af=ae?ae.toString:void 0;function ag(a,b,c){var d=-1,e=a.length;b<0&&(b=-b>e?0:e+b),(c=c>e?e:c)<0&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}function ah(a){if("string"==typeof a)return a;if(al(a))return af?af.call(a):"";var c=a+"";return"0"==c&&1/a==-b?"-0":c}function ai(a,b,c){var d=a.length;return c=void 0===c?d:c,!b&&c>=d?a:ag(a,b,c)}function aj(a){return function(b){var c=Z(b=am(b))?_(b):void 0,d=c?c[0]:b.charAt(0),e=c?ai(c,1).join(""):b.slice(1);return d[a]()+e}}function ak(a){return!!a&&"object"==typeof a}function al(a){return"symbol"==typeof a||ak(a)&&ac.call(a)==c}function am(a){return null==a?"":ah(a)}var an=function(a){return function(b){return V(ar(ap(b).replace(L,"")),a,"")}}(function(a,b,c){return b=b.toLowerCase(),a+(c?ao(b):b)});function ao(a){return aq(am(a).toLowerCase())}function ap(a){return(a=am(a))&&a.replace(e,Y).replace(M,"")}var aq=aj("toUpperCase");function ar(a,b,c){return(a=am(a),void 0===(b=c?void 0:b))?$(a)?ab(a):X(a):a.match(b)||[]}a.exports=an},63797:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.RoundRobinLoadBalancer=void 0;let d=c(4825),e=c(40249),f=c(14908),g=c(74590),h=c(35433),i=c(77797),j="round_robin";function k(a){h.trace(i.LogVerbosity.DEBUG,j,a)}let l="round_robin";class m{getLoadBalancerName(){return l}constructor(){}toJsonObject(){return{[l]:{}}}static createFromJson(a){return new m}}class n{constructor(a,b=0){this.subchannelList=a,this.nextIndex=b}pick(a){let b=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:f.PickResultType.COMPLETE,subchannel:b,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}}class o{constructor(a){this.channelControlHelper=a,this.subchannels=[],this.currentState=e.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(a,b,c,d,f)=>{this.calculateAndUpdateState(),(c===e.ConnectivityState.TRANSIENT_FAILURE||c===e.ConnectivityState.IDLE)&&(f&&(this.lastError=f),this.channelControlHelper.requestReresolution(),a.startConnecting())}}countSubchannelsWithState(a){return this.subchannels.filter(b=>b.getConnectivityState()===a).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(e.ConnectivityState.READY)>0){let a=this.subchannels.filter(a=>a.getConnectivityState()===e.ConnectivityState.READY),b=0;null!==this.currentReadyPicker&&(b=a.indexOf(this.currentReadyPicker.peekNextSubchannel()))<0&&(b=0),this.updateState(e.ConnectivityState.READY,new n(a,b))}else this.countSubchannelsWithState(e.ConnectivityState.CONNECTING)>0?this.updateState(e.ConnectivityState.CONNECTING,new f.QueuePicker(this)):this.countSubchannelsWithState(e.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(e.ConnectivityState.TRANSIENT_FAILURE,new f.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(e.ConnectivityState.IDLE,new f.QueuePicker(this))}updateState(a,b){k(e.ConnectivityState[this.currentState]+" -> "+e.ConnectivityState[a]),a===e.ConnectivityState.READY?this.currentReadyPicker=b:this.currentReadyPicker=null,this.currentState=a,this.channelControlHelper.updateState(a,b)}resetSubchannelList(){for(let a of this.subchannels)a.removeConnectivityStateListener(this.subchannelStateListener),a.unref(),this.channelControlHelper.removeChannelzChild(a.getChannelzRef());this.subchannels=[]}updateAddressList(a,b){for(let b of(this.resetSubchannelList(),k("Connect to address list "+a.map(a=>(0,g.subchannelAddressToString)(a))),this.subchannels=a.map(a=>this.channelControlHelper.createSubchannel(a,{})),this.subchannels)){b.ref(),b.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(b.getChannelzRef());let a=b.getConnectivityState();(a===e.ConnectivityState.IDLE||a===e.ConnectivityState.TRANSIENT_FAILURE)&&b.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let a of this.subchannels)a.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return l}}b.RoundRobinLoadBalancer=o,b.setup=function(){(0,d.registerLoadBalancerType)(l,o,m)}},65526:(a,b,c)=>{"use strict";a.exports=h;var d=c(60081),e=c(56207),f=c(36544);function g(a){return"missing required '"+a.name+"'"}function h(a){for(var b=f.codegen(["r","l","e"],a.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(a.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),c=0;c<a.fieldsArray.length;++c){var h=a._fieldsArray[c].resolve(),i=h.resolvedType instanceof d?"int32":h.type,j="m"+f.safeProp(h.name);b("case %i: {",h.id),h.map?(b("if(%s===util.emptyObject)",j)("%s={}",j)("var c2 = r.uint32()+r.pos"),void 0!==e.defaults[h.keyType]?b("k=%j",e.defaults[h.keyType]):b("k=null"),void 0!==e.defaults[i]?b("value=%j",e.defaults[i]):b("value=null"),b("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",h.keyType)("case 2:"),void 0===e.basic[i]?b("value=types[%i].decode(r,r.uint32())",c):b("value=r.%s()",i),b("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==e.long[h.keyType]?b('%s[typeof k==="object"?util.longToHash(k):k]=value',j):b("%s[k]=value",j)):h.repeated?(b("if(!(%s&&%s.length))",j,j)("%s=[]",j),void 0!==e.packed[i]&&b("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",j,i)("}else"),void 0===e.basic[i]?b(h.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",j,c):b("%s.push(r.%s())",j,i)):void 0===e.basic[i]?b(h.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",j,c):b("%s=r.%s()",j,i),b("break")("}")}for(b("default:")("r.skipType(t&7)")("break")("}")("}"),c=0;c<a._fieldsArray.length;++c){var k=a._fieldsArray[c];k.required&&b("if(!m.hasOwnProperty(%j))",k.name)("throw util.ProtocolError(%j,{instance:m})",g(k))}return b("return m")}},66528:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.mapUriDefaultScheme=b.getDefaultAuthority=b.createResolver=b.registerDefaultScheme=b.registerResolver=void 0;let d=c(23220),e={},f=null;b.registerResolver=function(a,b){e[a]=b},b.registerDefaultScheme=function(a){f=a},b.createResolver=function(a,b,c){if(void 0!==a.scheme&&a.scheme in e)return new e[a.scheme](a,b,c);throw Error(`No resolver could be created for target ${(0,d.uriToString)(a)}`)},b.getDefaultAuthority=function(a){if(void 0!==a.scheme&&a.scheme in e)return e[a.scheme].getDefaultAuthority(a);throw Error(`Invalid target ${(0,d.uriToString)(a)}`)},b.mapUriDefaultScheme=function(a){if(void 0===a.scheme||!(a.scheme in e))if(null!==f)return{scheme:f,authority:void 0,path:(0,d.uriToString)(a)};else return null;return a}},67677:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Server=void 0;let d=c(73496),e=c(77797),f=c(95910),g=c(43558),h=c(66528),i=c(35433),j=c(74590),k=c(23220),l=c(15981),m=0x7fffffff,n=0x7fffffff,o=2e4,{HTTP2_HEADER_PATH:p}=d.constants,q="server";function r(){}function s(a){return{code:e.Status.UNIMPLEMENTED,details:`The server does not implement the method ${a}`}}function t(a,b){let c=s(b);switch(a){case"unary":return(a,b)=>{b(c,null)};case"clientStream":return(a,b)=>{b(c,null)};case"serverStream":return a=>{a.emit("error",c)};case"bidi":return a=>{a.emit("error",c)};default:throw Error(`Invalid handlerType ${a}`)}}class u{constructor(a){var b,c,d,e;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new l.ChannelzTrace,this.callTracker=new l.ChannelzCallTracker,this.listenerChildrenTracker=new l.ChannelzChildrenTracker,this.sessionChildrenTracker=new l.ChannelzChildrenTracker,this.options=null!=a?a:{},0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,l.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=null!=(b=this.options["grpc.max_connection_age_ms"])?b:m,this.maxConnectionAgeGraceMs=null!=(c=this.options["grpc.max_connection_age_grace_ms"])?c:m,this.keepaliveTimeMs=null!=(d=this.options["grpc.keepalive_time_ms"])?d:n,this.keepaliveTimeoutMs=null!=(e=this.options["grpc.keepalive_timeout_ms"])?e:o,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(a){return()=>{var b,c,d;let e,f=this.sessions.get(a),g=a.socket,h=g.remoteAddress?(0,j.stringToSubchannelAddress)(g.remoteAddress,g.remotePort):null,i=g.localAddress?(0,j.stringToSubchannelAddress)(g.localAddress,g.localPort):null;if(a.encrypted){let a=g,c=a.getCipher(),d=a.getCertificate(),f=a.getPeerCertificate();e={cipherSuiteStandardName:null!=(b=c.standardName)?b:null,cipherSuiteOtherName:c.standardName?null:c.name,localCertificate:d&&"raw"in d?d.raw:null,remoteCertificate:f&&"raw"in f?f.raw:null}}else e=null;return{remoteAddress:h,localAddress:i,security:e,remoteName:null,streamsStarted:f.streamTracker.callsStarted,streamsSucceeded:f.streamTracker.callsSucceeded,streamsFailed:f.streamTracker.callsFailed,messagesSent:f.messagesSent,messagesReceived:f.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:f.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:f.lastMessageSentTimestamp,lastMessageReceivedTimestamp:f.lastMessageReceivedTimestamp,localFlowControlWindow:null!=(c=a.state.localWindowSize)?c:null,remoteFlowControlWindow:null!=(d=a.state.remoteWindowSize)?d:null}}}trace(a){i.trace(e.LogVerbosity.DEBUG,q,"("+this.channelzRef.id+") "+a)}addProtoService(){throw Error("Not implemented. Use addService() instead")}addService(a,b){if(null===a||"object"!=typeof a||null===b||"object"!=typeof b)throw Error("addService() requires two objects as arguments");let c=Object.keys(a);if(0===c.length)throw Error("Cannot add an empty service to a server");c.forEach(c=>{let d,e,f=a[c];d=f.requestStream?f.responseStream?"bidi":"clientStream":f.responseStream?"serverStream":"unary";let g=b[c];if(void 0===g&&"string"==typeof f.originalName&&(g=b[f.originalName]),e=void 0!==g?g.bind(b):t(d,c),!1===this.register(f.path,e,f.responseSerialize,f.requestDeserialize,d))throw Error(`Method handler for ${f.path} already provided.`)})}removeService(a){if(null===a||"object"!=typeof a)throw Error("removeService() requires object as argument");Object.keys(a).forEach(b=>{let c=a[b];this.unregister(c.path)})}bind(a,b){throw Error("Not implemented. Use bindAsync() instead")}bindAsync(a,b,c){if(!0===this.started)throw Error("server is already started");if(this.shutdown)throw Error("bindAsync called after shutdown");if("string"!=typeof a)throw TypeError("port must be a string");if(null===b||!(b instanceof g.ServerCredentials))throw TypeError("creds must be a ServerCredentials object");if("function"!=typeof c)throw TypeError("callback must be a function");let f=(0,k.parseUri)(a);if(null===f)throw Error(`Could not parse port "${a}"`);let m=(0,h.mapUriDefaultScheme)(f);if(null===m)throw Error(`Could not get a default scheme for port "${a}"`);let n={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?n.maxSessionMemory=this.options["grpc-node.max_session_memory"]:n.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(n.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let o=(a,b)=>{process.nextTick(()=>c(a,b))},p=()=>{let a;if(b._isSecure()){let c=Object.assign(n,b._getSettings());c.enableTrace=1===this.options["grpc-node.tls_enable_trace"],(a=d.createSecureServer(c)).on("secureConnection",a=>{a.on("error",a=>{this.trace("An incoming TLS connection closed with error: "+a.message)})})}else a=d.createServer(n);return a.setTimeout(0,r),this._setupHandlers(a),a},q=(a,b,c)=>0===a.length?Promise.resolve({port:b,count:c}):Promise.all(a.map(a=>{let c;this.trace("Attempting to bind "+(0,j.subchannelAddressToString)(a)),c=(0,j.isTcpSubchannelAddress)(a)?{host:a.host,port:b}:a;let d=p();return new Promise((e,f)=>{let g=b=>{this.trace("Failed to bind "+(0,j.subchannelAddressToString)(a)+" with error "+b.message),e(b)};d.once("error",g),d.listen(c,()=>{let a;if(this.shutdown){d.close(),e(Error("bindAsync failed because server is shutdown"));return}let c=d.address();a="string"==typeof c?{path:c}:{host:c.address,port:c.port};let f=(0,l.registerChannelzSocket)((0,j.subchannelAddressToString)(a),()=>({localAddress:a,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(f),this.http2ServerList.push({server:d,channelzRef:f}),this.trace("Successfully bound "+(0,j.subchannelAddressToString)(a)),e("port"in a?a.port:b),d.removeListener("error",g)})})})).then(a=>{let d=0;for(let c of a)if("number"==typeof c&&(d+=1,c!==b))throw Error("Invalid state: multiple port numbers added from single address");return{port:b,count:d+c}}),s=a=>{if(0===a.length)return Promise.resolve({port:0,count:0});let b=a[0],c=p();return new Promise((d,e)=>{let f=c=>{this.trace("Failed to bind "+(0,j.subchannelAddressToString)(b)+" with error "+c.message),d(s(a.slice(1)))};c.once("error",f),c.listen(b,()=>{if(this.shutdown){c.close(),d({port:0,count:0});return}let b=c.address(),e={host:b.address,port:b.port},g=(0,l.registerChannelzSocket)((0,j.subchannelAddressToString)(e),()=>({localAddress:e,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(g),this.http2ServerList.push({server:c,channelzRef:g}),this.trace("Successfully bound "+(0,j.subchannelAddressToString)(e)),d(q(a.slice(1),b.port,1)),c.removeListener("error",f)})})},t={onSuccessfulResolution:(b,c,d)=>{let f;if(t.onSuccessfulResolution=()=>{},this.shutdown&&o(Error("bindAsync failed because server is shutdown"),0),0===b.length)return void o(Error(`No addresses resolved for port ${a}`),0);(f=(0,j.isTcpSubchannelAddress)(b[0])?0===b[0].port?s(b):q(b,b[0].port,0):q(b,1,0)).then(a=>{if(0===a.count){let a=`No address added out of total ${b.length} resolved`;i.log(e.LogVerbosity.ERROR,a),o(Error(a),0)}else a.count<b.length&&i.log(e.LogVerbosity.INFO,`WARNING Only ${a.count} addresses added out of total ${b.length} resolved`),o(null,a.port)},a=>{let c=`No address added out of total ${b.length} resolved`;i.log(e.LogVerbosity.ERROR,c),o(Error(c),0)})},onError:a=>{o(Error(a.details),0)}};(0,h.createResolver)(m,t,this.options).updateResolution()}forceShutdown(){for(let{server:a,channelzRef:b}of this.http2ServerList)a.listening&&a.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(b),(0,l.unregisterChannelzRef)(b))});this.started=!1,this.shutdown=!0,this.sessions.forEach((a,b)=>{b.destroy(d.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,l.unregisterChannelzRef)(this.channelzRef)}register(a,b,c,d,e){return!this.handlers.has(a)&&(this.handlers.set(a,{func:b,serialize:c,deserialize:d,type:e,path:a}),!0)}unregister(a){return this.handlers.delete(a)}start(){if(0===this.http2ServerList.length||this.http2ServerList.every(({server:a})=>!0!==a.listening))throw Error("server must be bound in order to start");if(!0===this.started)throw Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(a){let b=b=>{this.channelzEnabled&&(0,l.unregisterChannelzRef)(this.channelzRef),a(b)},c=0;function d(){0==--c&&b()}for(let{server:a,channelzRef:b}of(this.started=!1,this.shutdown=!0,this.http2ServerList))a.listening&&(c++,a.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(b),(0,l.unregisterChannelzRef)(b)),d()}));this.sessions.forEach((a,b)=>{b.closed||(c+=1,b.close(d))}),0===c&&b()}addHttp2Port(){throw Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(a,b){let c=b[d.constants.HTTP2_HEADER_CONTENT_TYPE];return"string"==typeof c&&!!c.startsWith("application/grpc")||(a.respond({[d.constants.HTTP2_HEADER_STATUS]:d.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1)}_retrieveHandler(a){this.trace("Received call to method "+a+" at address "+this.serverAddressString);let b=this.handlers.get(a);return void 0===b?(this.trace("No handler registered for method "+a+". Sending UNIMPLEMENTED status."),null):b}_respondWithError(a,b,c=null){let d=new f.Http2ServerCallStream(b,null,this.options);void 0===a.code&&(a.code=e.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),null==c||c.streamTracker.addCallFailed()),d.sendError(a)}_channelzHandler(a,b){let c=this.sessions.get(a.session);if(this.callTracker.addCallStarted(),null==c||c.streamTracker.addCallStarted(),!this._verifyContentType(a,b)){this.callTracker.addCallFailed(),null==c||c.streamTracker.addCallFailed();return}let d=b[p],g=this._retrieveHandler(d);if(!g)return void this._respondWithError(s(d),a,c);let h=new f.Http2ServerCallStream(a,g,this.options);h.once("callEnd",a=>{a===e.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),c&&(h.once("streamEnd",a=>{a?c.streamTracker.addCallSucceeded():c.streamTracker.addCallFailed()}),h.on("sendMessage",()=>{c.messagesSent+=1,c.lastMessageSentTimestamp=new Date}),h.on("receiveMessage",()=>{c.messagesReceived+=1,c.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(h,g,b)||(this.callTracker.addCallFailed(),null==c||c.streamTracker.addCallFailed(),h.sendError({code:e.Status.INTERNAL,details:`Unknown handler type: ${g.type}`}))}_streamHandler(a,b){if(!0!==this._verifyContentType(a,b))return;let c=b[p],d=this._retrieveHandler(c);if(!d)return void this._respondWithError(s(c),a,null);let g=new f.Http2ServerCallStream(a,d,this.options);this._runHandlerForCall(g,d,b)||g.sendError({code:e.Status.INTERNAL,details:`Unknown handler type: ${d.type}`})}_runHandlerForCall(a,b,c){var d;let e=a.receiveMetadata(c),f=null!=(d=e.get("grpc-encoding")[0])?d:"identity";e.remove("grpc-encoding");let{type:g}=b;if("unary"===g)v(a,b,e,f);else if("clientStream"===g)w(a,b,e,f);else if("serverStream"===g)x(a,b,e,f);else{if("bidi"!==g)return!1;y(a,b,e,f)}return!0}_setupHandlers(a){if(null===a)return;let b=a.address(),c="null";b&&(c="string"==typeof b?b:b.address+":"+b.port),this.serverAddressString=c;let e=this.channelzEnabled?this._channelzHandler:this._streamHandler;a.on("stream",e.bind(this)),a.on("session",a=>{var b,c,e,f,g;if(!this.started)return void a.destroy();let h=(0,l.registerChannelzSocket)(null!=(b=a.socket.remoteAddress)?b:"unknown",this.getChannelzSessionInfoGetter(a),this.channelzEnabled),i={ref:h,streamTracker:new l.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(a,i);let j=a.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+j),this.sessionChildrenTracker.refChild(h));let k=null,n=null,o=!1;if(this.maxConnectionAgeMs!==m){let b=this.maxConnectionAgeMs/10,f=Math.random()*b*2-b;k=null==(e=(c=setTimeout(()=>{var b,c;o=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+j);try{a.goaway(d.constants.NGHTTP2_NO_ERROR,0x7fffffff,Buffer.from("max_age"))}catch(b){a.destroy();return}a.close(),this.maxConnectionAgeGraceMs!==m&&(n=null==(c=(b=setTimeout(()=>{a.destroy()},this.maxConnectionAgeGraceMs)).unref)?void 0:c.call(b))},this.maxConnectionAgeMs+f)).unref)?void 0:e.call(c)}let p=null==(g=(f=setInterval(()=>{var b,c;let d=null==(c=(b=setTimeout(()=>{o=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+j),a.close()},this.keepaliveTimeoutMs)).unref)?void 0:c.call(b);try{a.ping((a,b,c)=>{clearTimeout(d)})}catch(b){a.destroy()}},this.keepaliveTimeMs)).unref)?void 0:g.call(f);a.on("close",()=>{this.channelzEnabled&&(o||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+j),this.sessionChildrenTracker.unrefChild(h),(0,l.unregisterChannelzRef)(h)),k&&clearTimeout(k),n&&clearTimeout(n),p&&clearTimeout(p),this.sessions.delete(a)})})}}async function v(a,b,c,d){try{let e=await a.receiveUnaryMessage(d);if(void 0===e||a.cancelled)return;let g=new f.ServerUnaryCallImpl(a,c,e);b.func(g,(b,c,d,e)=>{a.sendUnaryMessage(b,c,d,e)})}catch(b){a.sendError(b)}}function w(a,b,c,d){let e=new f.ServerReadableStreamImpl(a,c,b.deserialize,d);function g(b,c,d,f){e.destroy(),a.sendUnaryMessage(b,c,d,f)}a.cancelled||(e.on("error",g),b.func(e,g))}async function x(a,b,c,d){try{let e=await a.receiveUnaryMessage(d);if(void 0===e||a.cancelled)return;let g=new f.ServerWritableStreamImpl(a,c,b.serialize,e);b.func(g)}catch(b){a.sendError(b)}}function y(a,b,c,d){let e=new f.ServerDuplexStreamImpl(a,c,b.serialize,b.deserialize,d);a.cancelled||b.func(e)}b.Server=u},68320:a=>{"use strict";function b(){this._listeners={}}a.exports=b,b.prototype.on=function(a,b,c){return(this._listeners[a]||(this._listeners[a]=[])).push({fn:b,ctx:c||this}),this},b.prototype.off=function(a,b){if(void 0===a)this._listeners={};else if(void 0===b)this._listeners[a]=[];else for(var c=this._listeners[a],d=0;d<c.length;)c[d].fn===b?c.splice(d,1):++d;return this},b.prototype.emit=function(a){var b=this._listeners[a];if(b){for(var c=[],d=1;d<arguments.length;)c.push(arguments[d++]);for(d=0;d<b.length;)b[d].fn.apply(b[d++].ctx,c)}return this}},68968:(a,b,c)=>{"use strict";a.exports=f;var d=c(78915);(f.prototype=Object.create(d.prototype)).constructor=f;var e=c(13884);function f(){d.call(this)}function g(a,b,c){a.length<40?e.utf8.write(a,b,c):b.utf8Write?b.utf8Write(a,c):b.write(a,c)}f._configure=function(){f.alloc=e._Buffer_allocUnsafe,f.writeBytesBuffer=e.Buffer&&e.Buffer.prototype instanceof Uint8Array&&"set"===e.Buffer.prototype.set.name?function(a,b,c){b.set(a,c)}:function(a,b,c){if(a.copy)a.copy(b,c,0,a.length);else for(var d=0;d<a.length;)b[c++]=a[d++]}},f.prototype.bytes=function(a){e.isString(a)&&(a=e._Buffer_from(a,"base64"));var b=a.length>>>0;return this.uint32(b),b&&this._push(f.writeBytesBuffer,b,a),this},f.prototype.string=function(a){var b=e.Buffer.byteLength(a);return this.uint32(b),b&&this._push(g,b,a),this},f._configure()},69602:(a,b,c)=>{"use strict";var d,e;d={value:!0},d=d=b.rS=b.Yi=d=b.Ib=d=d=void 0;let f=c(63766),g=c(96651),h=c(80433),i=c(98296);d=c(88460),d=function(a){return"@type"in a&&"string"==typeof a["@type"]},function(a){a.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",a.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",a.IDEMPOTENT="IDEMPOTENT"}(e=b.Ib||(b.Ib={}));let j={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function k(a,b){return""===a?b:a+"."+b}function l(a){return a instanceof g.Service||a instanceof g.Type||a instanceof g.Enum}function m(a){return a instanceof g.Namespace||a instanceof g.Root}function n(a,b){let c=k(b,a.name);return l(a)?[[c,a]]:m(a)&&void 0!==a.nested?Object.keys(a.nested).map(b=>n(a.nested[b],c)).reduce((a,b)=>a.concat(b),[]):[]}function o(a,b){return function(c){return a.toObject(a.decode(c),b)}}function p(a){return function(b){if(Array.isArray(b))throw Error(`Failed to serialize message: expected object with ${a.name} structure, got array instead`);let c=a.fromObject(b);return a.encode(c).finish()}}function q(a){return(a||[]).reduce((a,b)=>{for(let[c,d]of Object.entries(b))"uninterpreted_option"===c?a.uninterpreted_option.push(b.uninterpreted_option):a[c]=d;return a},{deprecated:!1,idempotency_level:e.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function r(a,b,c,d){let e=a.resolvedRequestType,g=a.resolvedResponseType;return{path:"/"+b+"/"+a.name,requestStream:!!a.requestStream,responseStream:!!a.responseStream,requestSerialize:p(e),requestDeserialize:o(e,c),responseSerialize:p(g),responseDeserialize:o(g,c),originalName:f(a.name),requestType:t(e,d),responseType:t(g,d),options:q(a.parsedOptions)}}function s(a,b,c,d){let e={};for(let f of a.methodsArray)e[f.name]=r(f,b,c,d);return e}function t(a,b){let c=a.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:c.$type.toObject(c,j),fileDescriptorProtos:b}}function u(a,b){let c=a.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:c.$type.toObject(c,j),fileDescriptorProtos:b}}function v(a,b,c,d){if(a instanceof g.Service)return s(a,b,c,d);if(a instanceof g.Type)return t(a,d);if(a instanceof g.Enum)return u(a,d);throw Error("Type mismatch in reflection object handling")}function w(a,b){let c={};a.resolveAll();let d=a.toDescriptor("proto3").file.map(a=>Buffer.from(h.FileDescriptorProto.encode(a).finish()));for(let[e,f]of n(a,""))c[e]=v(f,e,b,d);return c}function x(a,b){b=b||{};let c=g.Root.fromDescriptor(a);return c.resolveAll(),w(c,b)}d=function(a,b){return(0,i.loadProtosWithOptions)(a,b).then(a=>w(a,b))},b.Yi=function(a,b){return w((0,i.loadProtosWithOptionsSync)(a,b),b)},b.rS=function(a,b){b=b||{};let c=g.Root.fromJSON(a);return c.resolveAll(),w(c,b)},d=function(a,b){return x(h.FileDescriptorSet.decode(a),b)},d=function(a,b){return x(h.FileDescriptorSet.fromObject(a),b)},(0,i.addCommonProtos)()},70471:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ResolvingLoadBalancer=void 0;let d=c(4825),e=c(75478),f=c(40249),g=c(66528),h=c(14908),i=c(30422),j=c(77797),k=c(12667),l=c(35433),m=c(77797),n=c(23220),o=c(33371),p="resolving_load_balancer";function q(a){l.trace(m.LogVerbosity.DEBUG,p,a)}let r=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function s(a,b,c,d){for(let e of c.name)switch(d){case"EMPTY":if(!e.service&&!e.method)return!0;break;case"SERVICE":if(e.service===a&&!e.method)return!0;break;case"SERVICE_AND_METHOD":if(e.service===a&&e.method===b)return!0}return!1}function t(a,b,c,d){for(let e of c)if(s(a,b,e,d))return e;return null}function u(a){return function(b,c){var d,e;let f=b.split("/").filter(a=>a.length>0),g=null!=(d=f[0])?d:"",h=null!=(e=f[1])?e:"";if(a&&a.methodConfig)for(let b of r){let c=t(g,h,a.methodConfig,b);if(c)return{methodConfig:c,pickInformation:{},status:j.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:j.Status.OK,dynamicFilterFactories:[]}}}class v{constructor(a,b,c,l,m){this.target=a,this.channelControlHelper=b,this.onSuccessfulResolution=l,this.onFailedResolution=m,this.latestChildState=f.ConnectivityState.IDLE,this.latestChildPicker=new h.QueuePicker(this),this.currentState=f.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,c["grpc.service_config"]?this.defaultServiceConfig=(0,e.validateServiceConfig)(JSON.parse(c["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(f.ConnectivityState.IDLE,new h.QueuePicker(this)),this.childLoadBalancer=new o.ChildLoadBalancerHandler({createSubchannel:b.createSubchannel.bind(b),requestReresolution:()=>{this.backoffTimeout.isRunning()?(q("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,b)=>{this.latestChildState=a,this.latestChildPicker=b,this.updateState(a,b)},addChannelzChild:b.addChannelzChild.bind(b),removeChannelzChild:b.removeChannelzChild.bind(b)}),this.innerResolver=(0,g.createResolver)(a,{onSuccessfulResolution:(a,b,c,e,f)=>{var g;this.backoffTimeout.stop(),this.backoffTimeout.reset();let h=null;null===b?null===c?(this.previousServiceConfig=null,h=this.defaultServiceConfig):null===this.previousServiceConfig?this.handleResolutionFailure(c):h=this.previousServiceConfig:(h=b,this.previousServiceConfig=b);let i=null!=(g=null==h?void 0:h.loadBalancingConfig)?g:[],l=(0,d.getFirstUsableConfig)(i,!0);if(null===l)return void this.handleResolutionFailure({code:j.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new k.Metadata});this.childLoadBalancer.updateAddressList(a,l,f);let m=null!=h?h:this.defaultServiceConfig;this.onSuccessfulResolution(m,null!=e?e:u(m))},onError:a=>{this.handleResolutionFailure(a)}},c);let n={initialDelay:c["grpc.initial_reconnect_backoff_ms"],maxDelay:c["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new i.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},n),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===f.ConnectivityState.IDLE&&this.updateState(f.ConnectivityState.CONNECTING,new h.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(a,b){q((0,n.uriToString)(this.target)+" "+f.ConnectivityState[this.currentState]+" -> "+f.ConnectivityState[a]),a===f.ConnectivityState.IDLE&&(b=new h.QueuePicker(this)),this.currentState=a,this.channelControlHelper.updateState(a,b)}handleResolutionFailure(a){this.latestChildState===f.ConnectivityState.IDLE&&(this.updateState(f.ConnectivityState.TRANSIENT_FAILURE,new h.UnavailablePicker(a)),this.onFailedResolution(a))}exitIdle(){(this.currentState===f.ConnectivityState.IDLE||this.currentState===f.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(a,b){throw Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=f.ConnectivityState.IDLE,this.latestChildPicker=new h.QueuePicker(this),this.currentState=f.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}}b.ResolvingLoadBalancer=v},70484:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.channelOptionsEqual=b.recognizedOptions=void 0,b.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0},b.channelOptionsEqual=function(a,b){let c=Object.keys(a).sort(),d=Object.keys(b).sort();if(c.length!==d.length)return!1;for(let e=0;e<c.length;e+=1)if(c[e]!==d[e]||a[c[e]]!==b[d[e]])return!1;return!0}},73496:a=>{"use strict";a.exports=require("http2")},73533:(a,b,c)=>{"use strict";a.exports=e;var d=c(13884);function e(a,b){this.lo=a>>>0,this.hi=b>>>0}var f=e.zero=new e(0,0);f.toNumber=function(){return 0},f.zzEncode=f.zzDecode=function(){return this},f.length=function(){return 1};var g=e.zeroHash="\0\0\0\0\0\0\0\0";e.fromNumber=function(a){if(0===a)return f;var b=a<0;b&&(a=-a);var c=a>>>0,d=(a-c)/0x100000000>>>0;return b&&(d=~d>>>0,c=~c>>>0,++c>0xffffffff&&(c=0,++d>0xffffffff&&(d=0))),new e(c,d)},e.from=function(a){if("number"==typeof a)return e.fromNumber(a);if(d.isString(a))if(!d.Long)return e.fromNumber(parseInt(a,10));else a=d.Long.fromString(a);return a.low||a.high?new e(a.low>>>0,a.high>>>0):f},e.prototype.toNumber=function(a){if(!a&&this.hi>>>31){var b=~this.lo+1>>>0,c=~this.hi>>>0;return b||(c=c+1>>>0),-(b+0x100000000*c)}return this.lo+0x100000000*this.hi},e.prototype.toLong=function(a){return d.Long?new d.Long(0|this.lo,0|this.hi,!!a):{low:0|this.lo,high:0|this.hi,unsigned:!!a}};var h=String.prototype.charCodeAt;e.fromHash=function(a){return a===g?f:new e((h.call(a,0)|h.call(a,1)<<8|h.call(a,2)<<16|h.call(a,3)<<24)>>>0,(h.call(a,4)|h.call(a,5)<<8|h.call(a,6)<<16|h.call(a,7)<<24)>>>0)},e.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},e.prototype.zzEncode=function(){var a=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^a)>>>0,this.lo=(this.lo<<1^a)>>>0,this},e.prototype.zzDecode=function(){var a=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^a)>>>0,this.hi=(this.hi>>>1^a)>>>0,this},e.prototype.length=function(){var a=this.lo,b=(this.lo>>>28|this.hi<<4)>>>0,c=this.hi>>>24;return 0===c?0===b?a<16384?a<128?1:2:a<2097152?3:4:b<16384?b<128?5:6:b<2097152?7:8:c<128?9:10}},74075:a=>{"use strict";a.exports=require("zlib")},74590:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.stringToSubchannelAddress=b.subchannelAddressToString=b.subchannelAddressEqual=b.isTcpSubchannelAddress=void 0;let d=c(91645);function e(a){return"port"in a}b.isTcpSubchannelAddress=e,b.subchannelAddressEqual=function(a,b){return!a&&!b||!!a&&!!b&&(e(a)?e(b)&&a.host===b.host&&a.port===b.port:!e(b)&&a.path===b.path)},b.subchannelAddressToString=function(a){return e(a)?a.host+":"+a.port:a.path};let f=443;b.stringToSubchannelAddress=function(a,b){return(0,d.isIP)(a)?{host:a,port:null!=b?b:f}:{path:a}}},74981:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.RetryingCall=b.MessageBufferTracker=b.RetryThrottler=void 0;let d=c(77797),e=c(12667),f=c(35433),g="retrying_call";class h{constructor(a,b,c){this.maxTokens=a,this.tokenRatio=b,c?this.tokens=c.tokens*(a/c.maxTokens):this.tokens=a}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}}b.RetryThrottler=h;class i{constructor(a,b){this.totalLimit=a,this.limitPerCall=b,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(a,b){var c;let d=null!=(c=this.allocatedPerCall.get(b))?c:0;return!(this.limitPerCall-d<a)&&!(this.totalLimit-this.totalAllocated<a)&&(this.allocatedPerCall.set(b,d+a),this.totalAllocated+=a,!0)}free(a,b){var c;if(this.totalAllocated<a)throw Error(`Invalid buffer allocation state: call ${b} freed ${a} > total allocated ${this.totalAllocated}`);this.totalAllocated-=a;let d=null!=(c=this.allocatedPerCall.get(b))?c:0;if(d<a)throw Error(`Invalid buffer allocation state: call ${b} freed ${a} > allocated for call ${d}`);this.allocatedPerCall.set(b,d-a)}freeAll(a){var b;let c=null!=(b=this.allocatedPerCall.get(a))?b:0;if(this.totalAllocated<c)throw Error(`Invalid buffer allocation state: call ${a} allocated ${c} > total allocated ${this.totalAllocated}`);this.totalAllocated-=c,this.allocatedPerCall.delete(a)}}b.MessageBufferTracker=i;let j="grpc-previous-rpc-attempts";class k{constructor(a,b,c,d,e,f,g,h,i){if(this.channel=a,this.callConfig=b,this.methodName=c,this.host=d,this.credentials=e,this.deadline=f,this.callNumber=g,this.bufferTracker=h,this.retryThrottler=i,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,b.methodConfig.retryPolicy){this.state="RETRY";let a=b.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(a.initialBackoff.substring(0,a.initialBackoff.length-1))}else b.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(a){f.trace(d.LogVerbosity.DEBUG,g,"["+this.callNumber+"] "+a)}reportStatus(a){this.trace("ended with status: code="+a.code+' details="'+a.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var b;null==(b=this.listener)||b.onReceiveStatus({code:a.code,details:a.details,metadata:a.metadata})})}cancelWithStatus(a,b){for(let{call:c}of(this.trace("cancelWithStatus code: "+a+' details: "'+b+'"'),this.reportStatus({code:a,details:b,metadata:new e.Metadata}),this.underlyingCalls))c.cancelWithStatus(a,b)}getPeer(){return null!==this.committedCallIndex?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(a){var b;return null!=(b=this.writeBuffer[a-this.writeBufferOffset])?b:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if("COMMITTED"!==this.state)return;let a=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let b=this.writeBufferOffset;b<a;b++){let a=this.getBufferEntry(b);a.allocated&&this.bufferTracker.free(a.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(a-this.writeBufferOffset),this.writeBufferOffset=a}commitCall(a){if("COMMITTED"!==this.state&&"COMPLETED"!==this.underlyingCalls[a].state){this.trace("Committing call ["+this.underlyingCalls[a].call.getCallNumber()+"] at index "+a),this.state="COMMITTED",this.committedCallIndex=a;for(let b=0;b<this.underlyingCalls.length;b++)b!==a&&"COMPLETED"!==this.underlyingCalls[b].state&&(this.underlyingCalls[b].state="COMPLETED",this.underlyingCalls[b].call.cancelWithStatus(d.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if("COMMITTED"===this.state)return;let a=-1,b=-1;for(let[c,d]of this.underlyingCalls.entries())"ACTIVE"===d.state&&d.nextMessageToSend>a&&(a=d.nextMessageToSend,b=c);-1===b?this.state="TRANSPARENT_ONLY":this.commitCall(b)}isStatusCodeInList(a,b){return a.some(a=>a===b||a.toString().toLowerCase()===d.Status[b].toLowerCase())}getNextRetryBackoffMs(){var a;let b=null==(a=this.callConfig)?void 0:a.methodConfig.retryPolicy;if(!b)return 0;let c=Math.random()*this.nextRetryBackoffSec*1e3,d=Number(b.maxBackoff.substring(0,b.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*b.backoffMultiplier,d),c}maybeRetryCall(a,b){let c;if("RETRY"!==this.state)return void b(!1);let d=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(d.maxAttempts,5))return void b(!1);if(null===a)c=this.getNextRetryBackoffMs();else if(a<0){this.state="TRANSPARENT_ONLY",b(!1);return}else c=a,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var a,c;if("RETRY"!==this.state)return void b(!1);(null==(c=null==(a=this.retryThrottler)?void 0:a.canRetryCall())||c)&&(b(!0),this.attempts+=1,this.startNewAttempt())},c)}countActiveCalls(){let a=0;for(let b of this.underlyingCalls)(null==b?void 0:b.state)==="ACTIVE"&&(a+=1);return a}handleProcessedStatus(a,b,c){var d,e,f;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(b),this.reportStatus(a);break;case"HEDGING":if(this.isStatusCodeInList(null!=(d=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)?d:[],a.code)){let d;if(null==(e=this.retryThrottler)||e.addCallFailed(),null===c)d=0;else if(c<0){this.state="TRANSPARENT_ONLY",this.commitCall(b),this.reportStatus(a);return}else d=c;setTimeout(()=>{this.maybeStartHedgingAttempt(),0===this.countActiveCalls()&&(this.commitCall(b),this.reportStatus(a))},d)}else this.commitCall(b),this.reportStatus(a);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,a.code)?(null==(f=this.retryThrottler)||f.addCallFailed(),this.maybeRetryCall(c,c=>{c||(this.commitCall(b),this.reportStatus(a))})):(this.commitCall(b),this.reportStatus(a))}}getPushback(a){let b=a.get("grpc-retry-pushback-ms");if(0===b.length)return null;try{return parseInt(b[0])}catch(a){return -1}}handleChildStatus(a,b){var c;if("COMPLETED"===this.underlyingCalls[b].state)return;if(this.trace("state="+this.state+" handling status with progress "+a.progress+" from child ["+this.underlyingCalls[b].call.getCallNumber()+"] in state "+this.underlyingCalls[b].state),this.underlyingCalls[b].state="COMPLETED",a.code===d.Status.OK){null==(c=this.retryThrottler)||c.addCallSucceeded(),this.commitCall(b),this.reportStatus(a);return}if("COMMITTED"===this.state)return void this.reportStatus(a);let e=this.getPushback(a.metadata);switch(a.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(a,b,e):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(b),this.reportStatus(a);break;case"PROCESSED":this.handleProcessedStatus(a,b,e)}}maybeStartHedgingAttempt(){if("HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let a=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(a.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var a,b,c;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),"HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let d=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(d.maxAttempts,5))return;let e=null!=(a=d.hedgingDelay)?a:"0s",f=Number(e.substring(0,e.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},1e3*f),null==(c=(b=this.hedgingTimer).unref)||c.call(b)}startNewAttempt(){let a=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+a.getCallNumber()+"] for attempt "+this.attempts);let b=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:a,nextMessageToSend:0});let c=this.attempts-1,d=this.initialMetadata.clone();c>0&&d.set(j,`${c}`);let e=!1;a.start(d,{onReceiveMetadata:d=>{this.trace("Received metadata from child ["+a.getCallNumber()+"]"),this.commitCall(b),e=!0,c>0&&d.set(j,`${c}`),"ACTIVE"===this.underlyingCalls[b].state&&this.listener.onReceiveMetadata(d)},onReceiveMessage:c=>{this.trace("Received message from child ["+a.getCallNumber()+"]"),this.commitCall(b),"ACTIVE"===this.underlyingCalls[b].state&&this.listener.onReceiveMessage(c)},onReceiveStatus:d=>{this.trace("Received status from child ["+a.getCallNumber()+"]"),!e&&c>0&&d.metadata.set(j,`${c}`),this.handleChildStatus(d,b)}}),this.sendNextChildMessage(b),this.readStarted&&a.startRead()}start(a,b){this.trace("start called"),this.listener=b,this.initialMetadata=a,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(a){var b,c;let d=this.underlyingCalls[a],e=d.nextMessageToSend;null==(c=(b=this.getBufferEntry(e)).callback)||c.call(b),this.clearSentMessages(),d.nextMessageToSend+=1,this.sendNextChildMessage(a)}sendNextChildMessage(a){let b=this.underlyingCalls[a];if("COMPLETED"!==b.state&&this.getBufferEntry(b.nextMessageToSend)){let c=this.getBufferEntry(b.nextMessageToSend);switch(c.entryType){case"MESSAGE":b.call.sendMessageWithContext({callback:b=>{this.handleChildWriteCompleted(a)}},c.message.message);break;case"HALF_CLOSE":b.nextMessageToSend+=1,b.call.halfClose()}}}sendMessageWithContext(a,b){var c;this.trace("write() called with message of length "+b.length);let d={message:b,flags:a.flags},e=this.getNextBufferIndex(),f={entryType:"MESSAGE",message:d,allocated:this.bufferTracker.allocate(b.length,this.callNumber)};if(this.writeBuffer.push(f),f.allocated)for(let[d,f]of(null==(c=a.callback)||c.call(a),this.underlyingCalls.entries()))"ACTIVE"===f.state&&f.nextMessageToSend===e&&f.call.sendMessageWithContext({callback:a=>{this.handleChildWriteCompleted(d)}},b);else{if(this.commitCallWithMostMessages(),null===this.committedCallIndex)return;let c=this.underlyingCalls[this.committedCallIndex];f.callback=a.callback,"ACTIVE"===c.state&&c.nextMessageToSend===e&&c.call.sendMessageWithContext({callback:a=>{this.handleChildWriteCompleted(this.committedCallIndex)}},b)}}startRead(){for(let a of(this.trace("startRead called"),this.readStarted=!0,this.underlyingCalls))(null==a?void 0:a.state)==="ACTIVE"&&a.call.startRead()}halfClose(){this.trace("halfClose called");let a=this.getNextBufferIndex();for(let b of(this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1}),this.underlyingCalls))(null==b?void 0:b.state)==="ACTIVE"&&b.nextMessageToSend===a&&(b.nextMessageToSend+=1,b.call.halfClose())}setCredentials(a){throw Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}}b.RetryingCall=k},75046:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getSubchannelPool=b.SubchannelPool=void 0;let d=c(70484),e=c(98847),f=c(74590),g=c(23220),h=c(87549),i=1e4;class j{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let a=!0;for(let b in this.pool){let c=this.pool[b].filter(a=>!a.subchannel.unrefIfOneRef());c.length>0&&(a=!1),this.pool[b]=c}a&&null!==this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var a,b;null===this.cleanupTimer&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},i),null==(b=(a=this.cleanupTimer).unref)||b.call(a))}getOrCreateSubchannel(a,b,c,i){this.ensureCleanupTask();let j=(0,g.uriToString)(a);if(j in this.pool){for(let a of this.pool[j])if((0,f.subchannelAddressEqual)(b,a.subchannelAddress)&&(0,d.channelOptionsEqual)(c,a.channelArguments)&&i._equals(a.channelCredentials))return a.subchannel}let k=new e.Subchannel(a,b,c,i,new h.Http2SubchannelConnector(a));return j in this.pool||(this.pool[j]=[]),this.pool[j].push({subchannelAddress:b,channelArguments:c,channelCredentials:i,subchannel:k}),k.ref(),k}}b.SubchannelPool=j;let k=new j;b.getSubchannelPool=function(a){return a?k:new j}},75478:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.extractAndSelectServiceConfig=b.validateServiceConfig=b.validateRetryThrottling=void 0;let d=c(21820),e=c(77797),f=c(4825),g=/^\d+(\.\d{1,9})?s$/,h="node";function i(a){if("service"in a&&""!==a.service){if("string"!=typeof a.service)throw Error(`Invalid method config name: invalid service: expected type string, got ${typeof a.service}`);if(!("method"in a)||""===a.method)return{service:a.service};if("string"!=typeof a.method)throw Error(`Invalid method config name: invalid method: expected type string, got ${typeof a.service}`);return{service:a.service,method:a.method}}if("method"in a&&void 0!==a.method)throw Error("Invalid method config name: method set with empty or unset service");return{}}function j(a){if(!("maxAttempts"in a)||!Number.isInteger(a.maxAttempts)||a.maxAttempts<2)throw Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in a)||"string"!=typeof a.initialBackoff||!g.test(a.initialBackoff))throw Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in a)||"string"!=typeof a.maxBackoff||!g.test(a.maxBackoff))throw Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in a)||"number"!=typeof a.backoffMultiplier||a.backoffMultiplier<=0)throw Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in a&&Array.isArray(a.retryableStatusCodes)))throw Error("Invalid method config retry policy: retryableStatusCodes is required");if(0===a.retryableStatusCodes.length)throw Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let b of a.retryableStatusCodes)if("number"==typeof b){if(!Object.values(e.Status).includes(b))throw Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if("string"==typeof b){if(!Object.values(e.Status).includes(b.toUpperCase()))throw Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:a.maxAttempts,initialBackoff:a.initialBackoff,maxBackoff:a.maxBackoff,backoffMultiplier:a.backoffMultiplier,retryableStatusCodes:a.retryableStatusCodes}}function k(a){if(!("maxAttempts"in a)||!Number.isInteger(a.maxAttempts)||a.maxAttempts<2)throw Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in a&&("string"!=typeof a.hedgingDelay||!g.test(a.hedgingDelay)))throw Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in a&&Array.isArray(a.nonFatalStatusCodes))for(let b of a.nonFatalStatusCodes)if("number"==typeof b){if(!Object.values(e.Status).includes(b))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if("string"==typeof b){if(!Object.values(e.Status).includes(b.toUpperCase()))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let b={maxAttempts:a.maxAttempts};return a.hedgingDelay&&(b.hedgingDelay=a.hedgingDelay),a.nonFatalStatusCodes&&(b.nonFatalStatusCodes=a.nonFatalStatusCodes),b}function l(a){var b;let c={name:[]};if(!("name"in a)||!Array.isArray(a.name))throw Error("Invalid method config: invalid name array");for(let b of a.name)c.name.push(i(b));if("waitForReady"in a){if("boolean"!=typeof a.waitForReady)throw Error("Invalid method config: invalid waitForReady");c.waitForReady=a.waitForReady}if("timeout"in a)if("object"==typeof a.timeout){if(!("seconds"in a.timeout)||"number"!=typeof a.timeout.seconds)throw Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in a.timeout)||"number"!=typeof a.timeout.nanos)throw Error("Invalid method config: invalid timeout.nanos");c.timeout=a.timeout}else if("string"==typeof a.timeout&&g.test(a.timeout)){let d=a.timeout.substring(0,a.timeout.length-1).split(".");c.timeout={seconds:0|d[0],nanos:(null!=(b=d[1])?b:0)|0}}else throw Error("Invalid method config: invalid timeout");if("maxRequestBytes"in a){if("number"!=typeof a.maxRequestBytes)throw Error("Invalid method config: invalid maxRequestBytes");c.maxRequestBytes=a.maxRequestBytes}if("maxResponseBytes"in a){if("number"!=typeof a.maxResponseBytes)throw Error("Invalid method config: invalid maxRequestBytes");c.maxResponseBytes=a.maxResponseBytes}if("retryPolicy"in a)if("hedgingPolicy"in a)throw Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");else c.retryPolicy=j(a.retryPolicy);else"hedgingPolicy"in a&&(c.hedgingPolicy=k(a.hedgingPolicy));return c}function m(a){if(!("maxTokens"in a)||"number"!=typeof a.maxTokens||a.maxTokens<=0||a.maxTokens>1e3)throw Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in a)||"number"!=typeof a.tokenRatio||a.tokenRatio<=0)throw Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+a.maxTokens.toFixed(3),tokenRatio:+a.tokenRatio.toFixed(3)}}function n(a){let b={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in a)if("string"==typeof a.loadBalancingPolicy)b.loadBalancingPolicy=a.loadBalancingPolicy;else throw Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in a)if(Array.isArray(a.loadBalancingConfig))for(let c of a.loadBalancingConfig)b.loadBalancingConfig.push((0,f.validateLoadBalancingConfig)(c));else throw Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in a&&Array.isArray(a.methodConfig))for(let c of a.methodConfig)b.methodConfig.push(l(c));"retryThrottling"in a&&(b.retryThrottling=m(a.retryThrottling));let c=[];for(let a of b.methodConfig)for(let b of a.name){for(let a of c)if(b.service===a.service&&b.method===a.method)throw Error(`Invalid service config: duplicate name ${b.service}/${b.method}`);c.push(b)}return b}function o(a){if(!("serviceConfig"in a))throw Error("Invalid service config choice: missing service config");let b={serviceConfig:n(a.serviceConfig)};if("clientLanguage"in a)if(Array.isArray(a.clientLanguage))for(let c of(b.clientLanguage=[],a.clientLanguage))if("string"==typeof c)b.clientLanguage.push(c);else throw Error("Invalid service config choice: invalid clientLanguage");else throw Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in a)if(Array.isArray(a.clientHostname))for(let c of(b.clientHostname=[],a.clientHostname))if("string"==typeof c)b.clientHostname.push(c);else throw Error("Invalid service config choice: invalid clientHostname");else throw Error("Invalid service config choice: invalid clientHostname");if("percentage"in a)if("number"==typeof a.percentage&&0<=a.percentage&&a.percentage<=100)b.percentage=a.percentage;else throw Error("Invalid service config choice: invalid percentage");let c=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let b in a)if(!c.includes(b))throw Error(`Invalid service config choice: unexpected field ${b}`);return b}function p(a,b){if(!Array.isArray(a))throw Error("Invalid service config list");for(let c of a){let a=o(c);if("number"!=typeof a.percentage||!(b>a.percentage)){if(Array.isArray(a.clientHostname)){let b=!1;for(let c of a.clientHostname)c===d.hostname()&&(b=!0);if(!b)continue}if(Array.isArray(a.clientLanguage)){let b=!1;for(let c of a.clientLanguage)c===h&&(b=!0);if(!b)continue}return a.serviceConfig}}throw Error("No matching service config found")}b.validateRetryThrottling=m,b.validateServiceConfig=n,b.extractAndSelectServiceConfig=function(a,b){for(let c of a)if(c.length>0&&c[0].startsWith("grpc_config="))return p(JSON.parse(c.join("").substring(12)),b);return null}},75965:(a,b,c)=>{"use strict";a.exports=h;var d=c(18677);((h.prototype=Object.create(d.prototype)).constructor=h).className="Service";var e=c(24953),f=c(36544),g=c(78757);function h(a,b){d.call(this,a,b),this.methods={},this._methodsArray=null}function i(a){return a._methodsArray=null,a}h.fromJSON=function(a,b){var c=new h(a,b.options);if(b.methods)for(var d=Object.keys(b.methods),f=0;f<d.length;++f)c.add(e.fromJSON(d[f],b.methods[d[f]]));return b.nested&&c.addJSON(b.nested),b.edition&&(c._edition=b.edition),c.comment=b.comment,c._defaultEdition="proto3",c},h.prototype.toJSON=function(a){var b=d.prototype.toJSON.call(this,a),c=!!a&&!!a.keepComments;return f.toObject(["edition",this._editionToJSON(),"options",b&&b.options||void 0,"methods",d.arrayToJSON(this.methodsArray,a)||{},"nested",b&&b.nested||void 0,"comment",c?this.comment:void 0])},Object.defineProperty(h.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=f.toArray(this.methods))}}),h.prototype.get=function(a){return this.methods[a]||d.prototype.get.call(this,a)},h.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;d.prototype.resolve.call(this);for(var a=this.methodsArray,b=0;b<a.length;++b)a[b].resolve();return this},h.prototype._resolveFeaturesRecursive=function(a){return this._needsRecursiveFeatureResolution&&(a=this._edition||a,d.prototype._resolveFeaturesRecursive.call(this,a),this.methodsArray.forEach(b=>{b._resolveFeaturesRecursive(a)})),this},h.prototype.add=function(a){if(this.get(a.name))throw Error("duplicate name '"+a.name+"' in "+this);return a instanceof e?(this.methods[a.name]=a,a.parent=this,i(this)):d.prototype.add.call(this,a)},h.prototype.remove=function(a){if(a instanceof e){if(this.methods[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.methods[a.name],a.parent=null,i(this)}return d.prototype.remove.call(this,a)},h.prototype.create=function(a,b,c){for(var d,e=new g.Service(a,b,c),h=0;h<this.methodsArray.length;++h){var i=f.lcFirst((d=this._methodsArray[h]).resolve().name).replace(/[^$\w_]/g,"");e[i]=f.codegen(["r","c"],f.isReserved(i)?i+"_":i)("return this.rpcCall(m,q,s,r,c)")({m:d,q:d.resolvedRequestType.ctor,s:d.resolvedResponseType.ctor})}return e}},77148:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BaseFilter=void 0;class c{async sendMetadata(a){return a}receiveMetadata(a){return a}async sendMessage(a){return a}async receiveMessage(a){return a}receiveTrailers(a){return a}}b.BaseFilter=c},77797:(a,b)=>{"use strict";var c,d,e;Object.defineProperty(b,"__esModule",{value:!0}),b.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=b.DEFAULT_MAX_SEND_MESSAGE_LENGTH=b.Propagate=b.LogVerbosity=b.Status=void 0,function(a){a[a.OK=0]="OK",a[a.CANCELLED=1]="CANCELLED",a[a.UNKNOWN=2]="UNKNOWN",a[a.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",a[a.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",a[a.NOT_FOUND=5]="NOT_FOUND",a[a.ALREADY_EXISTS=6]="ALREADY_EXISTS",a[a.PERMISSION_DENIED=7]="PERMISSION_DENIED",a[a.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",a[a.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",a[a.ABORTED=10]="ABORTED",a[a.OUT_OF_RANGE=11]="OUT_OF_RANGE",a[a.UNIMPLEMENTED=12]="UNIMPLEMENTED",a[a.INTERNAL=13]="INTERNAL",a[a.UNAVAILABLE=14]="UNAVAILABLE",a[a.DATA_LOSS=15]="DATA_LOSS",a[a.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(c||(b.Status=c={})),function(a){a[a.DEBUG=0]="DEBUG",a[a.INFO=1]="INFO",a[a.ERROR=2]="ERROR",a[a.NONE=3]="NONE"}(d||(b.LogVerbosity=d={})),function(a){a[a.DEADLINE=1]="DEADLINE",a[a.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",a[a.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",a[a.CANCELLATION=8]="CANCELLATION",a[a.DEFAULTS=65535]="DEFAULTS"}(e||(b.Propagate=e={})),b.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1,b.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4194304},77986:a=>{"use strict";a.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Type":{"fields":{"name":{"type":"string","id":1},"fields":{"rule":"repeated","type":"Field","id":2},"oneofs":{"rule":"repeated","type":"string","id":3},"options":{"rule":"repeated","type":"Option","id":4},"sourceContext":{"type":"SourceContext","id":5},"syntax":{"type":"Syntax","id":6}}},"Field":{"fields":{"kind":{"type":"Kind","id":1},"cardinality":{"type":"Cardinality","id":2},"number":{"type":"int32","id":3},"name":{"type":"string","id":4},"typeUrl":{"type":"string","id":6},"oneofIndex":{"type":"int32","id":7},"packed":{"type":"bool","id":8},"options":{"rule":"repeated","type":"Option","id":9},"jsonName":{"type":"string","id":10},"defaultValue":{"type":"string","id":11}},"nested":{"Kind":{"values":{"TYPE_UNKNOWN":0,"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Cardinality":{"values":{"CARDINALITY_UNKNOWN":0,"CARDINALITY_OPTIONAL":1,"CARDINALITY_REQUIRED":2,"CARDINALITY_REPEATED":3}}}},"Enum":{"fields":{"name":{"type":"string","id":1},"enumvalue":{"rule":"repeated","type":"EnumValue","id":2},"options":{"rule":"repeated","type":"Option","id":3},"sourceContext":{"type":"SourceContext","id":4},"syntax":{"type":"Syntax","id":5}}},"EnumValue":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"rule":"repeated","type":"Option","id":3}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}},"Any":{"fields":{"type_url":{"type":"string","id":1},"value":{"type":"bytes","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},78335:()=>{},78397:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getProxiedConnection=b.mapProxyName=void 0;let d=c(35433),e=c(77797),f=c(66528),g=c(81630),h=c(34631),i=c(35433),j=c(74590),k=c(23220),l=c(79551),m=c(53818),n="proxy";function o(a){i.trace(e.LogVerbosity.DEBUG,n,a)}function p(){let a,b="",c="";if(process.env.grpc_proxy)c="grpc_proxy",b=process.env.grpc_proxy;else if(process.env.https_proxy)c="https_proxy",b=process.env.https_proxy;else{if(!process.env.http_proxy)return{};c="http_proxy",b=process.env.http_proxy}try{a=new l.URL(b)}catch(a){return(0,d.log)(e.LogVerbosity.ERROR,`cannot parse value of "${c}" env var`),{}}if("http:"!==a.protocol)return(0,d.log)(e.LogVerbosity.ERROR,`"${a.protocol}" scheme not supported in proxy URI`),{};let f=null;a.username&&(a.password?((0,d.log)(e.LogVerbosity.INFO,"userinfo found in proxy URI"),f=`${a.username}:${a.password}`):f=a.username);let g=a.hostname,h=a.port;""===h&&(h="80");let i={address:`${g}:${h}`};return f&&(i.creds=f),o("Proxy server "+i.address+" set by environment variable "+c),i}function q(){let a=process.env.no_grpc_proxy,b="no_grpc_proxy";return(a||(a=process.env.no_proxy,b="no_proxy"),a)?(o("No proxy server list set by environment variable "+b),a.split(",")):[]}b.mapProxyName=function(a,b){var c;let d={target:a,extraOptions:{}};if((null!=(c=b["grpc.enable_http_proxy"])?c:1)===0||"unix"===a.scheme)return d;let e=p();if(!e.address)return d;let f=(0,k.splitHostPort)(a.path);if(!f)return d;let g=f.host;for(let b of q())if(b===g)return o("Not using proxy for target in no_proxy list: "+(0,k.uriToString)(a)),d;let h={"grpc.http_connect_target":(0,k.uriToString)(a)};return e.creds&&(h["grpc.http_connect_creds"]=e.creds),{target:{scheme:"dns",path:e.address},extraOptions:h}},b.getProxiedConnection=function(a,b,c){var i;if(!("grpc.http_connect_target"in b))return Promise.resolve({});let l=b["grpc.http_connect_target"],n=(0,k.parseUri)(l);if(null===n)return Promise.resolve({});let p=(0,k.splitHostPort)(n.path);if(null===p)return Promise.resolve({});let q=`${p.host}:${null!=(i=p.port)?i:m.DEFAULT_PORT}`,r={method:"CONNECT",path:q},s={Host:q};(0,j.isTcpSubchannelAddress)(a)?(r.host=a.host,r.port=a.port):r.socketPath=a.path,"grpc.http_connect_creds"in b&&(s["Proxy-Authorization"]="Basic "+Buffer.from(b["grpc.http_connect_creds"]).toString("base64")),r.headers=s;let t=(0,j.subchannelAddressToString)(a);return o("Using proxy "+t+" to connect to "+r.path),new Promise((a,b)=>{let i=g.request(r);i.once("connect",(g,j,l)=>{var m;if(i.removeAllListeners(),j.removeAllListeners(),200===g.statusCode)if(o("Successfully connected to "+r.path+" through proxy "+t),"secureContext"in c){let d=(0,f.getDefaultAuthority)(n),e=(0,k.splitHostPort)(d),g=null!=(m=null==e?void 0:e.host)?m:d,i=h.connect(Object.assign({host:g,servername:g,socket:j},c),()=>{o("Successfully established a TLS connection to "+r.path+" through proxy "+t),a({socket:i,realTarget:n})});i.on("error",a=>{o("Failed to establish a TLS connection to "+r.path+" through proxy "+t+" with error "+a.message),b()})}else o("Successfully established a plaintext connection to "+r.path+" through proxy "+t),a({socket:j,realTarget:n});else(0,d.log)(e.LogVerbosity.ERROR,"Failed to connect to "+r.path+" through proxy "+t+" with status "+g.statusCode),b()}),i.once("error",a=>{i.removeAllListeners(),(0,d.log)(e.LogVerbosity.ERROR,"Failed to connect to proxy "+t+" with error "+a.message),b()}),i.end()})}},78757:(a,b,c)=>{"use strict";b.Service=c(39101)},78915:(a,b,c)=>{"use strict";a.exports=l;var d,e=c(13884),f=e.LongBits,g=e.base64,h=e.utf8;function i(a,b,c){this.fn=a,this.len=b,this.next=void 0,this.val=c}function j(){}function k(a){this.head=a.head,this.tail=a.tail,this.len=a.len,this.next=a.states}function l(){this.len=0,this.head=new i(j,0,0),this.tail=this.head,this.states=null}var m=function(){return e.Buffer?function(){return(l.create=function(){return new d})()}:function(){return new l}};function n(a,b,c){b[c]=255&a}function o(a,b,c){for(;a>127;)b[c++]=127&a|128,a>>>=7;b[c]=a}function p(a,b){this.len=a,this.next=void 0,this.val=b}function q(a,b,c){for(;a.hi;)b[c++]=127&a.lo|128,a.lo=(a.lo>>>7|a.hi<<25)>>>0,a.hi>>>=7;for(;a.lo>127;)b[c++]=127&a.lo|128,a.lo=a.lo>>>7;b[c++]=a.lo}function r(a,b,c){b[c]=255&a,b[c+1]=a>>>8&255,b[c+2]=a>>>16&255,b[c+3]=a>>>24}l.create=m(),l.alloc=function(a){return new e.Array(a)},e.Array!==Array&&(l.alloc=e.pool(l.alloc,e.Array.prototype.subarray)),l.prototype._push=function(a,b,c){return this.tail=this.tail.next=new i(a,b,c),this.len+=b,this},p.prototype=Object.create(i.prototype),p.prototype.fn=o,l.prototype.uint32=function(a){return this.len+=(this.tail=this.tail.next=new p((a>>>=0)<128?1:a<16384?2:a<2097152?3:a<0x10000000?4:5,a)).len,this},l.prototype.int32=function(a){return a<0?this._push(q,10,f.fromNumber(a)):this.uint32(a)},l.prototype.sint32=function(a){return this.uint32((a<<1^a>>31)>>>0)},l.prototype.uint64=function(a){var b=f.from(a);return this._push(q,b.length(),b)},l.prototype.int64=l.prototype.uint64,l.prototype.sint64=function(a){var b=f.from(a).zzEncode();return this._push(q,b.length(),b)},l.prototype.bool=function(a){return this._push(n,1,+!!a)},l.prototype.fixed32=function(a){return this._push(r,4,a>>>0)},l.prototype.sfixed32=l.prototype.fixed32,l.prototype.fixed64=function(a){var b=f.from(a);return this._push(r,4,b.lo)._push(r,4,b.hi)},l.prototype.sfixed64=l.prototype.fixed64,l.prototype.float=function(a){return this._push(e.float.writeFloatLE,4,a)},l.prototype.double=function(a){return this._push(e.float.writeDoubleLE,8,a)};var s=e.Array.prototype.set?function(a,b,c){b.set(a,c)}:function(a,b,c){for(var d=0;d<a.length;++d)b[c+d]=a[d]};l.prototype.bytes=function(a){var b=a.length>>>0;if(!b)return this._push(n,1,0);if(e.isString(a)){var c=l.alloc(b=g.length(a));g.decode(a,c,0),a=c}return this.uint32(b)._push(s,b,a)},l.prototype.string=function(a){var b=h.length(a);return b?this.uint32(b)._push(h.write,b,a):this._push(n,1,0)},l.prototype.fork=function(){return this.states=new k(this),this.head=this.tail=new i(j,0,0),this.len=0,this},l.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new i(j,0,0),this.len=0),this},l.prototype.ldelim=function(){var a=this.head,b=this.tail,c=this.len;return this.reset().uint32(c),c&&(this.tail.next=a.next,this.tail=b,this.len+=c),this},l.prototype.finish=function(){for(var a=this.head.next,b=this.constructor.alloc(this.len),c=0;a;)a.fn(a.val,b,c),c+=a.len,a=a.next;return b},l._configure=function(a){d=a,l.create=m(),d._configure()}},79551:a=>{"use strict";a.exports=require("url")},80366:(a,b,c)=>{"use strict";a.exports=g;var d=c(9758);((g.prototype=Object.create(d.prototype)).constructor=g).className="MapField";var e=c(56207),f=c(36544);function g(a,b,c,e,g,h){if(d.call(this,a,b,e,void 0,void 0,g,h),!f.isString(c))throw TypeError("keyType must be a string");this.keyType=c,this.resolvedKeyType=null,this.map=!0}g.fromJSON=function(a,b){return new g(a,b.id,b.keyType,b.type,b.options,b.comment)},g.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return f.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",b?this.comment:void 0])},g.prototype.resolve=function(){if(this.resolved)return this;if(void 0===e.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return d.prototype.resolve.call(this)},g.d=function(a,b,c){return"function"==typeof c?c=f.decorateType(c).name:c&&"object"==typeof c&&(c=f.decorateEnum(c).name),function(d,e){f.decorateType(d.constructor).add(new g(e,a,b,c))}}},80433:(a,b,c)=>{"use strict";var d=c(96651);a.exports=b=d.descriptor=d.Root.fromJSON(c(32003)).lookup(".google.protobuf");var e=d.Namespace,f=d.Root,g=d.Enum,h=d.Type,i=d.Field,j=d.MapField,k=d.OneOf,l=d.Service,m=d.Method;function n(a,c,d){var j=b.FileDescriptorProto.create({name:a.filename||(a.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});E(d,j),a instanceof f||(j.package=a.fullName.substring(1));for(var k,m=0;m<a.nestedArray.length;++m)(k=a._nestedArray[m])instanceof h?j.messageType.push(k.toDescriptor(d)):k instanceof g?j.enumType.push(k.toDescriptor()):k instanceof i?j.extension.push(k.toDescriptor(d)):k instanceof l?j.service.push(k.toDescriptor()):k instanceof e&&n(k,c,d);j.options=A(a.options,b.FileOptions),j.messageType.length+j.enumType.length+j.extension.length+j.service.length&&c.push(j)}f.fromDescriptor=function(a){"number"==typeof a.length&&(a=b.FileDescriptorSet.decode(a));var c=new f;if(a.file)for(var d,e,j,k=0;k<a.file.length;++k){e=c,(d=a.file[k]).package&&d.package.length&&(e=c.define(d.package));var m=D(d);if(d.name&&d.name.length&&c.files.push(e.filename=d.name),d.messageType)for(j=0;j<d.messageType.length;++j)e.add(h.fromDescriptor(d.messageType[j],m));if(d.enumType)for(j=0;j<d.enumType.length;++j)e.add(g.fromDescriptor(d.enumType[j],m));if(d.extension)for(j=0;j<d.extension.length;++j)e.add(i.fromDescriptor(d.extension[j],m));if(d.service)for(j=0;j<d.service.length;++j)e.add(l.fromDescriptor(d.service[j],m));var n=y(d.options,b.FileOptions);if(n){var o=Object.keys(n);for(j=0;j<o.length;++j)e.setOption(o[j],n[o[j]])}}return c.resolveAll()},f.prototype.toDescriptor=function(a){var c=b.FileDescriptorSet.create();return n(this,c.file,a),c};var o=0;h.fromDescriptor=function(a,c,d){"number"==typeof a.length&&(a=b.DescriptorProto.decode(a));var e,f=new h(a.name.length?a.name:"Type"+o++,y(a.options,b.MessageOptions));if(d||(f._edition=c),a.oneofDecl)for(e=0;e<a.oneofDecl.length;++e)f.add(k.fromDescriptor(a.oneofDecl[e]));if(a.field)for(e=0;e<a.field.length;++e){var j=i.fromDescriptor(a.field[e],c,!0);f.add(j),a.field[e].hasOwnProperty("oneofIndex")&&f.oneofsArray[a.field[e].oneofIndex].add(j)}if(a.extension)for(e=0;e<a.extension.length;++e)f.add(i.fromDescriptor(a.extension[e],c,!0));if(a.nestedType)for(e=0;e<a.nestedType.length;++e)f.add(h.fromDescriptor(a.nestedType[e],c,!0)),a.nestedType[e].options&&a.nestedType[e].options.mapEntry&&f.setOption("map_entry",!0);if(a.enumType)for(e=0;e<a.enumType.length;++e)f.add(g.fromDescriptor(a.enumType[e],c,!0));if(a.extensionRange&&a.extensionRange.length)for(e=0,f.extensions=[];e<a.extensionRange.length;++e)f.extensions.push([a.extensionRange[e].start,a.extensionRange[e].end]);if(a.reservedRange&&a.reservedRange.length||a.reservedName&&a.reservedName.length){if(f.reserved=[],a.reservedRange)for(e=0;e<a.reservedRange.length;++e)f.reserved.push([a.reservedRange[e].start,a.reservedRange[e].end]);if(a.reservedName)for(e=0;e<a.reservedName.length;++e)f.reserved.push(a.reservedName[e])}return f},h.prototype.toDescriptor=function(a){var c,d,e=b.DescriptorProto.create({name:this.name});for(d=0;d<this.fieldsArray.length;++d)if(e.field.push(c=this._fieldsArray[d].toDescriptor(a)),this._fieldsArray[d]instanceof j){var f=w(this._fieldsArray[d].keyType,this._fieldsArray[d].resolvedKeyType,!1),k=w(this._fieldsArray[d].type,this._fieldsArray[d].resolvedType,!1),l=11===k||14===k?this._fieldsArray[d].resolvedType&&B(this.parent,this._fieldsArray[d].resolvedType)||this._fieldsArray[d].type:void 0;e.nestedType.push(b.DescriptorProto.create({name:c.typeName,field:[b.FieldDescriptorProto.create({name:"key",number:1,label:1,type:f}),b.FieldDescriptorProto.create({name:"value",number:2,label:1,type:k,typeName:l})],options:b.MessageOptions.create({mapEntry:!0})}))}for(d=0;d<this.oneofsArray.length;++d)e.oneofDecl.push(this._oneofsArray[d].toDescriptor());for(d=0;d<this.nestedArray.length;++d)this._nestedArray[d]instanceof i?e.field.push(this._nestedArray[d].toDescriptor(a)):this._nestedArray[d]instanceof h?e.nestedType.push(this._nestedArray[d].toDescriptor(a)):this._nestedArray[d]instanceof g&&e.enumType.push(this._nestedArray[d].toDescriptor());if(this.extensions)for(d=0;d<this.extensions.length;++d)e.extensionRange.push(b.DescriptorProto.ExtensionRange.create({start:this.extensions[d][0],end:this.extensions[d][1]}));if(this.reserved)for(d=0;d<this.reserved.length;++d)"string"==typeof this.reserved[d]?e.reservedName.push(this.reserved[d]):e.reservedRange.push(b.DescriptorProto.ReservedRange.create({start:this.reserved[d][0],end:this.reserved[d][1]}));return e.options=A(this.options,b.MessageOptions),e};var p=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;i.fromDescriptor=function(a,c,d){if("number"==typeof a.length&&(a=b.DescriptorProto.decode(a)),"number"!=typeof a.number)throw Error("missing field id");switch(e=a.typeName&&a.typeName.length?a.typeName:u(a.type),a.label){case 1:f=void 0;break;case 2:f="required";break;case 3:f="repeated";break;default:throw Error("illegal label: "+a.label)}var e,f,g=a.extendee;void 0!==a.extendee&&(g=g.length?g:void 0);var h=new i(a.name.length?a.name:"field"+a.number,a.number,e,f,g);if(d||(h._edition=c),h.options=y(a.options,b.FieldOptions),a.proto3_optional&&(h.options.proto3_optional=!0),a.defaultValue&&a.defaultValue.length){var j=a.defaultValue;switch(j){case"true":case"TRUE":j=!0;break;case"false":case"FALSE":j=!1;break;default:p.exec(j)&&(j=parseInt(j))}h.setOption("default",j)}return v(a.type)&&("proto3"===c?a.options&&!a.options.packed&&h.setOption("packed",!1):(!c||"proto2"===c)&&a.options&&a.options.packed&&h.setOption("packed",!0)),h},i.prototype.toDescriptor=function(a){var c=b.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)c.type=11,c.typeName=d.util.ucFirst(this.name),c.label=3;else{switch(c.type=w(this.type,this.resolve().resolvedType,this.delimited)){case 10:case 11:case 14:c.typeName=this.resolvedType?B(this.parent,this.resolvedType):this.type}"repeated"===this.rule?c.label=3:this.required&&"proto2"===a?c.label=2:c.label=1}if(c.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(c.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(c.options=A(this.options,b.FieldOptions),null!=this.options.default&&(c.defaultValue=String(this.options.default)),this.options.proto3_optional&&(c.proto3_optional=!0)),"proto3"===a?this.packed||((c.options||(c.options=b.FieldOptions.create())).packed=!1):(!a||"proto2"===a)&&this.packed&&((c.options||(c.options=b.FieldOptions.create())).packed=!0),c};var q=0;g.fromDescriptor=function(a,c,d){"number"==typeof a.length&&(a=b.EnumDescriptorProto.decode(a));var e={};if(a.value)for(var f=0;f<a.value.length;++f){var h=a.value[f].name,i=a.value[f].number||0;e[h&&h.length?h:"NAME"+i]=i}var j=new g(a.name&&a.name.length?a.name:"Enum"+q++,e,y(a.options,b.EnumOptions));return d||(j._edition=c),j},g.prototype.toDescriptor=function(){for(var a=[],c=0,d=Object.keys(this.values);c<d.length;++c)a.push(b.EnumValueDescriptorProto.create({name:d[c],number:this.values[d[c]]}));return b.EnumDescriptorProto.create({name:this.name,value:a,options:A(this.options,b.EnumOptions)})};var r=0;k.fromDescriptor=function(a){return"number"==typeof a.length&&(a=b.OneofDescriptorProto.decode(a)),new k(a.name&&a.name.length?a.name:"oneof"+r++)},k.prototype.toDescriptor=function(){return b.OneofDescriptorProto.create({name:this.name})};var s=0;l.fromDescriptor=function(a,c,d){"number"==typeof a.length&&(a=b.ServiceDescriptorProto.decode(a));var e=new l(a.name&&a.name.length?a.name:"Service"+s++,y(a.options,b.ServiceOptions));if(d||(e._edition=c),a.method)for(var f=0;f<a.method.length;++f)e.add(m.fromDescriptor(a.method[f]));return e},l.prototype.toDescriptor=function(){for(var a=[],c=0;c<this.methodsArray.length;++c)a.push(this._methodsArray[c].toDescriptor());return b.ServiceDescriptorProto.create({name:this.name,method:a,options:A(this.options,b.ServiceOptions)})};var t=0;function u(a){switch(a){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+a)}function v(a){switch(a){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function w(a,b,c){switch(a){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(b instanceof g)return 14;if(b instanceof h)return c?10:11;throw Error("illegal type: "+a)}function x(a,b){for(var c,d,e={},f=0;f<b.fieldsArray.length;++f)if("uninterpretedOption"!==(d=(c=b._fieldsArray[f]).name)&&Object.prototype.hasOwnProperty.call(a,d)){var i=C(d);c.resolvedType instanceof h?e[i]=x(a[d],c.resolvedType):c.resolvedType instanceof g?e[i]=c.resolvedType.valuesById[a[d]]:e[i]=a[d]}return e}function y(a,b){if(a)return x(b.toObject(a),b)}function z(a,b){for(var c={},e=Object.keys(a),f=0;f<e.length;++f){var g=e[f],i=d.util.camelCase(g);if(Object.prototype.hasOwnProperty.call(b.fields,i)){var j=b.fields[i];j.resolvedType instanceof h?c[i]=z(a[g],j.resolvedType):c[i]=a[g],j.repeated&&!Array.isArray(c[i])&&(c[i]=[c[i]])}}return c}function A(a,b){if(a)return b.fromObject(z(a,b))}function B(a,b){var c=a.fullName.split("."),d=b.fullName.split("."),g=0,h=0,i=d.length-1;if(!(a instanceof f)&&b instanceof e)for(;g<c.length&&h<i&&c[g]===d[h];){var j=b.lookup(c[g++],!0);if(null!==j&&j!==b)break;++h}else for(;g<c.length&&h<i&&c[g]===d[h];++g,++h);return d.slice(h).join(".")}function C(a){return a.substring(0,1)+a.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(a,b){return"_"+b.toLowerCase()})}function D(a){if("editions"===a.syntax)if(a.edition===b.Edition.EDITION_2023)return"2023";else throw Error("Unsupported edition "+a.edition);return"proto3"===a.syntax?"proto3":"proto2"}function E(a,c){if(a)if("proto2"===a||"proto3"===a)c.syntax=a;else if(c.syntax="editions","2023"===a)c.edition=b.Edition.EDITION_2023;else throw Error("Unsupported edition "+a)}m.fromDescriptor=function(a){return"number"==typeof a.length&&(a=b.MethodDescriptorProto.decode(a)),new m(a.name&&a.name.length?a.name:"Method"+t++,"rpc",a.inputType,a.outputType,!!a.clientStreaming,!!a.serverStreaming,y(a.options,b.MethodOptions))},m.prototype.toDescriptor=function(){return b.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:A(this.options,b.MethodOptions)})}},81630:a=>{"use strict";a.exports=require("http")},84549:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getDefaultRootsData=b.CIPHER_SUITES=void 0;let d=c(29021);b.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;let e=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,f=null;b.getDefaultRootsData=function(){return e?(null===f&&(f=d.readFileSync(e)),f):null}},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},86723:(a,b,c)=>{"use strict";a.exports=i;var d,e=c(13884),f=e.LongBits,g=e.utf8;function h(a,b){return RangeError("index out of range: "+a.pos+" + "+(b||1)+" > "+a.len)}function i(a){this.buf=a,this.pos=0,this.len=a.length}var j="undefined"!=typeof Uint8Array?function(a){if(a instanceof Uint8Array||Array.isArray(a))return new i(a);throw Error("illegal buffer")}:function(a){if(Array.isArray(a))return new i(a);throw Error("illegal buffer")},k=function(){return e.Buffer?function(a){return(i.create=function(a){return e.Buffer.isBuffer(a)?new d(a):j(a)})(a)}:j};function l(){var a=new f(0,0),b=0;if(this.len-this.pos>4){for(;b<4;++b)if(a.lo=(a.lo|(127&this.buf[this.pos])<<7*b)>>>0,this.buf[this.pos++]<128)return a;if(a.lo=(a.lo|(127&this.buf[this.pos])<<28)>>>0,a.hi=(a.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return a;b=0}else{for(;b<3;++b){if(this.pos>=this.len)throw h(this);if(a.lo=(a.lo|(127&this.buf[this.pos])<<7*b)>>>0,this.buf[this.pos++]<128)return a}return a.lo=(a.lo|(127&this.buf[this.pos++])<<7*b)>>>0,a}if(this.len-this.pos>4){for(;b<5;++b)if(a.hi=(a.hi|(127&this.buf[this.pos])<<7*b+3)>>>0,this.buf[this.pos++]<128)return a}else for(;b<5;++b){if(this.pos>=this.len)throw h(this);if(a.hi=(a.hi|(127&this.buf[this.pos])<<7*b+3)>>>0,this.buf[this.pos++]<128)return a}throw Error("invalid varint encoding")}function m(a,b){return(a[b-4]|a[b-3]<<8|a[b-2]<<16|a[b-1]<<24)>>>0}function n(){if(this.pos+8>this.len)throw h(this,8);return new f(m(this.buf,this.pos+=4),m(this.buf,this.pos+=4))}i.create=k(),i.prototype._slice=e.Array.prototype.subarray||e.Array.prototype.slice,i.prototype.uint32=function(){var a=0xffffffff;return function(){if(a=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(a=(a|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(a=(a|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(a=(a|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(a=(a|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return a;if((this.pos+=5)>this.len)throw this.pos=this.len,h(this,10);return a}}(),i.prototype.int32=function(){return 0|this.uint32()},i.prototype.sint32=function(){var a=this.uint32();return a>>>1^-(1&a)},i.prototype.bool=function(){return 0!==this.uint32()},i.prototype.fixed32=function(){if(this.pos+4>this.len)throw h(this,4);return m(this.buf,this.pos+=4)},i.prototype.sfixed32=function(){if(this.pos+4>this.len)throw h(this,4);return 0|m(this.buf,this.pos+=4)},i.prototype.float=function(){if(this.pos+4>this.len)throw h(this,4);var a=e.float.readFloatLE(this.buf,this.pos);return this.pos+=4,a},i.prototype.double=function(){if(this.pos+8>this.len)throw h(this,4);var a=e.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,a},i.prototype.bytes=function(){var a=this.uint32(),b=this.pos,c=this.pos+a;if(c>this.len)throw h(this,a);if(this.pos+=a,Array.isArray(this.buf))return this.buf.slice(b,c);if(b===c){var d=e.Buffer;return d?d.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,b,c)},i.prototype.string=function(){var a=this.bytes();return g.read(a,0,a.length)},i.prototype.skip=function(a){if("number"==typeof a){if(this.pos+a>this.len)throw h(this,a);this.pos+=a}else do if(this.pos>=this.len)throw h(this);while(128&this.buf[this.pos++]);return this},i.prototype.skipType=function(a){switch(a){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(a=7&this.uint32());)this.skipType(a);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+a+" at offset "+this.pos)}return this},i._configure=function(a){d=a,i.create=k(),d._configure();var b=e.Long?"toLong":"toNumber";e.merge(i.prototype,{int64:function(){return l.call(this)[b](!1)},uint64:function(){return l.call(this)[b](!0)},sint64:function(){return l.call(this).zzDecode()[b](!1)},fixed64:function(){return n.call(this)[b](!0)},sfixed64:function(){return n.call(this)[b](!1)}})}},87549:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Http2SubchannelConnector=void 0;let d=c(73496),e=c(34631),f=c(15981),g=c(77797),h=c(78397),i=c(35433),j=c(66528),k=c(74590),l=c(23220),m=c(91645),n=c(58187),o=c(21306),p="transport",q="transport_flowctrl",r=c(26571).rE,{HTTP2_HEADER_AUTHORITY:s,HTTP2_HEADER_CONTENT_TYPE:t,HTTP2_HEADER_METHOD:u,HTTP2_HEADER_PATH:v,HTTP2_HEADER_TE:w,HTTP2_HEADER_USER_AGENT:x}=d.constants,y=2e4,z=Buffer.from("too_many_pings","ascii");class A{constructor(a,b,c,e){this.session=a,this.options=c,this.remoteName=e,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=y,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new f.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,k.subchannelAddressToString)(b),0===c["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,f.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[c["grpc.primary_user_agent"],`grpc-node-js/${r}`,c["grpc.secondary_user_agent"]].filter(a=>a).join(" "),"grpc.keepalive_time_ms"in c&&(this.keepaliveTimeMs=c["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in c&&(this.keepaliveTimeoutMs=c["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in c?this.keepaliveWithoutCalls=1===c["grpc.keepalive_permit_without_calls"]:this.keepaliveWithoutCalls=!1,a.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),a.once("goaway",(a,b,c)=>{let e=!1;a===d.constants.NGHTTP2_ENHANCE_YOUR_CALM&&c&&c.equals(z)&&(e=!0),this.trace("connection closed by GOAWAY with code "+a+" and data "+(null==c?void 0:c.toString())),this.reportDisconnectToOwner(e)}),a.once("error",a=>{this.trace("connection closed with error "+a.message)}),i.isTracerEnabled(p)&&(a.on("remoteSettings",b=>{this.trace("new settings received"+(this.session!==a?" on the old connection":"")+": "+JSON.stringify(b))}),a.on("localSettings",b=>{this.trace("local settings acknowledged by remote"+(this.session!==a?" on the old connection":"")+": "+JSON.stringify(b))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var a,b,c;let d,e=this.session.socket,f=e.remoteAddress?(0,k.stringToSubchannelAddress)(e.remoteAddress,e.remotePort):null,g=e.localAddress?(0,k.stringToSubchannelAddress)(e.localAddress,e.localPort):null;if(this.session.encrypted){let b=e,c=b.getCipher(),f=b.getCertificate(),g=b.getPeerCertificate();d={cipherSuiteStandardName:null!=(a=c.standardName)?a:null,cipherSuiteOtherName:c.standardName?null:c.name,localCertificate:f&&"raw"in f?f.raw:null,remoteCertificate:g&&"raw"in g?g.raw:null}}else d=null;return{remoteAddress:f,localAddress:g,security:d,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:null!=(b=this.session.state.localWindowSize)?b:null,remoteFlowControlWindow:null!=(c=this.session.state.remoteWindowSize)?c:null}}trace(a){i.trace(g.LogVerbosity.DEBUG,p,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}keepaliveTrace(a){i.trace(g.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}flowControlTrace(a){i.trace(g.LogVerbosity.DEBUG,q,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}internalsTrace(a){i.trace(g.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}reportDisconnectToOwner(a){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(b=>b(a)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let a of this.activeCalls)a.onDisconnect()})}addDisconnectListener(a){this.disconnectListeners.push(a)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var a,b;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),null==(b=(a=this.keepaliveTimeoutId).unref)||b.call(a));try{this.session.ping((a,b,c)=>{a&&(this.keepaliveTrace("Ping failed with error "+a.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch(a){this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var a,b;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):this.keepaliveTimerId||this.keepaliveTimeoutId||(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=null==(b=(a=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)?void 0:b.call(a)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(a){this.activeCalls.delete(a),0===this.activeCalls.size&&this.session.unref()}addActiveCall(a){this.activeCalls.add(a),1===this.activeCalls.size&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(a,b,c,d,e){let f,g,h,i=a.toHttp2Headers();i[s]=b,i[x]=this.userAgent,i[t]="application/grpc",i[u]="POST",i[v]=c,i[w]="trailers";try{f=this.session.request(i)}catch(a){throw this.handleDisconnect(),a}return this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed),this.channelzEnabled?(this.streamTracker.addCallStarted(),g={addMessageSent:()=>{var a;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,null==(a=e.addMessageSent)||a.call(e)},addMessageReceived:()=>{var a;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,null==(a=e.addMessageReceived)||a.call(e)},onCallEnd:a=>{var b;null==(b=e.onCallEnd)||b.call(e,a),this.removeActiveCall(h)},onStreamEnd:a=>{var b;a?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),null==(b=e.onStreamEnd)||b.call(e,a)}}):g={addMessageSent:()=>{var a;null==(a=e.addMessageSent)||a.call(e)},addMessageReceived:()=>{var a;null==(a=e.addMessageReceived)||a.call(e)},onCallEnd:a=>{var b;null==(b=e.onCallEnd)||b.call(e,a),this.removeActiveCall(h)},onStreamEnd:a=>{var b;null==(b=e.onStreamEnd)||b.call(e,a)}},h=new n.Http2SubchannelCall(f,g,d,this,(0,o.getNextCallNumber)()),this.addActiveCall(h),h}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,f.unregisterChannelzRef)(this.channelzRef)}}class B{constructor(a){this.channelTarget=a,this.session=null,this.isShutdown=!1}trace(a){i.trace(g.LogVerbosity.DEBUG,p,(0,l.uriToString)(this.channelTarget)+" "+a)}createSession(a,b,c,f){return this.isShutdown?Promise.reject():new Promise((g,h)=>{var i,n,o;let p;f.realTarget?(p=(0,l.uriToString)(f.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,l.uriToString)(f.realTarget))):(p=null,this.trace("creating HTTP/2 session to "+(0,k.subchannelAddressToString)(a)));let q=(0,j.getDefaultAuthority)(null!=(i=f.realTarget)?i:this.channelTarget),r=b._getConnectionOptions()||{};r.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in c?r.maxSessionMemory=c["grpc-node.max_session_memory"]:r.maxSessionMemory=Number.MAX_SAFE_INTEGER;let s="http://";if("secureContext"in r){if(s="https://",c["grpc.ssl_target_name_override"]){let a=c["grpc.ssl_target_name_override"];r.checkServerIdentity=(b,c)=>(0,e.checkServerIdentity)(a,c),r.servername=a}else{let a=null!=(o=null==(n=(0,l.splitHostPort)(q))?void 0:n.host)?o:"localhost";r.servername=a}f.socket&&(r.createConnection=(a,b)=>f.socket)}else r.createConnection=(b,c)=>f.socket?f.socket:m.connect(a);r=Object.assign(Object.assign(Object.assign({},r),a),{enableTrace:1===c["grpc-node.tls_enable_trace"]});let t=d.connect(s+q,r);this.session=t;let u="Failed to connect";t.unref(),t.once("connect",()=>{t.removeAllListeners(),g(new A(t,a,c,p)),this.session=null}),t.once("close",()=>{this.session=null,setImmediate(()=>{h(`${u} (${new Date().toISOString()})`)})}),t.once("error",a=>{u=a.message,this.trace("connection failed with error "+u)})})}connect(a,b,c){var d,f;if(this.isShutdown)return Promise.reject();let g=b._getConnectionOptions()||{};if("secureContext"in g){if(g.ALPNProtocols=["h2"],c["grpc.ssl_target_name_override"]){let a=c["grpc.ssl_target_name_override"];g.checkServerIdentity=(b,c)=>(0,e.checkServerIdentity)(a,c),g.servername=a}else if("grpc.http_connect_target"in c){let a=(0,j.getDefaultAuthority)(null!=(d=(0,l.parseUri)(c["grpc.http_connect_target"]))?d:{path:"localhost"}),b=(0,l.splitHostPort)(a);g.servername=null!=(f=null==b?void 0:b.host)?f:a}c["grpc-node.tls_enable_trace"]&&(g.enableTrace=!0)}return(0,h.getProxiedConnection)(a,c,g).then(d=>this.createSession(a,b,c,d))}shutdown(){var a;this.isShutdown=!0,null==(a=this.session)||a.close(),this.session=null}}b.Http2SubchannelConnector=B},87973:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BaseSubchannelWrapper=void 0;class c{constructor(a){this.child=a}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(a){this.child.addConnectivityStateListener(a)}removeConnectivityStateListener(a){this.child.removeConnectivityStateListener(a)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(a){this.child.throttleKeepalive(a)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(a){return this.getRealSubchannel()===a.getRealSubchannel()}}b.BaseSubchannelWrapper=c},88460:function(a,b){var c;!function(d,e){function f(a){return a.default||a}void 0===(c=(function(){var a={};return e(a),f(a)}).apply(b,[]))||(a.exports=c)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var b=null;try{b=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function c(a,b,c){this.low=0|a,this.high=0|b,this.unsigned=!!c}function d(a){return!0===(a&&a.__isLong__)}function e(a){var b=Math.clz32(a&-a);return a?31-b:b}c.prototype.__isLong__,Object.defineProperty(c.prototype,"__isLong__",{value:!0}),c.isLong=d;var f={},g={};function h(a,b){var c,d,e;if(b)return(a>>>=0,(e=0<=a&&a<256)&&(d=g[a]))?d:(c=j(a,0,!0),e&&(g[a]=c),c);return(a|=0,(e=-128<=a&&a<128)&&(d=f[a]))?d:(c=j(a,a<0?-1:0,!1),e&&(f[a]=c),c)}function i(a,b){if(isNaN(a))return b?s:r;if(b){if(a<0)return s;if(a>=o)return x}else{if(a<=-p)return y;if(a+1>=p)return w}return a<0?i(-a,b).neg():j(a%n|0,a/n|0,b)}function j(a,b,d){return new c(a,b,d)}c.fromInt=h,c.fromNumber=i,c.fromBits=j;var k=Math.pow;function l(a,b,c){if(0===a.length)throw Error("empty string");if("number"==typeof b?(c=b,b=!1):b=!!b,"NaN"===a||"Infinity"===a||"+Infinity"===a||"-Infinity"===a)return b?s:r;if((c=c||10)<2||36<c)throw RangeError("radix");if((d=a.indexOf("-"))>0)throw Error("interior hyphen");if(0===d)return l(a.substring(1),b,c).neg();for(var d,e=i(k(c,8)),f=r,g=0;g<a.length;g+=8){var h=Math.min(8,a.length-g),j=parseInt(a.substring(g,g+h),c);if(h<8){var m=i(k(c,h));f=f.mul(m).add(i(j))}else f=(f=f.mul(e)).add(i(j))}return f.unsigned=b,f}function m(a,b){return"number"==typeof a?i(a,b):"string"==typeof a?l(a,b):j(a.low,a.high,"boolean"==typeof b?b:a.unsigned)}c.fromString=l,c.fromValue=m;var n=0x100000000,o=0xffffffffffffffff,p=0x8000000000000000,q=h(0x1000000),r=h(0);c.ZERO=r;var s=h(0,!0);c.UZERO=s;var t=h(1);c.ONE=t;var u=h(1,!0);c.UONE=u;var v=h(-1);c.NEG_ONE=v;var w=j(-1,0x7fffffff,!1);c.MAX_VALUE=w;var x=j(-1,-1,!0);c.MAX_UNSIGNED_VALUE=x;var y=j(0,-0x80000000,!1);c.MIN_VALUE=y;var z=c.prototype;z.toInt=function(){return this.unsigned?this.low>>>0:this.low},z.toNumber=function(){return this.unsigned?(this.high>>>0)*n+(this.low>>>0):this.high*n+(this.low>>>0)},z.toString=function(a){if((a=a||10)<2||36<a)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(!this.eq(y))return"-"+this.neg().toString(a);else{var b=i(a),c=this.div(b),d=c.mul(b).sub(this);return c.toString(a)+d.toInt().toString(a)}for(var e=i(k(a,6),this.unsigned),f=this,g="";;){var h=f.div(e),j=(f.sub(h.mul(e)).toInt()>>>0).toString(a);if((f=h).isZero())return j+g;for(;j.length<6;)j="0"+j;g=""+j+g}},z.getHighBits=function(){return this.high},z.getHighBitsUnsigned=function(){return this.high>>>0},z.getLowBits=function(){return this.low},z.getLowBitsUnsigned=function(){return this.low>>>0},z.getNumBitsAbs=function(){if(this.isNegative())return this.eq(y)?64:this.neg().getNumBitsAbs();for(var a=0!=this.high?this.high:this.low,b=31;b>0&&(a&1<<b)==0;b--);return 0!=this.high?b+33:b+1},z.isSafeInteger=function(){var a=this.high>>21;return!a||!this.unsigned&&-1===a&&(0!==this.low||-2097152!==this.high)},z.isZero=function(){return 0===this.high&&0===this.low},z.eqz=z.isZero,z.isNegative=function(){return!this.unsigned&&this.high<0},z.isPositive=function(){return this.unsigned||this.high>=0},z.isOdd=function(){return(1&this.low)==1},z.isEven=function(){return(1&this.low)==0},z.equals=function(a){return d(a)||(a=m(a)),(this.unsigned===a.unsigned||this.high>>>31!=1||a.high>>>31!=1)&&this.high===a.high&&this.low===a.low},z.eq=z.equals,z.notEquals=function(a){return!this.eq(a)},z.neq=z.notEquals,z.ne=z.notEquals,z.lessThan=function(a){return 0>this.comp(a)},z.lt=z.lessThan,z.lessThanOrEqual=function(a){return 0>=this.comp(a)},z.lte=z.lessThanOrEqual,z.le=z.lessThanOrEqual,z.greaterThan=function(a){return this.comp(a)>0},z.gt=z.greaterThan,z.greaterThanOrEqual=function(a){return this.comp(a)>=0},z.gte=z.greaterThanOrEqual,z.ge=z.greaterThanOrEqual,z.compare=function(a){if(d(a)||(a=m(a)),this.eq(a))return 0;var b=this.isNegative(),c=a.isNegative();return b&&!c?-1:!b&&c?1:this.unsigned?a.high>>>0>this.high>>>0||a.high===this.high&&a.low>>>0>this.low>>>0?-1:1:this.sub(a).isNegative()?-1:1},z.comp=z.compare,z.negate=function(){return!this.unsigned&&this.eq(y)?y:this.not().add(t)},z.neg=z.negate,z.add=function(a){d(a)||(a=m(a));var b,c,e=this.high>>>16,f=65535&this.high,g=this.low>>>16,h=65535&this.low,i=a.high>>>16,k=65535&a.high,l=a.low>>>16,n=65535&a.low,o=0,p=0;return b=0+((c=0+(h+n))>>>16),c&=65535,b+=g+l,p+=b>>>16,b&=65535,p+=f+k,o+=p>>>16,p&=65535,o+=e+i,j(b<<16|c,(o&=65535)<<16|p,this.unsigned)},z.subtract=function(a){return d(a)||(a=m(a)),this.add(a.neg())},z.sub=z.subtract,z.multiply=function(a){if(this.isZero())return this;if(d(a)||(a=m(a)),b)return j(b.mul(this.low,this.high,a.low,a.high),b.get_high(),this.unsigned);if(a.isZero())return this.unsigned?s:r;if(this.eq(y))return a.isOdd()?y:r;if(a.eq(y))return this.isOdd()?y:r;if(this.isNegative())if(a.isNegative())return this.neg().mul(a.neg());else return this.neg().mul(a).neg();if(a.isNegative())return this.mul(a.neg()).neg();if(this.lt(q)&&a.lt(q))return i(this.toNumber()*a.toNumber(),this.unsigned);var c,e,f=this.high>>>16,g=65535&this.high,h=this.low>>>16,k=65535&this.low,l=a.high>>>16,n=65535&a.high,o=a.low>>>16,p=65535&a.low,t=0,u=0;return c=0+((e=0+k*p)>>>16),e&=65535,c+=h*p,u+=c>>>16,c&=65535,c+=k*o,u+=c>>>16,c&=65535,u+=g*p,t+=u>>>16,u&=65535,u+=h*o,t+=u>>>16,u&=65535,u+=k*n,t+=u>>>16,u&=65535,t+=f*p+g*o+h*n+k*l,j(c<<16|e,(t&=65535)<<16|u,this.unsigned)},z.mul=z.multiply,z.divide=function(a){if(d(a)||(a=m(a)),a.isZero())throw Error("division by zero");if(b){var c,e,f;return this.unsigned||-0x80000000!==this.high||-1!==a.low||-1!==a.high?j((this.unsigned?b.div_u:b.div_s)(this.low,this.high,a.low,a.high),b.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?s:r;if(this.unsigned){if(a.unsigned||(a=a.toUnsigned()),a.gt(this))return s;if(a.gt(this.shru(1)))return u;f=s}else{if(this.eq(y))if(a.eq(t)||a.eq(v))return y;else return a.eq(y)?t:(c=this.shr(1).div(a).shl(1)).eq(r)?a.isNegative()?t:v:(e=this.sub(a.mul(c)),f=c.add(e.div(a)));if(a.eq(y))return this.unsigned?s:r;if(this.isNegative())return a.isNegative()?this.neg().div(a.neg()):this.neg().div(a).neg();if(a.isNegative())return this.div(a.neg()).neg();f=r}for(e=this;e.gte(a);){for(var g=Math.ceil(Math.log(c=Math.max(1,Math.floor(e.toNumber()/a.toNumber())))/Math.LN2),h=g<=48?1:k(2,g-48),l=i(c),n=l.mul(a);n.isNegative()||n.gt(e);)c-=h,n=(l=i(c,this.unsigned)).mul(a);l.isZero()&&(l=t),f=f.add(l),e=e.sub(n)}return f},z.div=z.divide,z.modulo=function(a){return(d(a)||(a=m(a)),b)?j((this.unsigned?b.rem_u:b.rem_s)(this.low,this.high,a.low,a.high),b.get_high(),this.unsigned):this.sub(this.div(a).mul(a))},z.mod=z.modulo,z.rem=z.modulo,z.not=function(){return j(~this.low,~this.high,this.unsigned)},z.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},z.clz=z.countLeadingZeros,z.countTrailingZeros=function(){return this.low?e(this.low):e(this.high)+32},z.ctz=z.countTrailingZeros,z.and=function(a){return d(a)||(a=m(a)),j(this.low&a.low,this.high&a.high,this.unsigned)},z.or=function(a){return d(a)||(a=m(a)),j(this.low|a.low,this.high|a.high,this.unsigned)},z.xor=function(a){return d(a)||(a=m(a)),j(this.low^a.low,this.high^a.high,this.unsigned)},z.shiftLeft=function(a){return(d(a)&&(a=a.toInt()),0==(a&=63))?this:a<32?j(this.low<<a,this.high<<a|this.low>>>32-a,this.unsigned):j(0,this.low<<a-32,this.unsigned)},z.shl=z.shiftLeft,z.shiftRight=function(a){return(d(a)&&(a=a.toInt()),0==(a&=63))?this:a<32?j(this.low>>>a|this.high<<32-a,this.high>>a,this.unsigned):j(this.high>>a-32,this.high>=0?0:-1,this.unsigned)},z.shr=z.shiftRight,z.shiftRightUnsigned=function(a){return(d(a)&&(a=a.toInt()),0==(a&=63))?this:a<32?j(this.low>>>a|this.high<<32-a,this.high>>>a,this.unsigned):32===a?j(this.high,0,this.unsigned):j(this.high>>>a-32,0,this.unsigned)},z.shru=z.shiftRightUnsigned,z.shr_u=z.shiftRightUnsigned,z.rotateLeft=function(a){var b;return(d(a)&&(a=a.toInt()),0==(a&=63))?this:32===a?j(this.high,this.low,this.unsigned):a<32?(b=32-a,j(this.low<<a|this.high>>>b,this.high<<a|this.low>>>b,this.unsigned)):(a-=32,b=32-a,j(this.high<<a|this.low>>>b,this.low<<a|this.high>>>b,this.unsigned))},z.rotl=z.rotateLeft,z.rotateRight=function(a){var b;return(d(a)&&(a=a.toInt()),0==(a&=63))?this:32===a?j(this.high,this.low,this.unsigned):a<32?(b=32-a,j(this.high<<b|this.low>>>a,this.low<<b|this.high>>>a,this.unsigned)):(a-=32,b=32-a,j(this.low<<b|this.high>>>a,this.high<<b|this.low>>>a,this.unsigned))},z.rotr=z.rotateRight,z.toSigned=function(){return this.unsigned?j(this.low,this.high,!1):this},z.toUnsigned=function(){return this.unsigned?this:j(this.low,this.high,!0)},z.toBytes=function(a){return a?this.toBytesLE():this.toBytesBE()},z.toBytesLE=function(){var a=this.high,b=this.low;return[255&b,b>>>8&255,b>>>16&255,b>>>24,255&a,a>>>8&255,a>>>16&255,a>>>24]},z.toBytesBE=function(){var a=this.high,b=this.low;return[a>>>24,a>>>16&255,a>>>8&255,255&a,b>>>24,b>>>16&255,b>>>8&255,255&b]},c.fromBytes=function(a,b,d){return d?c.fromBytesLE(a,b):c.fromBytesBE(a,b)},c.fromBytesLE=function(a,b){return new c(a[0]|a[1]<<8|a[2]<<16|a[3]<<24,a[4]|a[5]<<8|a[6]<<16|a[7]<<24,b)},c.fromBytesBE=function(a,b){return new c(a[4]<<24|a[5]<<16|a[6]<<8|a[7],a[0]<<24|a[1]<<16|a[2]<<8|a[3],b)},"function"==typeof BigInt&&(c.fromBigInt=function(a,b){return j(Number(BigInt.asIntN(32,a)),Number(BigInt.asIntN(32,a>>BigInt(32))),b)},c.fromValue=function(a,b){return"bigint"==typeof a?c.fromBigInt(a,b):m(a,b)},z.toBigInt=function(){var a=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|a}),a.default=c})},89293:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.CompressionFilterFactory=b.CompressionFilter=void 0;let d=c(74075),e=c(45069),f=c(77797),g=c(77148),h=c(35433),i=a=>"number"==typeof a&&"string"==typeof e.CompressionAlgorithms[a];class j{async writeMessage(a,b){let c=a;b&&(c=await this.compressMessage(c));let d=Buffer.allocUnsafe(c.length+5);return d.writeUInt8(+!!b,0),d.writeUInt32BE(c.length,1),c.copy(d,5),d}async readMessage(a){let b=1===a.readUInt8(0),c=a.slice(5);return b&&(c=await this.decompressMessage(c)),c}}class k extends j{async compressMessage(a){return a}async writeMessage(a,b){let c=Buffer.allocUnsafe(a.length+5);return c.writeUInt8(0,0),c.writeUInt32BE(a.length,1),a.copy(c,5),c}decompressMessage(a){return Promise.reject(Error('Received compressed message but "grpc-encoding" header was identity'))}}class l extends j{constructor(a){super(),this.maxRecvMessageLength=a}compressMessage(a){return new Promise((b,c)=>{d.deflate(a,(a,d)=>{a?c(a):b(d)})})}decompressMessage(a){return new Promise((b,c)=>{let e=0,g=[],h=d.createInflate();h.on("data",a=>{g.push(a),e+=a.byteLength,-1!==this.maxRecvMessageLength&&e>this.maxRecvMessageLength&&(h.destroy(),c({code:f.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),h.on("end",()=>{b(Buffer.concat(g))}),h.write(a),h.end()})}}class m extends j{constructor(a){super(),this.maxRecvMessageLength=a}compressMessage(a){return new Promise((b,c)=>{d.gzip(a,(a,d)=>{a?c(a):b(d)})})}decompressMessage(a){return new Promise((b,c)=>{let e=0,g=[],h=d.createGunzip();h.on("data",a=>{g.push(a),e+=a.byteLength,-1!==this.maxRecvMessageLength&&e>this.maxRecvMessageLength&&(h.destroy(),c({code:f.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),h.on("end",()=>{b(Buffer.concat(g))}),h.write(a),h.end()})}}class n extends j{constructor(a){super(),this.compressionName=a}compressMessage(a){return Promise.reject(Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(a){return Promise.reject(Error(`Compression method not supported: ${this.compressionName}`))}}function o(a,b){switch(a){case"identity":return new k;case"deflate":return new l(b);case"gzip":return new m(b);default:return new n(a)}}class p extends g.BaseFilter{constructor(a,b){var c,d;super(),this.sharedFilterConfig=b,this.sendCompression=new k,this.receiveCompression=new k,this.currentCompressionAlgorithm="identity";let g=a["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=null!=(c=a["grpc.max_receive_message_length"])?c:f.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,void 0!==g)if(i(g)){let a=e.CompressionAlgorithms[g],c=null==(d=b.serverSupportedEncodingHeader)?void 0:d.split(",");(!c||c.includes(a))&&(this.currentCompressionAlgorithm=a,this.sendCompression=o(this.currentCompressionAlgorithm,-1))}else h.log(f.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${g}`)}async sendMetadata(a){let b=await a;return b.set("grpc-accept-encoding","identity,deflate,gzip"),b.set("accept-encoding","identity"),"identity"===this.currentCompressionAlgorithm?b.remove("grpc-encoding"):b.set("grpc-encoding",this.currentCompressionAlgorithm),b}receiveMetadata(a){let b=a.get("grpc-encoding");if(b.length>0){let a=b[0];"string"==typeof a&&(this.receiveCompression=o(a,this.maxReceiveMessageLength))}a.remove("grpc-encoding");let c=a.get("grpc-accept-encoding")[0];return c&&(this.sharedFilterConfig.serverSupportedEncodingHeader=c,c.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new k,this.currentCompressionAlgorithm="identity")),a.remove("grpc-accept-encoding"),a}async sendMessage(a){var b;let c,d=await a;return c=!(this.sendCompression instanceof k)&&((null!=(b=d.flags)?b:0)&2)==0,{message:await this.sendCompression.writeMessage(d.message,c),flags:d.flags}}async receiveMessage(a){return this.receiveCompression.readMessage(await a)}}b.CompressionFilter=p;class q{constructor(a,b){this.options=b,this.sharedFilterConfig={}}createFilter(){return new p(this.options,this.sharedFilterConfig)}}b.CompressionFilterFactory=q},90145:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.restrictControlPlaneStatusCode=void 0;let d=c(77797),e=[d.Status.OK,d.Status.INVALID_ARGUMENT,d.Status.NOT_FOUND,d.Status.ALREADY_EXISTS,d.Status.FAILED_PRECONDITION,d.Status.ABORTED,d.Status.OUT_OF_RANGE,d.Status.DATA_LOSS];b.restrictControlPlaneStatusCode=function(a,b){return e.includes(a)?{code:d.Status.INTERNAL,details:`Invalid status from control plane: ${a} ${d.Status[a]} ${b}`}:{code:a,details:b}}},91645:a=>{"use strict";a.exports=require("net")},91713:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.FilterStackFactory=b.FilterStack=void 0;class c{constructor(a){this.filters=a}sendMetadata(a){let b=a;for(let a=0;a<this.filters.length;a++)b=this.filters[a].sendMetadata(b);return b}receiveMetadata(a){let b=a;for(let a=this.filters.length-1;a>=0;a--)b=this.filters[a].receiveMetadata(b);return b}sendMessage(a){let b=a;for(let a=0;a<this.filters.length;a++)b=this.filters[a].sendMessage(b);return b}receiveMessage(a){let b=a;for(let a=this.filters.length-1;a>=0;a--)b=this.filters[a].receiveMessage(b);return b}receiveTrailers(a){let b=a;for(let a=this.filters.length-1;a>=0;a--)b=this.filters[a].receiveTrailers(b);return b}push(a){this.filters.unshift(...a)}getFilters(){return this.filters}}b.FilterStack=c;class d{constructor(a){this.factories=a}push(a){this.factories.unshift(...a)}clone(){return new d([...this.factories])}createFilter(){return new c(this.factories.map(a=>a.createFilter()))}}b.FilterStackFactory=d},92072:(a,b,c)=>{"use strict";a.exports=l;var d,e,f,g=c(18677);((l.prototype=Object.create(g.prototype)).constructor=l).className="Root";var h=c(9758),i=c(60081),j=c(10059),k=c(36544);function l(a){g.call(this,"",a),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}function m(){}l.fromJSON=function(a,b){return b||(b=new l),a.options&&b.setOptions(a.options),b.addJSON(a.nested).resolveAll()},l.prototype.resolvePath=k.path.resolve,l.prototype.fetch=k.fetch,l.prototype.load=function a(b,c,d){"function"==typeof c&&(d=c,c=void 0);var g=this;if(!d)return k.asPromise(a,g,b,c);var h=d===m;function i(a,b){if(d){if(h)throw a;b&&b.resolveAll();var c=d;d=null,c(a,b)}}function j(a){var b=a.lastIndexOf("google/protobuf/");if(b>-1){var c=a.substring(b);if(c in f)return c}return null}function l(a,b){try{if(k.isString(b)&&"{"===b.charAt(0)&&(b=JSON.parse(b)),k.isString(b)){e.filename=a;var d,f=e(b,g,c),l=0;if(f.imports)for(;l<f.imports.length;++l)(d=j(f.imports[l])||g.resolvePath(a,f.imports[l]))&&n(d);if(f.weakImports)for(l=0;l<f.weakImports.length;++l)(d=j(f.weakImports[l])||g.resolvePath(a,f.weakImports[l]))&&n(d,!0)}else g.setOptions(b.options).addJSON(b.nested)}catch(a){i(a)}h||o||i(null,g)}function n(a,b){if(a=j(a)||a,!(g.files.indexOf(a)>-1)){if(g.files.push(a),a in f)return void(h?l(a,f[a]):(++o,setTimeout(function(){--o,l(a,f[a])})));if(h){var c;try{c=k.fs.readFileSync(a).toString("utf8")}catch(a){b||i(a);return}l(a,c)}else++o,g.fetch(a,function(c,e){if(--o,d){if(c)return void(b?o||i(null,g):i(c));l(a,e)}})}}var o=0;k.isString(b)&&(b=[b]);for(var p,q=0;q<b.length;++q)(p=g.resolvePath("",b[q]))&&n(p);return h?g.resolveAll():o||i(null,g),g},l.prototype.loadSync=function(a,b){if(!k.isNode)throw Error("not supported");return this.load(a,b,m)},l.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(a){return"'extend "+a.extend+"' in "+a.parent.fullName}).join(", "));return g.prototype.resolveAll.call(this)};var n=/^[A-Z]/;function o(a,b){var c=b.parent.lookup(b.extend);if(c){var d=new h(b.fullName,b.id,b.type,b.rule,void 0,b.options);return!!c.get(d.name)||(d.declaringField=b,b.extensionField=d,c.add(d),!0)}return!1}l.prototype._handleAdd=function(a){if(a instanceof h)void 0===a.extend||a.extensionField||o(this,a)||this.deferred.push(a);else if(a instanceof i)n.test(a.name)&&(a.parent[a.name]=a.values);else if(!(a instanceof j)){if(a instanceof d)for(var b=0;b<this.deferred.length;)o(this,this.deferred[b])?this.deferred.splice(b,1):++b;for(var c=0;c<a.nestedArray.length;++c)this._handleAdd(a._nestedArray[c]);n.test(a.name)&&(a.parent[a.name]=a)}(a instanceof d||a instanceof i||a instanceof h)&&(this._fullyQualifiedObjects[a.fullName]=a)},l.prototype._handleRemove=function(a){if(a instanceof h){if(void 0!==a.extend)if(a.extensionField)a.extensionField.parent.remove(a.extensionField),a.extensionField=null;else{var b=this.deferred.indexOf(a);b>-1&&this.deferred.splice(b,1)}}else if(a instanceof i)n.test(a.name)&&delete a.parent[a.name];else if(a instanceof g){for(var c=0;c<a.nestedArray.length;++c)this._handleRemove(a._nestedArray[c]);n.test(a.name)&&delete a.parent[a.name]}delete this._fullyQualifiedObjects[a.fullName]},l._configure=function(a,b,c){d=a,e=b,f=c}},92385:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Client=void 0;let d=c(45366),e=c(93023),f=c(40249),g=c(77797),h=c(12667),i=c(44150),j=Symbol(),k=Symbol(),l=Symbol(),m=Symbol();function n(a){return"function"==typeof a}function o(a){return a.stack.split("\n").slice(1).join("\n")}class p{constructor(a,b,c={}){var d,f;if(c=Object.assign({},c),this[k]=null!=(d=c.interceptors)?d:[],delete c.interceptors,this[l]=null!=(f=c.interceptor_providers)?f:[],delete c.interceptor_providers,this[k].length>0&&this[l].length>0)throw Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[m]=c.callInvocationTransformer,delete c.callInvocationTransformer,c.channelOverride)this[j]=c.channelOverride;else if(c.channelFactoryOverride){let d=c.channelFactoryOverride;delete c.channelFactoryOverride,this[j]=d(a,b,c)}else this[j]=new e.ChannelImplementation(a,b,c)}close(){this[j].close()}getChannel(){return this[j]}waitForReady(a,b){let c=d=>{let e;if(d)return void b(Error("Failed to connect before the deadline"));try{e=this[j].getConnectivityState(!0)}catch(a){b(Error("The channel has been closed"));return}if(e===f.ConnectivityState.READY)b();else try{this[j].watchConnectivityState(e,a,c)}catch(a){b(Error("The channel has been closed"))}};setImmediate(c)}checkOptionalUnaryResponseArguments(a,b,c){if(n(a))return{metadata:new h.Metadata,options:{},callback:a};if(n(b))if(a instanceof h.Metadata)return{metadata:a,options:{},callback:b};else return{metadata:new h.Metadata,options:a,callback:b};if(!(a instanceof h.Metadata&&b instanceof Object&&n(c)))throw Error("Incorrect arguments passed");return{metadata:a,options:b,callback:c}}makeUnaryRequest(a,b,c,e,f,h,n){var p,q;let r=this.checkOptionalUnaryResponseArguments(f,h,n),s={path:a,requestStream:!1,responseStream:!1,requestSerialize:b,responseDeserialize:c},t={argument:e,metadata:r.metadata,call:new d.ClientUnaryCallImpl,channel:this[j],methodDefinition:s,callOptions:r.options,callback:r.callback};this[m]&&(t=this[m](t));let u=t.call,v={clientInterceptors:this[k],clientInterceptorProviders:this[l],callInterceptors:null!=(p=t.callOptions.interceptors)?p:[],callInterceptorProviders:null!=(q=t.callOptions.interceptor_providers)?q:[]},w=(0,i.getInterceptingCall)(v,t.methodDefinition,t.callOptions,t.channel);u.call=w;let x=null,y=!1,z=Error();return w.start(t.metadata,{onReceiveMetadata:a=>{u.emit("metadata",a)},onReceiveMessage(a){null!==x&&w.cancelWithStatus(g.Status.INTERNAL,"Too many responses received"),x=a},onReceiveStatus(a){if(!y){if(y=!0,a.code===g.Status.OK)if(null===x){let b=o(z);t.callback((0,d.callErrorFromStatus)({code:g.Status.INTERNAL,details:"No message received",metadata:a.metadata},b))}else t.callback(null,x);else{let b=o(z);t.callback((0,d.callErrorFromStatus)(a,b))}z=null,u.emit("status",a)}}}),w.sendMessage(e),w.halfClose(),u}makeClientStreamRequest(a,b,c,e,f,h){var n,p;let q=this.checkOptionalUnaryResponseArguments(e,f,h),r={path:a,requestStream:!0,responseStream:!1,requestSerialize:b,responseDeserialize:c},s={metadata:q.metadata,call:new d.ClientWritableStreamImpl(b),channel:this[j],methodDefinition:r,callOptions:q.options,callback:q.callback};this[m]&&(s=this[m](s));let t=s.call,u={clientInterceptors:this[k],clientInterceptorProviders:this[l],callInterceptors:null!=(n=s.callOptions.interceptors)?n:[],callInterceptorProviders:null!=(p=s.callOptions.interceptor_providers)?p:[]},v=(0,i.getInterceptingCall)(u,s.methodDefinition,s.callOptions,s.channel);t.call=v;let w=null,x=!1,y=Error();return v.start(s.metadata,{onReceiveMetadata:a=>{t.emit("metadata",a)},onReceiveMessage(a){null!==w&&v.cancelWithStatus(g.Status.INTERNAL,"Too many responses received"),w=a},onReceiveStatus(a){if(!x){if(x=!0,a.code===g.Status.OK)if(null===w){let b=o(y);s.callback((0,d.callErrorFromStatus)({code:g.Status.INTERNAL,details:"No message received",metadata:a.metadata},b))}else s.callback(null,w);else{let b=o(y);s.callback((0,d.callErrorFromStatus)(a,b))}y=null,t.emit("status",a)}}}),t}checkMetadataAndOptions(a,b){let c,d;return a instanceof h.Metadata?(c=a,d=b||{}):(d=a||{},c=new h.Metadata),{metadata:c,options:d}}makeServerStreamRequest(a,b,c,e,f,h){var n,p;let q=this.checkMetadataAndOptions(f,h),r={path:a,requestStream:!1,responseStream:!0,requestSerialize:b,responseDeserialize:c},s={argument:e,metadata:q.metadata,call:new d.ClientReadableStreamImpl(c),channel:this[j],methodDefinition:r,callOptions:q.options};this[m]&&(s=this[m](s));let t=s.call,u={clientInterceptors:this[k],clientInterceptorProviders:this[l],callInterceptors:null!=(n=s.callOptions.interceptors)?n:[],callInterceptorProviders:null!=(p=s.callOptions.interceptor_providers)?p:[]},v=(0,i.getInterceptingCall)(u,s.methodDefinition,s.callOptions,s.channel);t.call=v;let w=!1,x=Error();return v.start(s.metadata,{onReceiveMetadata(a){t.emit("metadata",a)},onReceiveMessage(a){t.push(a)},onReceiveStatus(a){if(!w){if(w=!0,t.push(null),a.code!==g.Status.OK){let b=o(x);t.emit("error",(0,d.callErrorFromStatus)(a,b))}x=null,t.emit("status",a)}}}),v.sendMessage(e),v.halfClose(),t}makeBidiStreamRequest(a,b,c,e,f){var h,n;let p=this.checkMetadataAndOptions(e,f),q={path:a,requestStream:!0,responseStream:!0,requestSerialize:b,responseDeserialize:c},r={metadata:p.metadata,call:new d.ClientDuplexStreamImpl(b,c),channel:this[j],methodDefinition:q,callOptions:p.options};this[m]&&(r=this[m](r));let s=r.call,t={clientInterceptors:this[k],clientInterceptorProviders:this[l],callInterceptors:null!=(h=r.callOptions.interceptors)?h:[],callInterceptorProviders:null!=(n=r.callOptions.interceptor_providers)?n:[]},u=(0,i.getInterceptingCall)(t,r.methodDefinition,r.callOptions,r.channel);s.call=u;let v=!1,w=Error();return u.start(r.metadata,{onReceiveMetadata(a){s.emit("metadata",a)},onReceiveMessage(a){s.push(a)},onReceiveStatus(a){if(!v){if(v=!0,s.push(null),a.code!==g.Status.OK){let b=o(w);s.emit("error",(0,d.callErrorFromStatus)(a,b))}w=null,s.emit("status",a)}}}),s}}b.Client=p},93023:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ChannelImplementation=void 0;let d=c(14952),e=c(25289);class f{constructor(a,b,c){if("string"!=typeof a)throw TypeError("Channel target must be a string");if(!(b instanceof d.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(c&&"object"!=typeof c)throw TypeError("Channel options must be an object");this.internalChannel=new e.InternalChannel(a,b,c)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(a){return this.internalChannel.getConnectivityState(a)}watchConnectivityState(a,b,c){this.internalChannel.watchConnectivityState(a,b,c)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(a,b,c,d,e){if("string"!=typeof a)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof b||b instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(a,b,c,d,e)}}b.ChannelImplementation=f},93690:(a,b,c)=>{"use strict";a.exports=f;var d=c(19275),e=c(30015)("fs");function f(a,b,c){return("function"==typeof b?(c=b,b={}):b||(b={}),c)?!b.xhr&&e&&e.readFile?e.readFile(a,function(d,e){return d&&"undefined"!=typeof XMLHttpRequest?f.xhr(a,b,c):d?c(d):c(null,b.binary?e:e.toString("utf8"))}):f.xhr(a,b,c):d(f,this,a,b)}f.xhr=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState){if(0!==d.status&&200!==d.status)return c(Error("status "+d.status));if(b.binary){var a=d.response;if(!a){a=[];for(var e=0;e<d.responseText.length;++e)a.push(255&d.responseText.charCodeAt(e))}return c(null,"undefined"!=typeof Uint8Array?new Uint8Array(a):a)}return c(null,d.responseText)}},b.binary&&("overrideMimeType"in d&&d.overrideMimeType("text/plain; charset=x-user-defined"),d.responseType="arraybuffer"),d.open("GET",a),d.send()}},94735:a=>{"use strict";a.exports=require("events")},95736:(a,b,c)=>{"use strict";a.exports=c(44870)},95910:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Http2ServerCallStream=b.ServerDuplexStreamImpl=b.ServerWritableStreamImpl=b.ServerReadableStreamImpl=b.ServerUnaryCallImpl=void 0;let d=c(94735),e=c(73496),f=c(27910),g=c(74075),h=c(77797),i=c(12667),j=c(59651),k=c(35433),l=c(98313),m="server_call";function n(a){k.trace(h.LogVerbosity.DEBUG,m,a)}let o="grpc-message",p="grpc-status",q="grpc-timeout",r=/(\d{1,8})\s*([HMSmun])/,s={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},t={"grpc-accept-encoding":"identity,deflate,gzip","grpc-encoding":"identity"},u={[e.constants.HTTP2_HEADER_STATUS]:e.constants.HTTP_STATUS_OK,[e.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},v={waitForTrailers:!0};class w extends d.EventEmitter{constructor(a,b,c){super(),this.call=a,this.metadata=b,this.request=c,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(a){this.call.sendMetadata(a)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}b.ServerUnaryCallImpl=w;class x extends f.Readable{constructor(a,b,c,d){super({objectMode:!0}),this.call=a,this.metadata=b,this.deserialize=c,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,d)}_read(a){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(a){this.call.sendMetadata(a)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}b.ServerReadableStreamImpl=x;class y extends f.Writable{constructor(a,b,c,d){super({objectMode:!0}),this.call=a,this.metadata=b,this.serialize=c,this.request=d,this.cancelled=!1,this.trailingMetadata=new i.Metadata,this.call.setupSurfaceCall(this),this.on("error",a=>{this.call.sendError(a),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(a){this.call.sendMetadata(a)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(a,b,c){try{let b=this.call.serializeMessage(a);if(!this.call.write(b))return void this.call.once("drain",c)}catch(a){this.emit("error",{details:(0,l.getErrorMessage)(a),code:h.Status.INTERNAL})}c()}_final(a){this.call.sendStatus({code:h.Status.OK,details:"OK",metadata:this.trailingMetadata}),a(null)}end(a){return a&&(this.trailingMetadata=a),super.end()}}b.ServerWritableStreamImpl=y;class z extends f.Duplex{constructor(a,b,c,d,e){super({objectMode:!0}),this.call=a,this.metadata=b,this.serialize=c,this.deserialize=d,this.cancelled=!1,this.trailingMetadata=new i.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,e),this.on("error",a=>{this.call.sendError(a),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(a){this.call.sendMetadata(a)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(a){return a&&(this.trailingMetadata=a),super.end()}}b.ServerDuplexStreamImpl=z,z.prototype._read=x.prototype._read,z.prototype._write=y.prototype._write,z.prototype._final=y.prototype._final;class A extends d.EventEmitter{constructor(a,b,c){super(),this.stream=a,this.handler=b,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=h.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=h.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",a=>{}),this.stream.once("close",()=>{var a;n("Request to method "+(null==(a=this.handler)?void 0:a.path)+" stream closed with rstCode "+this.stream.rstCode),!this.statusSent&&(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:h.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in c&&(this.maxSendMessageSize=c["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in c&&(this.maxReceiveMessageSize=c["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(a,b){let c=a.subarray(5);if("identity"===b)return c;if("deflate"!==b&&"gzip"!==b)return Promise.reject({code:h.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${b}"`});{let a;return a="deflate"===b?g.createInflate():g.createGunzip(),new Promise((b,d)=>{let e=0,f=[];a.on("data",b=>{f.push(b),e+=b.byteLength,-1!==this.maxReceiveMessageSize&&e>this.maxReceiveMessageSize&&(a.destroy(),d({code:h.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),a.on("end",()=>{b(Buffer.concat(f))}),a.write(c),a.end()})}}sendMetadata(a){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let b=a?a.toHttp2Headers():null,c=Object.assign(Object.assign(Object.assign({},u),t),b);this.stream.respond(c,v)}receiveMetadata(a){let b=i.Metadata.fromHttp2Headers(a);k.isTracerEnabled(m)&&n("Request to "+this.handler.path+" received headers "+JSON.stringify(b.toJSON()));let c=b.get(q);if(c.length>0){let a=c[0].toString().match(r);if(null===a){let a=Error("Invalid deadline");return a.code=h.Status.OUT_OF_RANGE,this.sendError(a),b}let d=a[1]*s[a[2]]|0,e=new Date;this.deadline=e.setMilliseconds(e.getMilliseconds()+d),this.deadlineTimer=setTimeout(B,d,this),b.remove(q)}return b.remove(e.constants.HTTP2_HEADER_ACCEPT_ENCODING),b.remove(e.constants.HTTP2_HEADER_TE),b.remove(e.constants.HTTP2_HEADER_CONTENT_TYPE),b.remove("grpc-accept-encoding"),b}receiveUnaryMessage(a){return new Promise((b,c)=>{let{stream:d}=this,e=0,f=this,g=[],i=this.maxReceiveMessageSize;function j(a){if(e+=a.byteLength,-1!==i&&e>i){d.removeListener("data",j),d.removeListener("end",k),d.removeListener("error",k),c({code:h.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${e} vs. ${i})`});return}g.push(a)}function k(i){if(d.removeListener("data",j),d.removeListener("end",k),d.removeListener("error",k),void 0!==i)return void c({code:h.Status.INTERNAL,details:i.message});if(0===e)return void c({code:h.Status.INTERNAL,details:"received empty unary message"});f.emit("receiveMessage");let l=Buffer.concat(g,e),m=1===l.readUInt8(0)?a:"identity",n=f.getDecompressedMessage(l,m);if(Buffer.isBuffer(n))return void b(f.deserializeMessageWithInternalError(n));n.then(a=>b(f.deserializeMessageWithInternalError(a)),b=>c(b.code?b:{code:h.Status.INTERNAL,details:`Received "grpc-encoding" header "${a}" but ${a} decompression failed`}))}this.stream.on("data",j),this.stream.on("end",k),this.stream.on("error",k)})}async deserializeMessageWithInternalError(a){try{return this.deserializeMessage(a)}catch(a){throw{details:(0,l.getErrorMessage)(a),code:h.Status.INTERNAL}}}serializeMessage(a){let b=this.handler.serialize(a),c=b.byteLength,d=Buffer.allocUnsafe(c+5);return d.writeUInt8(0,0),d.writeUInt32BE(c,1),b.copy(d,5),d}deserializeMessage(a){return this.handler.deserialize(a)}async sendUnaryMessage(a,b,c,d){if(!this.checkCancelled()){if(void 0===c&&(c=null),a){!Object.prototype.hasOwnProperty.call(a,"metadata")&&c&&(a.metadata=c),this.sendError(a);return}try{let a=this.serializeMessage(b);this.write(a),this.sendStatus({code:h.Status.OK,details:"OK",metadata:c})}catch(a){this.sendError({details:(0,l.getErrorMessage)(a),code:h.Status.INTERNAL})}}}sendStatus(a){var b,c;if(this.emit("callEnd",a.code),this.emit("streamEnd",a.code===h.Status.OK),!this.checkCancelled())if(n("Request to method "+(null==(b=this.handler)?void 0:b.path)+" ended with status code: "+h.Status[a.code]+" details: "+a.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var b;let c=Object.assign({[p]:a.code,[o]:encodeURI(a.details)},null==(b=a.metadata)?void 0:b.toHttp2Headers());this.stream.sendTrailers(c),this.statusSent=!0}),this.stream.end());else{let b=Object.assign(Object.assign({[p]:a.code,[o]:encodeURI(a.details)},u),null==(c=a.metadata)?void 0:c.toHttp2Headers());this.stream.respond(b,{endStream:!0}),this.statusSent=!0}}sendError(a){let b={code:h.Status.UNKNOWN,details:"message"in a?a.message:"Unknown Error",metadata:"metadata"in a&&void 0!==a.metadata?a.metadata:null};"code"in a&&"number"==typeof a.code&&Number.isInteger(a.code)&&(b.code=a.code,"details"in a&&"string"==typeof a.details&&(b.details=a.details)),this.sendStatus(b)}write(a){if(!this.checkCancelled())return -1!==this.maxSendMessageSize&&a.length>this.maxSendMessageSize?void this.sendError({code:h.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${a.length} vs. ${this.maxSendMessageSize})`}):(this.sendMetadata(),this.emit("sendMessage"),this.stream.write(a))}resume(){this.stream.resume()}setupSurfaceCall(a){this.once("cancelled",b=>{a.cancelled=!0,a.emit("cancelled",b)}),this.once("callEnd",b=>a.emit("callEnd",b))}setupReadable(a,b){let c=new j.StreamDecoder(this.maxReceiveMessageSize),d=!1,e=!1,f=!1,g=async()=>{f||!d||e||(f=!0,await this.pushOrBufferMessage(a,null))};this.stream.on("data",async d=>{let f;try{f=c.write(d)}catch(a){this.sendError({code:h.Status.RESOURCE_EXHAUSTED,details:a.message});return}for(let c of(e=!0,this.stream.pause(),f)){let d;this.emit("receiveMessage");let e=1===c.readUInt8(0)?b:"identity";try{d=await this.getDecompressedMessage(c,e)}catch(a){this.sendError(a);return}if(!d)return;await this.pushOrBufferMessage(a,d)}e=!1,this.stream.resume(),await g()}),this.stream.once("end",async()=>{d=!0,await g()})}consumeUnpushedMessages(a){for(this.canPush=!0;this.messagesToPush.length>0;){let b=this.messagesToPush.shift(),c=a.push(b);if(null===b||!1===c){this.canPush=!1;break}}return this.canPush}async pushOrBufferMessage(a,b){this.isPushPending?this.bufferedMessages.push(b):await this.pushMessage(a,b)}async pushMessage(a,b){if(null===b){n("Received end of stream"),this.canPush?a.push(null):this.messagesToPush.push(null);return}n("Received message of length "+b.length),this.isPushPending=!0;try{let c=await this.deserializeMessage(b);this.canPush?a.push(c)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(c)}catch(c){this.bufferedMessages.length=0;let b=(0,l.getErrorCode)(c);(null===b||b<h.Status.OK||b>h.Status.UNAUTHENTICATED)&&(b=h.Status.INTERNAL),a.emit("error",{details:(0,l.getErrorMessage)(c),code:b})}this.isPushPending=!1,this.bufferedMessages.length>0&&await this.pushMessage(a,this.bufferedMessages.shift())}getPeer(){var a;let b=null==(a=this.stream.session)?void 0:a.socket;return null!=b&&b.remoteAddress?b.remotePort?`${b.remoteAddress}:${b.remotePort}`:b.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}}function B(a){let b=Error("Deadline exceeded");b.code=h.Status.DEADLINE_EXCEEDED,a.sendError(b),a.cancelled=!0,a.emit("cancelled","deadline")}b.Http2ServerCallStream=A},96487:()=>{},96651:(a,b,c)=>{"use strict";a.exports=c(5546)},97594:(a,b,c)=>{"use strict";var d=b,e=c(60081),f=c(36544);function g(a,b,c,d){var f=!1;if(b.resolvedType)if(b.resolvedType instanceof e){a("switch(d%s){",d);for(var g=b.resolvedType.values,h=Object.keys(g),i=0;i<h.length;++i)g[h[i]]!==b.typeDefault||f||(a("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',d,d,d),b.repeated||a("break"),f=!0),a("case%j:",h[i])("case %i:",g[h[i]])("m%s=%j",d,g[h[i]])("break");a("}")}else a('if(typeof d%s!=="object")',d)("throw TypeError(%j)",b.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",d,c,d);else{var j=!1;switch(b.type){case"double":case"float":a("m%s=Number(d%s)",d,d);break;case"uint32":case"fixed32":a("m%s=d%s>>>0",d,d);break;case"int32":case"sint32":case"sfixed32":a("m%s=d%s|0",d,d);break;case"uint64":j=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":a("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",d,d,j)('else if(typeof d%s==="string")',d)("m%s=parseInt(d%s,10)",d,d)('else if(typeof d%s==="number")',d)("m%s=d%s",d,d)('else if(typeof d%s==="object")',d)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",d,d,d,j?"true":"");break;case"bytes":a('if(typeof d%s==="string")',d)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",d,d,d)("else if(d%s.length >= 0)",d)("m%s=d%s",d,d);break;case"string":a("m%s=String(d%s)",d,d);break;case"bool":a("m%s=Boolean(d%s)",d,d)}}return a}function h(a,b,c,d){if(b.resolvedType)b.resolvedType instanceof e?a("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",d,c,d,d,c,d,d):a("d%s=types[%i].toObject(m%s,o)",d,c,d);else{var f=!1;switch(b.type){case"double":case"float":a("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",d,d,d,d);break;case"uint64":f=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":a('if(typeof m%s==="number")',d)("d%s=o.longs===String?String(m%s):m%s",d,d,d)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",d,d,d,d,f?"true":"",d);break;case"bytes":a("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",d,d,d,d,d);break;default:a("d%s=m%s",d,d)}}return a}d.fromObject=function(a){var b=a.fieldsArray,c=f.codegen(["d"],a.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!b.length)return c("return new this.ctor");c("var m=new this.ctor");for(var d=0;d<b.length;++d){var h=b[d].resolve(),i=f.safeProp(h.name);h.map?(c("if(d%s){",i)('if(typeof d%s!=="object")',i)("throw TypeError(%j)",h.fullName+": object expected")("m%s={}",i)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",i),g(c,h,d,i+"[ks[i]]")("}")("}")):h.repeated?(c("if(d%s){",i)("if(!Array.isArray(d%s))",i)("throw TypeError(%j)",h.fullName+": array expected")("m%s=[]",i)("for(var i=0;i<d%s.length;++i){",i),g(c,h,d,i+"[i]")("}")("}")):(h.resolvedType instanceof e||c("if(d%s!=null){",i),g(c,h,d,i),h.resolvedType instanceof e||c("}"))}return c("return m")},d.toObject=function(a){var b=a.fieldsArray.slice().sort(f.compareFieldsById);if(!b.length)return f.codegen()("return {}");for(var c=f.codegen(["m","o"],a.name+"$toObject")("if(!o)")("o={}")("var d={}"),d=[],g=[],i=[],j=0;j<b.length;++j)b[j].partOf||(b[j].resolve().repeated?d:b[j].map?g:i).push(b[j]);if(d.length){for(c("if(o.arrays||o.defaults){"),j=0;j<d.length;++j)c("d%s=[]",f.safeProp(d[j].name));c("}")}if(g.length){for(c("if(o.objects||o.defaults){"),j=0;j<g.length;++j)c("d%s={}",f.safeProp(g[j].name));c("}")}if(i.length){for(c("if(o.defaults){"),j=0;j<i.length;++j){var k=i[j],l=f.safeProp(k.name);if(k.resolvedType instanceof e)c("d%s=o.enums===String?%j:%j",l,k.resolvedType.valuesById[k.typeDefault],k.typeDefault);else if(k.long)c("if(util.Long){")("var n=new util.Long(%i,%i,%j)",k.typeDefault.low,k.typeDefault.high,k.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",l)("}else")("d%s=o.longs===String?%j:%i",l,k.typeDefault.toString(),k.typeDefault.toNumber());else if(k.bytes){var m="["+Array.prototype.slice.call(k.typeDefault).join(",")+"]";c("if(o.bytes===String)d%s=%j",l,String.fromCharCode.apply(String,k.typeDefault))("else{")("d%s=%s",l,m)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",l,l)("}")}else c("d%s=%j",l,k.typeDefault)}c("}")}var n=!1;for(j=0;j<b.length;++j){var k=b[j],o=a._fieldsArray.indexOf(k),l=f.safeProp(k.name);k.map?(n||(n=!0,c("var ks2")),c("if(m%s&&(ks2=Object.keys(m%s)).length){",l,l)("d%s={}",l)("for(var j=0;j<ks2.length;++j){"),h(c,k,o,l+"[ks2[j]]")("}")):k.repeated?(c("if(m%s&&m%s.length){",l,l)("d%s=[]",l)("for(var j=0;j<m%s.length;++j){",l),h(c,k,o,l+"[j]")("}")):(c("if(m%s!=null&&m.hasOwnProperty(%j)){",l,k.name),h(c,k,o,l),k.partOf&&c("if(o.oneofs)")("d%s=%j",f.safeProp(k.partOf.name),k.name)),c("}")}return c("return d")}},98296:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.addCommonProtos=b.loadProtosWithOptionsSync=b.loadProtosWithOptions=void 0;let d=c(29021),e=c(33873),f=c(96651);function g(a,b){let c=a.resolvePath;a.resolvePath=(a,f)=>{if(e.isAbsolute(f))return f;for(let a of b){let b=e.join(a,f);try{return d.accessSync(b,d.constants.R_OK),b}catch(a){continue}}return process.emitWarning(`${f} not found in any of the include paths ${b}`),c(a,f)}}b.loadProtosWithOptions=async function(a,b){let c=new f.Root;if((b=b||{}).includeDirs){if(!Array.isArray(b.includeDirs))return Promise.reject(Error("The includeDirs option must be an array"));g(c,b.includeDirs)}let d=await c.load(a,b);return d.resolveAll(),d},b.loadProtosWithOptionsSync=function(a,b){let c=new f.Root;if((b=b||{}).includeDirs){if(!Array.isArray(b.includeDirs))throw Error("The includeDirs option must be an array");g(c,b.includeDirs)}let d=c.loadSync(a,b);return d.resolveAll(),d},b.addCommonProtos=function(){let a=c(42398),b=c(32003),d=c(51543),e=c(77986);f.common("api",a.nested.google.nested.protobuf.nested),f.common("descriptor",b.nested.google.nested.protobuf.nested),f.common("source_context",d.nested.google.nested.protobuf.nested),f.common("type",e.nested.google.nested.protobuf.nested)}},98313:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getErrorCode=b.getErrorMessage=void 0,b.getErrorMessage=function(a){return a instanceof Error?a.message:String(a)},b.getErrorCode=function(a){return"object"==typeof a&&null!==a&&"code"in a&&"number"==typeof a.code?a.code:null}},98847:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Subchannel=void 0;let d=c(40249),e=c(30422),f=c(35433),g=c(77797),h=c(23220),i=c(74590),j=c(15981),k="subchannel",l=0x7fffffff;class m{constructor(a,b,c,f,g){var h;this.channelTarget=a,this.subchannelAddress=b,this.options=c,this.credentials=f,this.connector=g,this.connectivityState=d.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new j.ChannelzCallTracker,this.childrenTracker=new j.ChannelzChildrenTracker,this.streamTracker=new j.ChannelzCallTracker;let k={initialDelay:c["grpc.initial_reconnect_backoff_ms"],maxDelay:c["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new e.BackoffTimeout(()=>{this.handleBackoffTimer()},k),this.backoffTimeout.unref(),this.subchannelAddressString=(0,i.subchannelAddressToString)(b),this.keepaliveTime=null!=(h=c["grpc.keepalive_time_ms"])?h:-1,0===c["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new j.ChannelzTrace,this.channelzRef=(0,j.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(c,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(a){f.trace(g.LogVerbosity.DEBUG,k,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}refTrace(a){f.trace(g.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([d.ConnectivityState.TRANSIENT_FAILURE],d.ConnectivityState.CONNECTING):this.transitionToState([d.ConnectivityState.TRANSIENT_FAILURE],d.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let a=this.options;if(a["grpc.keepalive_time_ms"]){let b=Math.min(this.keepaliveTime,l);a=Object.assign(Object.assign({},a),{"grpc.keepalive_time_ms":b})}this.connector.connect(this.subchannelAddress,this.credentials,a).then(a=>{this.transitionToState([d.ConnectivityState.CONNECTING],d.ConnectivityState.READY)?(this.transport=a,this.channelzEnabled&&this.childrenTracker.refChild(a.getChannelzRef()),a.addDisconnectListener(a=>{this.transitionToState([d.ConnectivityState.READY],d.ConnectivityState.IDLE),a&&this.keepaliveTime>0&&(this.keepaliveTime*=2,f.log(g.LogVerbosity.ERROR,`Connection to ${(0,h.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):a.shutdown()},a=>{this.transitionToState([d.ConnectivityState.CONNECTING],d.ConnectivityState.TRANSIENT_FAILURE,`${a}`)})}transitionToState(a,b,c){var e,f;if(-1===a.indexOf(this.connectivityState))return!1;this.trace(d.ConnectivityState[this.connectivityState]+" -> "+d.ConnectivityState[b]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+d.ConnectivityState[b]);let g=this.connectivityState;switch(this.connectivityState=b,b){case d.ConnectivityState.READY:this.stopBackoff();break;case d.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case d.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null==(e=this.transport)||e.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case d.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null==(f=this.transport)||f.shutdown(),this.transport=null;break;default:throw Error(`Invalid state: unknown ConnectivityState ${b}`)}for(let a of this.stateListeners)a(this,g,b,this.keepaliveTime,c);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,0===this.refcount&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,j.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([d.ConnectivityState.CONNECTING,d.ConnectivityState.READY],d.ConnectivityState.IDLE)}))}unrefIfOneRef(){return 1===this.refcount&&(this.unref(),!0)}createCall(a,b,c,d){let e;if(!this.transport)throw Error("Cannot create call, subchannel not READY");return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),e={onCallEnd:a=>{a.code===g.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):e={},this.transport.createCall(a,b,c,d,e)}startConnecting(){process.nextTick(()=>{this.transitionToState([d.ConnectivityState.IDLE],d.ConnectivityState.CONNECTING)||this.connectivityState!==d.ConnectivityState.TRANSIENT_FAILURE||(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(a){this.stateListeners.add(a)}removeConnectivityStateListener(a){this.stateListeners.delete(a)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([d.ConnectivityState.TRANSIENT_FAILURE],d.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(a){return a.getRealSubchannel()===this}throttleKeepalive(a){a>this.keepaliveTime&&(this.keepaliveTime=a)}}b.Subchannel=m}};var __webpack_require__=require("../../../../webpack-runtime.js");__webpack_require__.C(exports);var __webpack_exec__=a=>__webpack_require__(__webpack_require__.s=a),__webpack_exports__=__webpack_require__.X(0,[996,563],()=>__webpack_exec__(36076));module.exports=__webpack_exports__})();