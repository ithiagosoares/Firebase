(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1536],{1554:(e,r,s)=>{"use strict";s.d(r,{ZJ:()=>d,R8:()=>o,As:()=>c,D3:()=>u,sh:()=>h,jt:()=>m,$e:()=>f,Jd:()=>x});var t=s(95155),a=s(12115),n=s(59253),i=s(9891);function l(){let[e,r]=(0,a.useState)(null);if((0,a.useEffect)(()=>{let e=e=>{r(e)};return i.d.on("permission-error",e),()=>{i.d.off("permission-error",e)}},[]),e)throw e;return null}let d=(0,a.createContext)(void 0),o=e=>{let{children:r,firebaseApp:s,firestore:i,auth:o}=e,[u,c]=(0,a.useState)({user:null,isUserLoading:!0,userError:null});(0,a.useEffect)(()=>{if(!o)return void c({user:null,isUserLoading:!1,userError:Error("Auth service not provided.")});c({user:null,isUserLoading:!0,userError:null});let e=(0,n.hg)(o,e=>{c({user:e,isUserLoading:!1,userError:null})},e=>{console.error("FirebaseProvider: onAuthStateChanged error:",e),c({user:null,isUserLoading:!1,userError:e})});return()=>e()},[o]);let m=(0,a.useMemo)(()=>{let e=!!(s&&i&&o);return{areServicesAvailable:e,firebaseApp:e?s:null,firestore:e?i:null,auth:e?o:null,user:u.user,isUserLoading:u.isUserLoading,userError:u.userError}},[s,i,o,u]);return(0,t.jsxs)(d.Provider,{value:m,children:[(0,t.jsx)(l,{}),r]})},u=()=>{let e=(0,a.useContext)(d);if(void 0===e)throw Error("useFirebase must be used within a FirebaseProvider.");if(!e.areServicesAvailable||!e.firebaseApp||!e.firestore||!e.auth)throw Error("Firebase core services not available. Check FirebaseProvider props.");return{firebaseApp:e.firebaseApp,firestore:e.firestore,auth:e.auth,user:e.user,isUserLoading:e.isUserLoading,userError:e.userError}},c=()=>{let{auth:e}=u();return e},m=()=>{let{firestore:e}=u();return e},h=()=>{let{firebaseApp:e}=u();return e};function f(e,r){let s=(0,a.useMemo)(e,r);return"object"!=typeof s||null===s||(s.__memo=!0),s}let x=()=>{let{user:e,isUserLoading:r,userError:s}=u();return{user:e,isUserLoading:r,userError:s}}},3998:(e,r,s)=>{"use strict";s.d(r,{$:()=>o,r:()=>d});var t=s(95155),a=s(12115),n=s(32467),i=s(83101),l=s(64269);let d=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,r)=>{let{className:s,variant:a,size:i,asChild:o=!1,...u}=e,c=o?n.DX:"button";return(0,t.jsx)(c,{className:(0,l.cn)(d({variant:a,size:i,className:s})),ref:r,...u})});o.displayName="Button"},4371:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>F});var t=s(95155),a=s(12115),n=s(26991),i=s(98128),l=s(68425),d=s(47734),o=s(73697),u=s(23508),c=s(30757),m=s(80019),h=s(47643),f=s(86948),x=s(27500),g=s(6943),p=s(73181),v=s(42687);let j=e=>{let{message:r,icon:s}=e;return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full w-full text-muted-foreground gap-4 py-16",children:[(0,t.jsx)(s,{className:"h-12 w-12 opacity-50"}),(0,t.jsx)("p",{className:"text-center",children:r})]})};function b(e){let{messages:r,isLoading:s}=e,m=(0,a.useMemo)(()=>{if(!r)return[];let e=new Date,s=[];for(let r=5;r>=0;r--){let t=(0,p.a)(e,r);(0,v.GP)(t,"yyyy-MM");let a=(0,v.GP)(t,"MMM");s.push({month:a,sent:0,failed:0})}return r.forEach(e=>{try{let r=e.scheduledTime.toDate(),t=(0,v.GP)(r,"MMM"),a=s.find(e=>e.month===t);a&&("Enviado"===e.status?a.sent++:"Falhou"===e.status&&a.failed++)}catch(e){}}),s},[r]);return s?(0,t.jsxs)(f.Zp,{children:[(0,t.jsxs)(f.aR,{children:[(0,t.jsx)("div",{className:"h-5 bg-muted rounded-md w-1/2 mb-2"}),(0,t.jsx)("div",{className:"h-4 bg-muted rounded-md w-3/4"})]}),(0,t.jsx)(f.Wu,{className:"h-[300px] flex items-center justify-center",children:(0,t.jsx)("div",{className:"w-full h-full bg-muted rounded-lg"})})]}):(0,t.jsxs)(f.Zp,{children:[(0,t.jsxs)(f.aR,{children:[(0,t.jsx)(f.ZB,{children:"Mensagens Enviadas"}),(0,t.jsx)(f.BT,{children:"Um resumo das mensagens enviadas e falhadas nos \xfaltimos 6 meses."})]}),(0,t.jsx)(f.Wu,{className:"h-[300px]",children:r.length>0?(0,t.jsx)(n.u,{width:"100%",height:"100%",children:(0,t.jsxs)(i.E,{data:m,children:[(0,t.jsx)(l.d,{strokeDasharray:"3 3"}),(0,t.jsx)(d.W,{dataKey:"month"}),(0,t.jsx)(o.h,{}),(0,t.jsx)(u.m,{contentStyle:{background:"hsl(var(--card))",borderColor:"hsl(var(--border))"}}),(0,t.jsx)(c.y,{dataKey:"sent",fill:"hsl(var(--primary))",name:"Enviadas",radius:[4,4,0,0]}),(0,t.jsx)(c.y,{dataKey:"failed",fill:"hsl(var(--destructive))",name:"Falharam",radius:[4,4,0,0]})]})}):(0,t.jsx)(j,{message:"Nenhuma mensagem enviada ainda. As estat\xedsticas aparecer\xe3o aqui.",icon:x.A})})]})}function N(e){let{patients:r,isLoading:s}=e,i=(0,a.useMemo)(()=>{if(!r)return[];let e=new Date,s=[];for(let r=5;r>=0;r--){let t=(0,p.a)(e,r),a=(0,v.GP)(t,"MMM");s.push({month:a,count:0})}return r.forEach(e=>{try{let r=e.lastAppointment||e.nextAppointment;if(r){let e=r.toDate(),t=(0,v.GP)(e,"MMM"),a=s.find(e=>e.month===t);a&&a.count++}}catch(e){}}),s},[r]);return s?(0,t.jsxs)(f.Zp,{children:[(0,t.jsxs)(f.aR,{children:[(0,t.jsx)("div",{className:"h-5 bg-muted rounded-md w-1/2 mb-2"}),(0,t.jsx)("div",{className:"h-4 bg-muted rounded-md w-3/4"})]}),(0,t.jsx)(f.Wu,{className:"h-[300px] flex items-center justify-center",children:(0,t.jsx)("div",{className:"w-full h-full bg-muted rounded-lg"})})]}):(0,t.jsxs)(f.Zp,{children:[(0,t.jsxs)(f.aR,{children:[(0,t.jsx)(f.ZB,{children:"Novos Pacientes"}),(0,t.jsx)(f.BT,{children:"Crescimento do n\xfamero de pacientes cadastrados."})]}),(0,t.jsx)(f.Wu,{className:"h-[300px]",children:r.length>0?(0,t.jsx)(n.u,{width:"100%",height:"100%",children:(0,t.jsxs)(m.b,{data:i,children:[(0,t.jsx)(l.d,{strokeDasharray:"3 3"}),(0,t.jsx)(d.W,{dataKey:"month"}),(0,t.jsx)(o.h,{}),(0,t.jsx)(u.m,{contentStyle:{background:"hsl(var(--card))",borderColor:"hsl(var(--border))"}}),(0,t.jsx)(h.N,{type:"monotone",dataKey:"count",name:"Novos Pacientes",stroke:"hsl(var(--primary))",strokeWidth:2,activeDot:{r:8}})]})}):(0,t.jsx)(j,{message:"Nenhum paciente novo registrado. Comece a adicionar pacientes para ver o gr\xe1fico.",icon:g.A})})]})}var y=s(34818),w=s(3998),E=s(28127),A=s(78770),M=s(22452),C=s(5225),k=s(52619),R=s.n(k),_=s(1554),P=s(41048),D=s(19708);function F(){let{user:e,isUserLoading:r}=(0,_.Jd)(),s=(0,_.jt)(),n=(0,_.$e)(()=>e?(0,D.rJ)(s,"users/".concat(e.uid,"/patients")):null,[s,e]),{data:i,isLoading:l}=(0,P.G)(n),d=(0,_.$e)(()=>e?(0,D.rJ)(s,"users/".concat(e.uid,"/scheduledMessages")):null,[s,e]),{data:o,isLoading:u}=(0,P.G)(d),c=(0,a.useMemo)(()=>{var e;let r=(null==o?void 0:o.filter(e=>"Enviado"===e.status).length)||0,s=(null==o?void 0:o.filter(e=>"Falhou"===e.status).length)||0;return[{title:"Total de Pacientes",value:null!=(e=null==i?void 0:i.length)?e:0,icon:g.A,change:"Pacientes cadastrados"},{title:"Mensagens Enviadas",value:r,icon:x.A,change:"No \xfaltimo m\xeas"},{title:"Consultas Marcadas",value:"N/A",icon:E.A,change:"Em breve"},{title:"Falhas de Envio",value:s,icon:A.A,change:"No \xfaltimo m\xeas"}]},[i,o]),m=[{title:"Adicionar Paciente",icon:M.A,href:"/patients",description:"Cadastre um novo paciente."},{title:"Agendar Consulta",icon:E.A,href:"/calendar",description:"Marque uma nova consulta."},{title:"Criar Template",icon:C.A,href:"/templates",description:"Crie um novo modelo de mensagem."}],h=r||l||u;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.z,{title:"Dashboard"}),(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 mb-8",children:m.map(e=>(0,t.jsxs)(f.Zp,{className:"flex flex-col",children:[(0,t.jsxs)(f.aR,{children:[(0,t.jsxs)(f.ZB,{className:"text-lg flex items-center gap-2",children:[(0,t.jsx)(e.icon,{className:"h-5 w-5 text-primary"}),e.title]}),(0,t.jsx)(f.BT,{children:e.description})]}),(0,t.jsx)(f.Wu,{className:"flex-grow flex items-end",children:(0,t.jsx)(w.$,{asChild:!0,className:"w-full",children:(0,t.jsx)(R(),{href:e.href,children:"Acessar"})})})]},e.title))}),h?(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[,,,,].fill(0).map((e,r)=>(0,t.jsxs)(f.Zp,{children:[(0,t.jsx)(f.aR,{children:(0,t.jsx)("div",{className:"h-4 bg-muted rounded-md w-3/4"})}),(0,t.jsxs)(f.Wu,{children:[(0,t.jsx)("div",{className:"h-8 bg-muted rounded-md w-1/2 mb-2"}),(0,t.jsx)("div",{className:"h-3 bg-muted rounded-md w-full"})]})]},r))}):(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:c.map(e=>(0,t.jsxs)(f.Zp,{children:[(0,t.jsxs)(f.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(f.ZB,{className:"text-sm font-medium",children:e.title}),(0,t.jsx)(e.icon,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(f.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:e.value}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.change})]})]},e.title))}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-2 mt-8",children:[(0,t.jsx)(b,{messages:o||[],isLoading:h}),(0,t.jsx)(N,{patients:i||[],isLoading:h})]})]})}},9891:(e,r,s)=>{"use strict";s.d(r,{d:()=>t});let t=function(){let e={};return{on(r,s){var t;e[r]||(e[r]=[]),null==(t=e[r])||t.push(s)},off(r,s){var t;e[r]&&(e[r]=null==(t=e[r])?void 0:t.filter(e=>e!==s))},emit(r,s){var t;e[r]&&(null==(t=e[r])||t.forEach(e=>e(s)))}}}()},31084:(e,r,s)=>{Promise.resolve().then(s.bind(s,4371))},34818:(e,r,s)=>{"use strict";s.d(r,{z:()=>n});var t=s(95155),a=s(64269);function n(e){let{title:r,children:s,className:n,...i}=e;return(0,t.jsxs)("div",{className:(0,a.cn)("flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-6",n),...i,children:[(0,t.jsx)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:r}),s&&(0,t.jsx)("div",{className:"flex shrink-0 items-center gap-2",children:s})]})}},41048:(e,r,s)=>{"use strict";s.d(r,{G:()=>l});var t=s(12115),a=s(19708),n=s(9891),i=s(86501);function l(e){let[r,s]=(0,t.useState)(null),[l,d]=(0,t.useState)(!1),[o,u]=(0,t.useState)(null);if((0,t.useEffect)(()=>{if(!e){s(null),d(!1),u(null);return}d(!0),u(null);let r=(0,a.aQ)(e,e=>{let r=[];for(let s of e.docs)r.push({...s.data(),id:s.id});s(r),u(null),d(!1)},r=>{let t="collection"===e.type?e.path:e._query.path.canonicalString(),a=new i.$({operation:"list",path:t});u(a),s(null),d(!1),n.d.emit("permission-error",a)});return()=>r()},[e]),e&&!e.__memo)throw Error(e+" was not properly memoized using useMemoFirebase");return{data:r,isLoading:l,error:o}}},64269:(e,r,s)=>{"use strict";s.d(r,{cn:()=>n});var t=s(2821),a=s(75889);function n(){for(var e=arguments.length,r=Array(e),s=0;s<e;s++)r[s]=arguments[s];return(0,a.QP)((0,t.$)(r))}},86501:(e,r,s)=>{"use strict";s.d(r,{$:()=>a});var t=s(59253);class a extends Error{constructor(e){let r=function(e){let r=null;try{let e=(0,t.xI)().currentUser;e&&(r=function(e){var r;if(!e)return null;let s={name:e.displayName,email:e.email,email_verified:e.emailVerified,phone_number:e.phoneNumber,sub:e.uid,firebase:{identities:e.providerData.reduce((e,r)=>(r.providerId&&(e[r.providerId]=[r.uid]),e),{}),sign_in_provider:(null==(r=e.providerData[0])?void 0:r.providerId)||"custom",tenant:e.tenantId}};return{uid:e.uid,token:s}}(e))}catch(e){}return{auth:r,method:e.operation,path:"/databases/(default)/documents/".concat(e.path),resource:e.requestResourceData?{data:e.requestResourceData}:void 0}}(e);super("Missing or insufficient permissions: The following request was denied by Firestore Security Rules:\n".concat(JSON.stringify(r,null,2))),this.name="FirebaseError",this.request=r}}},86948:(e,r,s)=>{"use strict";s.d(r,{BT:()=>o,Wu:()=>u,ZB:()=>d,Zp:()=>i,aR:()=>l,wL:()=>c});var t=s(95155),a=s(12115),n=s(64269);let i=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});i.displayName="Card";let l=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...a})});l.displayName="CardHeader";let d=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});d.displayName="CardTitle";let o=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",s),...a})});o.displayName="CardDescription";let u=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",s),...a})});u.displayName="CardContent";let c=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",s),...a})});c.displayName="CardFooter"}},e=>{e.O(0,[2992,7138,7112,9251,1659,7353,2687,2889,8441,1255,7358],()=>e(e.s=31084)),_N_E=e.O()}]);