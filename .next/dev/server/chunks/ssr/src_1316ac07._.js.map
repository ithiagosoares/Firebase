{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/user/VitalLink-VF/src/components/page-header.tsx"],"sourcesContent":["\"use client\"\n\nimport { cn } from \"@/lib/utils\"\n\ninterface PageHeaderProps extends React.HTMLAttributes<HTMLDivElement> {\n  title: string\n}\n\nexport function PageHeader({ title, children, className, ...props }: PageHeaderProps) {\n  return (\n    <div\n      className={cn(\n        \"flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-6\",\n        className\n      )}\n      {...props}\n    >\n      <h1 className=\"text-2xl md:text-3xl font-bold tracking-tight\">{title}</h1>\n      {children && <div className=\"flex shrink-0 items-center gap-2\">{children}</div>}\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAQO,SAAS,WAAW,EAAE,KAAK,EAAE,QAAQ,EAAE,SAAS,EAAE,GAAG,OAAwB;IAClF,qBACE,8OAAC;QACC,WAAW,IAAA,yHAAE,EACX,oFACA;QAED,GAAG,KAAK;;0BAET,8OAAC;gBAAG,WAAU;0BAAiD;;;;;;YAC9D,0BAAY,8OAAC;gBAAI,WAAU;0BAAoC;;;;;;;;;;;;AAGtE"}},
    {"offset": {"line": 45, "column": 0}, "map": {"version":3,"sources":["file:///home/user/VitalLink-VF/src/components/ui/dropdown-menu.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 256, "column": 0}, "map": {"version":3,"sources":["file:///home/user/VitalLink-VF/src/components/ui/switch.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,uBAAS,mNAAgB,CAG7B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,0KAAqB;QACpB,WAAW,IAAA,yHAAE,EACX,sXACA;QAED,GAAG,KAAK;QACT,KAAK;kBAEL,cAAA,8OAAC,2KAAsB;YACrB,WAAW,IAAA,yHAAE,EACX;;;;;;;;;;;AAKR,OAAO,WAAW,GAAG,0KAAqB,CAAC,WAAW"}},
    {"offset": {"line": 291, "column": 0}, "map": {"version":3,"sources":["file:///home/user/VitalLink-VF/src/app/%28app%29/workflows/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, useMemo } from \"react\"\nimport { MoreVertical, PlusCircle, Trash, Copy, Pencil, Send, Loader2, Workflow as WorkflowIcon } from \"lucide-react\"\nimport Link from \"next/link\"\nimport { PageHeader } from \"@/components/page-header\"\nimport { Button } from \"@/components/ui/button\"\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardFooter,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\"\nimport { Switch } from \"@/components/ui/switch\"\nimport { useToast } from \"@/hooks/use-toast\"\nimport { type Workflow, type ScheduledMessage, type Patient } from \"@/lib/types\"\nimport { collection, doc, writeBatch, query, where, getDocs, Timestamp, orderBy, limit, getDoc } from \"firebase/firestore\"\nimport { add, sub } from \"date-fns\"\n\nimport { useUser, useFirestore, useMemoFirebase } from \"@/firebase/provider\"\nimport { useCollection } from \"@/firebase/firestore/use-collection\"\nimport { setDocumentNonBlocking, deleteDocumentNonBlocking, addDocumentNonBlocking } from \"@/firebase/non-blocking-updates\"\n\nexport default function WorkflowsPage() {\n  const { toast } = useToast()\n  const { user, isUserLoading } = useUser()\n  const firestore = useFirestore()\n\n  const workflowsCollection = useMemoFirebase(() => {\n    if (!user) return null;\n    return collection(firestore, `users/${user.uid}/workflows`);\n  }, [firestore, user]);\n\n  const { data: workflows, isLoading } = useCollection<Workflow>(workflowsCollection);\n\n  const patientsCollection = useMemoFirebase(() => {\n    if (!user) return null;\n    return collection(firestore, `users/${user.uid}/patients`);\n  }, [firestore, user]);\n  const { data: patients, isLoading: isLoadingPatients } = useCollection<Patient>(patientsCollection);\n\n\n  const handleToggleActive = (id: string, active: boolean) => {\n    if (!user) return;\n    const workflowDoc = doc(firestore, `users/${user.uid}/workflows/${id}`);\n    setDocumentNonBlocking(workflowDoc, { active }, { merge: true });\n  }\n  \n  const handleDeleteWorkflow = (id: string) => {\n    if (!user) return;\n    const workflowDoc = doc(firestore, `users/${user.uid}/workflows/${id}`);\n    deleteDocumentNonBlocking(workflowDoc);\n  };\n\n  const scheduleMessagesForAppointment = (\n    userId: string,\n    patientId: string,\n    appointmentDate: Date,\n    workflow: Workflow\n  ) => {\n    const scheduledMessagesCollection = collection(firestore, `users/${userId}/scheduledMessages`);\n  \n    workflow.steps.forEach(step => {\n      let scheduledTime;\n  \n      const scheduleAction = step.schedule.event === 'before' ? sub : add;\n      scheduledTime = scheduleAction(appointmentDate, { [step.schedule.unit]: step.schedule.quantity });\n  \n      const newMessage: Omit<ScheduledMessage, 'id' | 'appointmentId'> = {\n        userId,\n        patientId,\n        templateId: step.template,\n        workflowId: workflow.id,\n        scheduledTime: Timestamp.fromDate(scheduledTime),\n        status: 'Agendado',\n      };\n      addDocumentNonBlocking(scheduledMessagesCollection, newMessage);\n    });\n  };\n\n  const handleSendNow = async (workflow: Workflow) => {\n    if (!user || !firestore || !patients) return;\n\n    let patientsScheduled = 0;\n    let patientsWithoutDate = 0;\n    let patientsWithExistingMessages = 0;\n    \n    const patientsMap = new Map(patients.map(p => [p.id, p]));\n    const scheduledMessagesCollection = collection(firestore, `users/${user.uid}/scheduledMessages`);\n\n    for (const patientId of workflow.patients) {\n        const patientData = patientsMap.get(patientId);\n        \n        if (!patientData) continue;\n        \n        if (patientData.nextAppointment && patientData.nextAppointment.toDate() > new Date()) {\n            const appointmentDate = patientData.nextAppointment.toDate();\n            \n            // Check for existing scheduled messages for this workflow and patient\n            const q = query(\n              scheduledMessagesCollection, \n              where(\"patientId\", \"==\", patientId),\n              where(\"workflowId\", \"==\", workflow.id),\n              where(\"status\", \"==\", \"Agendado\")\n            );\n            const existingMessagesSnapshot = await getDocs(q);\n\n            if (existingMessagesSnapshot.empty) {\n                scheduleMessagesForAppointment(user.uid, patientId, appointmentDate, workflow);\n                patientsScheduled++;\n            } else {\n                patientsWithExistingMessages++;\n            }\n        } else {\n          if (!patientData.nextAppointment) {\n            patientsWithoutDate++;\n          }\n        }\n    }\n\n    if (patientsScheduled > 0) {\n      toast({\n        title: \"Fluxo de trabalho iniciado!\",\n        description: `Mensagens foram agendadas para ${patientsScheduled} novo(s) paciente(s).`,\n      });\n    } else {\n       toast({\n        variant: \"default\",\n        title: \"Nenhum novo agendamento\",\n        description: \"Nenhum paciente elegível para novos agendamentos neste fluxo.\",\n      });\n    }\n\n    if (patientsWithExistingMessages > 0) {\n        toast({\n            variant: \"default\",\n            title: \"Aviso de Fluxo\",\n            description: `Este fluxo já possui mensagens agendadas para ${patientsWithExistingMessages} paciente(s) e não será reenviado.`\n        })\n    }\n\n    if (patientsWithoutDate > 0) {\n      toast({\n        variant: \"destructive\",\n        title: \"Aviso de Dados\",\n        description: `${patientsWithoutDate} paciente(s) no fluxo estão sem data de próxima consulta e foram ignorados.`\n      })\n    }\n  };\n  \n  const getScheduleDescription = (wf: Workflow) => {\n    if (!wf.steps || wf.steps.length === 0) return \"Nenhum passo\";\n    const firstStep = wf.steps[0];\n    const { quantity, unit, event } = firstStep.schedule;\n    \n    const unitMap: Record<string, string> = {\n        hours: \"hora(s)\",\n        days: \"dia(s)\",\n        weeks: \"semana(s)\",\n        months: \"mês(es)\"\n    };\n\n    const friendlyUnit = unitMap[unit] || unit;\n\n    return `${quantity} ${friendlyUnit} ${event === 'before' ? 'antes' : 'depois'} da consulta`;\n  }\n  \n  const renderEmptyState = () => (\n    <div className=\"flex flex-1 items-center justify-center rounded-lg border border-dashed shadow-sm mt-8\">\n      <div className=\"flex flex-col items-center gap-2 text-center\">\n        <WorkflowIcon className=\"h-12 w-12 text-muted-foreground\" />\n        <h3 className=\"text-2xl font-bold tracking-tight\">\n          Nenhum fluxo de automação criado\n        </h3>\n        <p className=\"text-sm text-muted-foreground\">\n          Comece a automatizar sua comunicação criando seu primeiro fluxo.\n        </p>\n        <Button className=\"mt-4\" asChild>\n          <Link href=\"/workflows/new\">\n            <PlusCircle className=\"mr-2 h-4 w-4\" />\n            Criar Fluxo\n          </Link>\n        </Button>\n      </div>\n    </div>\n  );\n\n  if (isLoading || isUserLoading || isLoadingPatients) {\n    return (\n      <div className=\"flex justify-center items-center h-full\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    )\n  }\n\n  return (\n    <>\n      <PageHeader title=\"Fluxos de Automação\">\n        <Button asChild>\n          <Link href=\"/workflows/new\">\n            <PlusCircle className=\"mr-2 h-4 w-4\" />\n            Criar Fluxo\n          </Link>\n        </Button>\n      </PageHeader>\n\n      {workflows && workflows.length > 0 ? (\n        <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n          {workflows.map((wf) => (\n            <Card key={wf.id} className=\"flex flex-col\">\n              <CardHeader>\n                <div className=\"flex justify-between items-start\">\n                  <CardTitle>{wf.title}</CardTitle>\n                  <Switch \n                    checked={wf.active} \n                    onCheckedChange={(checked) => handleToggleActive(wf.id, checked)}\n                    aria-label=\"Ativar ou desativar fluxo\" />\n                </div>\n                <CardDescription>\n                  Enviando para \"{wf.target}\"\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"flex-grow space-y-2\">\n                <p className=\"text-sm text-muted-foreground\">\n                  Agendamento: <span className=\"font-medium text-foreground\">{getScheduleDescription(wf)}</span>\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  Passos: <span className=\"font-medium text-foreground\">{wf.steps.length}</span>\n                </p>\n              </CardContent>\n              <CardFooter className=\"flex justify-between\">\n                <Button variant=\"outline\" size=\"sm\" onClick={() => handleSendNow(wf)}>\n                  <Send className=\"mr-2 h-4 w-4\" />\n                  Enviar Agora\n                </Button>\n                <DropdownMenu>\n                  <DropdownMenuTrigger asChild>\n                    <Button variant=\"ghost\" size=\"icon\">\n                      <MoreVertical className=\"h-4 w-4\" />\n                    </Button>\n                  </DropdownMenuTrigger>\n                  <DropdownMenuContent align=\"end\">\n                    <DropdownMenuLabel>Ações</DropdownMenuLabel>\n                    <DropdownMenuSeparator />\n                    <DropdownMenuItem asChild>\n                      <Link href={`/workflows/edit/${wf.id}`} className=\"flex items-center cursor-pointer\">\n                        <Pencil className=\"mr-2 h-4 w-4\" />\n                        Editar\n                      </Link>\n                    </DropdownMenuItem>\n                    <DropdownMenuItem>\n                      <Copy className=\"mr-2 h-4 w-4\" />\n                      Duplicar\n                    </DropdownMenuItem>\n                    <DropdownMenuItem onClick={() => handleDeleteWorkflow(wf.id)} className=\"text-destructive\">\n                      <Trash className=\"mr-2 h-4 w-4\" />\n                      Excluir\n                    </DropdownMenuItem>\n                  </DropdownMenuContent>\n                </DropdownMenu>\n              </CardFooter>\n            </Card>\n          ))}\n        </div>\n      ) : (\n        renderEmptyState()\n      )}\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}