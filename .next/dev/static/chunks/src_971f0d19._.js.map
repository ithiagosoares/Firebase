{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/user/VitalLink-VF/src/components/ui/dropdown-menu.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AAAA;AAAA;AAEA;AANA;;;;;;AAQA,MAAM,eAAe,uLAA0B;AAE/C,MAAM,sBAAsB,0LAA6B;AAEzD,MAAM,oBAAoB,wLAA2B;AAErD,MAAM,qBAAqB,yLAA4B;AAEvD,MAAM,kBAAkB,sLAAyB;AAEjD,MAAM,yBAAyB,6LAAgC;AAE/D,MAAM,uCAAyB,2KAAgB,MAK7C,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBAC3C,6LAAC,6LAAgC;QAC/B,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,0MACA,SAAS,QACT;QAED,GAAG,KAAK;;YAER;0BACD,6LAAC,yOAAY;gBAAC,WAAU;;;;;;;;;;;;;AAG5B,uBAAuB,WAAW,GAChC,6LAAgC,CAAC,WAAW;AAE9C,MAAM,uCAAyB,2KAAgB,OAG7C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,6LAAgC;QAC/B,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,ybACA;QAED,GAAG,KAAK;;;;;;;AAGb,uBAAuB,WAAW,GAChC,6LAAgC,CAAC,WAAW;AAE9C,MAAM,oCAAsB,2KAAgB,OAG1C,CAAC,EAAE,SAAS,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO,EAAE,oBAC1C,6LAAC,yLAA4B;kBAC3B,cAAA,6LAAC,0LAA6B;YAC5B,KAAK;YACL,YAAY;YACZ,WAAW,IAAA,4HAAE,EACX,ybACA;YAED,GAAG,KAAK;;;;;;;;;;;;AAIf,oBAAoB,WAAW,GAAG,0LAA6B,CAAC,WAAW;AAE3E,MAAM,iCAAmB,2KAAgB,OAKvC,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,OAAO,EAAE,oBACjC,6LAAC,uLAA0B;QACzB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,qSACA,SAAS,QACT;QAED,GAAG,KAAK;;;;;;;AAGb,iBAAiB,WAAW,GAAG,uLAA0B,CAAC,WAAW;AAErE,MAAM,yCAA2B,2KAAgB,OAG/C,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE,oBAC7C,6LAAC,+LAAkC;QACjC,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,wOACA;QAEF,SAAS;QACR,GAAG,KAAK;;0BAET,6LAAC;gBAAK,WAAU;0BACd,cAAA,6LAAC,gMAAmC;8BAClC,cAAA,6LAAC,gNAAK;wBAAC,WAAU;;;;;;;;;;;;;;;;YAGpB;;;;;;;;AAGL,yBAAyB,WAAW,GAClC,+LAAkC,CAAC,WAAW;AAEhD,MAAM,sCAAwB,2KAAgB,QAG5C,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,6LAAC,4LAA+B;QAC9B,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,wOACA;QAED,GAAG,KAAK;;0BAET,6LAAC;gBAAK,WAAU;0BACd,cAAA,6LAAC,gMAAmC;8BAClC,cAAA,6LAAC,mNAAM;wBAAC,WAAU;;;;;;;;;;;;;;;;YAGrB;;;;;;;;AAGL,sBAAsB,WAAW,GAAG,4LAA+B,CAAC,WAAW;AAE/E,MAAM,kCAAoB,2KAAgB,QAKxC,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,OAAO,EAAE,oBACjC,6LAAC,wLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,qCACA,SAAS,QACT;QAED,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,wLAA2B,CAAC,WAAW;AAEvE,MAAM,sCAAwB,2KAAgB,QAG5C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,4LAA+B;QAC9B,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,4BAA4B;QACzC,GAAG,KAAK;;;;;;;AAGb,sBAAsB,WAAW,GAAG,4LAA+B,CAAC,WAAW;AAE/E,MAAM,uBAAuB,CAAC,EAC5B,SAAS,EACT,GAAG,OACmC;IACtC,qBACE,6LAAC;QACC,WAAW,IAAA,4HAAE,EAAC,8CAA8C;QAC3D,GAAG,KAAK;;;;;;AAGf;OAVM;AAWN,qBAAqB,WAAW,GAAG"}},
    {"offset": {"line": 245, "column": 0}, "map": {"version":3,"sources":["file:///home/user/VitalLink-VF/src/components/ui/switch.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,uBAAS,2KAAgB,MAG7B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,6KAAqB;QACpB,WAAW,IAAA,4HAAE,EACX,sXACA;QAED,GAAG,KAAK;QACT,KAAK;kBAEL,cAAA,6LAAC,8KAAsB;YACrB,WAAW,IAAA,4HAAE,EACX;;;;;;;;;;;;AAKR,OAAO,WAAW,GAAG,6KAAqB,CAAC,WAAW"}},
    {"offset": {"line": 287, "column": 0}, "map": {"version":3,"sources":["file:///home/user/VitalLink-VF/src/app/%28app%29/workflows/page.tsx"],"sourcesContent":["\n\"use client\"\n\nimport { useState, useEffect, useMemo } from \"react\"\nimport { MoreVertical, PlusCircle, Trash, Copy, Pencil, Send, Loader2, Workflow as WorkflowIcon } from \"lucide-react\"\nimport Link from \"next/link\"\nimport { Button } from \"@/components/ui/button\"\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardFooter,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\"\nimport { Switch } from \"@/components/ui/switch\"\nimport { useToast } from \"@/hooks/use-toast\"\nimport { type Workflow, type ScheduledMessage, type Patient, type Schedule, type RelativeSchedule } from \"@/lib/types\"\nimport { collection, doc, writeBatch, query, where, getDocs, Timestamp, orderBy, limit, getDoc } from \"firebase/firestore\"\nimport { add, sub, format } from \"date-fns\"\nimport { ptBR } from 'date-fns/locale';\n\nimport { useUser, useFirestore, useMemoFirebase } from \"@/firebase/provider\"\nimport { useCollection } from \"@/firebase/firestore/use-collection\"\nimport { setDocumentNonBlocking, deleteDocumentNonBlocking, addDocumentNonBlocking } from \"@/firebase/non-blocking-updates\"\n\nexport default function WorkflowsPage() {\n  const { toast } = useToast()\n  const { user, isUserLoading } = useUser()\n  const firestore = useFirestore()\n\n  const workflowsCollection = useMemoFirebase(() => {\n    if (!user) return null;\n    return collection(firestore, `users/${user.uid}/workflows`);\n  }, [firestore, user]);\n\n  const { data: workflows, isLoading } = useCollection<Workflow>(workflowsCollection);\n\n  const patientsCollection = useMemoFirebase(() => {\n    if (!user) return null;\n    return collection(firestore, `users/${user.uid}/patients`);\n  }, [firestore, user]);\n  const { data: patients, isLoading: isLoadingPatients } = useCollection<Patient>(patientsCollection);\n\n\n  const handleToggleActive = (id: string, active: boolean) => {\n    if (!user) return;\n    const workflowDoc = doc(firestore, `users/${user.uid}/workflows/${id}`);\n    setDocumentNonBlocking(workflowDoc, { active }, { merge: true });\n  }\n  \n  const handleDeleteWorkflow = (id: string) => {\n    if (!user) return;\n    const workflowDoc = doc(firestore, `users/${user.uid}/workflows/${id}`);\n    deleteDocumentNonBlocking(workflowDoc);\n  };\n\n  const scheduleMessagesForAppointment = (\n    userId: string,\n    patientId: string,\n    appointmentDate: Date,\n    workflow: Workflow\n  ) => {\n    const scheduledMessagesCollection = collection(firestore, `users/${userId}/scheduledMessages`);\n  \n    workflow.steps.forEach(step => {\n      // \"Enviar agora\" só se aplica a agendamentos relativos à consulta\n      if (step.schedule.triggerType !== 'relative') return;\n\n      const schedule = step.schedule as RelativeSchedule;\n      const scheduleAction = schedule.event === 'before' ? sub : add;\n      const scheduledTime = scheduleAction(appointmentDate, { [schedule.unit]: schedule.quantity });\n  \n      const newMessage: Omit<ScheduledMessage, 'id' | 'appointmentId'> = {\n        userId,\n        patientId,\n        templateId: step.template,\n        workflowId: workflow.id,\n        scheduledTime: Timestamp.fromDate(scheduledTime),\n        status: 'Agendado',\n      };\n      addDocumentNonBlocking(scheduledMessagesCollection, newMessage);\n    });\n  };\n\n  const handleSendNow = async (workflow: Workflow) => {\n    if (!user || !firestore || !patients) return;\n\n    let patientsScheduled = 0;\n    let patientsWithoutDate = 0;\n    let patientsWithExistingMessages = 0;\n    \n    const patientsMap = new Map(patients.map(p => [p.id, p]));\n    const scheduledMessagesCollection = collection(firestore, `users/${user.uid}/scheduledMessages`);\n\n    for (const patientId of workflow.patients) {\n        const patientData = patientsMap.get(patientId);\n        \n        if (!patientData) continue;\n        \n        if (patientData.nextAppointment && patientData.nextAppointment.toDate() > new Date()) {\n            const appointmentDate = patientData.nextAppointment.toDate();\n            \n            const q = query(\n              scheduledMessagesCollection, \n              where(\"patientId\", \"==\", patientId),\n              where(\"workflowId\", \"==\", workflow.id),\n              where(\"status\", \"==\", \"Agendado\")\n            );\n            const existingMessagesSnapshot = await getDocs(q);\n\n            if (existingMessagesSnapshot.empty) {\n                scheduleMessagesForAppointment(user.uid, patientId, appointmentDate, workflow);\n                patientsScheduled++;\n            } else {\n                patientsWithExistingMessages++;\n            }\n        } else {\n          if (!patientData.nextAppointment) {\n            patientsWithoutDate++;\n          }\n        }\n    }\n\n    if (patientsScheduled > 0) {\n      toast({\n        title: \"Fluxo de trabalho iniciado!\",\n        description: `Mensagens foram agendadas para ${patientsScheduled} novo(s) paciente(s).`,\n      });\n    } else {\n       toast({\n        variant: \"default\",\n        title: \"Nenhum novo agendamento\",\n        description: \"Nenhum paciente elegível para novos agendamentos neste fluxo.\",\n      });\n    }\n\n    if (patientsWithExistingMessages > 0) {\n        toast({\n            variant: \"default\",\n            title: \"Aviso de Fluxo\",\n            description: `Este fluxo já possui mensagens agendadas para ${patientsWithExistingMessages} paciente(s) e não será reenviado.`\n        })\n    }\n\n    if (patientsWithoutDate > 0) {\n      toast({\n        variant: \"destructive\",\n        title: \"Aviso de Dados\",\n        description: `${patientsWithoutDate} paciente(s) no fluxo estão sem data de próxima consulta e foram ignorados.`\n      })\n    }\n  };\n  \n  const getScheduleDescription = (wf: Workflow) => {\n    if (!wf.steps || wf.steps.length === 0) return \"Nenhum passo\";\n    \n    const { schedule } = wf.steps[0];\n\n    if (schedule.triggerType === 'specific') {\n        // O timestamp pode vir do Firestore, então garantimos que é um objeto Date\n        const date = (schedule.dateTime as any).toDate ? (schedule.dateTime as any).toDate() : new Date();\n        return `Em ${format(date, \"dd/MM/yyyy 'às' HH:mm\", { locale: ptBR })}`;\n    }\n\n    if (schedule.triggerType === 'relative') {\n        const { quantity, unit, event } = schedule;\n        const unitMap: Record<string, string> = {\n            hours: \"hora(s)\",\n            days: \"dia(s)\",\n            weeks: \"semana(s)\",\n            months: \"mês(es)\"\n        };\n        const friendlyUnit = unitMap[unit] || unit;\n        return `${quantity} ${friendlyUnit} ${event === 'before' ? 'antes' : 'depois'} da consulta`;\n    }\n    \n    return \"Agendamento inválido\";\n  }\n  \n  const renderEmptyState = () => (\n    <div className=\"flex flex-1 items-center justify-center rounded-lg border border-dashed shadow-sm mt-8\">\n      <div className=\"flex flex-col items-center gap-2 text-center\">\n        <WorkflowIcon className=\"h-12 w-12 text-muted-foreground\" />\n        <h3 className=\"text-2xl font-bold tracking-tight\">\n          Nenhum fluxo de automação criado\n        </h3>\n        <p className=\"text-sm text-muted-foreground\">\n          Comece a automatizar sua comunicação criando seu primeiro fluxo.\n        </p>\n        <Button className=\"mt-4\" asChild>\n          <Link href=\"/workflows/new\">\n            <PlusCircle className=\"mr-2 h-4 w-4\" />\n            Criar Fluxo\n          </Link>\n        </Button>\n      </div>\n    </div>\n  );\n\n  if (isLoading || isUserLoading || isLoadingPatients) {\n    return (\n      <div className=\"flex justify-center items-center h-full\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"flex justify-end mb-4\">\n        <Button asChild>\n          <Link href=\"/workflows/new\">\n            <PlusCircle className=\"mr-2 h-4 w-4\" />\n            Criar Fluxo\n          </Link>\n        </Button>\n      </div>\n\n      {workflows && workflows.length > 0 ? (\n        <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n          {workflows.map((wf) => (\n            <Card key={wf.id} className=\"flex flex-col\">\n              <CardHeader>\n                <div className=\"flex justify-between items-start\">\n                  <CardTitle>{wf.title}</CardTitle>\n                  <Switch \n                    checked={wf.active} \n                    onCheckedChange={(checked) => handleToggleActive(wf.id, checked)}\n                    aria-label=\"Ativar ou desativar fluxo\" />\n                </div>\n                <CardDescription>\n                  Enviando para \"{wf.target}\"\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"flex-grow space-y-2\">\n                <p className=\"text-sm text-muted-foreground\">\n                  Agendamento: <span className=\"font-medium text-foreground\">{getScheduleDescription(wf)}</span>\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  Passos: <span className=\"font-medium text-foreground\">{wf.steps.length}</span>\n                </p>\n              </CardContent>\n              <CardFooter className=\"flex justify-between\">\n                <Button variant=\"outline\" size=\"sm\" onClick={() => handleSendNow(wf)}>\n                  <Send className=\"mr-2 h-4 w-4\" />\n                  Enviar Agora\n                </Button>\n                <DropdownMenu>\n                  <DropdownMenuTrigger asChild>\n                    <Button variant=\"ghost\" size=\"icon\">\n                      <MoreVertical className=\"h-4 w-4\" />\n                    </Button>\n                  </DropdownMenuTrigger>\n                  <DropdownMenuContent align=\"end\">\n                    <DropdownMenuLabel>Ações</DropdownMenuLabel>\n                    <DropdownMenuSeparator />\n                    <DropdownMenuItem asChild>\n                      <Link href={`/workflows/edit/${wf.id}`} className=\"flex items-center cursor-pointer\">\n                        <Pencil className=\"mr-2 h-4 w-4\" />\n                        Editar\n                      </Link>\n                    </DropdownMenuItem>\n                    <DropdownMenuItem>\n                      <Copy className=\"mr-2 h-4 w-4\" />\n                      Duplicar\n                    </DropdownMenuItem>\n                    <DropdownMenuItem onClick={() => handleDeleteWorkflow(wf.id)} className=\"text-destructive\">\n                      <Trash className=\"mr-2 h-4 w-4\" />\n                      Excluir\n                    </DropdownMenuItem>\n                  </DropdownMenuContent>\n                </DropdownMenu>\n              </CardFooter>\n            </Card>\n          ))}\n        </div>\n      ) : (\n        renderEmptyState()\n      )}\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}